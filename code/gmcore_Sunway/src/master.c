#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include <time.h>
#include <sys/time.h>
#include <crts.h>

#include"../ExternLIB/filter.h"
#include"../LIB/Process.h"
#include"../LIB/Communicator.h"
#include"../LIB/ParaParam.h"
#include"../LIB/Async.h"
#include"../LIB/NCop.h"
#include"../LIB/Time.h"
#include"../LIB/Memory.h"
#include"../LIB/Diagnose.h"

#include"namelist.h"
#include"physical_variable.h"

#include "slave_struct.h"

#define MIN(a,b) ((a) < (b) ? (a) : (b))
#define MAX(a,b) ((a) > (b) ? (a) : (b))

extern SLAVE_FUN(global_prepare)(void*);
extern SLAVE_FUN(c2a_0_0)(void*);
extern SLAVE_FUN(calc_ph_0_0)(void*);
extern SLAVE_FUN(calc_ph_0_1)(void*);
extern SLAVE_FUN(calc_ph_0_2)(void*);
extern SLAVE_FUN(calc_m_0_0)(void*);
extern SLAVE_FUN(calc_m_0_1)(void*);
extern SLAVE_FUN(calc_m_0_2)(void*);
extern SLAVE_FUN(calc_m_0_3)(void*);
extern SLAVE_FUN(averageCellToLonEdge_0_0)(void*);
extern SLAVE_FUN(averageCellToLatEdge_0_0)(void*);
extern SLAVE_FUN(interpCellToVtx_0_0)(void*);
extern SLAVE_FUN(calc_t_0_0)(void*);
extern SLAVE_FUN(accum_uv_cell_0_0)(void*);
extern SLAVE_FUN(accum_uv_cell_0_1)(void*);
extern SLAVE_FUN(accum_uv_cell_0_2)(void*);
extern SLAVE_FUN(accum_uv_cell_0_3)(void*);
extern SLAVE_FUN(accum_uv_cell_0_4)(void*);
extern SLAVE_FUN(accum_uv_cell_0_5)(void*);
extern SLAVE_FUN(accum_uv_cell_0_6)(void*);
extern SLAVE_FUN(accum_uv_cell_0_7)(void*);
extern SLAVE_FUN(accum_uv_cell_0_8)(void*);
extern SLAVE_FUN(accum_uv_cell_0_9)(void*);
extern SLAVE_FUN(accum_uv_cell_0_10)(void*);
extern SLAVE_FUN(accum_uv_cell_0_11)(void*);
extern SLAVE_FUN(accum_uv_cell_0_12)(void*);
extern SLAVE_FUN(accum_uv_cell_0_13)(void*);
extern SLAVE_FUN(accum_uv_cell_0_14)(void*);
extern SLAVE_FUN(calc_mf_0_0)(void*);
extern SLAVE_FUN(calc_mf_0_1)(void*);
extern SLAVE_FUN(accum_mf_cell_0_0)(void*);
extern SLAVE_FUN(accum_mf_cell_0_1)(void*);
extern SLAVE_FUN(accum_mf_cell_0_2)(void*);
extern SLAVE_FUN(accum_mf_cell_0_3)(void*);
extern SLAVE_FUN(accum_mf_cell_0_4)(void*);
extern SLAVE_FUN(accum_mf_cell_0_5)(void*);
extern SLAVE_FUN(calc_mf_0_2)(void*);
extern SLAVE_FUN(calc_mf_0_3)(void*);
extern SLAVE_FUN(calc_ke_0_0)(void*);
extern SLAVE_FUN(calc_ke_0_1)(void*);
extern SLAVE_FUN(calc_ke_0_2)(void*);
extern SLAVE_FUN(calc_ke_0_3)(void*);
extern SLAVE_FUN(calc_vor_0_0)(void*);
extern SLAVE_FUN(calc_vor_0_1)(void*);
extern SLAVE_FUN(calc_vor_0_2)(void*);
extern SLAVE_FUN(calc_pv_0_0)(void*);
extern SLAVE_FUN(interp_pv_upwind_0_0)(void*);
extern SLAVE_FUN(interp_pv_upwind_0_1)(void*);
extern SLAVE_FUN(calc_div_0_0)(void*);
extern SLAVE_FUN(calc_div_0_1)(void*);
extern SLAVE_FUN(calc_div_0_2)(void*);
extern SLAVE_FUN(calc_gz_lev_0_0)(void*);
extern SLAVE_FUN(copy_old_m_0_0)(void*);
extern SLAVE_FUN(copy_old_m_0_1)(void*);
extern SLAVE_FUN(accum_uv_cell_0_45)(void*);
extern SLAVE_FUN(accum_uv_cell_0_46)(void*);
extern SLAVE_FUN(accum_uv_cell_0_47)(void*);
extern SLAVE_FUN(accum_uv_cell_0_48)(void*);
extern SLAVE_FUN(accum_uv_cell_0_49)(void*);
extern SLAVE_FUN(accum_uv_cell_0_50)(void*);
extern SLAVE_FUN(accum_uv_cell_0_51)(void*);
extern SLAVE_FUN(accum_uv_cell_0_52)(void*);
extern SLAVE_FUN(accum_uv_cell_0_53)(void*);
extern SLAVE_FUN(accum_uv_cell_0_54)(void*);
extern SLAVE_FUN(accum_uv_cell_0_55)(void*);
extern SLAVE_FUN(accum_uv_cell_0_56)(void*);
extern SLAVE_FUN(accum_uv_cell_0_57)(void*);
extern SLAVE_FUN(accum_uv_cell_0_58)(void*);
extern SLAVE_FUN(accum_uv_cell_0_59)(void*);
extern SLAVE_FUN(calc_mf_0_12)(void*);
extern SLAVE_FUN(calc_mf_0_13)(void*);
extern SLAVE_FUN(accum_mf_cell_0_18)(void*);
extern SLAVE_FUN(accum_mf_cell_0_19)(void*);
extern SLAVE_FUN(accum_mf_cell_0_20)(void*);
extern SLAVE_FUN(accum_mf_cell_0_21)(void*);
extern SLAVE_FUN(accum_mf_cell_0_22)(void*);
extern SLAVE_FUN(accum_mf_cell_0_23)(void*);
extern SLAVE_FUN(calc_mf_0_14)(void*);
extern SLAVE_FUN(calc_mf_0_15)(void*);
extern SLAVE_FUN(calc_ke_0_12)(void*);
extern SLAVE_FUN(calc_ke_0_13)(void*);
extern SLAVE_FUN(calc_ke_0_14)(void*);
extern SLAVE_FUN(calc_ke_0_15)(void*);
extern SLAVE_FUN(calc_div_0_9)(void*);
extern SLAVE_FUN(calc_div_0_10)(void*);
extern SLAVE_FUN(calc_div_0_11)(void*);
extern SLAVE_FUN(calc_vor_0_9)(void*);
extern SLAVE_FUN(calc_vor_0_10)(void*);
extern SLAVE_FUN(calc_vor_0_11)(void*);
extern SLAVE_FUN(calc_pv_0_3)(void*);
extern SLAVE_FUN(interp_pv_upwind_0_6)(void*);
extern SLAVE_FUN(interp_pv_upwind_0_7)(void*);
extern SLAVE_FUN(calc_grad_mf_0_8)(void*);
extern SLAVE_FUN(calc_grad_mf_0_9)(void*);
extern SLAVE_FUN(calc_grad_mf_0_10)(void*);
extern SLAVE_FUN(calc_grad_mf_0_11)(void*);
extern SLAVE_FUN(accum_we_lev_0_10)(void*);
extern SLAVE_FUN(accum_we_lev_0_11)(void*);
extern SLAVE_FUN(accum_we_lev_0_12)(void*);
extern SLAVE_FUN(accum_we_lev_0_13)(void*);
extern SLAVE_FUN(accum_we_lev_0_14)(void*);
extern SLAVE_FUN(interp_lev_edge_to_lev_lon_edge_0_2)(void*);
extern SLAVE_FUN(interp_lev_edge_to_lev_lat_edge_0_2)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_0_8)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_0_9)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_0_10)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_0_11)(void*);
extern SLAVE_FUN(hflx_ppm_inner_0_6)(void*);
extern SLAVE_FUN(hflx_ppm_inner_0_7)(void*);
extern SLAVE_FUN(hflx_ppm_inner_0_8)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_0_6)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_0_7)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_0_8)(void*);
extern SLAVE_FUN(hflx_ppm_outer_0_6)(void*);
extern SLAVE_FUN(hflx_ppm_outer_0_7)(void*);
extern SLAVE_FUN(hflx_ppm_outer_0_8)(void*);
extern SLAVE_FUN(calc_grad_ptf_0_12)(void*);
extern SLAVE_FUN(calc_grad_ptf_0_13)(void*);
extern SLAVE_FUN(calc_grad_ptf_0_14)(void*);
extern SLAVE_FUN(calc_grad_ptf_0_15)(void*);
extern SLAVE_FUN(calc_grad_ptf_0_16)(void*);
extern SLAVE_FUN(calc_grad_ptf_0_17)(void*);
extern SLAVE_FUN(calc_coriolis_0_4)(void*);
extern SLAVE_FUN(calc_coriolis_0_5)(void*);
extern SLAVE_FUN(calc_grad_ke_0_4)(void*);
extern SLAVE_FUN(calc_grad_ke_0_5)(void*);
extern SLAVE_FUN(calc_tend_forward_0_6)(void*);
extern SLAVE_FUN(calc_tend_forward_0_7)(void*);
extern SLAVE_FUN(calc_tend_forward_0_8)(void*);
extern SLAVE_FUN(calc_ph_0_15)(void*);
extern SLAVE_FUN(calc_ph_0_16)(void*);
extern SLAVE_FUN(calc_ph_0_17)(void*);
extern SLAVE_FUN(calc_m_0_36)(void*);
extern SLAVE_FUN(calc_m_0_37)(void*);
extern SLAVE_FUN(calc_m_0_38)(void*);
extern SLAVE_FUN(calc_m_0_39)(void*);
extern SLAVE_FUN(averageCellToLonEdge_0_9)(void*);
extern SLAVE_FUN(averageCellToLatEdge_0_9)(void*);
extern SLAVE_FUN(interpCellToVtx_0_9)(void*);
extern SLAVE_FUN(update_state_0_16)(void*);
extern SLAVE_FUN(update_state_0_17)(void*);
extern SLAVE_FUN(calc_m_0_40)(void*);
extern SLAVE_FUN(calc_m_0_41)(void*);
extern SLAVE_FUN(calc_m_0_42)(void*);
extern SLAVE_FUN(calc_m_0_43)(void*);
extern SLAVE_FUN(averageCellToLonEdge_0_10)(void*);
extern SLAVE_FUN(averageCellToLatEdge_0_10)(void*);
extern SLAVE_FUN(interpCellToVtx_0_10)(void*);
extern SLAVE_FUN(update_state_0_18)(void*);
extern SLAVE_FUN(update_state_0_19)(void*);
extern SLAVE_FUN(calc_t_0_3)(void*);
extern SLAVE_FUN(calc_gz_lev_0_3)(void*);
extern SLAVE_FUN(pgf_lin97_0_2)(void*);
extern SLAVE_FUN(calc_tend_backward_0_4)(void*);
extern SLAVE_FUN(calc_tend_backward_0_5)(void*);
extern SLAVE_FUN(calc_ph_0_18)(void*);
extern SLAVE_FUN(calc_ph_0_19)(void*);
extern SLAVE_FUN(calc_ph_0_20)(void*);
extern SLAVE_FUN(calc_m_0_44)(void*);
extern SLAVE_FUN(calc_m_0_45)(void*);
extern SLAVE_FUN(calc_m_0_46)(void*);
extern SLAVE_FUN(calc_m_0_47)(void*);
extern SLAVE_FUN(averageCellToLonEdge_0_11)(void*);
extern SLAVE_FUN(averageCellToLatEdge_0_11)(void*);
extern SLAVE_FUN(interpCellToVtx_0_11)(void*);
extern SLAVE_FUN(update_state_0_20)(void*);
extern SLAVE_FUN(update_state_0_21)(void*);
extern SLAVE_FUN(calc_m_0_48)(void*);
extern SLAVE_FUN(calc_m_0_49)(void*);
extern SLAVE_FUN(calc_m_0_50)(void*);
extern SLAVE_FUN(calc_m_0_51)(void*);
extern SLAVE_FUN(averageCellToLonEdge_0_12)(void*);
extern SLAVE_FUN(averageCellToLatEdge_0_12)(void*);
extern SLAVE_FUN(interpCellToVtx_0_12)(void*);
extern SLAVE_FUN(update_state_0_22)(void*);
extern SLAVE_FUN(update_state_0_23)(void*);
extern SLAVE_FUN(smag_damp_run_0_0)(void*);
extern SLAVE_FUN(smag_damp_run_0_1)(void*);
extern SLAVE_FUN(smag_damp_run_0_2)(void*);
extern SLAVE_FUN(smag_damp_run_0_3)(void*);
extern SLAVE_FUN(smag_damp_run_0_4)(void*);
extern SLAVE_FUN(smag_damp_run_0_5)(void*);
extern SLAVE_FUN(smag_damp_run_0_6)(void*);
extern SLAVE_FUN(smag_damp_run_0_7)(void*);
extern SLAVE_FUN(smag_damp_run_0_8)(void*);
extern SLAVE_FUN(trickypt_0_0)(void*);
extern SLAVE_FUN(calc_ph_0_21)(void*);
extern SLAVE_FUN(calc_ph_0_22)(void*);
extern SLAVE_FUN(calc_ph_0_23)(void*);
extern SLAVE_FUN(calc_m_0_52)(void*);
extern SLAVE_FUN(calc_m_0_53)(void*);
extern SLAVE_FUN(calc_m_0_54)(void*);
extern SLAVE_FUN(calc_m_0_55)(void*);
extern SLAVE_FUN(averageCellToLonEdge_0_13)(void*);
extern SLAVE_FUN(averageCellToLatEdge_0_13)(void*);
extern SLAVE_FUN(interpCellToVtx_0_13)(void*);
extern SLAVE_FUN(pole_damp_run_0_0)(void*);
extern SLAVE_FUN(c2a_0_1)(void*);
extern SLAVE_FUN(accum_uv_cell_0_60)(void*);
extern SLAVE_FUN(accum_uv_cell_0_61)(void*);
extern SLAVE_FUN(accum_uv_cell_0_62)(void*);
extern SLAVE_FUN(accum_uv_cell_0_63)(void*);
extern SLAVE_FUN(accum_uv_cell_0_64)(void*);
extern SLAVE_FUN(accum_uv_cell_0_65)(void*);
extern SLAVE_FUN(accum_uv_cell_0_66)(void*);
extern SLAVE_FUN(accum_uv_cell_0_67)(void*);
extern SLAVE_FUN(accum_uv_cell_0_68)(void*);
extern SLAVE_FUN(accum_uv_cell_0_69)(void*);
extern SLAVE_FUN(accum_uv_cell_0_70)(void*);
extern SLAVE_FUN(accum_uv_cell_0_71)(void*);
extern SLAVE_FUN(accum_uv_cell_0_72)(void*);
extern SLAVE_FUN(accum_uv_cell_0_73)(void*);
extern SLAVE_FUN(accum_uv_cell_0_74)(void*);
extern SLAVE_FUN(accum_mf_cell_0_24)(void*);
extern SLAVE_FUN(accum_mf_cell_0_25)(void*);
extern SLAVE_FUN(accum_mf_cell_0_26)(void*);
extern SLAVE_FUN(accum_mf_cell_0_27)(void*);
extern SLAVE_FUN(accum_mf_cell_0_28)(void*);
extern SLAVE_FUN(accum_mf_cell_0_29)(void*);
extern SLAVE_FUN(accum_we_lev_0_15)(void*);
extern SLAVE_FUN(accum_we_lev_0_16)(void*);
extern SLAVE_FUN(accum_we_lev_0_17)(void*);
extern SLAVE_FUN(accum_we_lev_0_18)(void*);
extern SLAVE_FUN(accum_we_lev_0_19)(void*);
extern SLAVE_FUN(hflx_ppm_inner_0_9)(void*);
extern SLAVE_FUN(hflx_ppm_inner_0_10)(void*);
extern SLAVE_FUN(hflx_ppm_inner_0_11)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_0_9)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_0_10)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_0_11)(void*);
extern SLAVE_FUN(hflx_ppm_outer_0_9)(void*);
extern SLAVE_FUN(hflx_ppm_outer_0_10)(void*);
extern SLAVE_FUN(hflx_ppm_outer_0_11)(void*);
extern SLAVE_FUN(adv_run_0_0)(void*);
extern SLAVE_FUN(adv_run_0_1)(void*);
extern SLAVE_FUN(adv_run_0_2)(void*);
extern SLAVE_FUN(adv_run_0_3)(void*);
extern SLAVE_FUN(adv_run_0_4)(void*);
extern SLAVE_FUN(adv_run_0_5)(void*);
extern SLAVE_FUN(copy_old_m_0_2)(void*);
extern SLAVE_FUN(c2a_1_0)(void*);
extern SLAVE_FUN(calc_ph_1_0)(void*);
extern SLAVE_FUN(calc_ph_1_1)(void*);
extern SLAVE_FUN(calc_ph_1_2)(void*);
extern SLAVE_FUN(calc_m_1_0)(void*);
extern SLAVE_FUN(calc_m_1_1)(void*);
extern SLAVE_FUN(calc_m_1_2)(void*);
extern SLAVE_FUN(calc_m_1_3)(void*);
extern SLAVE_FUN(averageCellToLonEdge_1_0)(void*);
extern SLAVE_FUN(averageCellToLatEdge_1_0)(void*);
extern SLAVE_FUN(interpCellToVtx_1_0)(void*);
extern SLAVE_FUN(calc_t_1_0)(void*);
extern SLAVE_FUN(accum_uv_cell_1_0)(void*);
extern SLAVE_FUN(accum_uv_cell_1_1)(void*);
extern SLAVE_FUN(accum_uv_cell_1_2)(void*);
extern SLAVE_FUN(accum_uv_cell_1_3)(void*);
extern SLAVE_FUN(accum_uv_cell_1_4)(void*);
extern SLAVE_FUN(accum_uv_cell_1_5)(void*);
extern SLAVE_FUN(accum_uv_cell_1_6)(void*);
extern SLAVE_FUN(accum_uv_cell_1_7)(void*);
extern SLAVE_FUN(accum_uv_cell_1_8)(void*);
extern SLAVE_FUN(accum_uv_cell_1_9)(void*);
extern SLAVE_FUN(accum_uv_cell_1_10)(void*);
extern SLAVE_FUN(accum_uv_cell_1_11)(void*);
extern SLAVE_FUN(accum_uv_cell_1_12)(void*);
extern SLAVE_FUN(calc_mf_1_0)(void*);
extern SLAVE_FUN(calc_mf_1_1)(void*);
extern SLAVE_FUN(accum_mf_cell_1_0)(void*);
extern SLAVE_FUN(accum_mf_cell_1_1)(void*);
extern SLAVE_FUN(accum_mf_cell_1_2)(void*);
extern SLAVE_FUN(accum_mf_cell_1_3)(void*);
extern SLAVE_FUN(accum_mf_cell_1_4)(void*);
extern SLAVE_FUN(accum_mf_cell_1_5)(void*);
extern SLAVE_FUN(calc_mf_1_2)(void*);
extern SLAVE_FUN(calc_mf_1_3)(void*);
extern SLAVE_FUN(calc_ke_1_0)(void*);
extern SLAVE_FUN(calc_ke_1_1)(void*);
extern SLAVE_FUN(calc_vor_1_0)(void*);
extern SLAVE_FUN(calc_pv_1_0)(void*);
extern SLAVE_FUN(interp_pv_upwind_1_0)(void*);
extern SLAVE_FUN(interp_pv_upwind_1_1)(void*);
extern SLAVE_FUN(calc_div_1_0)(void*);
extern SLAVE_FUN(calc_gz_lev_1_0)(void*);
extern SLAVE_FUN(copy_old_m_1_0)(void*);
extern SLAVE_FUN(copy_old_m_1_1)(void*);
extern SLAVE_FUN(accum_uv_cell_1_39)(void*);
extern SLAVE_FUN(accum_uv_cell_1_40)(void*);
extern SLAVE_FUN(accum_uv_cell_1_41)(void*);
extern SLAVE_FUN(accum_uv_cell_1_42)(void*);
extern SLAVE_FUN(accum_uv_cell_1_43)(void*);
extern SLAVE_FUN(accum_uv_cell_1_44)(void*);
extern SLAVE_FUN(accum_uv_cell_1_45)(void*);
extern SLAVE_FUN(accum_uv_cell_1_46)(void*);
extern SLAVE_FUN(accum_uv_cell_1_47)(void*);
extern SLAVE_FUN(accum_uv_cell_1_48)(void*);
extern SLAVE_FUN(accum_uv_cell_1_49)(void*);
extern SLAVE_FUN(accum_uv_cell_1_50)(void*);
extern SLAVE_FUN(accum_uv_cell_1_51)(void*);
extern SLAVE_FUN(calc_mf_1_12)(void*);
extern SLAVE_FUN(calc_mf_1_13)(void*);
extern SLAVE_FUN(accum_mf_cell_1_18)(void*);
extern SLAVE_FUN(accum_mf_cell_1_19)(void*);
extern SLAVE_FUN(accum_mf_cell_1_20)(void*);
extern SLAVE_FUN(accum_mf_cell_1_21)(void*);
extern SLAVE_FUN(accum_mf_cell_1_22)(void*);
extern SLAVE_FUN(accum_mf_cell_1_23)(void*);
extern SLAVE_FUN(calc_mf_1_14)(void*);
extern SLAVE_FUN(calc_mf_1_15)(void*);
extern SLAVE_FUN(calc_ke_1_6)(void*);
extern SLAVE_FUN(calc_ke_1_7)(void*);
extern SLAVE_FUN(calc_div_1_3)(void*);
extern SLAVE_FUN(calc_vor_1_3)(void*);
extern SLAVE_FUN(calc_pv_1_3)(void*);
extern SLAVE_FUN(interp_pv_upwind_1_6)(void*);
extern SLAVE_FUN(interp_pv_upwind_1_7)(void*);
extern SLAVE_FUN(calc_grad_mf_1_4)(void*);
extern SLAVE_FUN(calc_grad_mf_1_5)(void*);
extern SLAVE_FUN(accum_we_lev_1_10)(void*);
extern SLAVE_FUN(accum_we_lev_1_11)(void*);
extern SLAVE_FUN(accum_we_lev_1_12)(void*);
extern SLAVE_FUN(accum_we_lev_1_13)(void*);
extern SLAVE_FUN(accum_we_lev_1_14)(void*);
extern SLAVE_FUN(interp_lev_edge_to_lev_lon_edge_1_2)(void*);
extern SLAVE_FUN(interp_lev_edge_to_lev_lat_edge_1_2)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_1_8)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_1_9)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_1_10)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_1_11)(void*);
extern SLAVE_FUN(hflx_ppm_inner_1_6)(void*);
extern SLAVE_FUN(hflx_ppm_inner_1_7)(void*);
extern SLAVE_FUN(hflx_ppm_inner_1_8)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_1_2)(void*);
extern SLAVE_FUN(hflx_ppm_outer_1_6)(void*);
extern SLAVE_FUN(hflx_ppm_outer_1_7)(void*);
extern SLAVE_FUN(hflx_ppm_outer_1_8)(void*);
extern SLAVE_FUN(calc_grad_ptf_1_8)(void*);
extern SLAVE_FUN(calc_grad_ptf_1_9)(void*);
extern SLAVE_FUN(calc_grad_ptf_1_10)(void*);
extern SLAVE_FUN(calc_grad_ptf_1_11)(void*);
extern SLAVE_FUN(calc_coriolis_1_4)(void*);
extern SLAVE_FUN(calc_coriolis_1_5)(void*);
extern SLAVE_FUN(calc_grad_ke_1_4)(void*);
extern SLAVE_FUN(calc_grad_ke_1_5)(void*);
extern SLAVE_FUN(calc_tend_forward_1_6)(void*);
extern SLAVE_FUN(calc_tend_forward_1_7)(void*);
extern SLAVE_FUN(calc_tend_forward_1_8)(void*);
extern SLAVE_FUN(calc_ph_1_15)(void*);
extern SLAVE_FUN(calc_ph_1_16)(void*);
extern SLAVE_FUN(calc_ph_1_17)(void*);
extern SLAVE_FUN(calc_m_1_36)(void*);
extern SLAVE_FUN(calc_m_1_37)(void*);
extern SLAVE_FUN(calc_m_1_38)(void*);
extern SLAVE_FUN(calc_m_1_39)(void*);
extern SLAVE_FUN(averageCellToLonEdge_1_9)(void*);
extern SLAVE_FUN(averageCellToLatEdge_1_9)(void*);
extern SLAVE_FUN(interpCellToVtx_1_9)(void*);
extern SLAVE_FUN(update_state_1_16)(void*);
extern SLAVE_FUN(update_state_1_17)(void*);
extern SLAVE_FUN(calc_m_1_40)(void*);
extern SLAVE_FUN(calc_m_1_41)(void*);
extern SLAVE_FUN(calc_m_1_42)(void*);
extern SLAVE_FUN(calc_m_1_43)(void*);
extern SLAVE_FUN(averageCellToLonEdge_1_10)(void*);
extern SLAVE_FUN(averageCellToLatEdge_1_10)(void*);
extern SLAVE_FUN(interpCellToVtx_1_10)(void*);
extern SLAVE_FUN(update_state_1_18)(void*);
extern SLAVE_FUN(update_state_1_19)(void*);
extern SLAVE_FUN(calc_t_1_3)(void*);
extern SLAVE_FUN(calc_gz_lev_1_3)(void*);
extern SLAVE_FUN(pgf_lin97_1_2)(void*);
extern SLAVE_FUN(calc_tend_backward_1_4)(void*);
extern SLAVE_FUN(calc_tend_backward_1_5)(void*);
extern SLAVE_FUN(calc_ph_1_18)(void*);
extern SLAVE_FUN(calc_ph_1_19)(void*);
extern SLAVE_FUN(calc_ph_1_20)(void*);
extern SLAVE_FUN(calc_m_1_44)(void*);
extern SLAVE_FUN(calc_m_1_45)(void*);
extern SLAVE_FUN(calc_m_1_46)(void*);
extern SLAVE_FUN(calc_m_1_47)(void*);
extern SLAVE_FUN(averageCellToLonEdge_1_11)(void*);
extern SLAVE_FUN(averageCellToLatEdge_1_11)(void*);
extern SLAVE_FUN(interpCellToVtx_1_11)(void*);
extern SLAVE_FUN(update_state_1_20)(void*);
extern SLAVE_FUN(update_state_1_21)(void*);
extern SLAVE_FUN(calc_m_1_48)(void*);
extern SLAVE_FUN(calc_m_1_49)(void*);
extern SLAVE_FUN(calc_m_1_50)(void*);
extern SLAVE_FUN(calc_m_1_51)(void*);
extern SLAVE_FUN(averageCellToLonEdge_1_12)(void*);
extern SLAVE_FUN(averageCellToLatEdge_1_12)(void*);
extern SLAVE_FUN(interpCellToVtx_1_12)(void*);
extern SLAVE_FUN(update_state_1_22)(void*);
extern SLAVE_FUN(update_state_1_23)(void*);
extern SLAVE_FUN(smag_damp_run_1_0)(void*);
extern SLAVE_FUN(smag_damp_run_1_1)(void*);
extern SLAVE_FUN(smag_damp_run_1_2)(void*);
extern SLAVE_FUN(smag_damp_run_1_3)(void*);
extern SLAVE_FUN(smag_damp_run_1_4)(void*);
extern SLAVE_FUN(smag_damp_run_1_5)(void*);
extern SLAVE_FUN(smag_damp_run_1_6)(void*);
extern SLAVE_FUN(smag_damp_run_1_7)(void*);
extern SLAVE_FUN(trickypt_1_0)(void*);
extern SLAVE_FUN(calc_ph_1_21)(void*);
extern SLAVE_FUN(calc_ph_1_22)(void*);
extern SLAVE_FUN(calc_ph_1_23)(void*);
extern SLAVE_FUN(calc_m_1_52)(void*);
extern SLAVE_FUN(calc_m_1_53)(void*);
extern SLAVE_FUN(calc_m_1_54)(void*);
extern SLAVE_FUN(calc_m_1_55)(void*);
extern SLAVE_FUN(averageCellToLonEdge_1_13)(void*);
extern SLAVE_FUN(averageCellToLatEdge_1_13)(void*);
extern SLAVE_FUN(interpCellToVtx_1_13)(void*);
extern SLAVE_FUN(pole_damp_run_1_0)(void*);
extern SLAVE_FUN(c2a_1_1)(void*);
extern SLAVE_FUN(accum_uv_cell_1_52)(void*);
extern SLAVE_FUN(accum_uv_cell_1_53)(void*);
extern SLAVE_FUN(accum_uv_cell_1_54)(void*);
extern SLAVE_FUN(accum_uv_cell_1_55)(void*);
extern SLAVE_FUN(accum_uv_cell_1_56)(void*);
extern SLAVE_FUN(accum_uv_cell_1_57)(void*);
extern SLAVE_FUN(accum_uv_cell_1_58)(void*);
extern SLAVE_FUN(accum_uv_cell_1_59)(void*);
extern SLAVE_FUN(accum_uv_cell_1_60)(void*);
extern SLAVE_FUN(accum_uv_cell_1_61)(void*);
extern SLAVE_FUN(accum_uv_cell_1_62)(void*);
extern SLAVE_FUN(accum_uv_cell_1_63)(void*);
extern SLAVE_FUN(accum_uv_cell_1_64)(void*);
extern SLAVE_FUN(accum_mf_cell_1_24)(void*);
extern SLAVE_FUN(accum_mf_cell_1_25)(void*);
extern SLAVE_FUN(accum_mf_cell_1_26)(void*);
extern SLAVE_FUN(accum_mf_cell_1_27)(void*);
extern SLAVE_FUN(accum_mf_cell_1_28)(void*);
extern SLAVE_FUN(accum_mf_cell_1_29)(void*);
extern SLAVE_FUN(accum_we_lev_1_15)(void*);
extern SLAVE_FUN(accum_we_lev_1_16)(void*);
extern SLAVE_FUN(accum_we_lev_1_17)(void*);
extern SLAVE_FUN(accum_we_lev_1_18)(void*);
extern SLAVE_FUN(accum_we_lev_1_19)(void*);
extern SLAVE_FUN(hflx_ppm_inner_1_9)(void*);
extern SLAVE_FUN(hflx_ppm_inner_1_10)(void*);
extern SLAVE_FUN(hflx_ppm_inner_1_11)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_1_3)(void*);
extern SLAVE_FUN(hflx_ppm_outer_1_9)(void*);
extern SLAVE_FUN(hflx_ppm_outer_1_10)(void*);
extern SLAVE_FUN(hflx_ppm_outer_1_11)(void*);
extern SLAVE_FUN(adv_run_1_0)(void*);
extern SLAVE_FUN(adv_run_1_1)(void*);
extern SLAVE_FUN(adv_run_1_2)(void*);
extern SLAVE_FUN(adv_run_1_3)(void*);
extern SLAVE_FUN(copy_old_m_1_2)(void*);
extern SLAVE_FUN(c2a_2_0)(void*);
extern SLAVE_FUN(calc_ph_2_0)(void*);
extern SLAVE_FUN(calc_ph_2_1)(void*);
extern SLAVE_FUN(calc_ph_2_2)(void*);
extern SLAVE_FUN(calc_m_2_0)(void*);
extern SLAVE_FUN(calc_m_2_1)(void*);
extern SLAVE_FUN(calc_m_2_2)(void*);
extern SLAVE_FUN(calc_m_2_3)(void*);
extern SLAVE_FUN(averageCellToLonEdge_2_0)(void*);
extern SLAVE_FUN(averageCellToLatEdge_2_0)(void*);
extern SLAVE_FUN(interpCellToVtx_2_0)(void*);
extern SLAVE_FUN(calc_t_2_0)(void*);
extern SLAVE_FUN(accum_uv_cell_2_0)(void*);
extern SLAVE_FUN(accum_uv_cell_2_1)(void*);
extern SLAVE_FUN(accum_uv_cell_2_2)(void*);
extern SLAVE_FUN(accum_uv_cell_2_3)(void*);
extern SLAVE_FUN(accum_uv_cell_2_4)(void*);
extern SLAVE_FUN(accum_uv_cell_2_5)(void*);
extern SLAVE_FUN(accum_uv_cell_2_6)(void*);
extern SLAVE_FUN(accum_uv_cell_2_7)(void*);
extern SLAVE_FUN(accum_uv_cell_2_8)(void*);
extern SLAVE_FUN(accum_uv_cell_2_9)(void*);
extern SLAVE_FUN(accum_uv_cell_2_10)(void*);
extern SLAVE_FUN(accum_uv_cell_2_11)(void*);
extern SLAVE_FUN(accum_uv_cell_2_12)(void*);
extern SLAVE_FUN(accum_uv_cell_2_13)(void*);
extern SLAVE_FUN(accum_uv_cell_2_14)(void*);
extern SLAVE_FUN(calc_mf_2_0)(void*);
extern SLAVE_FUN(calc_mf_2_1)(void*);
extern SLAVE_FUN(accum_mf_cell_2_0)(void*);
extern SLAVE_FUN(accum_mf_cell_2_1)(void*);
extern SLAVE_FUN(accum_mf_cell_2_2)(void*);
extern SLAVE_FUN(accum_mf_cell_2_3)(void*);
extern SLAVE_FUN(accum_mf_cell_2_4)(void*);
extern SLAVE_FUN(accum_mf_cell_2_5)(void*);
extern SLAVE_FUN(calc_mf_2_2)(void*);
extern SLAVE_FUN(calc_mf_2_3)(void*);
extern SLAVE_FUN(calc_ke_2_0)(void*);
extern SLAVE_FUN(calc_ke_2_1)(void*);
extern SLAVE_FUN(calc_ke_2_2)(void*);
extern SLAVE_FUN(calc_ke_2_3)(void*);
extern SLAVE_FUN(calc_vor_2_0)(void*);
extern SLAVE_FUN(calc_vor_2_1)(void*);
extern SLAVE_FUN(calc_vor_2_2)(void*);
extern SLAVE_FUN(calc_pv_2_0)(void*);
extern SLAVE_FUN(interp_pv_upwind_2_0)(void*);
extern SLAVE_FUN(interp_pv_upwind_2_1)(void*);
extern SLAVE_FUN(calc_div_2_0)(void*);
extern SLAVE_FUN(calc_div_2_1)(void*);
extern SLAVE_FUN(calc_div_2_2)(void*);
extern SLAVE_FUN(calc_gz_lev_2_0)(void*);
extern SLAVE_FUN(copy_old_m_2_0)(void*);
extern SLAVE_FUN(copy_old_m_2_1)(void*);
extern SLAVE_FUN(accum_uv_cell_2_45)(void*);
extern SLAVE_FUN(accum_uv_cell_2_46)(void*);
extern SLAVE_FUN(accum_uv_cell_2_47)(void*);
extern SLAVE_FUN(accum_uv_cell_2_48)(void*);
extern SLAVE_FUN(accum_uv_cell_2_49)(void*);
extern SLAVE_FUN(accum_uv_cell_2_50)(void*);
extern SLAVE_FUN(accum_uv_cell_2_51)(void*);
extern SLAVE_FUN(accum_uv_cell_2_52)(void*);
extern SLAVE_FUN(accum_uv_cell_2_53)(void*);
extern SLAVE_FUN(accum_uv_cell_2_54)(void*);
extern SLAVE_FUN(accum_uv_cell_2_55)(void*);
extern SLAVE_FUN(accum_uv_cell_2_56)(void*);
extern SLAVE_FUN(accum_uv_cell_2_57)(void*);
extern SLAVE_FUN(accum_uv_cell_2_58)(void*);
extern SLAVE_FUN(accum_uv_cell_2_59)(void*);
extern SLAVE_FUN(calc_mf_2_12)(void*);
extern SLAVE_FUN(calc_mf_2_13)(void*);
extern SLAVE_FUN(accum_mf_cell_2_18)(void*);
extern SLAVE_FUN(accum_mf_cell_2_19)(void*);
extern SLAVE_FUN(accum_mf_cell_2_20)(void*);
extern SLAVE_FUN(accum_mf_cell_2_21)(void*);
extern SLAVE_FUN(accum_mf_cell_2_22)(void*);
extern SLAVE_FUN(accum_mf_cell_2_23)(void*);
extern SLAVE_FUN(calc_mf_2_14)(void*);
extern SLAVE_FUN(calc_mf_2_15)(void*);
extern SLAVE_FUN(calc_ke_2_12)(void*);
extern SLAVE_FUN(calc_ke_2_13)(void*);
extern SLAVE_FUN(calc_ke_2_14)(void*);
extern SLAVE_FUN(calc_ke_2_15)(void*);
extern SLAVE_FUN(calc_div_2_9)(void*);
extern SLAVE_FUN(calc_div_2_10)(void*);
extern SLAVE_FUN(calc_div_2_11)(void*);
extern SLAVE_FUN(calc_vor_2_9)(void*);
extern SLAVE_FUN(calc_vor_2_10)(void*);
extern SLAVE_FUN(calc_vor_2_11)(void*);
extern SLAVE_FUN(calc_pv_2_3)(void*);
extern SLAVE_FUN(interp_pv_upwind_2_6)(void*);
extern SLAVE_FUN(interp_pv_upwind_2_7)(void*);
extern SLAVE_FUN(calc_grad_mf_2_8)(void*);
extern SLAVE_FUN(calc_grad_mf_2_9)(void*);
extern SLAVE_FUN(calc_grad_mf_2_10)(void*);
extern SLAVE_FUN(calc_grad_mf_2_11)(void*);
extern SLAVE_FUN(accum_we_lev_2_10)(void*);
extern SLAVE_FUN(accum_we_lev_2_11)(void*);
extern SLAVE_FUN(accum_we_lev_2_12)(void*);
extern SLAVE_FUN(accum_we_lev_2_13)(void*);
extern SLAVE_FUN(accum_we_lev_2_14)(void*);
extern SLAVE_FUN(interp_lev_edge_to_lev_lon_edge_2_2)(void*);
extern SLAVE_FUN(interp_lev_edge_to_lev_lat_edge_2_2)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_2_8)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_2_9)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_2_10)(void*);
extern SLAVE_FUN(calc_wedudlev_wedvdlev_2_11)(void*);
extern SLAVE_FUN(hflx_ppm_inner_2_6)(void*);
extern SLAVE_FUN(hflx_ppm_inner_2_7)(void*);
extern SLAVE_FUN(hflx_ppm_inner_2_8)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_2_6)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_2_7)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_2_8)(void*);
extern SLAVE_FUN(hflx_ppm_outer_2_6)(void*);
extern SLAVE_FUN(hflx_ppm_outer_2_7)(void*);
extern SLAVE_FUN(hflx_ppm_outer_2_8)(void*);
extern SLAVE_FUN(calc_grad_ptf_2_12)(void*);
extern SLAVE_FUN(calc_grad_ptf_2_13)(void*);
extern SLAVE_FUN(calc_grad_ptf_2_14)(void*);
extern SLAVE_FUN(calc_grad_ptf_2_15)(void*);
extern SLAVE_FUN(calc_grad_ptf_2_16)(void*);
extern SLAVE_FUN(calc_grad_ptf_2_17)(void*);
extern SLAVE_FUN(calc_coriolis_2_4)(void*);
extern SLAVE_FUN(calc_coriolis_2_5)(void*);
extern SLAVE_FUN(calc_grad_ke_2_4)(void*);
extern SLAVE_FUN(calc_grad_ke_2_5)(void*);
extern SLAVE_FUN(calc_tend_forward_2_6)(void*);
extern SLAVE_FUN(calc_tend_forward_2_7)(void*);
extern SLAVE_FUN(calc_tend_forward_2_8)(void*);
extern SLAVE_FUN(calc_ph_2_15)(void*);
extern SLAVE_FUN(calc_ph_2_16)(void*);
extern SLAVE_FUN(calc_ph_2_17)(void*);
extern SLAVE_FUN(calc_m_2_36)(void*);
extern SLAVE_FUN(calc_m_2_37)(void*);
extern SLAVE_FUN(calc_m_2_38)(void*);
extern SLAVE_FUN(calc_m_2_39)(void*);
extern SLAVE_FUN(averageCellToLonEdge_2_9)(void*);
extern SLAVE_FUN(averageCellToLatEdge_2_9)(void*);
extern SLAVE_FUN(interpCellToVtx_2_9)(void*);
extern SLAVE_FUN(update_state_2_16)(void*);
extern SLAVE_FUN(update_state_2_17)(void*);
extern SLAVE_FUN(calc_m_2_40)(void*);
extern SLAVE_FUN(calc_m_2_41)(void*);
extern SLAVE_FUN(calc_m_2_42)(void*);
extern SLAVE_FUN(calc_m_2_43)(void*);
extern SLAVE_FUN(averageCellToLonEdge_2_10)(void*);
extern SLAVE_FUN(averageCellToLatEdge_2_10)(void*);
extern SLAVE_FUN(interpCellToVtx_2_10)(void*);
extern SLAVE_FUN(update_state_2_18)(void*);
extern SLAVE_FUN(update_state_2_19)(void*);
extern SLAVE_FUN(calc_t_2_3)(void*);
extern SLAVE_FUN(calc_gz_lev_2_3)(void*);
extern SLAVE_FUN(pgf_lin97_2_2)(void*);
extern SLAVE_FUN(calc_tend_backward_2_4)(void*);
extern SLAVE_FUN(calc_tend_backward_2_5)(void*);
extern SLAVE_FUN(calc_ph_2_18)(void*);
extern SLAVE_FUN(calc_ph_2_19)(void*);
extern SLAVE_FUN(calc_ph_2_20)(void*);
extern SLAVE_FUN(calc_m_2_44)(void*);
extern SLAVE_FUN(calc_m_2_45)(void*);
extern SLAVE_FUN(calc_m_2_46)(void*);
extern SLAVE_FUN(calc_m_2_47)(void*);
extern SLAVE_FUN(averageCellToLonEdge_2_11)(void*);
extern SLAVE_FUN(averageCellToLatEdge_2_11)(void*);
extern SLAVE_FUN(interpCellToVtx_2_11)(void*);
extern SLAVE_FUN(update_state_2_20)(void*);
extern SLAVE_FUN(update_state_2_21)(void*);
extern SLAVE_FUN(calc_m_2_48)(void*);
extern SLAVE_FUN(calc_m_2_49)(void*);
extern SLAVE_FUN(calc_m_2_50)(void*);
extern SLAVE_FUN(calc_m_2_51)(void*);
extern SLAVE_FUN(averageCellToLonEdge_2_12)(void*);
extern SLAVE_FUN(averageCellToLatEdge_2_12)(void*);
extern SLAVE_FUN(interpCellToVtx_2_12)(void*);
extern SLAVE_FUN(update_state_2_22)(void*);
extern SLAVE_FUN(update_state_2_23)(void*);
extern SLAVE_FUN(smag_damp_run_2_0)(void*);
extern SLAVE_FUN(smag_damp_run_2_1)(void*);
extern SLAVE_FUN(smag_damp_run_2_2)(void*);
extern SLAVE_FUN(smag_damp_run_2_3)(void*);
extern SLAVE_FUN(smag_damp_run_2_4)(void*);
extern SLAVE_FUN(smag_damp_run_2_5)(void*);
extern SLAVE_FUN(smag_damp_run_2_6)(void*);
extern SLAVE_FUN(smag_damp_run_2_7)(void*);
extern SLAVE_FUN(smag_damp_run_2_8)(void*);
extern SLAVE_FUN(trickypt_2_0)(void*);
extern SLAVE_FUN(calc_ph_2_21)(void*);
extern SLAVE_FUN(calc_ph_2_22)(void*);
extern SLAVE_FUN(calc_ph_2_23)(void*);
extern SLAVE_FUN(calc_m_2_52)(void*);
extern SLAVE_FUN(calc_m_2_53)(void*);
extern SLAVE_FUN(calc_m_2_54)(void*);
extern SLAVE_FUN(calc_m_2_55)(void*);
extern SLAVE_FUN(averageCellToLonEdge_2_13)(void*);
extern SLAVE_FUN(averageCellToLatEdge_2_13)(void*);
extern SLAVE_FUN(interpCellToVtx_2_13)(void*);
extern SLAVE_FUN(pole_damp_run_2_0)(void*);
extern SLAVE_FUN(c2a_2_1)(void*);
extern SLAVE_FUN(accum_uv_cell_2_60)(void*);
extern SLAVE_FUN(accum_uv_cell_2_61)(void*);
extern SLAVE_FUN(accum_uv_cell_2_62)(void*);
extern SLAVE_FUN(accum_uv_cell_2_63)(void*);
extern SLAVE_FUN(accum_uv_cell_2_64)(void*);
extern SLAVE_FUN(accum_uv_cell_2_65)(void*);
extern SLAVE_FUN(accum_uv_cell_2_66)(void*);
extern SLAVE_FUN(accum_uv_cell_2_67)(void*);
extern SLAVE_FUN(accum_uv_cell_2_68)(void*);
extern SLAVE_FUN(accum_uv_cell_2_69)(void*);
extern SLAVE_FUN(accum_uv_cell_2_70)(void*);
extern SLAVE_FUN(accum_uv_cell_2_71)(void*);
extern SLAVE_FUN(accum_uv_cell_2_72)(void*);
extern SLAVE_FUN(accum_uv_cell_2_73)(void*);
extern SLAVE_FUN(accum_uv_cell_2_74)(void*);
extern SLAVE_FUN(accum_mf_cell_2_24)(void*);
extern SLAVE_FUN(accum_mf_cell_2_25)(void*);
extern SLAVE_FUN(accum_mf_cell_2_26)(void*);
extern SLAVE_FUN(accum_mf_cell_2_27)(void*);
extern SLAVE_FUN(accum_mf_cell_2_28)(void*);
extern SLAVE_FUN(accum_mf_cell_2_29)(void*);
extern SLAVE_FUN(accum_we_lev_2_15)(void*);
extern SLAVE_FUN(accum_we_lev_2_16)(void*);
extern SLAVE_FUN(accum_we_lev_2_17)(void*);
extern SLAVE_FUN(accum_we_lev_2_18)(void*);
extern SLAVE_FUN(accum_we_lev_2_19)(void*);
extern SLAVE_FUN(hflx_ppm_inner_2_9)(void*);
extern SLAVE_FUN(hflx_ppm_inner_2_10)(void*);
extern SLAVE_FUN(hflx_ppm_inner_2_11)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_2_9)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_2_10)(void*);
extern SLAVE_FUN(ffsl_calc_tracer_hflx_2_11)(void*);
extern SLAVE_FUN(hflx_ppm_outer_2_9)(void*);
extern SLAVE_FUN(hflx_ppm_outer_2_10)(void*);
extern SLAVE_FUN(hflx_ppm_outer_2_11)(void*);
extern SLAVE_FUN(adv_run_2_0)(void*);
extern SLAVE_FUN(adv_run_2_1)(void*);
extern SLAVE_FUN(adv_run_2_2)(void*);
extern SLAVE_FUN(adv_run_2_3)(void*);
extern SLAVE_FUN(adv_run_2_4)(void*);
extern SLAVE_FUN(adv_run_2_5)(void*);
extern SLAVE_FUN(copy_old_m_2_2)(void*);

struct MeshVector3 disect(int inx, struct MeshVector6* loopinfo)
{
  int k, tmp, j, i;
  k = (inx % (loopinfo->lz));
  tmp = (inx / (loopinfo->lz));
  j = (tmp % (loopinfo->ly));
  tmp = (tmp / (loopinfo->ly));
  i = (tmp % (loopinfo->lx));
  return (struct MeshVector3){(i + (loopinfo->sx)),(j + (loopinfo->sy)),(k + (loopinfo->sz))};
}

struct Vector3 cartesian_transform(double lon, double lat)
{
  double cos_lat, x, y, z;
  cos_lat = cos(lat);
  x = ((6371220.0 * cos_lat) * cos(lon));
  y = ((6371220.0 * cos_lat) * sin(lon));
  z = (6371220.0 * sin(lat));
  return (struct Vector3){x,y,z};
}

struct Vector2 inverse_cartesian_transform(double x, double y, double z)
{
  double lon, lat;
  lon = atan2(y,x);
  lat = asin((z / 6371220.0));
  if ((lon < 0.0))
  {
    lon = (lon + 6.283185307179586);
  }
  return (struct Vector2){lon,lat};
}

struct Vector3 cross_product(struct Vector3* a, struct Vector3* b)
{
  struct Vector3 res;
  res = (struct Vector3){0,0,0};
  res.x = (((a->y) * (b->z)) - ((a->z) * (b->y)));
  res.y = (((a->z) * (b->x)) - ((a->x) * (b->z)));
  res.z = (((a->x) * (b->y)) - ((a->y) * (b->x)));
  return res;
}

struct Vector3 norm_vector(struct Vector3* v)
{
  struct Vector3 res;
  double sum;
  res = (struct Vector3){0,0,0};
  sum = ((((v->x) * (v->x)) + ((v->y) * (v->y))) + ((v->z) * (v->z)));
  sum = sqrt(sum);
  if ((sum != 0))
  {
    res.x = ((v->x) / sum);
    res.y = ((v->y) / sum);
    res.z = ((v->z) / sum);
  }
  return res;
}

double calc_sphere_angle(struct Vector3* a, struct Vector3* b, struct Vector3* c)
{
  struct Vector3 nab, nbc, ta, tb;
  double dot, res;
  nab = (struct Vector3){0,0,0};
  nbc = (struct Vector3){0,0,0};
  ta = (struct Vector3){0,0,0};
  tb = (struct Vector3){0,0,0};
  ta = cross_product(a,b);
  tb = cross_product(b,c);
  nab = norm_vector(&ta);
  nbc = norm_vector(&tb);
  dot = (((nab.x * nbc.x) + (nab.y * nbc.y)) + (nab.z * nbc.z));
  res = acos(-MAX(MIN(dot,1.0),-1.0));
  return res;
}

double calc_area(struct Vector3* x, struct Vector3* y, struct Vector3* z)
{
  int n;
  double res, angle;
  struct Vector3 vi, vip, vim;
  n = 3;
  res = 0.0;
  angle = 0.0;
  vi = (struct Vector3){(x->x),(y->x),(z->x)};
  vip = (struct Vector3){(x->y),(y->y),(z->y)};
  vim = (struct Vector3){(x->z),(y->z),(z->z)};
  angle = calc_sphere_angle(&vim,&vi,&vip);
  res = (res + angle);
  angle = calc_sphere_angle(&vi,&vip,&vim);
  res = (res + angle);
  angle = calc_sphere_angle(&vip,&vim,&vi);
  res = (res + angle);
  res = (pow(6371220.0,2) * (res - ((n - 2) * 3.141592653589793)));
  return res;
}

double calc_area_with_last_small_arc(struct Vector3* x, struct Vector3* y, struct Vector3* z)
{
  struct Vector3 xv, yv, zv;
  double res, lat0, lon1, lat1, lon2, dlon, area1, area2, area3;
  struct Vector2 lonlat0, lonlat1, lonlat2;
  xv = (struct Vector3){0,0,0};
  yv = (struct Vector3){0,0,0};
  zv = (struct Vector3){0,0,0};
  res = calc_area(x,y,z);
  lonlat0 = inverse_cartesian_transform((x->x),(y->x),(z->x));
  lat0 = lonlat0.y;
  lonlat1 = inverse_cartesian_transform((x->y),(y->y),(z->y));
  lon1 = lonlat1.x;
  lat1 = lonlat1.y;
  lonlat2 = inverse_cartesian_transform((x->z),(y->z),(z->z));
  lon2 = lonlat2.x;
  if ((lat1 == 0))
  {
    return res;
  }
  else
  {
    if ((lat0 > lat1))
    {
      dlon = (lon2 - lon1);
    }
    else
    {
      dlon = (lon1 - lon2);
    }
    if ((dlon < 0.0))
    {
      dlon = (dlon + 6.283185307179586);
    }
    xv.x = 0.0;
    yv.x = 0.0;
    if ((((lat0 * lat1) >= 0) && (fabs(lat0) > fabs(lat1))))
    {
      xv.y = (x->y);
      yv.y = (y->y);
      zv.y = (z->y);
      xv.z = (x->z);
      yv.z = (y->z);
      zv.z = (z->z);
    }
    else
    {
      xv.y = (x->z);
      yv.y = (y->z);
      zv.y = (z->z);
      xv.z = (x->y);
      yv.z = (y->y);
      zv.z = (z->y);
    }
    if ((lat1 > 0.0))
    {
      zv.x = 6371220.0;
      area1 = ((pow(6371220.0,2) * dlon) * (1.0 - sin(lat1)));
    }
    else
    {
      zv.x = -6371220.0;
      area1 = ((pow(6371220.0,2) * dlon) * (sin(lat1) + 1.0));
    }
    area2 = calc_area(&xv,&yv,&zv);
    area3 = (area1 - area2);
    if (((area3 < 0.0) && (fabs(area3) > 1e-10)))
    {
      area3 = 0;
    }
    if ((((lat0 * lat1) >= 0) && (fabs(lat0) > fabs(lat1))))
    {
      res = (res + area3);
    }
    else
    {
      res = (res - area3);
    }
    return res;
  }
}

double hybrid_coord_calc_ph(double hyam, double hybm, double phs)
{
  return (((hyam * (100000.0 - 219.4)) + (hybm * (phs - 219.4))) + 219.4);
}

double hybrid_coord_calc_ph_lev(double hyai, double hybi, double phs)
{
  return (((hyai * (100000.0 - 219.4)) + (hybi * (phs - 219.4))) + 219.4);
}

double hybrid_coord_calc_dphdt_lev(double hybi, double dphsdt)
{
  return (hybi * dphsdt);
}

double specific_humidity(double qv)
{
  return (qv / (1 + qv));
}

double mixing_ratio(double sh)
{
  return (sh / (1 - sh));
}

double sign(double x, double y)
{
  if ((y > 0.0))
  {
    return x;
  }
  else
  {
    return -x;
  }
}

double potential_temperature(double t, double p, double qv)
{
  return ((t * pow((100000.0 / p),0.2858964143426295)) * (1 + (1.607779403567447 * qv)));
}

double temperature(double pt, double p, double qv)
{
  return ((pt * pow((p / 100000.0),0.2858964143426295)) / (1 + (1.607779403567447 * qv)));
}

double virtual_temperature(double t, double sh)
{
  return (t * (1 + ((1.607779403567447 - 1) * sh)));
}

double dry_air_density(double pt, double p)
{
  return (((100000.0 / 287.04) / pt) * pow((p / 100000.0),0.7141434262948207));
}

double moist_air_density(double t, double p, double qv)
{
  return ((p / 287.04) / virtual_temperature(t,specific_humidity(qv)));
}

double upwind1(double dir, double wgt, double f1, double f2)
{
  return ((0.5 * (f2 + f1)) - (((0.5 * (f2 - f1)) * wgt) * dir));
}

double upwind3(double dir, double wgt, double f1, double f2, double f3, double f4)
{
  double c31, c32, c33;
  c31 = (7.0 / 12.0);
  c32 = (-1.0 / 12.0);
  c33 = (1.0 / 12.0);
  return (((c31 * (f3 + f2)) + (c32 * (f4 + f1))) + (((c33 * ((f4 - f1) - (3 * (f3 - f2)))) * wgt) * dir));
}

double slope(double fm1, double f, double fp1)
{
  double df, df_min, df_max;
  df = ((fp1 - fm1) * 0.5);
  df_min = (2 * (f - MIN(MIN(fm1,f),fp1)));
  df_max = (2 * (MAX(MAX(fm1,f),fp1) - f));
  return sign(MIN(fabs(df),MIN(df_min,df_max)),df);
}

struct Vector3 ppm(double fm2, double fm1, double f, double fp1, double fp2)
{
  double dfl, df, dfr, fl, fr, f6;
  dfl = slope(fm2,fm1,f);
  df = slope(fm1,f,fp1);
  dfr = slope(f,fp1,fp2);
  fl = ((0.5 * (fm1 + f)) + ((dfl - df) / 6.0));
  fr = ((0.5 * (fp1 + f)) + ((df - dfr) / 6.0));
  fl = (f - sign(MIN(fabs(df),fabs((fl - f))),df));
  fr = (f + sign(MIN(fabs(df),fabs((fr - f))),df));
  f6 = ((6 * f) - (3 * (fl + fr)));
  df = (fr - fl);
  return (struct Vector3){fl,df,f6};
}

void LatLonMeshInit(struct HybridMeshField* mesh)
{
  int t, i, j, k;
  struct MeshVector6 loopinfo;
  double dlon, dlat0;
  struct MeshVector3 v_inx;
  struct Vector3 v1, v2, v3, buf;
  t = 0;
  loopinfo = (struct MeshVector6){1,1,2400+2*Proc.lon_hw,0,0,-Proc.lon_hw + 1};
  dlon = (double)(((6.283185307179586 - 0) / 2400));
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(i=0; i<2400+2*Proc.lon_hw; i+=1){
    v_inx = disect(t,&loopinfo);
    t = (t + 1);
    mesh->full_lon[0][0][i] = (0 + ((v_inx.z - 1) * dlon));
    mesh->half_lon[0][0][i] = (mesh->full_lon[0][0][i] + (0.5 * dlon));
    mesh->full_lon_deg[0][0][i] = (mesh->full_lon[0][0][i] * 57.29577951308232);
    mesh->half_lon_deg[0][0][i] = (mesh->half_lon[0][0][i] * 57.29577951308232);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  dlat0 = (double)(((1.5707963267948966 - -1.5707963267948966) / 1199));
  t = 0;
  loopinfo = (struct MeshVector6){1,1199,1,0,1,0};
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    v_inx = disect(t,&loopinfo);
    t = (t + 1);
    mesh->half_lat[0][j][0] = (-1.5707963267948966 + ((v_inx.y - 0.5) * dlat0));
    if ((fabs(mesh->half_lat[0][j][0]) < 1e-12))
    {
      mesh->half_lat[0][j][0] = 0.0;
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    mesh->dlat[0][j][0] = dlat0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1+Proc.lat_hw; j+=1){
    mesh->full_lat[0][j][0] = -1.5707963267948966;
    mesh->full_lat_deg[0][j][0] = (-1.5707963267948966 * 57.29577951308232);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=1+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    mesh->full_lat[0][j][0] = (mesh->full_lat[0][(j - 1)][0] + mesh->dlat[0][(j - 1)][0]);
    if ((fabs(mesh->full_lat[0][j][0]) < 1e-12))
    {
      mesh->full_lat[0][j][0] = 0.0;
    }
    mesh->full_lat_deg[0][j][0] = (mesh->full_lat[0][j][0] * 57.29577951308232);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=1199+Proc.lat_hw; j<1200+Proc.lat_hw; j+=1){
    mesh->full_lat[0][j][0] = 1.5707963267948966;
    mesh->full_lat_deg[0][j][0] = (1.5707963267948966 * 57.29577951308232);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    if (!(mesh->full_lat[0][j][0] == 1.5707963267948966))
    {
      mesh->half_lat[0][j][0] = (mesh->full_lat[0][j][0] + (0.5 * mesh->dlat[0][j][0]));
      if ((fabs(mesh->half_lat[0][j][0]) < 1e-12))
      {
        mesh->half_lat[0][j][0] = 0.0;
      }
      mesh->half_lat_deg[0][j][0] = (mesh->half_lat[0][j][0] * 57.29577951308232);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(i=0; i<2400+2*Proc.lon_hw; i+=1){
    mesh->full_cos_lon[0][0][i] = cos(mesh->full_lon[0][0][i]);
    mesh->full_sin_lon[0][0][i] = sin(mesh->full_lon[0][0][i]);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(i=0; i<2401+2*Proc.lon_hw; i+=1){
    mesh->half_cos_lon[0][0][i] = cos(mesh->half_lon[0][0][i]);
    mesh->half_sin_lon[0][0][i] = sin(mesh->half_lon[0][0][i]);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0; j<1199+2*Proc.lat_hw; j+=1){
    if (((mesh->half_lat[0][j][0] >= -1.5707963267948966) && (mesh->half_lat[0][j][0] <= 1.5707963267948966)))
    {
      mesh->half_cos_lat[0][j][0] = cos(mesh->half_lat[0][j][0]);
      mesh->half_sin_lat[0][j][0] = sin(mesh->half_lat[0][j][0]);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0; j<1200+2*Proc.lat_hw; j+=1){
    if (((mesh->full_lat[0][j][0] >= -1.5707963267948966) && (mesh->full_lat[0][j][0] <= 1.5707963267948966)))
    {
      mesh->full_cos_lat[0][j][0] = cos(mesh->full_lat[0][j][0]);
      mesh->full_sin_lat[0][j][0] = sin(mesh->full_lat[0][j][0]);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1+Proc.lat_hw; j+=1){
    mesh->full_cos_lat[0][j][0] = 0.0;
    mesh->full_sin_lat[0][j][0] = -1.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=1199+Proc.lat_hw; j<1200+Proc.lat_hw; j+=1){
    mesh->full_cos_lat[0][j][0] = 0.0;
    mesh->full_sin_lat[0][j][0] = 1.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1+Proc.lat_hw; j+=1){
    mesh->area_cell[0][j][0] = ((pow(6371220.0,2) * dlon) * (mesh->half_sin_lat[0][j][0] + 1.0));
    mesh->area_subcell_1[0][j][0] = (((pow(6371220.0,2) * 0.5) * dlon) * (mesh->half_sin_lat[0][j][0] + 1.0));
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=1199+Proc.lat_hw; j<1200+Proc.lat_hw; j+=1){
    mesh->area_cell[0][j][0] = ((pow(6371220.0,2) * dlon) * (1.0 - mesh->half_sin_lat[0][(j - 1)][0]));
    mesh->area_subcell_0[0][j][0] = (((pow(6371220.0,2) * 0.5) * dlon) * (1.0 - mesh->half_sin_lat[0][(j - 1)][0]));
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  v1 = (struct Vector3){0.0,0.0,0.0};
  v2 = (struct Vector3){0.0,0.0,0.0};
  v3 = (struct Vector3){0.0,0.0,0.0};
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=1+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    for(i=0+Proc.lon_hw; i<1+Proc.lon_hw; i+=1){
      mesh->area_cell[0][j][0] = ((pow(6371220.0,2) * dlon) * (mesh->half_sin_lat[0][j][0] - mesh->half_sin_lat[0][(j - 1)][0]));
      mesh->area_subcell_0[0][j][0] = (((pow(6371220.0,2) * 0.5) * dlon) * (mesh->full_sin_lat[0][j][0] - mesh->half_sin_lat[0][(j - 1)][0]));
      mesh->area_subcell_1[0][j][0] = (((pow(6371220.0,2) * 0.5) * dlon) * (mesh->half_sin_lat[0][j][0] - mesh->full_sin_lat[0][j][0]));
      buf = cartesian_transform(mesh->full_lon[0][0][i],mesh->full_lat[0][j][0]);
      v1.x = buf.x;
      v2.x = buf.y;
      v3.x = buf.z;
      buf = cartesian_transform(mesh->half_lon[0][0][i],mesh->half_lat[0][(j - 1)][0]);
      v1.y = buf.x;
      v2.y = buf.y;
      v3.y = buf.z;
      buf = cartesian_transform(mesh->half_lon[0][0][i],mesh->half_lat[0][j][0]);
      v1.z = buf.x;
      v2.z = buf.y;
      v3.z = buf.z;
      mesh->area_lon_west[0][j][0] = calc_area(&v1,&v2,&v3);
      mesh->area_lon_east[0][j][0] = mesh->area_lon_west[0][j][0];
      mesh->area_lon[0][j][0] = (mesh->area_lon_west[0][j][0] + mesh->area_lon_east[0][j][0]);
      buf = cartesian_transform(mesh->half_lon[0][0][i],mesh->half_lat[0][j][0]);
      v1.x = buf.x;
      v2.x = buf.y;
      v3.x = buf.z;
      buf = cartesian_transform(mesh->full_lon[0][0][i],mesh->full_lat[0][j][0]);
      v1.y = buf.x;
      v2.y = buf.y;
      v3.y = buf.z;
      buf = cartesian_transform(mesh->full_lon[0][0][(i + 1)],mesh->full_lat[0][j][0]);
      v1.z = buf.x;
      v2.z = buf.y;
      v3.z = buf.z;
      mesh->area_lon_north[0][j][0] = calc_area_with_last_small_arc(&v1,&v2,&v3);
      buf = cartesian_transform(mesh->half_lon[0][0][i],mesh->half_lat[0][(j - 1)][0]);
      v1.x = buf.x;
      v2.x = buf.y;
      v3.x = buf.z;
      buf = cartesian_transform(mesh->full_lon[0][0][(i + 1)],mesh->full_lat[0][j][0]);
      v1.y = buf.x;
      v2.y = buf.y;
      v3.y = buf.z;
      buf = cartesian_transform(mesh->full_lon[0][0][i],mesh->full_lat[0][j][0]);
      v1.z = buf.x;
      v2.z = buf.y;
      v3.z = buf.z;
      mesh->area_lon_south[0][j][0] = calc_area_with_last_small_arc(&v1,&v2,&v3);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    for(i=0+Proc.lon_hw; i<1+Proc.lon_hw; i+=1){
      mesh->area_vtx[0][j][0] = ((pow(6371220.0,2) * dlon) * (mesh->full_sin_lat[0][(j + 1)][0] - mesh->full_sin_lat[0][j][0]));
      buf = cartesian_transform(mesh->half_lon[0][0][i],mesh->half_lat[0][j][0]);
      v1.x = buf.x;
      v2.x = buf.y;
      v3.x = buf.z;
      buf = cartesian_transform(mesh->full_lon[0][0][(i + 1)],mesh->full_lat[0][j][0]);
      v1.y = buf.x;
      v2.y = buf.y;
      v3.y = buf.z;
      buf = cartesian_transform(mesh->full_lon[0][0][(i + 1)],mesh->full_lat[0][(j + 1)][0]);
      v1.z = buf.x;
      v2.z = buf.y;
      v3.z = buf.z;
      mesh->area_lat_west[0][j][0] = calc_area(&v1,&v2,&v3);
      mesh->area_lat_east[0][j][0] = mesh->area_lat_west[0][j][0];
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1198+Proc.lat_hw; j+=1){
    for(i=0+Proc.lon_hw; i<1+Proc.lon_hw; i+=1){
      buf = cartesian_transform(mesh->full_lon[0][0][(i + 1)],mesh->full_lat[0][(j + 1)][0]);
      v1.x = buf.x;
      v2.x = buf.y;
      v3.x = buf.z;
      buf = cartesian_transform(mesh->half_lon[0][0][i],mesh->half_lat[0][j][0]);
      v1.y = buf.x;
      v2.y = buf.y;
      v3.y = buf.z;
      buf = cartesian_transform(mesh->half_lon[0][0][(i + 1)],mesh->half_lat[0][j][0]);
      v1.z = buf.x;
      v2.z = buf.y;
      v3.z = buf.z;
      mesh->area_lat_north[0][j][0] = calc_area_with_last_small_arc(&v1,&v2,&v3);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=1198+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    mesh->area_lat_north[0][j][0] = mesh->area_cell[0][(j + 1)][0];
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1+Proc.lat_hw; j+=1){
    mesh->area_lat_south[0][j][0] = mesh->area_cell[0][j][0];
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=1+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    for(i=0+Proc.lon_hw; i<1+Proc.lon_hw; i+=1){
      buf = cartesian_transform(mesh->full_lon[0][0][(i + 1)],mesh->full_lat[0][j][0]);
      v1.x = buf.x;
      v2.x = buf.y;
      v3.x = buf.z;
      buf = cartesian_transform(mesh->half_lon[0][0][(i + 1)],mesh->half_lat[0][j][0]);
      v1.y = buf.x;
      v2.y = buf.y;
      v3.y = buf.z;
      buf = cartesian_transform(mesh->half_lon[0][0][i],mesh->half_lat[0][j][0]);
      v1.z = buf.x;
      v2.z = buf.y;
      v3.z = buf.z;
      mesh->area_lat_south[0][j][0] = calc_area_with_last_small_arc(&v1,&v2,&v3);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    mesh->area_lat[0][j][0] = (mesh->area_lat_north[0][j][0] + mesh->area_lat_south[0][j][0]);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=1+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    mesh->de_lon[0][j][0] = ((6371220.0 * mesh->full_cos_lat[0][j][0]) * dlon);
    mesh->le_lon[0][j][0] = ((2.0 * mesh->area_lon[0][j][0]) / mesh->de_lon[0][j][0]);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1+Proc.lat_hw; j+=1){
    mesh->le_lon[0][j][0] = 0.0;
    mesh->de_lon[0][j][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=1199+Proc.lat_hw; j<1200+Proc.lat_hw; j+=1){
    mesh->le_lon[0][j][0] = 0.0;
    mesh->de_lon[0][j][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    mesh->le_lat[0][j][0] = ((6371220.0 * mesh->half_cos_lat[0][j][0]) * dlon);
    mesh->de_lat[0][j][0] = ((2.0 * mesh->area_lat[0][j][0]) / mesh->le_lat[0][j][0]);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=1+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    mesh->full_tangent_wgt_0[0][j][0] = ((mesh->le_lat[0][(j - 1)][0] / mesh->de_lon[0][j][0]) * 0.25);
    mesh->full_tangent_wgt_1[0][j][0] = ((mesh->le_lat[0][j][0] / mesh->de_lon[0][j][0]) * 0.25);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    mesh->half_tangent_wgt_0[0][j][0] = ((mesh->le_lon[0][j][0] / mesh->de_lat[0][j][0]) * 0.25);
    mesh->half_tangent_wgt_1[0][j][0] = ((mesh->le_lon[0][(j + 1)][0] / mesh->de_lat[0][j][0]) * 0.25);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1200+Proc.lat_hw; j+=1){
    mesh->full_f[0][j][0] = ((2.0 * 7.27220521664304e-05) * mesh->full_sin_lat[0][j][0]);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=0+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
    mesh->half_f[0][j][0] = ((2.0 * 7.27220521664304e-05) * mesh->half_sin_lat[0][j][0]);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<1+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=1+Proc.lev_hw; k<2+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0027008056640625;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=2+Proc.lev_hw; k<3+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.007686834782362;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=3+Proc.lev_hw; k<4+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0158526937798342;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=4+Proc.lev_hw; k<5+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0276367470939261;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=5+Proc.lev_hw; k<6+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0414515552099706;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=6+Proc.lev_hw; k<7+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0562277844155789;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=7+Proc.lev_hw; k<8+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0724737972365225;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=8+Proc.lev_hw; k<9+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0893795253309864;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=9+Proc.lev_hw; k<10+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.1063548465048298;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=10+Proc.lev_hw; k<11+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.125472525784964;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=11+Proc.lev_hw; k<12+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.1479642011314251;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=12+Proc.lev_hw; k<13+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.1744233770857367;
    mesh->hybi[k][0][0] = 0.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=13+Proc.lev_hw; k<14+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.2054476619883455;
    mesh->hybi[k][0][0] = 0.0001056069805219;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=14+Proc.lev_hw; k<15+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.2362396334209435;
    mesh->hybi[k][0][0] = 0.0059397906834944;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=15+Proc.lev_hw; k<16+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.2617261684535087;
    mesh->hybi[k][0][0] = 0.0235374270991938;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=16+Proc.lev_hw; k<17+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.2783057827853432;
    mesh->hybi[k][0][0] = 0.0576439176162314;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=17+Proc.lev_hw; k<18+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.2816243248017372;
    mesh->hybi[k][0][0] = 0.1139578493851603;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=18+Proc.lev_hw; k<19+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.2683280168286641;
    mesh->hybi[k][0][0] = 0.1932313936022966;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=19+Proc.lev_hw; k<20+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.2429473354807992;
    mesh->hybi[k][0][0] = 0.2808764820852269;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=20+Proc.lev_hw; k<21+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.2108099294331058;
    mesh->hybi[k][0][0] = 0.3715629284436812;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=21+Proc.lev_hw; k<22+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.1759998110016148;
    mesh->hybi[k][0][0] = 0.4612091687348547;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=22+Proc.lev_hw; k<23+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.1415334037742616;
    mesh->hybi[k][0][0] = 0.5467954414732804;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=23+Proc.lev_hw; k<24+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.1095123294032484;
    mesh->hybi[k][0][0] = 0.6262219272258057;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=24+Proc.lev_hw; k<25+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0812761592574764;
    mesh->hybi[k][0][0] = 0.6981497395977654;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=25+Proc.lev_hw; k<26+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0575423961814687;
    mesh->hybi[k][0][0] = 0.7618575996945027;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=26+Proc.lev_hw; k<27+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0385285881906738;
    mesh->hybi[k][0][0] = 0.8171268253424389;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=27+Proc.lev_hw; k<28+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0240694984015316;
    mesh->hybi[k][0][0] = 0.8641240158900223;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=28+Proc.lev_hw; k<29+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0137226170696702;
    mesh->hybi[k][0][0] = 0.9032994538662682;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=29+Proc.lev_hw; k<30+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0068720184783044;
    mesh->hybi[k][0][0] = 0.935256044816174;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=30+Proc.lev_hw; k<31+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0027973066609278;
    mesh->hybi[k][0][0] = 0.9607227915792738;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=31+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0007580797514921;
    mesh->hybi[k][0][0] = 0.9804356127137464;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=32+Proc.lev_hw; k<33+Proc.lev_hw; k+=1){
    mesh->hyai[k][0][0] = 0.0;
    mesh->hybi[k][0][0] = 1.0;
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    mesh->hyam[k][0][0] = (0.5 * (mesh->hyai[k][0][0] + mesh->hyai[(k + 1)][0][0]));
    mesh->hybm[k][0][0] = (0.5 * (mesh->hybi[k][0][0] + mesh->hybi[(k + 1)][0][0]));
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    mesh->full_lev[k][0][0] = (mesh->hyam[k][0][0] + mesh->hybm[k][0][0]);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<33+Proc.lev_hw; k+=1){
    mesh->half_lev[k][0][0] = (mesh->hyai[k][0][0] + mesh->hybi[k][0][0]);
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=1+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
      mesh->c_lon[k][j][0] = (((0.0078125 * MAX(1.0,(8 * (1 + tanh(log((219.4 / hybrid_coord_calc_ph(mesh->hyam[k][0][0],mesh->hybm[k][0][0],100000.0)))))))) * mesh->le_lon[0][j][0]) * mesh->de_lon[0][j][0]);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=0+Proc.lat_hw; j<1199+Proc.lat_hw; j+=1){
      mesh->c_lat[k][j][0] = (((0.0078125 * MAX(1.0,(8 * (1 + tanh(log((219.4 / hybrid_coord_calc_ph(mesh->hyam[k][0][0],mesh->hybm[k][0][0],100000.0)))))))) * mesh->le_lat[0][j][0]) * mesh->de_lat[0][j][0]);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  LatLonMeshInitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void ncIO_Read_0(struct HybridStateField* state, struct HybridStaticField* staticv)
{
  int nid;
  nid = ncOpenFile("gmcore.restart.DSL.15.nc",0);
  ncGetVar(nid, "u_lon", 0, 32, Proc.lev_hw, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.half_nlon, Proc.lon_hw, &(state->u_lon[0][0][0]));
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  
  ncGetVar(nid, "v_lat", 0, 32, Proc.lev_hw, Proc.lat_beg, Proc.half_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(state->v_lat[0][0][0]));
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  
  ncGetVar(nid, "pt", 0, 32, Proc.lev_hw, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(state->pt[0][0][0]));
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  
  ncGetVar(nid, "phs", 0, 1, 0, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(state->phs[0][0][0]));
  UpdateHalo_2d_D(Proc, &state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
  
  ncGetVar(nid, "gzs", 0, 1, 0, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(staticv->gzs[0][0][0]));
  UpdateHalo_2d_D(Proc, &staticv->gzs[0][0][0], &Proc.FieldReq[async_gzs], true, true, true, true, true, true, false);
  
  ncCloseFile(nid);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ncCloseFileTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void spaceOperatorInit_0(struct HybridStaticField* staticv, struct HybridMeshField* mesh)
{
  int j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=MAX(Proc.lat_beg, 1)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
    for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
      staticv->dzsdlon[0][j][i] = (((staticv->gzs[0][j][(i + 1)] - staticv->gzs[0][j][i]) / 9.80616) / mesh->de_lon[0][j][0]);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  prepareStaticdzsdlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
    for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
      staticv->dzsdlat[0][j][i] = (((staticv->gzs[0][(j + 1)][i] - staticv->gzs[0][j][i]) / 9.80616) / mesh->de_lat[0][j][0]);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  prepareStaticdzsdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void gzlevInit_0(struct HybridStateField* state, struct HybridStaticField* staticv)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=32+Proc.lev_hw; k<33+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->gz_lev[k][j][i] = staticv->gzs[0][j][i];
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  preparegzlevgz_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_2d_D(Proc, &state->gz_lev[32 + Proc.lev_hw][0][0], &Proc.FieldReq[async_gz_lev], true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void uvInit_0(struct HybridStateField* state)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  c2a_0_0_info c2a_0_0_para;
  c2a_0_0_para.lz = 32 - 0;
  c2a_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  c2a_0_0_para.lx = MIN(Proc.lon_end+1, 2399) - MAX(Proc.lon_beg, 0);
  c2a_0_0_para.oz = 0;
  c2a_0_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  c2a_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  c2a_0_0_para.hx = 1;
  c2a_0_0_para.hy = 1;
  c2a_0_0_para.hz = 0;
  c2a_0_0_para.bx = 256;
  c2a_0_0_para.by = 8;
  c2a_0_0_para.bz = 1;
  c2a_0_0_para.mx = 1;
  c2a_0_0_para.my = 2;
  c2a_0_0_para.mz = 32;
  c2a_0_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+c2a_0_0_para.oz][Proc.lat_hw -1+c2a_0_0_para.oy][Proc.lon_hw -1+c2a_0_0_para.ox];
  c2a_0_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+c2a_0_0_para.oz][Proc.lat_hw -1+c2a_0_0_para.oy][Proc.lon_hw -1+c2a_0_0_para.ox];
  c2a_0_0_para.stateu = &state->u[Proc.lev_hw - 0+c2a_0_0_para.oz][Proc.lat_hw -1+c2a_0_0_para.oy][Proc.lon_hw -1+c2a_0_0_para.ox];
  c2a_0_0_para.statev = &state->v[Proc.lev_hw - 0+c2a_0_0_para.oz][Proc.lat_hw -1+c2a_0_0_para.oy][Proc.lon_hw -1+c2a_0_0_para.ox];
  
  athread_spawn(c2a_0_0, &c2a_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  c2auTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void operatorPrepareNull_0(struct HybridStateField* state, struct HybridStaticField* staticv, struct HybridAdvField* advpt, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  int k, j, i, l;
  double b, dgz;
  double *tmp_state_tmpsum;
  struct Vector4 ke_vtx;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_phs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_0_0_info calc_ph_0_0_para;
  calc_ph_0_0_para.lz = 33 - 0;
  calc_ph_0_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_0_0_para.oz = 0;
  calc_ph_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_0_0_para.hx = 1;
  calc_ph_0_0_para.hy = 1;
  calc_ph_0_0_para.hz = 0;
  calc_ph_0_0_para.bx = 256;
  calc_ph_0_0_para.by = 8;
  calc_ph_0_0_para.bz = 1;
  calc_ph_0_0_para.mx = 1;
  calc_ph_0_0_para.my = 2;
  calc_ph_0_0_para.mz = 32;
  calc_ph_0_0_para.statephs = &state->phs[0][Proc.lat_hw -1+calc_ph_0_0_para.oy][Proc.lon_hw -1+calc_ph_0_0_para.ox];
  calc_ph_0_0_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_0_0_para.oz][Proc.lat_hw -1+calc_ph_0_0_para.oy][Proc.lon_hw -1+calc_ph_0_0_para.ox];
  calc_ph_0_0_para.hyai = &mesh->hyai[0][0][0];
  calc_ph_0_0_para.hybi = &mesh->hybi[0][0][0];
  
  athread_spawn(calc_ph_0_0, &calc_ph_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_0_1_info calc_ph_0_1_para;
  calc_ph_0_1_para.lz = 33 - 0;
  calc_ph_0_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_0_1_para.oz = 0;
  calc_ph_0_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_0_1_para.hx = 1;
  calc_ph_0_1_para.hy = 1;
  calc_ph_0_1_para.hz = 0;
  calc_ph_0_1_para.bx = 256;
  calc_ph_0_1_para.by = 8;
  calc_ph_0_1_para.bz = 1;
  calc_ph_0_1_para.mx = 1;
  calc_ph_0_1_para.my = 2;
  calc_ph_0_1_para.mz = 32;
  calc_ph_0_1_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_0_1_para.oz][Proc.lat_hw -1+calc_ph_0_1_para.oy][Proc.lon_hw -1+calc_ph_0_1_para.ox];
  calc_ph_0_1_para.stateph_exn_lev = &state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_0_1_para.oz][Proc.lat_hw -1+calc_ph_0_1_para.oy][Proc.lon_hw -1+calc_ph_0_1_para.ox];
  
  athread_spawn(calc_ph_0_1, &calc_ph_0_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_exn_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_0_2_info calc_ph_0_2_para;
  calc_ph_0_2_para.lz = 32 - 0;
  calc_ph_0_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_0_2_para.oz = 0;
  calc_ph_0_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_0_2_para.hx = 0;
  calc_ph_0_2_para.hy = 0;
  calc_ph_0_2_para.hz = 1;
  calc_ph_0_2_para.bx = 256;
  calc_ph_0_2_para.by = 1;
  calc_ph_0_2_para.bz = 4;
  calc_ph_0_2_para.mx = 1;
  calc_ph_0_2_para.my = 8;
  calc_ph_0_2_para.mz = 8;
  calc_ph_0_2_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_ph_0_2_para.oz][Proc.lat_hw -0+calc_ph_0_2_para.oy][Proc.lon_hw -0+calc_ph_0_2_para.ox];
  calc_ph_0_2_para.stateph = &state->ph[Proc.lev_hw - 1+calc_ph_0_2_para.oz][Proc.lat_hw -0+calc_ph_0_2_para.oy][Proc.lon_hw -0+calc_ph_0_2_para.ox];
  
  athread_spawn(calc_ph_0_2, &calc_ph_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phphTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_0_0_info calc_m_0_0_para;
  calc_m_0_0_para.lz = 32 - 0;
  calc_m_0_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_0_0_para.oz = 0;
  calc_m_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_0_0_para.hx = 1;
  calc_m_0_0_para.hy = 0;
  calc_m_0_0_para.hz = 1;
  calc_m_0_0_para.bx = 256;
  calc_m_0_0_para.by = 1;
  calc_m_0_0_para.bz = 4;
  calc_m_0_0_para.mx = 1;
  calc_m_0_0_para.my = 8;
  calc_m_0_0_para.mz = 8;
  calc_m_0_0_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_0_0_para.oz][Proc.lat_hw -0+calc_m_0_0_para.oy][Proc.lon_hw -1+calc_m_0_0_para.ox];
  calc_m_0_0_para.statem = &state->m[Proc.lev_hw - 1+calc_m_0_0_para.oz][Proc.lat_hw -0+calc_m_0_0_para.oy][Proc.lon_hw -1+calc_m_0_0_para.ox];
  
  athread_spawn(calc_m_0_0, &calc_m_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mmTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_0_1_info calc_m_0_1_para;
  calc_m_0_1_para.lz = 32 - 1;
  calc_m_0_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_0_1_para.oz = 1;
  calc_m_0_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_0_1_para.hx = 0;
  calc_m_0_1_para.hy = 0;
  calc_m_0_1_para.hz = 1;
  calc_m_0_1_para.bx = 256;
  calc_m_0_1_para.by = 1;
  calc_m_0_1_para.bz = 4;
  calc_m_0_1_para.mx = 1;
  calc_m_0_1_para.my = 8;
  calc_m_0_1_para.mz = 8;
  calc_m_0_1_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_0_1_para.oz][Proc.lat_hw -0+calc_m_0_1_para.oy][Proc.lon_hw -0+calc_m_0_1_para.ox];
  calc_m_0_1_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_0_1_para.oz][Proc.lat_hw -0+calc_m_0_1_para.oy][Proc.lon_hw -0+calc_m_0_1_para.ox];
  
  athread_spawn(calc_m_0_1, &calc_m_0_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_0_2_info calc_m_0_2_para;
  calc_m_0_2_para.lz = 1 - 0;
  calc_m_0_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_0_2_para.oz = 0;
  calc_m_0_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_0_2_para.hx = 0;
  calc_m_0_2_para.hy = 0;
  calc_m_0_2_para.hz = 0;
  calc_m_0_2_para.bx = 256;
  calc_m_0_2_para.by = 8;
  calc_m_0_2_para.bz = 1;
  calc_m_0_2_para.mx = 1;
  calc_m_0_2_para.my = 2;
  calc_m_0_2_para.mz = 32;
  calc_m_0_2_para.stateph = &state->ph[Proc.lev_hw - 0+calc_m_0_2_para.oz][Proc.lat_hw -0+calc_m_0_2_para.oy][Proc.lon_hw -0+calc_m_0_2_para.ox];
  calc_m_0_2_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_m_0_2_para.oz][Proc.lat_hw -0+calc_m_0_2_para.oy][Proc.lon_hw -0+calc_m_0_2_para.ox];
  calc_m_0_2_para.statem_lev = &state->m_lev[Proc.lev_hw - 0+calc_m_0_2_para.oz][Proc.lat_hw -0+calc_m_0_2_para.oy][Proc.lon_hw -0+calc_m_0_2_para.ox];
  
  athread_spawn(calc_m_0_2, &calc_m_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_0_3_info calc_m_0_3_para;
  calc_m_0_3_para.lz = 33 - 32;
  calc_m_0_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_0_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_0_3_para.oz = 32;
  calc_m_0_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_0_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_0_3_para.hx = 0;
  calc_m_0_3_para.hy = 0;
  calc_m_0_3_para.hz = 1;
  calc_m_0_3_para.bx = 256;
  calc_m_0_3_para.by = 1;
  calc_m_0_3_para.bz = 4;
  calc_m_0_3_para.mx = 1;
  calc_m_0_3_para.my = 8;
  calc_m_0_3_para.mz = 8;
  calc_m_0_3_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_0_3_para.oz][Proc.lat_hw -0+calc_m_0_3_para.oy][Proc.lon_hw -0+calc_m_0_3_para.ox];
  calc_m_0_3_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_0_3_para.oz][Proc.lat_hw -0+calc_m_0_3_para.oy][Proc.lon_hw -0+calc_m_0_3_para.ox];
  calc_m_0_3_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_0_3_para.oz][Proc.lat_hw -0+calc_m_0_3_para.oy][Proc.lon_hw -0+calc_m_0_3_para.ox];
  
  athread_spawn(calc_m_0_3, &calc_m_0_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLonEdge_0_0_info averageCellToLonEdge_0_0_para;
  averageCellToLonEdge_0_0_para.lz = 32 - 0;
  averageCellToLonEdge_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  averageCellToLonEdge_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLonEdge_0_0_para.oz = 0;
  averageCellToLonEdge_0_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  averageCellToLonEdge_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLonEdge_0_0_para.hx = 1;
  averageCellToLonEdge_0_0_para.hy = 1;
  averageCellToLonEdge_0_0_para.hz = 0;
  averageCellToLonEdge_0_0_para.bx = 256;
  averageCellToLonEdge_0_0_para.by = 8;
  averageCellToLonEdge_0_0_para.bz = 1;
  averageCellToLonEdge_0_0_para.mx = 1;
  averageCellToLonEdge_0_0_para.my = 2;
  averageCellToLonEdge_0_0_para.mz = 32;
  averageCellToLonEdge_0_0_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLonEdge_0_0_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_0_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_0_para.ox];
  averageCellToLonEdge_0_0_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_0_0_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_0_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_0_para.ox];
  
  athread_spawn(averageCellToLonEdge_0_0, &averageCellToLonEdge_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLatEdge_0_0_info averageCellToLatEdge_0_0_para;
  averageCellToLatEdge_0_0_para.lz = 32 - 0;
  averageCellToLatEdge_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  averageCellToLatEdge_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLatEdge_0_0_para.oz = 0;
  averageCellToLatEdge_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  averageCellToLatEdge_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLatEdge_0_0_para.hx = 1;
  averageCellToLatEdge_0_0_para.hy = 1;
  averageCellToLatEdge_0_0_para.hz = 0;
  averageCellToLatEdge_0_0_para.bx = 256;
  averageCellToLatEdge_0_0_para.by = 8;
  averageCellToLatEdge_0_0_para.bz = 1;
  averageCellToLatEdge_0_0_para.mx = 1;
  averageCellToLatEdge_0_0_para.my = 2;
  averageCellToLatEdge_0_0_para.mz = 32;
  averageCellToLatEdge_0_0_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLatEdge_0_0_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_0_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_0_para.ox];
  averageCellToLatEdge_0_0_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_0_0_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_0_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_0_para.ox];
  
  athread_spawn(averageCellToLatEdge_0_0, &averageCellToLatEdge_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interpCellToVtx_0_0_info interpCellToVtx_0_0_para;
  interpCellToVtx_0_0_para.lz = 32 - 0;
  interpCellToVtx_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interpCellToVtx_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interpCellToVtx_0_0_para.oz = 0;
  interpCellToVtx_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interpCellToVtx_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interpCellToVtx_0_0_para.hx = 1;
  interpCellToVtx_0_0_para.hy = 1;
  interpCellToVtx_0_0_para.hz = 0;
  interpCellToVtx_0_0_para.bx = 256;
  interpCellToVtx_0_0_para.by = 8;
  interpCellToVtx_0_0_para.bz = 1;
  interpCellToVtx_0_0_para.mx = 1;
  interpCellToVtx_0_0_para.my = 2;
  interpCellToVtx_0_0_para.mz = 32;
  interpCellToVtx_0_0_para.statem = &state->m[Proc.lev_hw - 0+interpCellToVtx_0_0_para.oz][Proc.lat_hw -1+interpCellToVtx_0_0_para.oy][Proc.lon_hw -1+interpCellToVtx_0_0_para.ox];
  interpCellToVtx_0_0_para.statem_vtx = &state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_0_0_para.oz][Proc.lat_hw -1+interpCellToVtx_0_0_para.oy][Proc.lon_hw -1+interpCellToVtx_0_0_para.ox];
  interpCellToVtx_0_0_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  interpCellToVtx_0_0_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  interpCellToVtx_0_0_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(interpCellToVtx_0_0, &interpCellToVtx_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_t_0_0_info calc_t_0_0_para;
  calc_t_0_0_para.lz = 32 - 0;
  calc_t_0_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_t_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_t_0_0_para.oz = 0;
  calc_t_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_t_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_t_0_0_para.hx = 2;
  calc_t_0_0_para.hy = 2;
  calc_t_0_0_para.hz = 0;
  calc_t_0_0_para.bx = 256;
  calc_t_0_0_para.by = 8;
  calc_t_0_0_para.bz = 1;
  calc_t_0_0_para.mx = 1;
  calc_t_0_0_para.my = 2;
  calc_t_0_0_para.mz = 32;
  calc_t_0_0_para.statept = &state->pt[Proc.lev_hw - 0+calc_t_0_0_para.oz][Proc.lat_hw -2+calc_t_0_0_para.oy][Proc.lon_hw -2+calc_t_0_0_para.ox];
  calc_t_0_0_para.stateph = &state->ph[Proc.lev_hw - 0+calc_t_0_0_para.oz][Proc.lat_hw -2+calc_t_0_0_para.oy][Proc.lon_hw -2+calc_t_0_0_para.ox];
  calc_t_0_0_para.stateqv = &state->qv[Proc.lev_hw - 0+calc_t_0_0_para.oz][Proc.lat_hw -2+calc_t_0_0_para.oy][Proc.lon_hw -2+calc_t_0_0_para.ox];
  calc_t_0_0_para.statet = &state->t[Proc.lev_hw - 0+calc_t_0_0_para.oz][Proc.lat_hw -2+calc_t_0_0_para.oy][Proc.lon_hw -2+calc_t_0_0_para.ox];
  
  athread_spawn(calc_t_0_0, &calc_t_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_ttTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  if (((advPara->uv_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_0_info accum_uv_cell_0_0_para;
    accum_uv_cell_0_0_para.lz = 32 - 0;
    accum_uv_cell_0_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_0_para.oz = 0;
    accum_uv_cell_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_0_para.hx = 1;
    accum_uv_cell_0_0_para.hy = 0;
    accum_uv_cell_0_0_para.hz = 0;
    accum_uv_cell_0_0_para.bx = 256;
    accum_uv_cell_0_0_para.by = 8;
    accum_uv_cell_0_0_para.bz = 1;
    accum_uv_cell_0_0_para.mx = 1;
    accum_uv_cell_0_0_para.my = 2;
    accum_uv_cell_0_0_para.mz = 32;
    accum_uv_cell_0_0_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_0_0_para.oz][Proc.lat_hw -0+accum_uv_cell_0_0_para.oy][Proc.lon_hw -1+accum_uv_cell_0_0_para.ox];
    accum_uv_cell_0_0_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_0_para.oz][Proc.lat_hw -0+accum_uv_cell_0_0_para.oy][Proc.lon_hw -1+accum_uv_cell_0_0_para.ox];
    
    athread_spawn(accum_uv_cell_0_0, &accum_uv_cell_0_0_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_1_info accum_uv_cell_0_1_para;
    accum_uv_cell_0_1_para.lz = 32 - 0;
    accum_uv_cell_0_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_1_para.oz = 0;
    accum_uv_cell_0_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_1_para.hx = 0;
    accum_uv_cell_0_1_para.hy = 1;
    accum_uv_cell_0_1_para.hz = 0;
    accum_uv_cell_0_1_para.bx = 256;
    accum_uv_cell_0_1_para.by = 8;
    accum_uv_cell_0_1_para.bz = 1;
    accum_uv_cell_0_1_para.mx = 1;
    accum_uv_cell_0_1_para.my = 2;
    accum_uv_cell_0_1_para.mz = 32;
    accum_uv_cell_0_1_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_0_1_para.oz][Proc.lat_hw -1+accum_uv_cell_0_1_para.oy][Proc.lon_hw -0+accum_uv_cell_0_1_para.ox];
    accum_uv_cell_0_1_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_1_para.oz][Proc.lat_hw -1+accum_uv_cell_0_1_para.oy][Proc.lon_hw -0+accum_uv_cell_0_1_para.ox];
    
    athread_spawn(accum_uv_cell_0_1, &accum_uv_cell_0_1_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->uv_step) = 1;
  }
  if (((advPara->uv_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_2_info accum_uv_cell_0_2_para;
    accum_uv_cell_0_2_para.lz = 32 - 0;
    accum_uv_cell_0_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_2_para.oz = 0;
    accum_uv_cell_0_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_2_para.hx = 1;
    accum_uv_cell_0_2_para.hy = 1;
    accum_uv_cell_0_2_para.hz = 0;
    accum_uv_cell_0_2_para.bx = 256;
    accum_uv_cell_0_2_para.by = 8;
    accum_uv_cell_0_2_para.bz = 1;
    accum_uv_cell_0_2_para.mx = 1;
    accum_uv_cell_0_2_para.my = 2;
    accum_uv_cell_0_2_para.mz = 32;
    accum_uv_cell_0_2_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+accum_uv_cell_0_2_para.oz][Proc.lat_hw -1+accum_uv_cell_0_2_para.oy][Proc.lon_hw -1+accum_uv_cell_0_2_para.ox];
    accum_uv_cell_0_2_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_2_para.oz][Proc.lat_hw -1+accum_uv_cell_0_2_para.oy][Proc.lon_hw -1+accum_uv_cell_0_2_para.ox];
    
    athread_spawn(accum_uv_cell_0_2, &accum_uv_cell_0_2_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_3_info accum_uv_cell_0_3_para;
    accum_uv_cell_0_3_para.lz = 32 - 0;
    accum_uv_cell_0_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_3_para.oz = 0;
    accum_uv_cell_0_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_3_para.hx = 1;
    accum_uv_cell_0_3_para.hy = 1;
    accum_uv_cell_0_3_para.hz = 0;
    accum_uv_cell_0_3_para.bx = 256;
    accum_uv_cell_0_3_para.by = 8;
    accum_uv_cell_0_3_para.bz = 1;
    accum_uv_cell_0_3_para.mx = 1;
    accum_uv_cell_0_3_para.my = 2;
    accum_uv_cell_0_3_para.mz = 32;
    accum_uv_cell_0_3_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+accum_uv_cell_0_3_para.oz][Proc.lat_hw -1+accum_uv_cell_0_3_para.oy][Proc.lon_hw -1+accum_uv_cell_0_3_para.ox];
    accum_uv_cell_0_3_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_3_para.oz][Proc.lat_hw -1+accum_uv_cell_0_3_para.oy][Proc.lon_hw -1+accum_uv_cell_0_3_para.ox];
    
    athread_spawn(accum_uv_cell_0_3, &accum_uv_cell_0_3_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->uv_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_4_info accum_uv_cell_0_4_para;
      accum_uv_cell_0_4_para.lz = 32 - 0;
      accum_uv_cell_0_4_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_4_para.oz = 0;
      accum_uv_cell_0_4_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_4_para.hx = 1;
      accum_uv_cell_0_4_para.hy = 1;
      accum_uv_cell_0_4_para.hz = 0;
      accum_uv_cell_0_4_para.bx = 256;
      accum_uv_cell_0_4_para.by = 8;
      accum_uv_cell_0_4_para.bz = 1;
      accum_uv_cell_0_4_para.mx = 1;
      accum_uv_cell_0_4_para.my = 2;
      accum_uv_cell_0_4_para.mz = 32;
      accum_uv_cell_0_4_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_4_para.oz][Proc.lat_hw -1+accum_uv_cell_0_4_para.oy][Proc.lon_hw -1+accum_uv_cell_0_4_para.ox];
      accum_uv_cell_0_4_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+accum_uv_cell_0_4_para.oz][Proc.lat_hw -1+accum_uv_cell_0_4_para.oy][Proc.lon_hw -1+accum_uv_cell_0_4_para.ox];
      accum_uv_cell_0_4_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_0_4, &accum_uv_cell_0_4_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_5_info accum_uv_cell_0_5_para;
      accum_uv_cell_0_5_para.lz = 32 - 0;
      accum_uv_cell_0_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_5_para.oz = 0;
      accum_uv_cell_0_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_5_para.hx = 1;
      accum_uv_cell_0_5_para.hy = 1;
      accum_uv_cell_0_5_para.hz = 0;
      accum_uv_cell_0_5_para.bx = 256;
      accum_uv_cell_0_5_para.by = 8;
      accum_uv_cell_0_5_para.bz = 1;
      accum_uv_cell_0_5_para.mx = 1;
      accum_uv_cell_0_5_para.my = 2;
      accum_uv_cell_0_5_para.mz = 32;
      accum_uv_cell_0_5_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_5_para.oz][Proc.lat_hw -1+accum_uv_cell_0_5_para.oy][Proc.lon_hw -1+accum_uv_cell_0_5_para.ox];
      accum_uv_cell_0_5_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+accum_uv_cell_0_5_para.oz][Proc.lat_hw -1+accum_uv_cell_0_5_para.oy][Proc.lon_hw -1+accum_uv_cell_0_5_para.ox];
      accum_uv_cell_0_5_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_0_5, &accum_uv_cell_0_5_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_6_info accum_uv_cell_0_6_para;
      accum_uv_cell_0_6_para.lz = 32 - 0;
      accum_uv_cell_0_6_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_6_para.oz = 0;
      accum_uv_cell_0_6_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_6_para.hx = 1;
      accum_uv_cell_0_6_para.hy = 0;
      accum_uv_cell_0_6_para.hz = 0;
      accum_uv_cell_0_6_para.bx = 256;
      accum_uv_cell_0_6_para.by = 8;
      accum_uv_cell_0_6_para.bz = 1;
      accum_uv_cell_0_6_para.mx = 1;
      accum_uv_cell_0_6_para.my = 2;
      accum_uv_cell_0_6_para.mz = 32;
      accum_uv_cell_0_6_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_6_para.oz][Proc.lat_hw -0+accum_uv_cell_0_6_para.oy][Proc.lon_hw -1+accum_uv_cell_0_6_para.ox];
      accum_uv_cell_0_6_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_0_6_para.oz][Proc.lat_hw -0+accum_uv_cell_0_6_para.oy][Proc.lon_hw -1+accum_uv_cell_0_6_para.ox];
      
      athread_spawn(accum_uv_cell_0_6, &accum_uv_cell_0_6_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellu0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_7_info accum_uv_cell_0_7_para;
      accum_uv_cell_0_7_para.lz = 32 - 0;
      accum_uv_cell_0_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_7_para.oz = 0;
      accum_uv_cell_0_7_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_7_para.hx = 0;
      accum_uv_cell_0_7_para.hy = 1;
      accum_uv_cell_0_7_para.hz = 0;
      accum_uv_cell_0_7_para.bx = 256;
      accum_uv_cell_0_7_para.by = 8;
      accum_uv_cell_0_7_para.bz = 1;
      accum_uv_cell_0_7_para.mx = 1;
      accum_uv_cell_0_7_para.my = 2;
      accum_uv_cell_0_7_para.mz = 32;
      accum_uv_cell_0_7_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_7_para.oz][Proc.lat_hw -1+accum_uv_cell_0_7_para.oy][Proc.lon_hw -0+accum_uv_cell_0_7_para.ox];
      accum_uv_cell_0_7_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_0_7_para.oz][Proc.lat_hw -1+accum_uv_cell_0_7_para.oy][Proc.lon_hw -0+accum_uv_cell_0_7_para.ox];
      
      athread_spawn(accum_uv_cell_0_7, &accum_uv_cell_0_7_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellv0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_8_info accum_uv_cell_0_8_para;
      accum_uv_cell_0_8_para.lz = 32 - 0;
      accum_uv_cell_0_8_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_8_para.oz = 0;
      accum_uv_cell_0_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_8_para.hx = 1;
      accum_uv_cell_0_8_para.hy = 1;
      accum_uv_cell_0_8_para.hz = 0;
      accum_uv_cell_0_8_para.bx = 256;
      accum_uv_cell_0_8_para.by = 8;
      accum_uv_cell_0_8_para.bz = 1;
      accum_uv_cell_0_8_para.mx = 1;
      accum_uv_cell_0_8_para.my = 2;
      accum_uv_cell_0_8_para.mz = 32;
      accum_uv_cell_0_8_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_8_para.oz][Proc.lat_hw -1+accum_uv_cell_0_8_para.oy][Proc.lon_hw -1+accum_uv_cell_0_8_para.ox];
      accum_uv_cell_0_8_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+accum_uv_cell_0_8_para.oz][Proc.lat_hw -1+accum_uv_cell_0_8_para.oy][Proc.lon_hw -1+accum_uv_cell_0_8_para.ox];
      
      athread_spawn(accum_uv_cell_0_8, &accum_uv_cell_0_8_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_9_info accum_uv_cell_0_9_para;
      accum_uv_cell_0_9_para.lz = 32 - 0;
      accum_uv_cell_0_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_9_para.oz = 0;
      accum_uv_cell_0_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_9_para.hx = 1;
      accum_uv_cell_0_9_para.hy = 1;
      accum_uv_cell_0_9_para.hz = 0;
      accum_uv_cell_0_9_para.bx = 256;
      accum_uv_cell_0_9_para.by = 8;
      accum_uv_cell_0_9_para.bz = 1;
      accum_uv_cell_0_9_para.mx = 1;
      accum_uv_cell_0_9_para.my = 2;
      accum_uv_cell_0_9_para.mz = 32;
      accum_uv_cell_0_9_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_9_para.oz][Proc.lat_hw -1+accum_uv_cell_0_9_para.oy][Proc.lon_hw -1+accum_uv_cell_0_9_para.ox];
      accum_uv_cell_0_9_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+accum_uv_cell_0_9_para.oz][Proc.lat_hw -1+accum_uv_cell_0_9_para.oy][Proc.lon_hw -1+accum_uv_cell_0_9_para.ox];
      
      athread_spawn(accum_uv_cell_0_9, &accum_uv_cell_0_9_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->uv_step) = 0;
  }
  else
  {
    (advPara->uv_step) = ((advPara->uv_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->uv_step) > (advPara->nstep))))
  {
    if (!(advPara->dynamic))
    {
      (advPara->uv_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_10_info accum_uv_cell_0_10_para;
    accum_uv_cell_0_10_para.lz = 32 - 0;
    accum_uv_cell_0_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_10_para.oz = 0;
    accum_uv_cell_0_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_10_para.hx = 1;
    accum_uv_cell_0_10_para.hy = 0;
    accum_uv_cell_0_10_para.hz = 0;
    accum_uv_cell_0_10_para.bx = 256;
    accum_uv_cell_0_10_para.by = 8;
    accum_uv_cell_0_10_para.bz = 1;
    accum_uv_cell_0_10_para.mx = 1;
    accum_uv_cell_0_10_para.my = 2;
    accum_uv_cell_0_10_para.mz = 32;
    accum_uv_cell_0_10_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_10_para.oz][Proc.lat_hw -0+accum_uv_cell_0_10_para.oy][Proc.lon_hw -1+accum_uv_cell_0_10_para.ox];
    accum_uv_cell_0_10_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+accum_uv_cell_0_10_para.oz][Proc.lat_hw -0+accum_uv_cell_0_10_para.oy][Proc.lon_hw -1+accum_uv_cell_0_10_para.ox];
    accum_uv_cell_0_10_para.de_lon = &mesh->de_lon[0][0][0];
    accum_uv_cell_0_10_para.dt = dt;
    
    athread_spawn(accum_uv_cell_0_10, &accum_uv_cell_0_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_11_info accum_uv_cell_0_11_para;
    accum_uv_cell_0_11_para.lz = 32 - 0;
    accum_uv_cell_0_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_11_para.oz = 0;
    accum_uv_cell_0_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_11_para.hx = 0;
    accum_uv_cell_0_11_para.hy = 1;
    accum_uv_cell_0_11_para.hz = 0;
    accum_uv_cell_0_11_para.bx = 256;
    accum_uv_cell_0_11_para.by = 8;
    accum_uv_cell_0_11_para.bz = 1;
    accum_uv_cell_0_11_para.mx = 1;
    accum_uv_cell_0_11_para.my = 2;
    accum_uv_cell_0_11_para.mz = 32;
    accum_uv_cell_0_11_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_11_para.oz][Proc.lat_hw -1+accum_uv_cell_0_11_para.oy][Proc.lon_hw -0+accum_uv_cell_0_11_para.ox];
    accum_uv_cell_0_11_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+accum_uv_cell_0_11_para.oz][Proc.lat_hw -1+accum_uv_cell_0_11_para.oy][Proc.lon_hw -0+accum_uv_cell_0_11_para.ox];
    accum_uv_cell_0_11_para.de_lat = &mesh->de_lat[0][0][0];
    accum_uv_cell_0_11_para.dt = dt;
    
    athread_spawn(accum_uv_cell_0_11, &accum_uv_cell_0_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_12_info accum_uv_cell_0_12_para;
    accum_uv_cell_0_12_para.lz = 32 - 0;
    accum_uv_cell_0_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_0_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_12_para.oz = 0;
    accum_uv_cell_0_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_0_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_12_para.hx = 1;
    accum_uv_cell_0_12_para.hy = 1;
    accum_uv_cell_0_12_para.hz = 0;
    accum_uv_cell_0_12_para.bx = 256;
    accum_uv_cell_0_12_para.by = 8;
    accum_uv_cell_0_12_para.bz = 1;
    accum_uv_cell_0_12_para.mx = 1;
    accum_uv_cell_0_12_para.my = 2;
    accum_uv_cell_0_12_para.mz = 32;
    accum_uv_cell_0_12_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_12_para.oz][Proc.lat_hw -1+accum_uv_cell_0_12_para.oy][Proc.lon_hw -1+accum_uv_cell_0_12_para.ox];
    accum_uv_cell_0_12_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_12_para.oz][Proc.lat_hw -1+accum_uv_cell_0_12_para.oy][Proc.lon_hw -1+accum_uv_cell_0_12_para.ox];
    accum_uv_cell_0_12_para.advptdivx = &advpt->divx[Proc.lev_hw - 0+accum_uv_cell_0_12_para.oz][Proc.lat_hw -1+accum_uv_cell_0_12_para.oy][Proc.lon_hw -1+accum_uv_cell_0_12_para.ox];
    accum_uv_cell_0_12_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+accum_uv_cell_0_12_para.oz][Proc.lat_hw -1+accum_uv_cell_0_12_para.oy][Proc.lon_hw -1+accum_uv_cell_0_12_para.ox];
    accum_uv_cell_0_12_para.le_lon = &mesh->le_lon[0][0][0];
    accum_uv_cell_0_12_para.area_cell = &mesh->area_cell[0][0][0];
    accum_uv_cell_0_12_para.le_lat = &mesh->le_lat[0][0][0];
    
    athread_spawn(accum_uv_cell_0_12, &accum_uv_cell_0_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_13_info accum_uv_cell_0_13_para;
    accum_uv_cell_0_13_para.lz = 32 - 0;
    accum_uv_cell_0_13_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_13_para.oz = 0;
    accum_uv_cell_0_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_13_para.hx = 0;
    accum_uv_cell_0_13_para.hy = 1;
    accum_uv_cell_0_13_para.hz = 0;
    accum_uv_cell_0_13_para.bx = 256;
    accum_uv_cell_0_13_para.by = 8;
    accum_uv_cell_0_13_para.bz = 1;
    accum_uv_cell_0_13_para.mx = 1;
    accum_uv_cell_0_13_para.my = 2;
    accum_uv_cell_0_13_para.mz = 32;
    accum_uv_cell_0_13_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_13_para.oz][Proc.lat_hw -1+accum_uv_cell_0_13_para.oy][Proc.lon_hw -0+accum_uv_cell_0_13_para.ox];
    accum_uv_cell_0_13_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+accum_uv_cell_0_13_para.oz][Proc.lat_hw -1+accum_uv_cell_0_13_para.oy][Proc.lon_hw -0+accum_uv_cell_0_13_para.ox];
    
    athread_spawn(accum_uv_cell_0_13, &accum_uv_cell_0_13_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celltmpsumTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    // SumCall:state->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
    tmp_state_tmpsum = allocate_1d_array_D(32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          tmp_state_tmpsum[k-Proc.lev_hw]=tmp_state_tmpsum[k-Proc.lev_hw]+state->tmpsum[k][j][i];
        }
      }
    }
    Zonal_Sum_1d_D(Proc, &tmp_state_tmpsum,32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          state->tmpsum[k][j][i]=tmp_state_tmpsum[k-Proc.lev_hw];
        }
      }
    }
    free_1d_array_D(tmp_state_tmpsum,32);
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_14_info accum_uv_cell_0_14_para;
    accum_uv_cell_0_14_para.lz = 32 - 0;
    accum_uv_cell_0_14_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_14_para.oz = 0;
    accum_uv_cell_0_14_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_14_para.hx = 0;
    accum_uv_cell_0_14_para.hy = 0;
    accum_uv_cell_0_14_para.hz = 0;
    accum_uv_cell_0_14_para.bx = 256;
    accum_uv_cell_0_14_para.by = 8;
    accum_uv_cell_0_14_para.bz = 1;
    accum_uv_cell_0_14_para.mx = 1;
    accum_uv_cell_0_14_para.my = 2;
    accum_uv_cell_0_14_para.mz = 32;
    accum_uv_cell_0_14_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+accum_uv_cell_0_14_para.oz][Proc.lat_hw -0+accum_uv_cell_0_14_para.oy][Proc.lon_hw -0+accum_uv_cell_0_14_para.ox];
    accum_uv_cell_0_14_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+accum_uv_cell_0_14_para.oz][Proc.lat_hw -0+accum_uv_cell_0_14_para.oy][Proc.lon_hw -0+accum_uv_cell_0_14_para.ox];
    accum_uv_cell_0_14_para.le_lat = &mesh->le_lat[0][0][0];
    accum_uv_cell_0_14_para.area_cell = &mesh->area_cell[0][0][0];
    
    athread_spawn(accum_uv_cell_0_14, &accum_uv_cell_0_14_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_0_0_info calc_mf_0_0_para;
  calc_mf_0_0_para.lz = 32 - 0;
  calc_mf_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_0_0_para.oz = 0;
  calc_mf_0_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_0_0_para.hx = 1;
  calc_mf_0_0_para.hy = 1;
  calc_mf_0_0_para.hz = 0;
  calc_mf_0_0_para.bx = 256;
  calc_mf_0_0_para.by = 8;
  calc_mf_0_0_para.bz = 1;
  calc_mf_0_0_para.mx = 1;
  calc_mf_0_0_para.my = 2;
  calc_mf_0_0_para.mz = 32;
  calc_mf_0_0_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+calc_mf_0_0_para.oz][Proc.lat_hw -1+calc_mf_0_0_para.oy][Proc.lon_hw -1+calc_mf_0_0_para.ox];
  calc_mf_0_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_mf_0_0_para.oz][Proc.lat_hw -1+calc_mf_0_0_para.oy][Proc.lon_hw -1+calc_mf_0_0_para.ox];
  calc_mf_0_0_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+calc_mf_0_0_para.oz][Proc.lat_hw -1+calc_mf_0_0_para.oy][Proc.lon_hw -1+calc_mf_0_0_para.ox];
  
  athread_spawn(calc_mf_0_0, &calc_mf_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->mfx_lon[0][0][0], &Proc.FieldReq[async_mfx_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_0_1_info calc_mf_0_1_para;
  calc_mf_0_1_para.lz = 32 - 0;
  calc_mf_0_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_0_1_para.oz = 0;
  calc_mf_0_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_0_1_para.hx = 1;
  calc_mf_0_1_para.hy = 1;
  calc_mf_0_1_para.hz = 0;
  calc_mf_0_1_para.bx = 256;
  calc_mf_0_1_para.by = 8;
  calc_mf_0_1_para.bz = 1;
  calc_mf_0_1_para.mx = 1;
  calc_mf_0_1_para.my = 2;
  calc_mf_0_1_para.mz = 32;
  calc_mf_0_1_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+calc_mf_0_1_para.oz][Proc.lat_hw -1+calc_mf_0_1_para.oy][Proc.lon_hw -1+calc_mf_0_1_para.ox];
  calc_mf_0_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_mf_0_1_para.oz][Proc.lat_hw -1+calc_mf_0_1_para.oy][Proc.lon_hw -1+calc_mf_0_1_para.ox];
  calc_mf_0_1_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+calc_mf_0_1_para.oz][Proc.lat_hw -1+calc_mf_0_1_para.oy][Proc.lon_hw -1+calc_mf_0_1_para.ox];
  
  athread_spawn(calc_mf_0_1, &calc_mf_0_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->mfy_lat[0][0][0], &Proc.FieldReq[async_mfy_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  if (((advPara->mf_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfx[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfy[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->mf_step) = 1;
  }
  if (((advPara->mf_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_0_0_info accum_mf_cell_0_0_para;
    accum_mf_cell_0_0_para.lz = 32 - 0;
    accum_mf_cell_0_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_0_0_para.oz = 0;
    accum_mf_cell_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_0_0_para.hx = 1;
    accum_mf_cell_0_0_para.hy = 1;
    accum_mf_cell_0_0_para.hz = 0;
    accum_mf_cell_0_0_para.bx = 256;
    accum_mf_cell_0_0_para.by = 8;
    accum_mf_cell_0_0_para.bz = 1;
    accum_mf_cell_0_0_para.mx = 1;
    accum_mf_cell_0_0_para.my = 2;
    accum_mf_cell_0_0_para.mz = 32;
    accum_mf_cell_0_0_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_0_0_para.oz][Proc.lat_hw -1+accum_mf_cell_0_0_para.oy][Proc.lon_hw -1+accum_mf_cell_0_0_para.ox];
    accum_mf_cell_0_0_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_0_0_para.oz][Proc.lat_hw -1+accum_mf_cell_0_0_para.oy][Proc.lon_hw -1+accum_mf_cell_0_0_para.ox];
    
    athread_spawn(accum_mf_cell_0_0, &accum_mf_cell_0_0_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_0_1_info accum_mf_cell_0_1_para;
    accum_mf_cell_0_1_para.lz = 32 - 0;
    accum_mf_cell_0_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_0_1_para.oz = 0;
    accum_mf_cell_0_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_0_1_para.hx = 1;
    accum_mf_cell_0_1_para.hy = 1;
    accum_mf_cell_0_1_para.hz = 0;
    accum_mf_cell_0_1_para.bx = 256;
    accum_mf_cell_0_1_para.by = 8;
    accum_mf_cell_0_1_para.bz = 1;
    accum_mf_cell_0_1_para.mx = 1;
    accum_mf_cell_0_1_para.my = 2;
    accum_mf_cell_0_1_para.mz = 32;
    accum_mf_cell_0_1_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_0_1_para.oz][Proc.lat_hw -1+accum_mf_cell_0_1_para.oy][Proc.lon_hw -1+accum_mf_cell_0_1_para.ox];
    accum_mf_cell_0_1_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_0_1_para.oz][Proc.lat_hw -1+accum_mf_cell_0_1_para.oy][Proc.lon_hw -1+accum_mf_cell_0_1_para.ox];
    
    athread_spawn(accum_mf_cell_0_1, &accum_mf_cell_0_1_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->mf_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_2_info accum_mf_cell_0_2_para;
      accum_mf_cell_0_2_para.lz = 32 - 0;
      accum_mf_cell_0_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_2_para.oz = 0;
      accum_mf_cell_0_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_2_para.hx = 1;
      accum_mf_cell_0_2_para.hy = 1;
      accum_mf_cell_0_2_para.hz = 0;
      accum_mf_cell_0_2_para.bx = 256;
      accum_mf_cell_0_2_para.by = 8;
      accum_mf_cell_0_2_para.bz = 1;
      accum_mf_cell_0_2_para.mx = 1;
      accum_mf_cell_0_2_para.my = 2;
      accum_mf_cell_0_2_para.mz = 32;
      accum_mf_cell_0_2_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_0_2_para.oz][Proc.lat_hw -1+accum_mf_cell_0_2_para.oy][Proc.lon_hw -1+accum_mf_cell_0_2_para.ox];
      accum_mf_cell_0_2_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_0_2_para.oz][Proc.lat_hw -1+accum_mf_cell_0_2_para.oy][Proc.lon_hw -1+accum_mf_cell_0_2_para.ox];
      accum_mf_cell_0_2_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_0_2, &accum_mf_cell_0_2_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_3_info accum_mf_cell_0_3_para;
      accum_mf_cell_0_3_para.lz = 32 - 0;
      accum_mf_cell_0_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_3_para.oz = 0;
      accum_mf_cell_0_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_3_para.hx = 1;
      accum_mf_cell_0_3_para.hy = 1;
      accum_mf_cell_0_3_para.hz = 0;
      accum_mf_cell_0_3_para.bx = 256;
      accum_mf_cell_0_3_para.by = 8;
      accum_mf_cell_0_3_para.bz = 1;
      accum_mf_cell_0_3_para.mx = 1;
      accum_mf_cell_0_3_para.my = 2;
      accum_mf_cell_0_3_para.mz = 32;
      accum_mf_cell_0_3_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_0_3_para.oz][Proc.lat_hw -1+accum_mf_cell_0_3_para.oy][Proc.lon_hw -1+accum_mf_cell_0_3_para.ox];
      accum_mf_cell_0_3_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_0_3_para.oz][Proc.lat_hw -1+accum_mf_cell_0_3_para.oy][Proc.lon_hw -1+accum_mf_cell_0_3_para.ox];
      accum_mf_cell_0_3_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_0_3, &accum_mf_cell_0_3_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_4_info accum_mf_cell_0_4_para;
      accum_mf_cell_0_4_para.lz = 32 - 0;
      accum_mf_cell_0_4_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_4_para.oz = 0;
      accum_mf_cell_0_4_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_4_para.hx = 1;
      accum_mf_cell_0_4_para.hy = 1;
      accum_mf_cell_0_4_para.hz = 0;
      accum_mf_cell_0_4_para.bx = 256;
      accum_mf_cell_0_4_para.by = 8;
      accum_mf_cell_0_4_para.bz = 1;
      accum_mf_cell_0_4_para.mx = 1;
      accum_mf_cell_0_4_para.my = 2;
      accum_mf_cell_0_4_para.mz = 32;
      accum_mf_cell_0_4_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_0_4_para.oz][Proc.lat_hw -1+accum_mf_cell_0_4_para.oy][Proc.lon_hw -1+accum_mf_cell_0_4_para.ox];
      accum_mf_cell_0_4_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_0_4_para.oz][Proc.lat_hw -1+accum_mf_cell_0_4_para.oy][Proc.lon_hw -1+accum_mf_cell_0_4_para.ox];
      
      athread_spawn(accum_mf_cell_0_4, &accum_mf_cell_0_4_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_5_info accum_mf_cell_0_5_para;
      accum_mf_cell_0_5_para.lz = 32 - 0;
      accum_mf_cell_0_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_5_para.oz = 0;
      accum_mf_cell_0_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_5_para.hx = 1;
      accum_mf_cell_0_5_para.hy = 1;
      accum_mf_cell_0_5_para.hz = 0;
      accum_mf_cell_0_5_para.bx = 256;
      accum_mf_cell_0_5_para.by = 8;
      accum_mf_cell_0_5_para.bz = 1;
      accum_mf_cell_0_5_para.mx = 1;
      accum_mf_cell_0_5_para.my = 2;
      accum_mf_cell_0_5_para.mz = 32;
      accum_mf_cell_0_5_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_0_5_para.oz][Proc.lat_hw -1+accum_mf_cell_0_5_para.oy][Proc.lon_hw -1+accum_mf_cell_0_5_para.ox];
      accum_mf_cell_0_5_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_0_5_para.oz][Proc.lat_hw -1+accum_mf_cell_0_5_para.oy][Proc.lon_hw -1+accum_mf_cell_0_5_para.ox];
      
      athread_spawn(accum_mf_cell_0_5, &accum_mf_cell_0_5_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->mf_step) = 0;
  }
  else
  {
    (advPara->mf_step) = ((advPara->mf_step) + 1);
  }
  if ((!(advPara->dynamic) && ((advPara->mf_step) > (advPara->nstep))))
  {
    (advPara->mf_step) = -1;
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_0_2_info calc_mf_0_2_para;
  calc_mf_0_2_para.lz = 32 - 0;
  calc_mf_0_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_0_2_para.oz = 0;
  calc_mf_0_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_0_2_para.hx = 1;
  calc_mf_0_2_para.hy = 1;
  calc_mf_0_2_para.hz = 0;
  calc_mf_0_2_para.bx = 256;
  calc_mf_0_2_para.by = 8;
  calc_mf_0_2_para.bz = 1;
  calc_mf_0_2_para.mx = 1;
  calc_mf_0_2_para.my = 2;
  calc_mf_0_2_para.mz = 32;
  calc_mf_0_2_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+calc_mf_0_2_para.oz][Proc.lat_hw -1+calc_mf_0_2_para.oy][Proc.lon_hw -1+calc_mf_0_2_para.ox];
  calc_mf_0_2_para.statemfx_lat = &state->mfx_lat[Proc.lev_hw - 0+calc_mf_0_2_para.oz][Proc.lat_hw -1+calc_mf_0_2_para.oy][Proc.lon_hw -1+calc_mf_0_2_para.ox];
  calc_mf_0_2_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+calc_mf_0_2_para.oz][Proc.lat_hw -1+calc_mf_0_2_para.oy][Proc.lon_hw -1+calc_mf_0_2_para.ox];
  calc_mf_0_2_para.stateu_lat = &state->u_lat[Proc.lev_hw - 0+calc_mf_0_2_para.oz][Proc.lat_hw -1+calc_mf_0_2_para.oy][Proc.lon_hw -1+calc_mf_0_2_para.ox];
  calc_mf_0_2_para.half_tangent_wgt_0 = &mesh->half_tangent_wgt_0[0][0][0];
  calc_mf_0_2_para.half_tangent_wgt_1 = &mesh->half_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_0_2, &calc_mf_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_0_3_info calc_mf_0_3_para;
  calc_mf_0_3_para.lz = 32 - 0;
  calc_mf_0_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_0_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_0_3_para.oz = 0;
  calc_mf_0_3_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_0_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_0_3_para.hx = 1;
  calc_mf_0_3_para.hy = 1;
  calc_mf_0_3_para.hz = 0;
  calc_mf_0_3_para.bx = 256;
  calc_mf_0_3_para.by = 8;
  calc_mf_0_3_para.bz = 1;
  calc_mf_0_3_para.mx = 1;
  calc_mf_0_3_para.my = 2;
  calc_mf_0_3_para.mz = 32;
  calc_mf_0_3_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+calc_mf_0_3_para.oz][Proc.lat_hw -1+calc_mf_0_3_para.oy][Proc.lon_hw -1+calc_mf_0_3_para.ox];
  calc_mf_0_3_para.statemfy_lon = &state->mfy_lon[Proc.lev_hw - 0+calc_mf_0_3_para.oz][Proc.lat_hw -1+calc_mf_0_3_para.oy][Proc.lon_hw -1+calc_mf_0_3_para.ox];
  calc_mf_0_3_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+calc_mf_0_3_para.oz][Proc.lat_hw -1+calc_mf_0_3_para.oy][Proc.lon_hw -1+calc_mf_0_3_para.ox];
  calc_mf_0_3_para.statev_lon = &state->v_lon[Proc.lev_hw - 0+calc_mf_0_3_para.oz][Proc.lat_hw -1+calc_mf_0_3_para.oy][Proc.lon_hw -1+calc_mf_0_3_para.ox];
  calc_mf_0_3_para.full_tangent_wgt_0 = &mesh->full_tangent_wgt_0[0][0][0];
  calc_mf_0_3_para.full_tangent_wgt_1 = &mesh->full_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_0_3, &calc_mf_0_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  ke_vtx = (struct Vector4){0.0,0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_0_0_info calc_ke_0_0_para;
  calc_ke_0_0_para.lz = 32 - 0;
  calc_ke_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_0_0_para.oz = 0;
  calc_ke_0_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_0_0_para.hx = 1;
  calc_ke_0_0_para.hy = 1;
  calc_ke_0_0_para.hz = 0;
  calc_ke_0_0_para.bx = 256;
  calc_ke_0_0_para.by = 8;
  calc_ke_0_0_para.bz = 1;
  calc_ke_0_0_para.mx = 1;
  calc_ke_0_0_para.my = 2;
  calc_ke_0_0_para.mz = 32;
  calc_ke_0_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_ke_0_0_para.oz][Proc.lat_hw -1+calc_ke_0_0_para.oy][Proc.lon_hw -1+calc_ke_0_0_para.ox];
  calc_ke_0_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_ke_0_0_para.oz][Proc.lat_hw -1+calc_ke_0_0_para.oy][Proc.lon_hw -1+calc_ke_0_0_para.ox];
  calc_ke_0_0_para.stateke = &state->ke[Proc.lev_hw - 0+calc_ke_0_0_para.oz][Proc.lat_hw -1+calc_ke_0_0_para.oy][Proc.lon_hw -1+calc_ke_0_0_para.ox];
  calc_ke_0_0_para.area_lon_west = &mesh->area_lon_west[0][0][0];
  calc_ke_0_0_para.area_lon_east = &mesh->area_lon_east[0][0][0];
  calc_ke_0_0_para.area_lat_north = &mesh->area_lat_north[0][0][0];
  calc_ke_0_0_para.area_lat_south = &mesh->area_lat_south[0][0][0];
  calc_ke_0_0_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_0_0, &calc_ke_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_0_1_info calc_ke_0_1_para;
  calc_ke_0_1_para.lz = 32 - 0;
  calc_ke_0_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_0_1_para.oz = 0;
  calc_ke_0_1_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_0_1_para.hx = 1;
  calc_ke_0_1_para.hy = 1;
  calc_ke_0_1_para.hz = 0;
  calc_ke_0_1_para.bx = 256;
  calc_ke_0_1_para.by = 8;
  calc_ke_0_1_para.bz = 1;
  calc_ke_0_1_para.mx = 1;
  calc_ke_0_1_para.my = 2;
  calc_ke_0_1_para.mz = 32;
  calc_ke_0_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_ke_0_1_para.oz][Proc.lat_hw -1+calc_ke_0_1_para.oy][Proc.lon_hw -1+calc_ke_0_1_para.ox];
  calc_ke_0_1_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_ke_0_1_para.oz][Proc.lat_hw -1+calc_ke_0_1_para.oy][Proc.lon_hw -1+calc_ke_0_1_para.ox];
  calc_ke_0_1_para.stateke = &state->ke[Proc.lev_hw - 0+calc_ke_0_1_para.oz][Proc.lat_hw -1+calc_ke_0_1_para.oy][Proc.lon_hw -1+calc_ke_0_1_para.ox];
  calc_ke_0_1_para.area_lat_east = &mesh->area_lat_east[0][0][0];
  calc_ke_0_1_para.area_lat_west = &mesh->area_lat_west[0][0][0];
  calc_ke_0_1_para.area_lon_north = &mesh->area_lon_north[0][0][0];
  calc_ke_0_1_para.area_lon_south = &mesh->area_lon_south[0][0][0];
  calc_ke_0_1_para.area_vtx = &mesh->area_vtx[0][0][0];
  calc_ke_0_1_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  calc_ke_0_1_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  calc_ke_0_1_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_0_1, &calc_ke_0_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_0_2_info calc_ke_0_2_para;
  calc_ke_0_2_para.lz = 32 - 0;
  calc_ke_0_2_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_ke_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_0_2_para.oz = 0;
  calc_ke_0_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ke_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_0_2_para.hx = 1;
  calc_ke_0_2_para.hy = 1;
  calc_ke_0_2_para.hz = 0;
  calc_ke_0_2_para.bx = 256;
  calc_ke_0_2_para.by = 8;
  calc_ke_0_2_para.bz = 1;
  calc_ke_0_2_para.mx = 1;
  calc_ke_0_2_para.my = 2;
  calc_ke_0_2_para.mz = 32;
  calc_ke_0_2_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_ke_0_2_para.oz][Proc.lat_hw -1+calc_ke_0_2_para.oy][Proc.lon_hw -1+calc_ke_0_2_para.ox];
  calc_ke_0_2_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_ke_0_2_para.oz][Proc.lat_hw -1+calc_ke_0_2_para.oy][Proc.lon_hw -1+calc_ke_0_2_para.ox];
  
  athread_spawn(calc_ke_0_2, &calc_ke_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_ketmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:state->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
  tmp_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_state_tmpsum[k-Proc.lev_hw]=tmp_state_tmpsum[k-Proc.lev_hw]+state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->tmpsum[k][j][i]=tmp_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_0_3_info calc_ke_0_3_para;
  calc_ke_0_3_para.lz = 32 - 0;
  calc_ke_0_3_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_ke_0_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_0_3_para.oz = 0;
  calc_ke_0_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ke_0_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_0_3_para.hx = 1;
  calc_ke_0_3_para.hy = 1;
  calc_ke_0_3_para.hz = 0;
  calc_ke_0_3_para.bx = 256;
  calc_ke_0_3_para.by = 8;
  calc_ke_0_3_para.bz = 1;
  calc_ke_0_3_para.mx = 1;
  calc_ke_0_3_para.my = 2;
  calc_ke_0_3_para.mz = 32;
  calc_ke_0_3_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_ke_0_3_para.oz][Proc.lat_hw -1+calc_ke_0_3_para.oy][Proc.lon_hw -1+calc_ke_0_3_para.ox];
  calc_ke_0_3_para.stateke = &state->ke[Proc.lev_hw - 0+calc_ke_0_3_para.oz][Proc.lat_hw -1+calc_ke_0_3_para.oy][Proc.lon_hw -1+calc_ke_0_3_para.ox];
  
  athread_spawn(calc_ke_0_3, &calc_ke_0_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->ke[0][0][0], &Proc.FieldReq[async_ke], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_0_0_info calc_vor_0_0_para;
  calc_vor_0_0_para.lz = 32 - 0;
  calc_vor_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_vor_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_0_0_para.oz = 0;
  calc_vor_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_vor_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_0_0_para.hx = 1;
  calc_vor_0_0_para.hy = 1;
  calc_vor_0_0_para.hz = 0;
  calc_vor_0_0_para.bx = 256;
  calc_vor_0_0_para.by = 8;
  calc_vor_0_0_para.bz = 1;
  calc_vor_0_0_para.mx = 1;
  calc_vor_0_0_para.my = 2;
  calc_vor_0_0_para.mz = 32;
  calc_vor_0_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_vor_0_0_para.oz][Proc.lat_hw -1+calc_vor_0_0_para.oy][Proc.lon_hw -1+calc_vor_0_0_para.ox];
  calc_vor_0_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_vor_0_0_para.oz][Proc.lat_hw -1+calc_vor_0_0_para.oy][Proc.lon_hw -1+calc_vor_0_0_para.ox];
  calc_vor_0_0_para.statevor = &state->vor[Proc.lev_hw - 0+calc_vor_0_0_para.oz][Proc.lat_hw -1+calc_vor_0_0_para.oy][Proc.lon_hw -1+calc_vor_0_0_para.ox];
  calc_vor_0_0_para.de_lon = &mesh->de_lon[0][0][0];
  calc_vor_0_0_para.de_lat = &mesh->de_lat[0][0][0];
  calc_vor_0_0_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(calc_vor_0_0, &calc_vor_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vorvorTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_0_1_info calc_vor_0_1_para;
  calc_vor_0_1_para.lz = 32 - 0;
  calc_vor_0_1_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_vor_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_0_1_para.oz = 0;
  calc_vor_0_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_vor_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_0_1_para.hx = 0;
  calc_vor_0_1_para.hy = 0;
  calc_vor_0_1_para.hz = 0;
  calc_vor_0_1_para.bx = 256;
  calc_vor_0_1_para.by = 8;
  calc_vor_0_1_para.bz = 1;
  calc_vor_0_1_para.mx = 1;
  calc_vor_0_1_para.my = 2;
  calc_vor_0_1_para.mz = 32;
  calc_vor_0_1_para.stateu_lat = &state->u_lat[Proc.lev_hw - 0+calc_vor_0_1_para.oz][Proc.lat_hw -0+calc_vor_0_1_para.oy][Proc.lon_hw -0+calc_vor_0_1_para.ox];
  calc_vor_0_1_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_vor_0_1_para.oz][Proc.lat_hw -0+calc_vor_0_1_para.oy][Proc.lon_hw -0+calc_vor_0_1_para.ox];
  calc_vor_0_1_para.le_lat = &mesh->le_lat[0][0][0];
  
  athread_spawn(calc_vor_0_1, &calc_vor_0_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vortmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:state->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
  tmp_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_state_tmpsum[k-Proc.lev_hw]=tmp_state_tmpsum[k-Proc.lev_hw]+state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->tmpsum[k][j][i]=tmp_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_0_2_info calc_vor_0_2_para;
  calc_vor_0_2_para.lz = 32 - 0;
  calc_vor_0_2_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_vor_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_0_2_para.oz = 0;
  calc_vor_0_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_vor_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_0_2_para.hx = 0;
  calc_vor_0_2_para.hy = 0;
  calc_vor_0_2_para.hz = 0;
  calc_vor_0_2_para.bx = 256;
  calc_vor_0_2_para.by = 8;
  calc_vor_0_2_para.bz = 1;
  calc_vor_0_2_para.mx = 1;
  calc_vor_0_2_para.my = 2;
  calc_vor_0_2_para.mz = 32;
  calc_vor_0_2_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_vor_0_2_para.oz][Proc.lat_hw -0+calc_vor_0_2_para.oy][Proc.lon_hw -0+calc_vor_0_2_para.ox];
  calc_vor_0_2_para.statevor = &state->vor[Proc.lev_hw - 0+calc_vor_0_2_para.oz][Proc.lat_hw -0+calc_vor_0_2_para.oy][Proc.lon_hw -0+calc_vor_0_2_para.ox];
  calc_vor_0_2_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_vor_0_2, &calc_vor_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vorvorTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_pv_0_0_info calc_pv_0_0_para;
  calc_pv_0_0_para.lz = 32 - 0;
  calc_pv_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_pv_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_pv_0_0_para.oz = 0;
  calc_pv_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_pv_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_pv_0_0_para.hx = 2;
  calc_pv_0_0_para.hy = 2;
  calc_pv_0_0_para.hz = 0;
  calc_pv_0_0_para.bx = 256;
  calc_pv_0_0_para.by = 8;
  calc_pv_0_0_para.bz = 1;
  calc_pv_0_0_para.mx = 1;
  calc_pv_0_0_para.my = 2;
  calc_pv_0_0_para.mz = 32;
  calc_pv_0_0_para.statevor = &state->vor[Proc.lev_hw - 0+calc_pv_0_0_para.oz][Proc.lat_hw -2+calc_pv_0_0_para.oy][Proc.lon_hw -2+calc_pv_0_0_para.ox];
  calc_pv_0_0_para.statem_vtx = &state->m_vtx[Proc.lev_hw - 0+calc_pv_0_0_para.oz][Proc.lat_hw -2+calc_pv_0_0_para.oy][Proc.lon_hw -2+calc_pv_0_0_para.ox];
  calc_pv_0_0_para.statepv = &state->pv[Proc.lev_hw - 0+calc_pv_0_0_para.oz][Proc.lat_hw -2+calc_pv_0_0_para.oy][Proc.lon_hw -2+calc_pv_0_0_para.ox];
  calc_pv_0_0_para.half_f = &mesh->half_f[0][0][0];
  
  athread_spawn(calc_pv_0_0, &calc_pv_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_pvpvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pv[0][0][0], &Proc.FieldReq[async_pv], false, false, true, true, true, true, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_0_0_info interp_pv_upwind_0_0_para;
  interp_pv_upwind_0_0_para.lz = 32 - 0;
  interp_pv_upwind_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  interp_pv_upwind_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_0_0_para.oz = 0;
  interp_pv_upwind_0_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  interp_pv_upwind_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_0_0_para.hx = 2;
  interp_pv_upwind_0_0_para.hy = 2;
  interp_pv_upwind_0_0_para.hz = 0;
  interp_pv_upwind_0_0_para.bx = 256;
  interp_pv_upwind_0_0_para.by = 8;
  interp_pv_upwind_0_0_para.bz = 1;
  interp_pv_upwind_0_0_para.mx = 1;
  interp_pv_upwind_0_0_para.my = 2;
  interp_pv_upwind_0_0_para.mz = 32;
  interp_pv_upwind_0_0_para.statev_lon = &state->v_lon[Proc.lev_hw - 0+interp_pv_upwind_0_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_0_para.ox];
  interp_pv_upwind_0_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+interp_pv_upwind_0_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_0_para.ox];
  interp_pv_upwind_0_0_para.statepv = &state->pv[Proc.lev_hw - 0+interp_pv_upwind_0_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_0_para.ox];
  interp_pv_upwind_0_0_para.statepv_lon = &state->pv_lon[Proc.lev_hw - 0+interp_pv_upwind_0_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_0_para.ox];
  
  athread_spawn(interp_pv_upwind_0_0, &interp_pv_upwind_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pv_lon[0][0][0], &Proc.FieldReq[async_pv_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_0_1_info interp_pv_upwind_0_1_para;
  interp_pv_upwind_0_1_para.lz = 32 - 0;
  interp_pv_upwind_0_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interp_pv_upwind_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_0_1_para.oz = 0;
  interp_pv_upwind_0_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interp_pv_upwind_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_0_1_para.hx = 2;
  interp_pv_upwind_0_1_para.hy = 2;
  interp_pv_upwind_0_1_para.hz = 0;
  interp_pv_upwind_0_1_para.bx = 256;
  interp_pv_upwind_0_1_para.by = 8;
  interp_pv_upwind_0_1_para.bz = 1;
  interp_pv_upwind_0_1_para.mx = 1;
  interp_pv_upwind_0_1_para.my = 2;
  interp_pv_upwind_0_1_para.mz = 32;
  interp_pv_upwind_0_1_para.stateu_lat = &state->u_lat[Proc.lev_hw - 0+interp_pv_upwind_0_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_1_para.ox];
  interp_pv_upwind_0_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+interp_pv_upwind_0_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_1_para.ox];
  interp_pv_upwind_0_1_para.statepv = &state->pv[Proc.lev_hw - 0+interp_pv_upwind_0_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_1_para.ox];
  interp_pv_upwind_0_1_para.statepv_lat = &state->pv_lat[Proc.lev_hw - 0+interp_pv_upwind_0_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_1_para.ox];
  
  athread_spawn(interp_pv_upwind_0_1, &interp_pv_upwind_0_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pv_lat[0][0][0], &Proc.FieldReq[async_pv_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_0_0_info calc_div_0_0_para;
  calc_div_0_0_para.lz = 32 - 0;
  calc_div_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_div_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_0_0_para.oz = 0;
  calc_div_0_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_div_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_0_0_para.hx = 1;
  calc_div_0_0_para.hy = 1;
  calc_div_0_0_para.hz = 0;
  calc_div_0_0_para.bx = 256;
  calc_div_0_0_para.by = 8;
  calc_div_0_0_para.bz = 1;
  calc_div_0_0_para.mx = 1;
  calc_div_0_0_para.my = 2;
  calc_div_0_0_para.mz = 32;
  calc_div_0_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_div_0_0_para.oz][Proc.lat_hw -1+calc_div_0_0_para.oy][Proc.lon_hw -1+calc_div_0_0_para.ox];
  calc_div_0_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_div_0_0_para.oz][Proc.lat_hw -1+calc_div_0_0_para.oy][Proc.lon_hw -1+calc_div_0_0_para.ox];
  calc_div_0_0_para.statediv = &state->div[Proc.lev_hw - 0+calc_div_0_0_para.oz][Proc.lat_hw -1+calc_div_0_0_para.oy][Proc.lon_hw -1+calc_div_0_0_para.ox];
  calc_div_0_0_para.le_lon = &mesh->le_lon[0][0][0];
  calc_div_0_0_para.le_lat = &mesh->le_lat[0][0][0];
  calc_div_0_0_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_div_0_0, &calc_div_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divdivTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_0_1_info calc_div_0_1_para;
  calc_div_0_1_para.lz = 32 - 0;
  calc_div_0_1_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_div_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_0_1_para.oz = 0;
  calc_div_0_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_div_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_0_1_para.hx = 1;
  calc_div_0_1_para.hy = 1;
  calc_div_0_1_para.hz = 0;
  calc_div_0_1_para.bx = 256;
  calc_div_0_1_para.by = 8;
  calc_div_0_1_para.bz = 1;
  calc_div_0_1_para.mx = 1;
  calc_div_0_1_para.my = 2;
  calc_div_0_1_para.mz = 32;
  calc_div_0_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_div_0_1_para.oz][Proc.lat_hw -1+calc_div_0_1_para.oy][Proc.lon_hw -1+calc_div_0_1_para.ox];
  calc_div_0_1_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_div_0_1_para.oz][Proc.lat_hw -1+calc_div_0_1_para.oy][Proc.lon_hw -1+calc_div_0_1_para.ox];
  
  athread_spawn(calc_div_0_1, &calc_div_0_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divtmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:state->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
  tmp_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_state_tmpsum[k-Proc.lev_hw]=tmp_state_tmpsum[k-Proc.lev_hw]+state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->tmpsum[k][j][i]=tmp_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_0_2_info calc_div_0_2_para;
  calc_div_0_2_para.lz = 32 - 0;
  calc_div_0_2_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_div_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_0_2_para.oz = 0;
  calc_div_0_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_div_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_0_2_para.hx = 1;
  calc_div_0_2_para.hy = 1;
  calc_div_0_2_para.hz = 0;
  calc_div_0_2_para.bx = 256;
  calc_div_0_2_para.by = 8;
  calc_div_0_2_para.bz = 1;
  calc_div_0_2_para.mx = 1;
  calc_div_0_2_para.my = 2;
  calc_div_0_2_para.mz = 32;
  calc_div_0_2_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_div_0_2_para.oz][Proc.lat_hw -1+calc_div_0_2_para.oy][Proc.lon_hw -1+calc_div_0_2_para.ox];
  calc_div_0_2_para.statediv = &state->div[Proc.lev_hw - 0+calc_div_0_2_para.oz][Proc.lat_hw -1+calc_div_0_2_para.oy][Proc.lon_hw -1+calc_div_0_2_para.ox];
  calc_div_0_2_para.le_lat = &mesh->le_lat[0][0][0];
  calc_div_0_2_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_div_0_2, &calc_div_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divdivTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->div[0][0][0], &Proc.FieldReq[async_div], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_gz_lev_0_0_info calc_gz_lev_0_0_para;
  calc_gz_lev_0_0_para.lz = 32 - 0;
  calc_gz_lev_0_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_gz_lev_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_gz_lev_0_0_para.oz = 0;
  calc_gz_lev_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_gz_lev_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_gz_lev_0_0_para.hx = 1;
  calc_gz_lev_0_0_para.hy = 0;
  calc_gz_lev_0_0_para.hz = Proc.lev_hw;
  calc_gz_lev_0_0_para.bx = 64;
  calc_gz_lev_0_0_para.by = 1;
  calc_gz_lev_0_0_para.bz = 32;
  calc_gz_lev_0_0_para.mx = 8;
  calc_gz_lev_0_0_para.my = 8;
  calc_gz_lev_0_0_para.mz = 1;
  calc_gz_lev_0_0_para.statet = &state->t[Proc.lev_hw - calc_gz_lev_0_0_para.hz+calc_gz_lev_0_0_para.oz][Proc.lat_hw -0+calc_gz_lev_0_0_para.oy][Proc.lon_hw -1+calc_gz_lev_0_0_para.ox];
  calc_gz_lev_0_0_para.stateph_lev = &state->ph_lev[Proc.lev_hw - calc_gz_lev_0_0_para.hz+calc_gz_lev_0_0_para.oz][Proc.lat_hw -0+calc_gz_lev_0_0_para.oy][Proc.lon_hw -1+calc_gz_lev_0_0_para.ox];
  calc_gz_lev_0_0_para.staticvgzs = &staticv->gzs[0][Proc.lat_hw -0+calc_gz_lev_0_0_para.oy][Proc.lon_hw -1+calc_gz_lev_0_0_para.ox];
  calc_gz_lev_0_0_para.stategz_lev = &state->gz_lev[Proc.lev_hw - calc_gz_lev_0_0_para.hz+calc_gz_lev_0_0_para.oz][Proc.lat_hw -0+calc_gz_lev_0_0_para.oy][Proc.lon_hw -1+calc_gz_lev_0_0_para.ox];
  
  athread_spawn(calc_gz_lev_0_0, &calc_gz_lev_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_gz_levgz_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->gz_lev[0][0][0], &Proc.FieldReq[async_gz_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void advPrepare_0(struct HybridStateField* state, struct HybridAdvField* advm, struct HybridAdvField* advpt)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  copy_old_m_0_0_info copy_old_m_0_0_para;
  copy_old_m_0_0_para.lz = 32 - 0;
  copy_old_m_0_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  copy_old_m_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  copy_old_m_0_0_para.oz = 0;
  copy_old_m_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  copy_old_m_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  copy_old_m_0_0_para.hx = 1;
  copy_old_m_0_0_para.hy = 1;
  copy_old_m_0_0_para.hz = 0;
  copy_old_m_0_0_para.bx = 256;
  copy_old_m_0_0_para.by = 8;
  copy_old_m_0_0_para.bz = 1;
  copy_old_m_0_0_para.mx = 1;
  copy_old_m_0_0_para.my = 2;
  copy_old_m_0_0_para.mz = 32;
  copy_old_m_0_0_para.statem = &state->m[Proc.lev_hw - 0+copy_old_m_0_0_para.oz][Proc.lat_hw -1+copy_old_m_0_0_para.oy][Proc.lon_hw -1+copy_old_m_0_0_para.ox];
  copy_old_m_0_0_para.advmold_m = &advm->old_m[Proc.lev_hw - 0+copy_old_m_0_0_para.oz][Proc.lat_hw -1+copy_old_m_0_0_para.oy][Proc.lon_hw -1+copy_old_m_0_0_para.ox];
  
  athread_spawn(copy_old_m_0_0, &copy_old_m_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  copy_old_mold_mTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  copy_old_m_0_1_info copy_old_m_0_1_para;
  copy_old_m_0_1_para.lz = 32 - 0;
  copy_old_m_0_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  copy_old_m_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  copy_old_m_0_1_para.oz = 0;
  copy_old_m_0_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  copy_old_m_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  copy_old_m_0_1_para.hx = 1;
  copy_old_m_0_1_para.hy = 1;
  copy_old_m_0_1_para.hz = 0;
  copy_old_m_0_1_para.bx = 256;
  copy_old_m_0_1_para.by = 8;
  copy_old_m_0_1_para.bz = 1;
  copy_old_m_0_1_para.mx = 1;
  copy_old_m_0_1_para.my = 2;
  copy_old_m_0_1_para.mz = 32;
  copy_old_m_0_1_para.statem = &state->m[Proc.lev_hw - 0+copy_old_m_0_1_para.oz][Proc.lat_hw -1+copy_old_m_0_1_para.oy][Proc.lon_hw -1+copy_old_m_0_1_para.ox];
  copy_old_m_0_1_para.advptold_m = &advpt->old_m[Proc.lev_hw - 0+copy_old_m_0_1_para.oz][Proc.lat_hw -1+copy_old_m_0_1_para.oy][Proc.lon_hw -1+copy_old_m_0_1_para.ox];
  
  athread_spawn(copy_old_m_0_1, &copy_old_m_0_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  copy_old_mold_mTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void filterinit_0(struct HybridMeshField* mesh, double dt)
{
  Filter_Init(mesh,dt);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_InitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void stepForwardBackward_0(struct HybridStateField* old_state, struct HybridStateField* star_state, struct HybridStateField* new_state, struct HybridStaticField* staticv, struct HybridTendField* tend1, struct HybridTendField* tend2, struct HybridTendPara* tendPara, struct HybridAdvField* advpt, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  double b, mfs, cursum, cf, s1, s2, ds1, ds2, ds3, dgz, tl, dph1, dph2, dgz1, dgz2;
  int k, j, i, l, ci;
  double *tmp_star_state_tmpsum;
  struct Vector4 ke_vtx;
  struct Vector3 buf;
  tendPara = tendPara;
  advPara = advPara;
  dt = dt;
  tendPara = tendPara;
  (tendPara->u) = 0;
  (tendPara->v) = 0;
  (tendPara->pt) = 0;
  (tendPara->gz) = 0;
  (tendPara->phs) = 0;
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  if (((advPara->uv_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_45_info accum_uv_cell_0_45_para;
    accum_uv_cell_0_45_para.lz = 32 - 0;
    accum_uv_cell_0_45_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_45_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_45_para.oz = 0;
    accum_uv_cell_0_45_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_45_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_45_para.hx = 1;
    accum_uv_cell_0_45_para.hy = 0;
    accum_uv_cell_0_45_para.hz = 0;
    accum_uv_cell_0_45_para.bx = 256;
    accum_uv_cell_0_45_para.by = 8;
    accum_uv_cell_0_45_para.bz = 1;
    accum_uv_cell_0_45_para.mx = 1;
    accum_uv_cell_0_45_para.my = 2;
    accum_uv_cell_0_45_para.mz = 32;
    accum_uv_cell_0_45_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_0_45_para.oz][Proc.lat_hw -0+accum_uv_cell_0_45_para.oy][Proc.lon_hw -1+accum_uv_cell_0_45_para.ox];
    accum_uv_cell_0_45_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_45_para.oz][Proc.lat_hw -0+accum_uv_cell_0_45_para.oy][Proc.lon_hw -1+accum_uv_cell_0_45_para.ox];
    
    athread_spawn(accum_uv_cell_0_45, &accum_uv_cell_0_45_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_46_info accum_uv_cell_0_46_para;
    accum_uv_cell_0_46_para.lz = 32 - 0;
    accum_uv_cell_0_46_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_46_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_46_para.oz = 0;
    accum_uv_cell_0_46_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_46_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_46_para.hx = 0;
    accum_uv_cell_0_46_para.hy = 1;
    accum_uv_cell_0_46_para.hz = 0;
    accum_uv_cell_0_46_para.bx = 256;
    accum_uv_cell_0_46_para.by = 8;
    accum_uv_cell_0_46_para.bz = 1;
    accum_uv_cell_0_46_para.mx = 1;
    accum_uv_cell_0_46_para.my = 2;
    accum_uv_cell_0_46_para.mz = 32;
    accum_uv_cell_0_46_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_0_46_para.oz][Proc.lat_hw -1+accum_uv_cell_0_46_para.oy][Proc.lon_hw -0+accum_uv_cell_0_46_para.ox];
    accum_uv_cell_0_46_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_46_para.oz][Proc.lat_hw -1+accum_uv_cell_0_46_para.oy][Proc.lon_hw -0+accum_uv_cell_0_46_para.ox];
    
    athread_spawn(accum_uv_cell_0_46, &accum_uv_cell_0_46_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->uv_step) = 1;
  }
  if (((advPara->uv_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_47_info accum_uv_cell_0_47_para;
    accum_uv_cell_0_47_para.lz = 32 - 0;
    accum_uv_cell_0_47_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_47_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_47_para.oz = 0;
    accum_uv_cell_0_47_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_47_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_47_para.hx = 1;
    accum_uv_cell_0_47_para.hy = 1;
    accum_uv_cell_0_47_para.hz = 0;
    accum_uv_cell_0_47_para.bx = 256;
    accum_uv_cell_0_47_para.by = 8;
    accum_uv_cell_0_47_para.bz = 1;
    accum_uv_cell_0_47_para.mx = 1;
    accum_uv_cell_0_47_para.my = 2;
    accum_uv_cell_0_47_para.mz = 32;
    accum_uv_cell_0_47_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+accum_uv_cell_0_47_para.oz][Proc.lat_hw -1+accum_uv_cell_0_47_para.oy][Proc.lon_hw -1+accum_uv_cell_0_47_para.ox];
    accum_uv_cell_0_47_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_47_para.oz][Proc.lat_hw -1+accum_uv_cell_0_47_para.oy][Proc.lon_hw -1+accum_uv_cell_0_47_para.ox];
    
    athread_spawn(accum_uv_cell_0_47, &accum_uv_cell_0_47_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_48_info accum_uv_cell_0_48_para;
    accum_uv_cell_0_48_para.lz = 32 - 0;
    accum_uv_cell_0_48_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_48_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_48_para.oz = 0;
    accum_uv_cell_0_48_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_48_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_48_para.hx = 1;
    accum_uv_cell_0_48_para.hy = 1;
    accum_uv_cell_0_48_para.hz = 0;
    accum_uv_cell_0_48_para.bx = 256;
    accum_uv_cell_0_48_para.by = 8;
    accum_uv_cell_0_48_para.bz = 1;
    accum_uv_cell_0_48_para.mx = 1;
    accum_uv_cell_0_48_para.my = 2;
    accum_uv_cell_0_48_para.mz = 32;
    accum_uv_cell_0_48_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+accum_uv_cell_0_48_para.oz][Proc.lat_hw -1+accum_uv_cell_0_48_para.oy][Proc.lon_hw -1+accum_uv_cell_0_48_para.ox];
    accum_uv_cell_0_48_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_48_para.oz][Proc.lat_hw -1+accum_uv_cell_0_48_para.oy][Proc.lon_hw -1+accum_uv_cell_0_48_para.ox];
    
    athread_spawn(accum_uv_cell_0_48, &accum_uv_cell_0_48_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->uv_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_49_info accum_uv_cell_0_49_para;
      accum_uv_cell_0_49_para.lz = 32 - 0;
      accum_uv_cell_0_49_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_49_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_49_para.oz = 0;
      accum_uv_cell_0_49_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_49_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_49_para.hx = 1;
      accum_uv_cell_0_49_para.hy = 1;
      accum_uv_cell_0_49_para.hz = 0;
      accum_uv_cell_0_49_para.bx = 256;
      accum_uv_cell_0_49_para.by = 8;
      accum_uv_cell_0_49_para.bz = 1;
      accum_uv_cell_0_49_para.mx = 1;
      accum_uv_cell_0_49_para.my = 2;
      accum_uv_cell_0_49_para.mz = 32;
      accum_uv_cell_0_49_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_49_para.oz][Proc.lat_hw -1+accum_uv_cell_0_49_para.oy][Proc.lon_hw -1+accum_uv_cell_0_49_para.ox];
      accum_uv_cell_0_49_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+accum_uv_cell_0_49_para.oz][Proc.lat_hw -1+accum_uv_cell_0_49_para.oy][Proc.lon_hw -1+accum_uv_cell_0_49_para.ox];
      accum_uv_cell_0_49_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_0_49, &accum_uv_cell_0_49_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_50_info accum_uv_cell_0_50_para;
      accum_uv_cell_0_50_para.lz = 32 - 0;
      accum_uv_cell_0_50_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_50_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_50_para.oz = 0;
      accum_uv_cell_0_50_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_50_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_50_para.hx = 1;
      accum_uv_cell_0_50_para.hy = 1;
      accum_uv_cell_0_50_para.hz = 0;
      accum_uv_cell_0_50_para.bx = 256;
      accum_uv_cell_0_50_para.by = 8;
      accum_uv_cell_0_50_para.bz = 1;
      accum_uv_cell_0_50_para.mx = 1;
      accum_uv_cell_0_50_para.my = 2;
      accum_uv_cell_0_50_para.mz = 32;
      accum_uv_cell_0_50_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_50_para.oz][Proc.lat_hw -1+accum_uv_cell_0_50_para.oy][Proc.lon_hw -1+accum_uv_cell_0_50_para.ox];
      accum_uv_cell_0_50_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+accum_uv_cell_0_50_para.oz][Proc.lat_hw -1+accum_uv_cell_0_50_para.oy][Proc.lon_hw -1+accum_uv_cell_0_50_para.ox];
      accum_uv_cell_0_50_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_0_50, &accum_uv_cell_0_50_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_51_info accum_uv_cell_0_51_para;
      accum_uv_cell_0_51_para.lz = 32 - 0;
      accum_uv_cell_0_51_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_51_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_51_para.oz = 0;
      accum_uv_cell_0_51_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_51_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_51_para.hx = 1;
      accum_uv_cell_0_51_para.hy = 0;
      accum_uv_cell_0_51_para.hz = 0;
      accum_uv_cell_0_51_para.bx = 256;
      accum_uv_cell_0_51_para.by = 8;
      accum_uv_cell_0_51_para.bz = 1;
      accum_uv_cell_0_51_para.mx = 1;
      accum_uv_cell_0_51_para.my = 2;
      accum_uv_cell_0_51_para.mz = 32;
      accum_uv_cell_0_51_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_51_para.oz][Proc.lat_hw -0+accum_uv_cell_0_51_para.oy][Proc.lon_hw -1+accum_uv_cell_0_51_para.ox];
      accum_uv_cell_0_51_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_0_51_para.oz][Proc.lat_hw -0+accum_uv_cell_0_51_para.oy][Proc.lon_hw -1+accum_uv_cell_0_51_para.ox];
      
      athread_spawn(accum_uv_cell_0_51, &accum_uv_cell_0_51_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellu0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_52_info accum_uv_cell_0_52_para;
      accum_uv_cell_0_52_para.lz = 32 - 0;
      accum_uv_cell_0_52_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_52_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_52_para.oz = 0;
      accum_uv_cell_0_52_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_52_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_52_para.hx = 0;
      accum_uv_cell_0_52_para.hy = 1;
      accum_uv_cell_0_52_para.hz = 0;
      accum_uv_cell_0_52_para.bx = 256;
      accum_uv_cell_0_52_para.by = 8;
      accum_uv_cell_0_52_para.bz = 1;
      accum_uv_cell_0_52_para.mx = 1;
      accum_uv_cell_0_52_para.my = 2;
      accum_uv_cell_0_52_para.mz = 32;
      accum_uv_cell_0_52_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_52_para.oz][Proc.lat_hw -1+accum_uv_cell_0_52_para.oy][Proc.lon_hw -0+accum_uv_cell_0_52_para.ox];
      accum_uv_cell_0_52_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_0_52_para.oz][Proc.lat_hw -1+accum_uv_cell_0_52_para.oy][Proc.lon_hw -0+accum_uv_cell_0_52_para.ox];
      
      athread_spawn(accum_uv_cell_0_52, &accum_uv_cell_0_52_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellv0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_53_info accum_uv_cell_0_53_para;
      accum_uv_cell_0_53_para.lz = 32 - 0;
      accum_uv_cell_0_53_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_53_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_53_para.oz = 0;
      accum_uv_cell_0_53_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_53_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_53_para.hx = 1;
      accum_uv_cell_0_53_para.hy = 1;
      accum_uv_cell_0_53_para.hz = 0;
      accum_uv_cell_0_53_para.bx = 256;
      accum_uv_cell_0_53_para.by = 8;
      accum_uv_cell_0_53_para.bz = 1;
      accum_uv_cell_0_53_para.mx = 1;
      accum_uv_cell_0_53_para.my = 2;
      accum_uv_cell_0_53_para.mz = 32;
      accum_uv_cell_0_53_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_53_para.oz][Proc.lat_hw -1+accum_uv_cell_0_53_para.oy][Proc.lon_hw -1+accum_uv_cell_0_53_para.ox];
      accum_uv_cell_0_53_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+accum_uv_cell_0_53_para.oz][Proc.lat_hw -1+accum_uv_cell_0_53_para.oy][Proc.lon_hw -1+accum_uv_cell_0_53_para.ox];
      
      athread_spawn(accum_uv_cell_0_53, &accum_uv_cell_0_53_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_54_info accum_uv_cell_0_54_para;
      accum_uv_cell_0_54_para.lz = 32 - 0;
      accum_uv_cell_0_54_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_54_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_54_para.oz = 0;
      accum_uv_cell_0_54_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_54_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_54_para.hx = 1;
      accum_uv_cell_0_54_para.hy = 1;
      accum_uv_cell_0_54_para.hz = 0;
      accum_uv_cell_0_54_para.bx = 256;
      accum_uv_cell_0_54_para.by = 8;
      accum_uv_cell_0_54_para.bz = 1;
      accum_uv_cell_0_54_para.mx = 1;
      accum_uv_cell_0_54_para.my = 2;
      accum_uv_cell_0_54_para.mz = 32;
      accum_uv_cell_0_54_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_54_para.oz][Proc.lat_hw -1+accum_uv_cell_0_54_para.oy][Proc.lon_hw -1+accum_uv_cell_0_54_para.ox];
      accum_uv_cell_0_54_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+accum_uv_cell_0_54_para.oz][Proc.lat_hw -1+accum_uv_cell_0_54_para.oy][Proc.lon_hw -1+accum_uv_cell_0_54_para.ox];
      
      athread_spawn(accum_uv_cell_0_54, &accum_uv_cell_0_54_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->uv_step) = 0;
  }
  else
  {
    (advPara->uv_step) = ((advPara->uv_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->uv_step) > (advPara->nstep))))
  {
    if (!(advPara->dynamic))
    {
      (advPara->uv_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_55_info accum_uv_cell_0_55_para;
    accum_uv_cell_0_55_para.lz = 32 - 0;
    accum_uv_cell_0_55_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_0_55_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_55_para.oz = 0;
    accum_uv_cell_0_55_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_0_55_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_55_para.hx = 1;
    accum_uv_cell_0_55_para.hy = 0;
    accum_uv_cell_0_55_para.hz = 0;
    accum_uv_cell_0_55_para.bx = 256;
    accum_uv_cell_0_55_para.by = 8;
    accum_uv_cell_0_55_para.bz = 1;
    accum_uv_cell_0_55_para.mx = 1;
    accum_uv_cell_0_55_para.my = 2;
    accum_uv_cell_0_55_para.mz = 32;
    accum_uv_cell_0_55_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_55_para.oz][Proc.lat_hw -0+accum_uv_cell_0_55_para.oy][Proc.lon_hw -1+accum_uv_cell_0_55_para.ox];
    accum_uv_cell_0_55_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+accum_uv_cell_0_55_para.oz][Proc.lat_hw -0+accum_uv_cell_0_55_para.oy][Proc.lon_hw -1+accum_uv_cell_0_55_para.ox];
    accum_uv_cell_0_55_para.de_lon = &mesh->de_lon[0][0][0];
    accum_uv_cell_0_55_para.dt = dt;
    
    athread_spawn(accum_uv_cell_0_55, &accum_uv_cell_0_55_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_56_info accum_uv_cell_0_56_para;
    accum_uv_cell_0_56_para.lz = 32 - 0;
    accum_uv_cell_0_56_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_56_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_56_para.oz = 0;
    accum_uv_cell_0_56_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_56_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_56_para.hx = 0;
    accum_uv_cell_0_56_para.hy = 1;
    accum_uv_cell_0_56_para.hz = 0;
    accum_uv_cell_0_56_para.bx = 256;
    accum_uv_cell_0_56_para.by = 8;
    accum_uv_cell_0_56_para.bz = 1;
    accum_uv_cell_0_56_para.mx = 1;
    accum_uv_cell_0_56_para.my = 2;
    accum_uv_cell_0_56_para.mz = 32;
    accum_uv_cell_0_56_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_56_para.oz][Proc.lat_hw -1+accum_uv_cell_0_56_para.oy][Proc.lon_hw -0+accum_uv_cell_0_56_para.ox];
    accum_uv_cell_0_56_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+accum_uv_cell_0_56_para.oz][Proc.lat_hw -1+accum_uv_cell_0_56_para.oy][Proc.lon_hw -0+accum_uv_cell_0_56_para.ox];
    accum_uv_cell_0_56_para.de_lat = &mesh->de_lat[0][0][0];
    accum_uv_cell_0_56_para.dt = dt;
    
    athread_spawn(accum_uv_cell_0_56, &accum_uv_cell_0_56_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_57_info accum_uv_cell_0_57_para;
    accum_uv_cell_0_57_para.lz = 32 - 0;
    accum_uv_cell_0_57_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_0_57_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_57_para.oz = 0;
    accum_uv_cell_0_57_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_0_57_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_57_para.hx = 1;
    accum_uv_cell_0_57_para.hy = 1;
    accum_uv_cell_0_57_para.hz = 0;
    accum_uv_cell_0_57_para.bx = 256;
    accum_uv_cell_0_57_para.by = 8;
    accum_uv_cell_0_57_para.bz = 1;
    accum_uv_cell_0_57_para.mx = 1;
    accum_uv_cell_0_57_para.my = 2;
    accum_uv_cell_0_57_para.mz = 32;
    accum_uv_cell_0_57_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_0_57_para.oz][Proc.lat_hw -1+accum_uv_cell_0_57_para.oy][Proc.lon_hw -1+accum_uv_cell_0_57_para.ox];
    accum_uv_cell_0_57_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_57_para.oz][Proc.lat_hw -1+accum_uv_cell_0_57_para.oy][Proc.lon_hw -1+accum_uv_cell_0_57_para.ox];
    accum_uv_cell_0_57_para.advptdivx = &advpt->divx[Proc.lev_hw - 0+accum_uv_cell_0_57_para.oz][Proc.lat_hw -1+accum_uv_cell_0_57_para.oy][Proc.lon_hw -1+accum_uv_cell_0_57_para.ox];
    accum_uv_cell_0_57_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+accum_uv_cell_0_57_para.oz][Proc.lat_hw -1+accum_uv_cell_0_57_para.oy][Proc.lon_hw -1+accum_uv_cell_0_57_para.ox];
    accum_uv_cell_0_57_para.le_lon = &mesh->le_lon[0][0][0];
    accum_uv_cell_0_57_para.area_cell = &mesh->area_cell[0][0][0];
    accum_uv_cell_0_57_para.le_lat = &mesh->le_lat[0][0][0];
    
    athread_spawn(accum_uv_cell_0_57, &accum_uv_cell_0_57_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_58_info accum_uv_cell_0_58_para;
    accum_uv_cell_0_58_para.lz = 32 - 0;
    accum_uv_cell_0_58_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_58_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_58_para.oz = 0;
    accum_uv_cell_0_58_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_58_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_58_para.hx = 0;
    accum_uv_cell_0_58_para.hy = 1;
    accum_uv_cell_0_58_para.hz = 0;
    accum_uv_cell_0_58_para.bx = 256;
    accum_uv_cell_0_58_para.by = 8;
    accum_uv_cell_0_58_para.bz = 1;
    accum_uv_cell_0_58_para.mx = 1;
    accum_uv_cell_0_58_para.my = 2;
    accum_uv_cell_0_58_para.mz = 32;
    accum_uv_cell_0_58_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_0_58_para.oz][Proc.lat_hw -1+accum_uv_cell_0_58_para.oy][Proc.lon_hw -0+accum_uv_cell_0_58_para.ox];
    accum_uv_cell_0_58_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+accum_uv_cell_0_58_para.oz][Proc.lat_hw -1+accum_uv_cell_0_58_para.oy][Proc.lon_hw -0+accum_uv_cell_0_58_para.ox];
    
    athread_spawn(accum_uv_cell_0_58, &accum_uv_cell_0_58_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celltmpsumTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    // SumCall:star_state->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
    tmp_star_state_tmpsum = allocate_1d_array_D(32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
        }
      }
    }
    Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
        }
      }
    }
    free_1d_array_D(tmp_star_state_tmpsum,32);
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_59_info accum_uv_cell_0_59_para;
    accum_uv_cell_0_59_para.lz = 32 - 0;
    accum_uv_cell_0_59_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_59_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_59_para.oz = 0;
    accum_uv_cell_0_59_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_59_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_59_para.hx = 0;
    accum_uv_cell_0_59_para.hy = 0;
    accum_uv_cell_0_59_para.hz = 0;
    accum_uv_cell_0_59_para.bx = 256;
    accum_uv_cell_0_59_para.by = 8;
    accum_uv_cell_0_59_para.bz = 1;
    accum_uv_cell_0_59_para.mx = 1;
    accum_uv_cell_0_59_para.my = 2;
    accum_uv_cell_0_59_para.mz = 32;
    accum_uv_cell_0_59_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+accum_uv_cell_0_59_para.oz][Proc.lat_hw -0+accum_uv_cell_0_59_para.oy][Proc.lon_hw -0+accum_uv_cell_0_59_para.ox];
    accum_uv_cell_0_59_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+accum_uv_cell_0_59_para.oz][Proc.lat_hw -0+accum_uv_cell_0_59_para.oy][Proc.lon_hw -0+accum_uv_cell_0_59_para.ox];
    accum_uv_cell_0_59_para.le_lat = &mesh->le_lat[0][0][0];
    accum_uv_cell_0_59_para.area_cell = &mesh->area_cell[0][0][0];
    
    athread_spawn(accum_uv_cell_0_59, &accum_uv_cell_0_59_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_0_12_info calc_mf_0_12_para;
  calc_mf_0_12_para.lz = 32 - 0;
  calc_mf_0_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_0_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_0_12_para.oz = 0;
  calc_mf_0_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_0_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_0_12_para.hx = 1;
  calc_mf_0_12_para.hy = 1;
  calc_mf_0_12_para.hz = 0;
  calc_mf_0_12_para.bx = 256;
  calc_mf_0_12_para.by = 8;
  calc_mf_0_12_para.bz = 1;
  calc_mf_0_12_para.mx = 1;
  calc_mf_0_12_para.my = 2;
  calc_mf_0_12_para.mz = 32;
  calc_mf_0_12_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 0+calc_mf_0_12_para.oz][Proc.lat_hw -1+calc_mf_0_12_para.oy][Proc.lon_hw -1+calc_mf_0_12_para.ox];
  calc_mf_0_12_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_mf_0_12_para.oz][Proc.lat_hw -1+calc_mf_0_12_para.oy][Proc.lon_hw -1+calc_mf_0_12_para.ox];
  calc_mf_0_12_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_mf_0_12_para.oz][Proc.lat_hw -1+calc_mf_0_12_para.oy][Proc.lon_hw -1+calc_mf_0_12_para.ox];
  
  athread_spawn(calc_mf_0_12, &calc_mf_0_12_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->mfx_lon[0][0][0], &Proc.FieldReq[async_mfx_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_0_13_info calc_mf_0_13_para;
  calc_mf_0_13_para.lz = 32 - 0;
  calc_mf_0_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_0_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_0_13_para.oz = 0;
  calc_mf_0_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_0_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_0_13_para.hx = 1;
  calc_mf_0_13_para.hy = 1;
  calc_mf_0_13_para.hz = 0;
  calc_mf_0_13_para.bx = 256;
  calc_mf_0_13_para.by = 8;
  calc_mf_0_13_para.bz = 1;
  calc_mf_0_13_para.mx = 1;
  calc_mf_0_13_para.my = 2;
  calc_mf_0_13_para.mz = 32;
  calc_mf_0_13_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 0+calc_mf_0_13_para.oz][Proc.lat_hw -1+calc_mf_0_13_para.oy][Proc.lon_hw -1+calc_mf_0_13_para.ox];
  calc_mf_0_13_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_mf_0_13_para.oz][Proc.lat_hw -1+calc_mf_0_13_para.oy][Proc.lon_hw -1+calc_mf_0_13_para.ox];
  calc_mf_0_13_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_mf_0_13_para.oz][Proc.lat_hw -1+calc_mf_0_13_para.oy][Proc.lon_hw -1+calc_mf_0_13_para.ox];
  
  athread_spawn(calc_mf_0_13, &calc_mf_0_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->mfy_lat[0][0][0], &Proc.FieldReq[async_mfy_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  if (((advPara->mf_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfx[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfy[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->mf_step) = 1;
  }
  if (((advPara->mf_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_0_18_info accum_mf_cell_0_18_para;
    accum_mf_cell_0_18_para.lz = 32 - 0;
    accum_mf_cell_0_18_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_0_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_0_18_para.oz = 0;
    accum_mf_cell_0_18_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_0_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_0_18_para.hx = 1;
    accum_mf_cell_0_18_para.hy = 1;
    accum_mf_cell_0_18_para.hz = 0;
    accum_mf_cell_0_18_para.bx = 256;
    accum_mf_cell_0_18_para.by = 8;
    accum_mf_cell_0_18_para.bz = 1;
    accum_mf_cell_0_18_para.mx = 1;
    accum_mf_cell_0_18_para.my = 2;
    accum_mf_cell_0_18_para.mz = 32;
    accum_mf_cell_0_18_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_0_18_para.oz][Proc.lat_hw -1+accum_mf_cell_0_18_para.oy][Proc.lon_hw -1+accum_mf_cell_0_18_para.ox];
    accum_mf_cell_0_18_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_0_18_para.oz][Proc.lat_hw -1+accum_mf_cell_0_18_para.oy][Proc.lon_hw -1+accum_mf_cell_0_18_para.ox];
    
    athread_spawn(accum_mf_cell_0_18, &accum_mf_cell_0_18_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_0_19_info accum_mf_cell_0_19_para;
    accum_mf_cell_0_19_para.lz = 32 - 0;
    accum_mf_cell_0_19_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_0_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_0_19_para.oz = 0;
    accum_mf_cell_0_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_0_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_0_19_para.hx = 1;
    accum_mf_cell_0_19_para.hy = 1;
    accum_mf_cell_0_19_para.hz = 0;
    accum_mf_cell_0_19_para.bx = 256;
    accum_mf_cell_0_19_para.by = 8;
    accum_mf_cell_0_19_para.bz = 1;
    accum_mf_cell_0_19_para.mx = 1;
    accum_mf_cell_0_19_para.my = 2;
    accum_mf_cell_0_19_para.mz = 32;
    accum_mf_cell_0_19_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_0_19_para.oz][Proc.lat_hw -1+accum_mf_cell_0_19_para.oy][Proc.lon_hw -1+accum_mf_cell_0_19_para.ox];
    accum_mf_cell_0_19_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_0_19_para.oz][Proc.lat_hw -1+accum_mf_cell_0_19_para.oy][Proc.lon_hw -1+accum_mf_cell_0_19_para.ox];
    
    athread_spawn(accum_mf_cell_0_19, &accum_mf_cell_0_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->mf_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_20_info accum_mf_cell_0_20_para;
      accum_mf_cell_0_20_para.lz = 32 - 0;
      accum_mf_cell_0_20_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_20_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_20_para.oz = 0;
      accum_mf_cell_0_20_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_20_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_20_para.hx = 1;
      accum_mf_cell_0_20_para.hy = 1;
      accum_mf_cell_0_20_para.hz = 0;
      accum_mf_cell_0_20_para.bx = 256;
      accum_mf_cell_0_20_para.by = 8;
      accum_mf_cell_0_20_para.bz = 1;
      accum_mf_cell_0_20_para.mx = 1;
      accum_mf_cell_0_20_para.my = 2;
      accum_mf_cell_0_20_para.mz = 32;
      accum_mf_cell_0_20_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_0_20_para.oz][Proc.lat_hw -1+accum_mf_cell_0_20_para.oy][Proc.lon_hw -1+accum_mf_cell_0_20_para.ox];
      accum_mf_cell_0_20_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_0_20_para.oz][Proc.lat_hw -1+accum_mf_cell_0_20_para.oy][Proc.lon_hw -1+accum_mf_cell_0_20_para.ox];
      accum_mf_cell_0_20_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_0_20, &accum_mf_cell_0_20_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_21_info accum_mf_cell_0_21_para;
      accum_mf_cell_0_21_para.lz = 32 - 0;
      accum_mf_cell_0_21_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_21_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_21_para.oz = 0;
      accum_mf_cell_0_21_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_21_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_21_para.hx = 1;
      accum_mf_cell_0_21_para.hy = 1;
      accum_mf_cell_0_21_para.hz = 0;
      accum_mf_cell_0_21_para.bx = 256;
      accum_mf_cell_0_21_para.by = 8;
      accum_mf_cell_0_21_para.bz = 1;
      accum_mf_cell_0_21_para.mx = 1;
      accum_mf_cell_0_21_para.my = 2;
      accum_mf_cell_0_21_para.mz = 32;
      accum_mf_cell_0_21_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_0_21_para.oz][Proc.lat_hw -1+accum_mf_cell_0_21_para.oy][Proc.lon_hw -1+accum_mf_cell_0_21_para.ox];
      accum_mf_cell_0_21_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_0_21_para.oz][Proc.lat_hw -1+accum_mf_cell_0_21_para.oy][Proc.lon_hw -1+accum_mf_cell_0_21_para.ox];
      accum_mf_cell_0_21_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_0_21, &accum_mf_cell_0_21_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_22_info accum_mf_cell_0_22_para;
      accum_mf_cell_0_22_para.lz = 32 - 0;
      accum_mf_cell_0_22_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_22_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_22_para.oz = 0;
      accum_mf_cell_0_22_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_22_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_22_para.hx = 1;
      accum_mf_cell_0_22_para.hy = 1;
      accum_mf_cell_0_22_para.hz = 0;
      accum_mf_cell_0_22_para.bx = 256;
      accum_mf_cell_0_22_para.by = 8;
      accum_mf_cell_0_22_para.bz = 1;
      accum_mf_cell_0_22_para.mx = 1;
      accum_mf_cell_0_22_para.my = 2;
      accum_mf_cell_0_22_para.mz = 32;
      accum_mf_cell_0_22_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_0_22_para.oz][Proc.lat_hw -1+accum_mf_cell_0_22_para.oy][Proc.lon_hw -1+accum_mf_cell_0_22_para.ox];
      accum_mf_cell_0_22_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_0_22_para.oz][Proc.lat_hw -1+accum_mf_cell_0_22_para.oy][Proc.lon_hw -1+accum_mf_cell_0_22_para.ox];
      
      athread_spawn(accum_mf_cell_0_22, &accum_mf_cell_0_22_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_23_info accum_mf_cell_0_23_para;
      accum_mf_cell_0_23_para.lz = 32 - 0;
      accum_mf_cell_0_23_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_23_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_23_para.oz = 0;
      accum_mf_cell_0_23_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_23_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_23_para.hx = 1;
      accum_mf_cell_0_23_para.hy = 1;
      accum_mf_cell_0_23_para.hz = 0;
      accum_mf_cell_0_23_para.bx = 256;
      accum_mf_cell_0_23_para.by = 8;
      accum_mf_cell_0_23_para.bz = 1;
      accum_mf_cell_0_23_para.mx = 1;
      accum_mf_cell_0_23_para.my = 2;
      accum_mf_cell_0_23_para.mz = 32;
      accum_mf_cell_0_23_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_0_23_para.oz][Proc.lat_hw -1+accum_mf_cell_0_23_para.oy][Proc.lon_hw -1+accum_mf_cell_0_23_para.ox];
      accum_mf_cell_0_23_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_0_23_para.oz][Proc.lat_hw -1+accum_mf_cell_0_23_para.oy][Proc.lon_hw -1+accum_mf_cell_0_23_para.ox];
      
      athread_spawn(accum_mf_cell_0_23, &accum_mf_cell_0_23_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->mf_step) = 0;
  }
  else
  {
    (advPara->mf_step) = ((advPara->mf_step) + 1);
  }
  if ((!(advPara->dynamic) && ((advPara->mf_step) > (advPara->nstep))))
  {
    (advPara->mf_step) = -1;
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_0_14_info calc_mf_0_14_para;
  calc_mf_0_14_para.lz = 32 - 0;
  calc_mf_0_14_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_0_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_0_14_para.oz = 0;
  calc_mf_0_14_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_0_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_0_14_para.hx = 1;
  calc_mf_0_14_para.hy = 1;
  calc_mf_0_14_para.hz = 0;
  calc_mf_0_14_para.bx = 256;
  calc_mf_0_14_para.by = 8;
  calc_mf_0_14_para.bz = 1;
  calc_mf_0_14_para.mx = 1;
  calc_mf_0_14_para.my = 2;
  calc_mf_0_14_para.mz = 32;
  calc_mf_0_14_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_mf_0_14_para.oz][Proc.lat_hw -1+calc_mf_0_14_para.oy][Proc.lon_hw -1+calc_mf_0_14_para.ox];
  calc_mf_0_14_para.star_statemfx_lat = &star_state->mfx_lat[Proc.lev_hw - 0+calc_mf_0_14_para.oz][Proc.lat_hw -1+calc_mf_0_14_para.oy][Proc.lon_hw -1+calc_mf_0_14_para.ox];
  calc_mf_0_14_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 0+calc_mf_0_14_para.oz][Proc.lat_hw -1+calc_mf_0_14_para.oy][Proc.lon_hw -1+calc_mf_0_14_para.ox];
  calc_mf_0_14_para.star_stateu_lat = &star_state->u_lat[Proc.lev_hw - 0+calc_mf_0_14_para.oz][Proc.lat_hw -1+calc_mf_0_14_para.oy][Proc.lon_hw -1+calc_mf_0_14_para.ox];
  calc_mf_0_14_para.half_tangent_wgt_0 = &mesh->half_tangent_wgt_0[0][0][0];
  calc_mf_0_14_para.half_tangent_wgt_1 = &mesh->half_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_0_14, &calc_mf_0_14_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_0_15_info calc_mf_0_15_para;
  calc_mf_0_15_para.lz = 32 - 0;
  calc_mf_0_15_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_0_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_0_15_para.oz = 0;
  calc_mf_0_15_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_0_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_0_15_para.hx = 1;
  calc_mf_0_15_para.hy = 1;
  calc_mf_0_15_para.hz = 0;
  calc_mf_0_15_para.bx = 256;
  calc_mf_0_15_para.by = 8;
  calc_mf_0_15_para.bz = 1;
  calc_mf_0_15_para.mx = 1;
  calc_mf_0_15_para.my = 2;
  calc_mf_0_15_para.mz = 32;
  calc_mf_0_15_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_mf_0_15_para.oz][Proc.lat_hw -1+calc_mf_0_15_para.oy][Proc.lon_hw -1+calc_mf_0_15_para.ox];
  calc_mf_0_15_para.star_statemfy_lon = &star_state->mfy_lon[Proc.lev_hw - 0+calc_mf_0_15_para.oz][Proc.lat_hw -1+calc_mf_0_15_para.oy][Proc.lon_hw -1+calc_mf_0_15_para.ox];
  calc_mf_0_15_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 0+calc_mf_0_15_para.oz][Proc.lat_hw -1+calc_mf_0_15_para.oy][Proc.lon_hw -1+calc_mf_0_15_para.ox];
  calc_mf_0_15_para.star_statev_lon = &star_state->v_lon[Proc.lev_hw - 0+calc_mf_0_15_para.oz][Proc.lat_hw -1+calc_mf_0_15_para.oy][Proc.lon_hw -1+calc_mf_0_15_para.ox];
  calc_mf_0_15_para.full_tangent_wgt_0 = &mesh->full_tangent_wgt_0[0][0][0];
  calc_mf_0_15_para.full_tangent_wgt_1 = &mesh->full_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_0_15, &calc_mf_0_15_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  ke_vtx = (struct Vector4){0.0,0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_0_12_info calc_ke_0_12_para;
  calc_ke_0_12_para.lz = 32 - 0;
  calc_ke_0_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_0_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_0_12_para.oz = 0;
  calc_ke_0_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_0_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_0_12_para.hx = 1;
  calc_ke_0_12_para.hy = 1;
  calc_ke_0_12_para.hz = 0;
  calc_ke_0_12_para.bx = 256;
  calc_ke_0_12_para.by = 8;
  calc_ke_0_12_para.bz = 1;
  calc_ke_0_12_para.mx = 1;
  calc_ke_0_12_para.my = 2;
  calc_ke_0_12_para.mz = 32;
  calc_ke_0_12_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_ke_0_12_para.oz][Proc.lat_hw -1+calc_ke_0_12_para.oy][Proc.lon_hw -1+calc_ke_0_12_para.ox];
  calc_ke_0_12_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_ke_0_12_para.oz][Proc.lat_hw -1+calc_ke_0_12_para.oy][Proc.lon_hw -1+calc_ke_0_12_para.ox];
  calc_ke_0_12_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_ke_0_12_para.oz][Proc.lat_hw -1+calc_ke_0_12_para.oy][Proc.lon_hw -1+calc_ke_0_12_para.ox];
  calc_ke_0_12_para.area_lon_west = &mesh->area_lon_west[0][0][0];
  calc_ke_0_12_para.area_lon_east = &mesh->area_lon_east[0][0][0];
  calc_ke_0_12_para.area_lat_north = &mesh->area_lat_north[0][0][0];
  calc_ke_0_12_para.area_lat_south = &mesh->area_lat_south[0][0][0];
  calc_ke_0_12_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_0_12, &calc_ke_0_12_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_0_13_info calc_ke_0_13_para;
  calc_ke_0_13_para.lz = 32 - 0;
  calc_ke_0_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_0_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_0_13_para.oz = 0;
  calc_ke_0_13_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_0_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_0_13_para.hx = 1;
  calc_ke_0_13_para.hy = 1;
  calc_ke_0_13_para.hz = 0;
  calc_ke_0_13_para.bx = 256;
  calc_ke_0_13_para.by = 8;
  calc_ke_0_13_para.bz = 1;
  calc_ke_0_13_para.mx = 1;
  calc_ke_0_13_para.my = 2;
  calc_ke_0_13_para.mz = 32;
  calc_ke_0_13_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_ke_0_13_para.oz][Proc.lat_hw -1+calc_ke_0_13_para.oy][Proc.lon_hw -1+calc_ke_0_13_para.ox];
  calc_ke_0_13_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_ke_0_13_para.oz][Proc.lat_hw -1+calc_ke_0_13_para.oy][Proc.lon_hw -1+calc_ke_0_13_para.ox];
  calc_ke_0_13_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_ke_0_13_para.oz][Proc.lat_hw -1+calc_ke_0_13_para.oy][Proc.lon_hw -1+calc_ke_0_13_para.ox];
  calc_ke_0_13_para.area_lat_east = &mesh->area_lat_east[0][0][0];
  calc_ke_0_13_para.area_lat_west = &mesh->area_lat_west[0][0][0];
  calc_ke_0_13_para.area_lon_north = &mesh->area_lon_north[0][0][0];
  calc_ke_0_13_para.area_lon_south = &mesh->area_lon_south[0][0][0];
  calc_ke_0_13_para.area_vtx = &mesh->area_vtx[0][0][0];
  calc_ke_0_13_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  calc_ke_0_13_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  calc_ke_0_13_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_0_13, &calc_ke_0_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_0_14_info calc_ke_0_14_para;
  calc_ke_0_14_para.lz = 32 - 0;
  calc_ke_0_14_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_ke_0_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_0_14_para.oz = 0;
  calc_ke_0_14_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ke_0_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_0_14_para.hx = 1;
  calc_ke_0_14_para.hy = 1;
  calc_ke_0_14_para.hz = 0;
  calc_ke_0_14_para.bx = 256;
  calc_ke_0_14_para.by = 8;
  calc_ke_0_14_para.bz = 1;
  calc_ke_0_14_para.mx = 1;
  calc_ke_0_14_para.my = 2;
  calc_ke_0_14_para.mz = 32;
  calc_ke_0_14_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_ke_0_14_para.oz][Proc.lat_hw -1+calc_ke_0_14_para.oy][Proc.lon_hw -1+calc_ke_0_14_para.ox];
  calc_ke_0_14_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_ke_0_14_para.oz][Proc.lat_hw -1+calc_ke_0_14_para.oy][Proc.lon_hw -1+calc_ke_0_14_para.ox];
  
  athread_spawn(calc_ke_0_14, &calc_ke_0_14_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_ketmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_0_15_info calc_ke_0_15_para;
  calc_ke_0_15_para.lz = 32 - 0;
  calc_ke_0_15_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_ke_0_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_0_15_para.oz = 0;
  calc_ke_0_15_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ke_0_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_0_15_para.hx = 1;
  calc_ke_0_15_para.hy = 1;
  calc_ke_0_15_para.hz = 0;
  calc_ke_0_15_para.bx = 256;
  calc_ke_0_15_para.by = 8;
  calc_ke_0_15_para.bz = 1;
  calc_ke_0_15_para.mx = 1;
  calc_ke_0_15_para.my = 2;
  calc_ke_0_15_para.mz = 32;
  calc_ke_0_15_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_ke_0_15_para.oz][Proc.lat_hw -1+calc_ke_0_15_para.oy][Proc.lon_hw -1+calc_ke_0_15_para.ox];
  calc_ke_0_15_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_ke_0_15_para.oz][Proc.lat_hw -1+calc_ke_0_15_para.oy][Proc.lon_hw -1+calc_ke_0_15_para.ox];
  
  athread_spawn(calc_ke_0_15, &calc_ke_0_15_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ke[0][0][0], &Proc.FieldReq[async_ke], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_0_9_info calc_div_0_9_para;
  calc_div_0_9_para.lz = 32 - 0;
  calc_div_0_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_div_0_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_0_9_para.oz = 0;
  calc_div_0_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_div_0_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_0_9_para.hx = 1;
  calc_div_0_9_para.hy = 1;
  calc_div_0_9_para.hz = 0;
  calc_div_0_9_para.bx = 256;
  calc_div_0_9_para.by = 8;
  calc_div_0_9_para.bz = 1;
  calc_div_0_9_para.mx = 1;
  calc_div_0_9_para.my = 2;
  calc_div_0_9_para.mz = 32;
  calc_div_0_9_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_div_0_9_para.oz][Proc.lat_hw -1+calc_div_0_9_para.oy][Proc.lon_hw -1+calc_div_0_9_para.ox];
  calc_div_0_9_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_div_0_9_para.oz][Proc.lat_hw -1+calc_div_0_9_para.oy][Proc.lon_hw -1+calc_div_0_9_para.ox];
  calc_div_0_9_para.star_statediv = &star_state->div[Proc.lev_hw - 0+calc_div_0_9_para.oz][Proc.lat_hw -1+calc_div_0_9_para.oy][Proc.lon_hw -1+calc_div_0_9_para.ox];
  calc_div_0_9_para.le_lon = &mesh->le_lon[0][0][0];
  calc_div_0_9_para.le_lat = &mesh->le_lat[0][0][0];
  calc_div_0_9_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_div_0_9, &calc_div_0_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divdivTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_0_10_info calc_div_0_10_para;
  calc_div_0_10_para.lz = 32 - 0;
  calc_div_0_10_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_div_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_0_10_para.oz = 0;
  calc_div_0_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_div_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_0_10_para.hx = 1;
  calc_div_0_10_para.hy = 1;
  calc_div_0_10_para.hz = 0;
  calc_div_0_10_para.bx = 256;
  calc_div_0_10_para.by = 8;
  calc_div_0_10_para.bz = 1;
  calc_div_0_10_para.mx = 1;
  calc_div_0_10_para.my = 2;
  calc_div_0_10_para.mz = 32;
  calc_div_0_10_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_div_0_10_para.oz][Proc.lat_hw -1+calc_div_0_10_para.oy][Proc.lon_hw -1+calc_div_0_10_para.ox];
  calc_div_0_10_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_div_0_10_para.oz][Proc.lat_hw -1+calc_div_0_10_para.oy][Proc.lon_hw -1+calc_div_0_10_para.ox];
  
  athread_spawn(calc_div_0_10, &calc_div_0_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divtmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_0_11_info calc_div_0_11_para;
  calc_div_0_11_para.lz = 32 - 0;
  calc_div_0_11_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_div_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_0_11_para.oz = 0;
  calc_div_0_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_div_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_0_11_para.hx = 1;
  calc_div_0_11_para.hy = 1;
  calc_div_0_11_para.hz = 0;
  calc_div_0_11_para.bx = 256;
  calc_div_0_11_para.by = 8;
  calc_div_0_11_para.bz = 1;
  calc_div_0_11_para.mx = 1;
  calc_div_0_11_para.my = 2;
  calc_div_0_11_para.mz = 32;
  calc_div_0_11_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_div_0_11_para.oz][Proc.lat_hw -1+calc_div_0_11_para.oy][Proc.lon_hw -1+calc_div_0_11_para.ox];
  calc_div_0_11_para.star_statediv = &star_state->div[Proc.lev_hw - 0+calc_div_0_11_para.oz][Proc.lat_hw -1+calc_div_0_11_para.oy][Proc.lon_hw -1+calc_div_0_11_para.ox];
  calc_div_0_11_para.le_lat = &mesh->le_lat[0][0][0];
  calc_div_0_11_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_div_0_11, &calc_div_0_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divdivTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->div[0][0][0], &Proc.FieldReq[async_div], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_0_9_info calc_vor_0_9_para;
  calc_vor_0_9_para.lz = 32 - 0;
  calc_vor_0_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_vor_0_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_0_9_para.oz = 0;
  calc_vor_0_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_vor_0_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_0_9_para.hx = 1;
  calc_vor_0_9_para.hy = 1;
  calc_vor_0_9_para.hz = 0;
  calc_vor_0_9_para.bx = 256;
  calc_vor_0_9_para.by = 8;
  calc_vor_0_9_para.bz = 1;
  calc_vor_0_9_para.mx = 1;
  calc_vor_0_9_para.my = 2;
  calc_vor_0_9_para.mz = 32;
  calc_vor_0_9_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_vor_0_9_para.oz][Proc.lat_hw -1+calc_vor_0_9_para.oy][Proc.lon_hw -1+calc_vor_0_9_para.ox];
  calc_vor_0_9_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_vor_0_9_para.oz][Proc.lat_hw -1+calc_vor_0_9_para.oy][Proc.lon_hw -1+calc_vor_0_9_para.ox];
  calc_vor_0_9_para.star_statevor = &star_state->vor[Proc.lev_hw - 0+calc_vor_0_9_para.oz][Proc.lat_hw -1+calc_vor_0_9_para.oy][Proc.lon_hw -1+calc_vor_0_9_para.ox];
  calc_vor_0_9_para.de_lon = &mesh->de_lon[0][0][0];
  calc_vor_0_9_para.de_lat = &mesh->de_lat[0][0][0];
  calc_vor_0_9_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(calc_vor_0_9, &calc_vor_0_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vorvorTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_0_10_info calc_vor_0_10_para;
  calc_vor_0_10_para.lz = 32 - 0;
  calc_vor_0_10_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_vor_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_0_10_para.oz = 0;
  calc_vor_0_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_vor_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_0_10_para.hx = 0;
  calc_vor_0_10_para.hy = 0;
  calc_vor_0_10_para.hz = 0;
  calc_vor_0_10_para.bx = 256;
  calc_vor_0_10_para.by = 8;
  calc_vor_0_10_para.bz = 1;
  calc_vor_0_10_para.mx = 1;
  calc_vor_0_10_para.my = 2;
  calc_vor_0_10_para.mz = 32;
  calc_vor_0_10_para.star_stateu_lat = &star_state->u_lat[Proc.lev_hw - 0+calc_vor_0_10_para.oz][Proc.lat_hw -0+calc_vor_0_10_para.oy][Proc.lon_hw -0+calc_vor_0_10_para.ox];
  calc_vor_0_10_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_vor_0_10_para.oz][Proc.lat_hw -0+calc_vor_0_10_para.oy][Proc.lon_hw -0+calc_vor_0_10_para.ox];
  calc_vor_0_10_para.le_lat = &mesh->le_lat[0][0][0];
  
  athread_spawn(calc_vor_0_10, &calc_vor_0_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vortmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_0_11_info calc_vor_0_11_para;
  calc_vor_0_11_para.lz = 32 - 0;
  calc_vor_0_11_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_vor_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_0_11_para.oz = 0;
  calc_vor_0_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_vor_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_0_11_para.hx = 0;
  calc_vor_0_11_para.hy = 0;
  calc_vor_0_11_para.hz = 0;
  calc_vor_0_11_para.bx = 256;
  calc_vor_0_11_para.by = 8;
  calc_vor_0_11_para.bz = 1;
  calc_vor_0_11_para.mx = 1;
  calc_vor_0_11_para.my = 2;
  calc_vor_0_11_para.mz = 32;
  calc_vor_0_11_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_vor_0_11_para.oz][Proc.lat_hw -0+calc_vor_0_11_para.oy][Proc.lon_hw -0+calc_vor_0_11_para.ox];
  calc_vor_0_11_para.star_statevor = &star_state->vor[Proc.lev_hw - 0+calc_vor_0_11_para.oz][Proc.lat_hw -0+calc_vor_0_11_para.oy][Proc.lon_hw -0+calc_vor_0_11_para.ox];
  calc_vor_0_11_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_vor_0_11, &calc_vor_0_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vorvorTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_pv_0_3_info calc_pv_0_3_para;
  calc_pv_0_3_para.lz = 32 - 0;
  calc_pv_0_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_pv_0_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_pv_0_3_para.oz = 0;
  calc_pv_0_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_pv_0_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_pv_0_3_para.hx = 2;
  calc_pv_0_3_para.hy = 2;
  calc_pv_0_3_para.hz = 0;
  calc_pv_0_3_para.bx = 256;
  calc_pv_0_3_para.by = 8;
  calc_pv_0_3_para.bz = 1;
  calc_pv_0_3_para.mx = 1;
  calc_pv_0_3_para.my = 2;
  calc_pv_0_3_para.mz = 32;
  calc_pv_0_3_para.star_statevor = &star_state->vor[Proc.lev_hw - 0+calc_pv_0_3_para.oz][Proc.lat_hw -2+calc_pv_0_3_para.oy][Proc.lon_hw -2+calc_pv_0_3_para.ox];
  calc_pv_0_3_para.star_statem_vtx = &star_state->m_vtx[Proc.lev_hw - 0+calc_pv_0_3_para.oz][Proc.lat_hw -2+calc_pv_0_3_para.oy][Proc.lon_hw -2+calc_pv_0_3_para.ox];
  calc_pv_0_3_para.star_statepv = &star_state->pv[Proc.lev_hw - 0+calc_pv_0_3_para.oz][Proc.lat_hw -2+calc_pv_0_3_para.oy][Proc.lon_hw -2+calc_pv_0_3_para.ox];
  calc_pv_0_3_para.half_f = &mesh->half_f[0][0][0];
  
  athread_spawn(calc_pv_0_3, &calc_pv_0_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_pvpvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pv[0][0][0], &Proc.FieldReq[async_pv], false, false, true, true, true, true, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_0_6_info interp_pv_upwind_0_6_para;
  interp_pv_upwind_0_6_para.lz = 32 - 0;
  interp_pv_upwind_0_6_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  interp_pv_upwind_0_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_0_6_para.oz = 0;
  interp_pv_upwind_0_6_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  interp_pv_upwind_0_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_0_6_para.hx = 2;
  interp_pv_upwind_0_6_para.hy = 2;
  interp_pv_upwind_0_6_para.hz = 0;
  interp_pv_upwind_0_6_para.bx = 256;
  interp_pv_upwind_0_6_para.by = 8;
  interp_pv_upwind_0_6_para.bz = 1;
  interp_pv_upwind_0_6_para.mx = 1;
  interp_pv_upwind_0_6_para.my = 2;
  interp_pv_upwind_0_6_para.mz = 32;
  interp_pv_upwind_0_6_para.star_statev_lon = &star_state->v_lon[Proc.lev_hw - 0+interp_pv_upwind_0_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_6_para.ox];
  interp_pv_upwind_0_6_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+interp_pv_upwind_0_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_6_para.ox];
  interp_pv_upwind_0_6_para.star_statepv = &star_state->pv[Proc.lev_hw - 0+interp_pv_upwind_0_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_6_para.ox];
  interp_pv_upwind_0_6_para.star_statepv_lon = &star_state->pv_lon[Proc.lev_hw - 0+interp_pv_upwind_0_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_6_para.ox];
  
  athread_spawn(interp_pv_upwind_0_6, &interp_pv_upwind_0_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pv_lon[0][0][0], &Proc.FieldReq[async_pv_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_0_7_info interp_pv_upwind_0_7_para;
  interp_pv_upwind_0_7_para.lz = 32 - 0;
  interp_pv_upwind_0_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interp_pv_upwind_0_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_0_7_para.oz = 0;
  interp_pv_upwind_0_7_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interp_pv_upwind_0_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_0_7_para.hx = 2;
  interp_pv_upwind_0_7_para.hy = 2;
  interp_pv_upwind_0_7_para.hz = 0;
  interp_pv_upwind_0_7_para.bx = 256;
  interp_pv_upwind_0_7_para.by = 8;
  interp_pv_upwind_0_7_para.bz = 1;
  interp_pv_upwind_0_7_para.mx = 1;
  interp_pv_upwind_0_7_para.my = 2;
  interp_pv_upwind_0_7_para.mz = 32;
  interp_pv_upwind_0_7_para.star_stateu_lat = &star_state->u_lat[Proc.lev_hw - 0+interp_pv_upwind_0_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_7_para.ox];
  interp_pv_upwind_0_7_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+interp_pv_upwind_0_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_7_para.ox];
  interp_pv_upwind_0_7_para.star_statepv = &star_state->pv[Proc.lev_hw - 0+interp_pv_upwind_0_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_7_para.ox];
  interp_pv_upwind_0_7_para.star_statepv_lat = &star_state->pv_lat[Proc.lev_hw - 0+interp_pv_upwind_0_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_0_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_0_7_para.ox];
  
  athread_spawn(interp_pv_upwind_0_7, &interp_pv_upwind_0_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pv_lat[0][0][0], &Proc.FieldReq[async_pv_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_mf_0_8_info calc_grad_mf_0_8_para;
  calc_grad_mf_0_8_para.lz = 32 - 0;
  calc_grad_mf_0_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_mf_0_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_mf_0_8_para.oz = 0;
  calc_grad_mf_0_8_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_mf_0_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_mf_0_8_para.hx = 1;
  calc_grad_mf_0_8_para.hy = 1;
  calc_grad_mf_0_8_para.hz = 0;
  calc_grad_mf_0_8_para.bx = 256;
  calc_grad_mf_0_8_para.by = 8;
  calc_grad_mf_0_8_para.bz = 1;
  calc_grad_mf_0_8_para.mx = 1;
  calc_grad_mf_0_8_para.my = 2;
  calc_grad_mf_0_8_para.mz = 32;
  calc_grad_mf_0_8_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_grad_mf_0_8_para.oz][Proc.lat_hw -1+calc_grad_mf_0_8_para.oy][Proc.lon_hw -1+calc_grad_mf_0_8_para.ox];
  calc_grad_mf_0_8_para.tend1dmfdlon = &tend1->dmfdlon[Proc.lev_hw - 0+calc_grad_mf_0_8_para.oz][Proc.lat_hw -1+calc_grad_mf_0_8_para.oy][Proc.lon_hw -1+calc_grad_mf_0_8_para.ox];
  calc_grad_mf_0_8_para.le_lon = &mesh->le_lon[0][0][0];
  calc_grad_mf_0_8_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_mf_0_8, &calc_grad_mf_0_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_mfdmfdlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_mf_0_9_info calc_grad_mf_0_9_para;
  calc_grad_mf_0_9_para.lz = 32 - 0;
  calc_grad_mf_0_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_mf_0_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_mf_0_9_para.oz = 0;
  calc_grad_mf_0_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_mf_0_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_mf_0_9_para.hx = 1;
  calc_grad_mf_0_9_para.hy = 1;
  calc_grad_mf_0_9_para.hz = 0;
  calc_grad_mf_0_9_para.bx = 256;
  calc_grad_mf_0_9_para.by = 8;
  calc_grad_mf_0_9_para.bz = 1;
  calc_grad_mf_0_9_para.mx = 1;
  calc_grad_mf_0_9_para.my = 2;
  calc_grad_mf_0_9_para.mz = 32;
  calc_grad_mf_0_9_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_grad_mf_0_9_para.oz][Proc.lat_hw -1+calc_grad_mf_0_9_para.oy][Proc.lon_hw -1+calc_grad_mf_0_9_para.ox];
  calc_grad_mf_0_9_para.tend1dmfdlat = &tend1->dmfdlat[Proc.lev_hw - 0+calc_grad_mf_0_9_para.oz][Proc.lat_hw -1+calc_grad_mf_0_9_para.oy][Proc.lon_hw -1+calc_grad_mf_0_9_para.ox];
  calc_grad_mf_0_9_para.le_lat = &mesh->le_lat[0][0][0];
  calc_grad_mf_0_9_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_mf_0_9, &calc_grad_mf_0_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_mfdmfdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_mf_0_10_info calc_grad_mf_0_10_para;
  calc_grad_mf_0_10_para.lz = 32 - 0;
  calc_grad_mf_0_10_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_grad_mf_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_mf_0_10_para.oz = 0;
  calc_grad_mf_0_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_mf_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_mf_0_10_para.hx = 1;
  calc_grad_mf_0_10_para.hy = 1;
  calc_grad_mf_0_10_para.hz = 0;
  calc_grad_mf_0_10_para.bx = 256;
  calc_grad_mf_0_10_para.by = 8;
  calc_grad_mf_0_10_para.bz = 1;
  calc_grad_mf_0_10_para.mx = 1;
  calc_grad_mf_0_10_para.my = 2;
  calc_grad_mf_0_10_para.mz = 32;
  calc_grad_mf_0_10_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_grad_mf_0_10_para.oz][Proc.lat_hw -1+calc_grad_mf_0_10_para.oy][Proc.lon_hw -1+calc_grad_mf_0_10_para.ox];
  calc_grad_mf_0_10_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_grad_mf_0_10_para.oz][Proc.lat_hw -1+calc_grad_mf_0_10_para.oy][Proc.lon_hw -1+calc_grad_mf_0_10_para.ox];
  
  athread_spawn(calc_grad_mf_0_10, &calc_grad_mf_0_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_mftmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_mf_0_11_info calc_grad_mf_0_11_para;
  calc_grad_mf_0_11_para.lz = 32 - 0;
  calc_grad_mf_0_11_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_grad_mf_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_mf_0_11_para.oz = 0;
  calc_grad_mf_0_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_mf_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_mf_0_11_para.hx = 0;
  calc_grad_mf_0_11_para.hy = 0;
  calc_grad_mf_0_11_para.hz = 0;
  calc_grad_mf_0_11_para.bx = 256;
  calc_grad_mf_0_11_para.by = 8;
  calc_grad_mf_0_11_para.bz = 1;
  calc_grad_mf_0_11_para.mx = 1;
  calc_grad_mf_0_11_para.my = 2;
  calc_grad_mf_0_11_para.mz = 32;
  calc_grad_mf_0_11_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_grad_mf_0_11_para.oz][Proc.lat_hw -0+calc_grad_mf_0_11_para.oy][Proc.lon_hw -0+calc_grad_mf_0_11_para.ox];
  calc_grad_mf_0_11_para.tend1dmfdlat = &tend1->dmfdlat[Proc.lev_hw - 0+calc_grad_mf_0_11_para.oz][Proc.lat_hw -0+calc_grad_mf_0_11_para.oy][Proc.lon_hw -0+calc_grad_mf_0_11_para.ox];
  calc_grad_mf_0_11_para.le_lat = &mesh->le_lat[0][0][0];
  calc_grad_mf_0_11_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_mf_0_11, &calc_grad_mf_0_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_mfdmfdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
    for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
      tend1->dphs[0][j][i] = 0.0;
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_dphsdtdphsTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_dphs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tend1->dphs[0][j][i] = ((tend1->dphs[0][j][i] - tend1->dmfdlon[k][j][i]) - tend1->dmfdlat[k][j][i]);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_dphsdtdphsTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_2d_D(Proc, &tend1->dphs[0][0][0], &Proc.FieldReq[async_dphs], true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  dt = dt;
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->we_lev[k][j][i] = 0.0;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_we_levwe_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=32+Proc.lev_hw; k<33+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->we_lev[k][j][i] = 0.0;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_we_levwe_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_dphs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=1+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        mfs = 0.0;
        for (l=0+Proc.lev_hw;l<((k - 1) + 1);l+=1){
          mfs = ((mfs + tend1->dmfdlon[l][j][i]) + tend1->dmfdlat[l][j][i]);
        }
        star_state->we_lev[k][j][i] = (-hybrid_coord_calc_dphdt_lev(mesh->hybi[k][0][0],tend1->dphs[0][j][i]) - mfs);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_we_levwe_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->we_lev[0][0][0], &Proc.FieldReq[async_we_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  dt = dt;
  if (((advPara->we_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_0_10_info accum_we_lev_0_10_para;
    accum_we_lev_0_10_para.lz = 33 - 0;
    accum_we_lev_0_10_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_0_10_para.oz = 0;
    accum_we_lev_0_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_0_10_para.hx = 0;
    accum_we_lev_0_10_para.hy = 0;
    accum_we_lev_0_10_para.hz = 0;
    accum_we_lev_0_10_para.bx = 256;
    accum_we_lev_0_10_para.by = 8;
    accum_we_lev_0_10_para.bz = 1;
    accum_we_lev_0_10_para.mx = 1;
    accum_we_lev_0_10_para.my = 2;
    accum_we_lev_0_10_para.mz = 32;
    accum_we_lev_0_10_para.advptwe0 = &advpt->we0[Proc.lev_hw - 0+accum_we_lev_0_10_para.oz][Proc.lat_hw -0+accum_we_lev_0_10_para.oy][Proc.lon_hw -0+accum_we_lev_0_10_para.ox];
    accum_we_lev_0_10_para.advptm0 = &advpt->m0[Proc.lev_hw - 0+accum_we_lev_0_10_para.oz][Proc.lat_hw -0+accum_we_lev_0_10_para.oy][Proc.lon_hw -0+accum_we_lev_0_10_para.ox];
    accum_we_lev_0_10_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_0_10_para.oz][Proc.lat_hw -0+accum_we_lev_0_10_para.oy][Proc.lon_hw -0+accum_we_lev_0_10_para.ox];
    accum_we_lev_0_10_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_0_10_para.oz][Proc.lat_hw -0+accum_we_lev_0_10_para.oy][Proc.lon_hw -0+accum_we_lev_0_10_para.ox];
    
    athread_spawn(accum_we_lev_0_10, &accum_we_lev_0_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->we_step) = 1;
  }
  if (((advPara->we_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_0_11_info accum_we_lev_0_11_para;
    accum_we_lev_0_11_para.lz = 33 - 0;
    accum_we_lev_0_11_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_0_11_para.oz = 0;
    accum_we_lev_0_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_0_11_para.hx = 1;
    accum_we_lev_0_11_para.hy = 1;
    accum_we_lev_0_11_para.hz = 0;
    accum_we_lev_0_11_para.bx = 256;
    accum_we_lev_0_11_para.by = 8;
    accum_we_lev_0_11_para.bz = 1;
    accum_we_lev_0_11_para.mx = 1;
    accum_we_lev_0_11_para.my = 2;
    accum_we_lev_0_11_para.mz = 32;
    accum_we_lev_0_11_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+accum_we_lev_0_11_para.oz][Proc.lat_hw -1+accum_we_lev_0_11_para.oy][Proc.lon_hw -1+accum_we_lev_0_11_para.ox];
    accum_we_lev_0_11_para.star_statem_lev = &star_state->m_lev[Proc.lev_hw - 0+accum_we_lev_0_11_para.oz][Proc.lat_hw -1+accum_we_lev_0_11_para.oy][Proc.lon_hw -1+accum_we_lev_0_11_para.ox];
    accum_we_lev_0_11_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_0_11_para.oz][Proc.lat_hw -1+accum_we_lev_0_11_para.oy][Proc.lon_hw -1+accum_we_lev_0_11_para.ox];
    accum_we_lev_0_11_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_0_11_para.oz][Proc.lat_hw -1+accum_we_lev_0_11_para.oy][Proc.lon_hw -1+accum_we_lev_0_11_para.ox];
    
    athread_spawn(accum_we_lev_0_11, &accum_we_lev_0_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->we_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_0_12_info accum_we_lev_0_12_para;
      accum_we_lev_0_12_para.lz = 33 - 0;
      accum_we_lev_0_12_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_0_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_0_12_para.oz = 0;
      accum_we_lev_0_12_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_0_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_0_12_para.hx = 1;
      accum_we_lev_0_12_para.hy = 1;
      accum_we_lev_0_12_para.hz = 0;
      accum_we_lev_0_12_para.bx = 256;
      accum_we_lev_0_12_para.by = 8;
      accum_we_lev_0_12_para.bz = 1;
      accum_we_lev_0_12_para.mx = 1;
      accum_we_lev_0_12_para.my = 2;
      accum_we_lev_0_12_para.mz = 32;
      accum_we_lev_0_12_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_0_12_para.oz][Proc.lat_hw -1+accum_we_lev_0_12_para.oy][Proc.lon_hw -1+accum_we_lev_0_12_para.ox];
      accum_we_lev_0_12_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+accum_we_lev_0_12_para.oz][Proc.lat_hw -1+accum_we_lev_0_12_para.oy][Proc.lon_hw -1+accum_we_lev_0_12_para.ox];
      accum_we_lev_0_12_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_0_12_para.oz][Proc.lat_hw -1+accum_we_lev_0_12_para.oy][Proc.lon_hw -1+accum_we_lev_0_12_para.ox];
      accum_we_lev_0_12_para.star_statem_lev = &star_state->m_lev[Proc.lev_hw - 0+accum_we_lev_0_12_para.oz][Proc.lat_hw -1+accum_we_lev_0_12_para.oy][Proc.lon_hw -1+accum_we_lev_0_12_para.ox];
      accum_we_lev_0_12_para.advptwe0 = &advpt->we0[Proc.lev_hw - 0+accum_we_lev_0_12_para.oz][Proc.lat_hw -1+accum_we_lev_0_12_para.oy][Proc.lon_hw -1+accum_we_lev_0_12_para.ox];
      accum_we_lev_0_12_para.advptm0 = &advpt->m0[Proc.lev_hw - 0+accum_we_lev_0_12_para.oz][Proc.lat_hw -1+accum_we_lev_0_12_para.oy][Proc.lon_hw -1+accum_we_lev_0_12_para.ox];
      accum_we_lev_0_12_para.nstep = advPara->nstep;
      
      athread_spawn(accum_we_lev_0_12, &accum_we_lev_0_12_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_0_13_info accum_we_lev_0_13_para;
      accum_we_lev_0_13_para.lz = 33 - 0;
      accum_we_lev_0_13_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_0_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_0_13_para.oz = 0;
      accum_we_lev_0_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_0_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_0_13_para.hx = 1;
      accum_we_lev_0_13_para.hy = 1;
      accum_we_lev_0_13_para.hz = 0;
      accum_we_lev_0_13_para.bx = 256;
      accum_we_lev_0_13_para.by = 8;
      accum_we_lev_0_13_para.bz = 1;
      accum_we_lev_0_13_para.mx = 1;
      accum_we_lev_0_13_para.my = 2;
      accum_we_lev_0_13_para.mz = 32;
      accum_we_lev_0_13_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_0_13_para.oz][Proc.lat_hw -1+accum_we_lev_0_13_para.oy][Proc.lon_hw -1+accum_we_lev_0_13_para.ox];
      accum_we_lev_0_13_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+accum_we_lev_0_13_para.oz][Proc.lat_hw -1+accum_we_lev_0_13_para.oy][Proc.lon_hw -1+accum_we_lev_0_13_para.ox];
      accum_we_lev_0_13_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_0_13_para.oz][Proc.lat_hw -1+accum_we_lev_0_13_para.oy][Proc.lon_hw -1+accum_we_lev_0_13_para.ox];
      accum_we_lev_0_13_para.star_statem_lev = &star_state->m_lev[Proc.lev_hw - 0+accum_we_lev_0_13_para.oz][Proc.lat_hw -1+accum_we_lev_0_13_para.oy][Proc.lon_hw -1+accum_we_lev_0_13_para.ox];
      
      athread_spawn(accum_we_lev_0_13, &accum_we_lev_0_13_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->we_step) = 0;
  }
  else
  {
    (advPara->we_step) = ((advPara->we_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->we_step) > (advPara->nstep))))
  {
    if (((advPara->dynamic) == 0))
    {
      (advPara->we_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_0_14_info accum_we_lev_0_14_para;
    accum_we_lev_0_14_para.lz = 32 - 1;
    accum_we_lev_0_14_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_0_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_0_14_para.oz = 1;
    accum_we_lev_0_14_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_0_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_0_14_para.hx = 0;
    accum_we_lev_0_14_para.hy = 0;
    accum_we_lev_0_14_para.hz = 0;
    accum_we_lev_0_14_para.bx = 256;
    accum_we_lev_0_14_para.by = 8;
    accum_we_lev_0_14_para.bz = 1;
    accum_we_lev_0_14_para.mx = 1;
    accum_we_lev_0_14_para.my = 2;
    accum_we_lev_0_14_para.mz = 32;
    accum_we_lev_0_14_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_0_14_para.oz][Proc.lat_hw -0+accum_we_lev_0_14_para.oy][Proc.lon_hw -0+accum_we_lev_0_14_para.ox];
    accum_we_lev_0_14_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_0_14_para.oz][Proc.lat_hw -0+accum_we_lev_0_14_para.oy][Proc.lon_hw -0+accum_we_lev_0_14_para.ox];
    accum_we_lev_0_14_para.advptcflz = &advpt->cflz[Proc.lev_hw - 0+accum_we_lev_0_14_para.oz][Proc.lat_hw -0+accum_we_lev_0_14_para.oy][Proc.lon_hw -0+accum_we_lev_0_14_para.ox];
    accum_we_lev_0_14_para.dt = dt;
    
    athread_spawn(accum_we_lev_0_14, &accum_we_lev_0_14_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levcflzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_lev_edge_to_lev_lon_edge_0_2_info interp_lev_edge_to_lev_lon_edge_0_2_para;
  interp_lev_edge_to_lev_lon_edge_0_2_para.lz = 33 - 0;
  interp_lev_edge_to_lev_lon_edge_0_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  interp_lev_edge_to_lev_lon_edge_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_lev_edge_to_lev_lon_edge_0_2_para.oz = 0;
  interp_lev_edge_to_lev_lon_edge_0_2_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  interp_lev_edge_to_lev_lon_edge_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_lev_edge_to_lev_lon_edge_0_2_para.hx = 1;
  interp_lev_edge_to_lev_lon_edge_0_2_para.hy = 1;
  interp_lev_edge_to_lev_lon_edge_0_2_para.hz = 0;
  interp_lev_edge_to_lev_lon_edge_0_2_para.bx = 256;
  interp_lev_edge_to_lev_lon_edge_0_2_para.by = 8;
  interp_lev_edge_to_lev_lon_edge_0_2_para.bz = 1;
  interp_lev_edge_to_lev_lon_edge_0_2_para.mx = 1;
  interp_lev_edge_to_lev_lon_edge_0_2_para.my = 2;
  interp_lev_edge_to_lev_lon_edge_0_2_para.mz = 32;
  interp_lev_edge_to_lev_lon_edge_0_2_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+interp_lev_edge_to_lev_lon_edge_0_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lon_edge_0_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lon_edge_0_2_para.ox];
  interp_lev_edge_to_lev_lon_edge_0_2_para.star_statewe_lev_lon = &star_state->we_lev_lon[Proc.lev_hw - 0+interp_lev_edge_to_lev_lon_edge_0_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lon_edge_0_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lon_edge_0_2_para.ox];
  interp_lev_edge_to_lev_lon_edge_0_2_para.area_lon_west = &mesh->area_lon_west[0][0][0];
  interp_lev_edge_to_lev_lon_edge_0_2_para.area_lon_east = &mesh->area_lon_east[0][0][0];
  interp_lev_edge_to_lev_lon_edge_0_2_para.area_lon = &mesh->area_lon[0][0][0];
  
  athread_spawn(interp_lev_edge_to_lev_lon_edge_0_2, &interp_lev_edge_to_lev_lon_edge_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_lev_edge_to_lev_lon_edgewe_lev_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_lev_edge_to_lev_lat_edge_0_2_info interp_lev_edge_to_lev_lat_edge_0_2_para;
  interp_lev_edge_to_lev_lat_edge_0_2_para.lz = 33 - 0;
  interp_lev_edge_to_lev_lat_edge_0_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interp_lev_edge_to_lev_lat_edge_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_lev_edge_to_lev_lat_edge_0_2_para.oz = 0;
  interp_lev_edge_to_lev_lat_edge_0_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interp_lev_edge_to_lev_lat_edge_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_lev_edge_to_lev_lat_edge_0_2_para.hx = 1;
  interp_lev_edge_to_lev_lat_edge_0_2_para.hy = 1;
  interp_lev_edge_to_lev_lat_edge_0_2_para.hz = 0;
  interp_lev_edge_to_lev_lat_edge_0_2_para.bx = 256;
  interp_lev_edge_to_lev_lat_edge_0_2_para.by = 8;
  interp_lev_edge_to_lev_lat_edge_0_2_para.bz = 1;
  interp_lev_edge_to_lev_lat_edge_0_2_para.mx = 1;
  interp_lev_edge_to_lev_lat_edge_0_2_para.my = 2;
  interp_lev_edge_to_lev_lat_edge_0_2_para.mz = 32;
  interp_lev_edge_to_lev_lat_edge_0_2_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+interp_lev_edge_to_lev_lat_edge_0_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lat_edge_0_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lat_edge_0_2_para.ox];
  interp_lev_edge_to_lev_lat_edge_0_2_para.star_statewe_lev_lat = &star_state->we_lev_lat[Proc.lev_hw - 0+interp_lev_edge_to_lev_lat_edge_0_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lat_edge_0_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lat_edge_0_2_para.ox];
  interp_lev_edge_to_lev_lat_edge_0_2_para.area_lat_north = &mesh->area_lat_north[0][0][0];
  interp_lev_edge_to_lev_lat_edge_0_2_para.area_lat_south = &mesh->area_lat_south[0][0][0];
  interp_lev_edge_to_lev_lat_edge_0_2_para.area_lat = &mesh->area_lat[0][0][0];
  
  athread_spawn(interp_lev_edge_to_lev_lat_edge_0_2, &interp_lev_edge_to_lev_lat_edge_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_lev_edge_to_lev_lat_edgewe_lev_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_0_8_info calc_wedudlev_wedvdlev_0_8_para;
  calc_wedudlev_wedvdlev_0_8_para.lz = 31 - 1;
  calc_wedudlev_wedvdlev_0_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_wedudlev_wedvdlev_0_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_0_8_para.oz = 1;
  calc_wedudlev_wedvdlev_0_8_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_0_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_0_8_para.hx = 1;
  calc_wedudlev_wedvdlev_0_8_para.hy = 0;
  calc_wedudlev_wedvdlev_0_8_para.hz = 1;
  calc_wedudlev_wedvdlev_0_8_para.bx = 256;
  calc_wedudlev_wedvdlev_0_8_para.by = 1;
  calc_wedudlev_wedvdlev_0_8_para.bz = 4;
  calc_wedudlev_wedvdlev_0_8_para.mx = 1;
  calc_wedudlev_wedvdlev_0_8_para.my = 8;
  calc_wedudlev_wedvdlev_0_8_para.mz = 8;
  calc_wedudlev_wedvdlev_0_8_para.star_statewe_lev_lon = &star_state->we_lev_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_8_para.ox];
  calc_wedudlev_wedvdlev_0_8_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_8_para.ox];
  calc_wedudlev_wedvdlev_0_8_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_8_para.ox];
  calc_wedudlev_wedvdlev_0_8_para.tend1wedudlev = &tend1->wedudlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_8_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_0_8, &calc_wedudlev_wedvdlev_0_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedudlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tend1->wedudlev[k][j][i] = (((star_state->we_lev_lon[(k + 1)][j][i] * (star_state->u_lon[(k + 1)][j][i] - star_state->u_lon[k][j][i])) / star_state->m_lon[k][j][i]) / 2.0);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedudlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_0_9_info calc_wedudlev_wedvdlev_0_9_para;
  calc_wedudlev_wedvdlev_0_9_para.lz = 32 - 31;
  calc_wedudlev_wedvdlev_0_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_wedudlev_wedvdlev_0_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_0_9_para.oz = 31;
  calc_wedudlev_wedvdlev_0_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_0_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_0_9_para.hx = 1;
  calc_wedudlev_wedvdlev_0_9_para.hy = 0;
  calc_wedudlev_wedvdlev_0_9_para.hz = 1;
  calc_wedudlev_wedvdlev_0_9_para.bx = 256;
  calc_wedudlev_wedvdlev_0_9_para.by = 1;
  calc_wedudlev_wedvdlev_0_9_para.bz = 4;
  calc_wedudlev_wedvdlev_0_9_para.mx = 1;
  calc_wedudlev_wedvdlev_0_9_para.my = 8;
  calc_wedudlev_wedvdlev_0_9_para.mz = 8;
  calc_wedudlev_wedvdlev_0_9_para.star_statewe_lev_lon = &star_state->we_lev_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_9_para.ox];
  calc_wedudlev_wedvdlev_0_9_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_9_para.ox];
  calc_wedudlev_wedvdlev_0_9_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_9_para.ox];
  calc_wedudlev_wedvdlev_0_9_para.tend1wedudlev = &tend1->wedudlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_9_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_0_9, &calc_wedudlev_wedvdlev_0_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedudlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_0_10_info calc_wedudlev_wedvdlev_0_10_para;
  calc_wedudlev_wedvdlev_0_10_para.lz = 31 - 1;
  calc_wedudlev_wedvdlev_0_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_wedudlev_wedvdlev_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_0_10_para.oz = 1;
  calc_wedudlev_wedvdlev_0_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_0_10_para.hx = 1;
  calc_wedudlev_wedvdlev_0_10_para.hy = 0;
  calc_wedudlev_wedvdlev_0_10_para.hz = 1;
  calc_wedudlev_wedvdlev_0_10_para.bx = 256;
  calc_wedudlev_wedvdlev_0_10_para.by = 1;
  calc_wedudlev_wedvdlev_0_10_para.bz = 4;
  calc_wedudlev_wedvdlev_0_10_para.mx = 1;
  calc_wedudlev_wedvdlev_0_10_para.my = 8;
  calc_wedudlev_wedvdlev_0_10_para.mz = 8;
  calc_wedudlev_wedvdlev_0_10_para.star_statewe_lev_lat = &star_state->we_lev_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_10_para.ox];
  calc_wedudlev_wedvdlev_0_10_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_10_para.ox];
  calc_wedudlev_wedvdlev_0_10_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_10_para.ox];
  calc_wedudlev_wedvdlev_0_10_para.tend1wedvdlev = &tend1->wedvdlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_10_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_0_10, &calc_wedudlev_wedvdlev_0_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedvdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tend1->wedvdlev[k][j][i] = (((star_state->we_lev_lat[(k + 1)][j][i] * (star_state->v_lat[(k + 1)][j][i] - star_state->v_lat[k][j][i])) / star_state->m_lat[k][j][i]) / 2.0);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedvdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_0_11_info calc_wedudlev_wedvdlev_0_11_para;
  calc_wedudlev_wedvdlev_0_11_para.lz = 32 - 31;
  calc_wedudlev_wedvdlev_0_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_wedudlev_wedvdlev_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_0_11_para.oz = 31;
  calc_wedudlev_wedvdlev_0_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_0_11_para.hx = 1;
  calc_wedudlev_wedvdlev_0_11_para.hy = 0;
  calc_wedudlev_wedvdlev_0_11_para.hz = 1;
  calc_wedudlev_wedvdlev_0_11_para.bx = 256;
  calc_wedudlev_wedvdlev_0_11_para.by = 1;
  calc_wedudlev_wedvdlev_0_11_para.bz = 4;
  calc_wedudlev_wedvdlev_0_11_para.mx = 1;
  calc_wedudlev_wedvdlev_0_11_para.my = 8;
  calc_wedudlev_wedvdlev_0_11_para.mz = 8;
  calc_wedudlev_wedvdlev_0_11_para.star_statewe_lev_lat = &star_state->we_lev_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_11_para.ox];
  calc_wedudlev_wedvdlev_0_11_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_11_para.ox];
  calc_wedudlev_wedvdlev_0_11_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_11_para.ox];
  calc_wedudlev_wedvdlev_0_11_para.tend1wedvdlev = &tend1->wedvdlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_0_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_0_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_0_11_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_0_11, &calc_wedudlev_wedvdlev_0_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedvdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  dt = dt;
  dt = dt;
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_0_6_info hflx_ppm_inner_0_6_para;
  hflx_ppm_inner_0_6_para.lz = 32 - 0;
  hflx_ppm_inner_0_6_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_0_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_0_6_para.oz = 0;
  hflx_ppm_inner_0_6_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_0_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_0_6_para.hx = 2;
  hflx_ppm_inner_0_6_para.hy = 2;
  hflx_ppm_inner_0_6_para.hz = 0;
  hflx_ppm_inner_0_6_para.bx = 256;
  hflx_ppm_inner_0_6_para.by = 8;
  hflx_ppm_inner_0_6_para.bz = 1;
  hflx_ppm_inner_0_6_para.mx = 1;
  hflx_ppm_inner_0_6_para.my = 2;
  hflx_ppm_inner_0_6_para.mz = 32;
  hflx_ppm_inner_0_6_para.star_statept = &star_state->pt[Proc.lev_hw - 0+hflx_ppm_inner_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_6_para.ox];
  hflx_ppm_inner_0_6_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_inner_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_6_para.ox];
  hflx_ppm_inner_0_6_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_inner_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_6_para.ox];
  hflx_ppm_inner_0_6_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_inner_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_6_para.ox];
  hflx_ppm_inner_0_6_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_inner_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_6_para.ox];
  hflx_ppm_inner_0_6_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_inner_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_6_para.ox];
  hflx_ppm_inner_0_6_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_inner_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_6_para.ox];
  
  athread_spawn(hflx_ppm_inner_0_6, &hflx_ppm_inner_0_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_uu]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_0_7_info hflx_ppm_inner_0_7_para;
  hflx_ppm_inner_0_7_para.lz = 32 - 0;
  hflx_ppm_inner_0_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_inner_0_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_0_7_para.oz = 0;
  hflx_ppm_inner_0_7_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_inner_0_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_0_7_para.hx = Proc.lon_hw;
  hflx_ppm_inner_0_7_para.hy = Proc.lat_hw;
  hflx_ppm_inner_0_7_para.hz = 0;
  hflx_ppm_inner_0_7_para.bx = 64;
  hflx_ppm_inner_0_7_para.by = 1;
  hflx_ppm_inner_0_7_para.bz = 1;
  hflx_ppm_inner_0_7_para.mx = 1;
  hflx_ppm_inner_0_7_para.my = 2;
  hflx_ppm_inner_0_7_para.mz = 32;
  hflx_ppm_inner_0_7_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+hflx_ppm_inner_0_7_para.oz][Proc.lat_hw -hflx_ppm_inner_0_7_para.hy +hflx_ppm_inner_0_7_para.oy][Proc.lon_hw -hflx_ppm_inner_0_7_para.hx +hflx_ppm_inner_0_7_para.ox];
  hflx_ppm_inner_0_7_para.star_statept = &star_state->pt[Proc.lev_hw - 0+hflx_ppm_inner_0_7_para.oz][Proc.lat_hw -hflx_ppm_inner_0_7_para.hy +hflx_ppm_inner_0_7_para.oy][Proc.lon_hw -hflx_ppm_inner_0_7_para.hx +hflx_ppm_inner_0_7_para.ox];
  hflx_ppm_inner_0_7_para.advptuu = &advpt->uu[Proc.lev_hw - 0+hflx_ppm_inner_0_7_para.oz][Proc.lat_hw -hflx_ppm_inner_0_7_para.hy +hflx_ppm_inner_0_7_para.oy][Proc.lon_hw -hflx_ppm_inner_0_7_para.hx +hflx_ppm_inner_0_7_para.ox];
  hflx_ppm_inner_0_7_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_inner_0_7_para.oz][Proc.lat_hw -hflx_ppm_inner_0_7_para.hy +hflx_ppm_inner_0_7_para.oy][Proc.lon_hw -hflx_ppm_inner_0_7_para.hx +hflx_ppm_inner_0_7_para.ox];
  hflx_ppm_inner_0_7_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_inner_0_7_para.oz][Proc.lat_hw -hflx_ppm_inner_0_7_para.hy +hflx_ppm_inner_0_7_para.oy][Proc.lon_hw -hflx_ppm_inner_0_7_para.hx +hflx_ppm_inner_0_7_para.ox];
  hflx_ppm_inner_0_7_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_inner_0_7_para.oz][Proc.lat_hw -hflx_ppm_inner_0_7_para.hy +hflx_ppm_inner_0_7_para.oy][Proc.lon_hw -hflx_ppm_inner_0_7_para.hx +hflx_ppm_inner_0_7_para.ox];
  hflx_ppm_inner_0_7_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+hflx_ppm_inner_0_7_para.oz][Proc.lat_hw -hflx_ppm_inner_0_7_para.hy +hflx_ppm_inner_0_7_para.oy][Proc.lon_hw -hflx_ppm_inner_0_7_para.hx +hflx_ppm_inner_0_7_para.ox];
  
  athread_spawn(hflx_ppm_inner_0_7, &hflx_ppm_inner_0_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerptf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lon[0][0][0], &Proc.FieldReq[async_ptf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_vv]);
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_0_8_info hflx_ppm_inner_0_8_para;
  hflx_ppm_inner_0_8_para.lz = 32 - 0;
  hflx_ppm_inner_0_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_0_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_0_8_para.oz = 0;
  hflx_ppm_inner_0_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_0_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_0_8_para.hx = 0;
  hflx_ppm_inner_0_8_para.hy = 1;
  hflx_ppm_inner_0_8_para.hz = 0;
  hflx_ppm_inner_0_8_para.bx = 256;
  hflx_ppm_inner_0_8_para.by = 8;
  hflx_ppm_inner_0_8_para.bz = 1;
  hflx_ppm_inner_0_8_para.mx = 1;
  hflx_ppm_inner_0_8_para.my = 2;
  hflx_ppm_inner_0_8_para.mz = 32;
  hflx_ppm_inner_0_8_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+hflx_ppm_inner_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_8_para.ox];
  hflx_ppm_inner_0_8_para.advptvv = &advpt->vv[Proc.lev_hw - 0+hflx_ppm_inner_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_8_para.ox];
  hflx_ppm_inner_0_8_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_inner_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_8_para.ox];
  hflx_ppm_inner_0_8_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_inner_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_8_para.ox];
  hflx_ppm_inner_0_8_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_inner_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_8_para.ox];
  hflx_ppm_inner_0_8_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+hflx_ppm_inner_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_8_para.ox];
  
  athread_spawn(hflx_ppm_inner_0_8, &hflx_ppm_inner_0_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerptf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lat[0][0][0], &Proc.FieldReq[async_ptf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_0_6_info ffsl_calc_tracer_hflx_0_6_para;
  ffsl_calc_tracer_hflx_0_6_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_0_6_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  ffsl_calc_tracer_hflx_0_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_0_6_para.oz = 0;
  ffsl_calc_tracer_hflx_0_6_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_0_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_0_6_para.hx = 2;
  ffsl_calc_tracer_hflx_0_6_para.hy = 2;
  ffsl_calc_tracer_hflx_0_6_para.hz = 0;
  ffsl_calc_tracer_hflx_0_6_para.bx = 256;
  ffsl_calc_tracer_hflx_0_6_para.by = 8;
  ffsl_calc_tracer_hflx_0_6_para.bz = 1;
  ffsl_calc_tracer_hflx_0_6_para.mx = 1;
  ffsl_calc_tracer_hflx_0_6_para.my = 2;
  ffsl_calc_tracer_hflx_0_6_para.mz = 32;
  ffsl_calc_tracer_hflx_0_6_para.star_statept = &star_state->pt[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_6_para.ox];
  ffsl_calc_tracer_hflx_0_6_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_6_para.ox];
  ffsl_calc_tracer_hflx_0_6_para.advptdivx = &advpt->divx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_6_para.ox];
  ffsl_calc_tracer_hflx_0_6_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_6_para.ox];
  ffsl_calc_tracer_hflx_0_6_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_6_para.ox];
  ffsl_calc_tracer_hflx_0_6_para.advptqx = &advpt->qx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_6_para.ox];
  ffsl_calc_tracer_hflx_0_6_para.advptqy = &advpt->qy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_6_para.ox];
  ffsl_calc_tracer_hflx_0_6_para.le_lon = &mesh->le_lon[0][0][0];
  ffsl_calc_tracer_hflx_0_6_para.area_cell = &mesh->area_cell[0][0][0];
  ffsl_calc_tracer_hflx_0_6_para.le_lat = &mesh->le_lat[0][0][0];
  ffsl_calc_tracer_hflx_0_6_para.dt = dt;
  
  athread_spawn(ffsl_calc_tracer_hflx_0_6, &ffsl_calc_tracer_hflx_0_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxqxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_0_7_info ffsl_calc_tracer_hflx_0_7_para;
  ffsl_calc_tracer_hflx_0_7_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_0_7_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  ffsl_calc_tracer_hflx_0_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_0_7_para.oz = 0;
  ffsl_calc_tracer_hflx_0_7_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_0_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_0_7_para.hx = 0;
  ffsl_calc_tracer_hflx_0_7_para.hy = 1;
  ffsl_calc_tracer_hflx_0_7_para.hz = 0;
  ffsl_calc_tracer_hflx_0_7_para.bx = 256;
  ffsl_calc_tracer_hflx_0_7_para.by = 8;
  ffsl_calc_tracer_hflx_0_7_para.bz = 1;
  ffsl_calc_tracer_hflx_0_7_para.mx = 1;
  ffsl_calc_tracer_hflx_0_7_para.my = 2;
  ffsl_calc_tracer_hflx_0_7_para.mz = 32;
  ffsl_calc_tracer_hflx_0_7_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_7_para.oz][Proc.lat_hw -1+ffsl_calc_tracer_hflx_0_7_para.oy][Proc.lon_hw -0+ffsl_calc_tracer_hflx_0_7_para.ox];
  ffsl_calc_tracer_hflx_0_7_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_7_para.oz][Proc.lat_hw -1+ffsl_calc_tracer_hflx_0_7_para.oy][Proc.lon_hw -0+ffsl_calc_tracer_hflx_0_7_para.ox];
  
  athread_spawn(ffsl_calc_tracer_hflx_0_7, &ffsl_calc_tracer_hflx_0_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxtmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_0_8_info ffsl_calc_tracer_hflx_0_8_para;
  ffsl_calc_tracer_hflx_0_8_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_0_8_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  ffsl_calc_tracer_hflx_0_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_0_8_para.oz = 0;
  ffsl_calc_tracer_hflx_0_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_0_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_0_8_para.hx = 2;
  ffsl_calc_tracer_hflx_0_8_para.hy = 2;
  ffsl_calc_tracer_hflx_0_8_para.hz = 0;
  ffsl_calc_tracer_hflx_0_8_para.bx = 256;
  ffsl_calc_tracer_hflx_0_8_para.by = 8;
  ffsl_calc_tracer_hflx_0_8_para.bz = 1;
  ffsl_calc_tracer_hflx_0_8_para.mx = 1;
  ffsl_calc_tracer_hflx_0_8_para.my = 2;
  ffsl_calc_tracer_hflx_0_8_para.mz = 32;
  ffsl_calc_tracer_hflx_0_8_para.star_statept = &star_state->pt[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_8_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_8_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_8_para.ox];
  ffsl_calc_tracer_hflx_0_8_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_8_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_8_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_8_para.ox];
  ffsl_calc_tracer_hflx_0_8_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_8_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_8_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_8_para.ox];
  ffsl_calc_tracer_hflx_0_8_para.advptqx = &advpt->qx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_8_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_8_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_8_para.ox];
  ffsl_calc_tracer_hflx_0_8_para.advptqy = &advpt->qy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_8_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_8_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_8_para.ox];
  ffsl_calc_tracer_hflx_0_8_para.le_lat = &mesh->le_lat[0][0][0];
  ffsl_calc_tracer_hflx_0_8_para.area_cell = &mesh->area_cell[0][0][0];
  ffsl_calc_tracer_hflx_0_8_para.dt = dt;
  
  athread_spawn(ffsl_calc_tracer_hflx_0_8, &ffsl_calc_tracer_hflx_0_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxqxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qx[0][0][0], &Proc.FieldReq[async_qx], true, true, true, false, false, true, true, true);
  UpdateHalo_3d_D(Proc, &advpt->qy[0][0][0], &Proc.FieldReq[async_qy], true, true, true, true, true, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qx]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_0_6_info hflx_ppm_outer_0_6_para;
  hflx_ppm_outer_0_6_para.lz = 32 - 0;
  hflx_ppm_outer_0_6_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_0_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_0_6_para.oz = 0;
  hflx_ppm_outer_0_6_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_0_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_0_6_para.hx = 2;
  hflx_ppm_outer_0_6_para.hy = 2;
  hflx_ppm_outer_0_6_para.hz = 0;
  hflx_ppm_outer_0_6_para.bx = 256;
  hflx_ppm_outer_0_6_para.by = 8;
  hflx_ppm_outer_0_6_para.bz = 1;
  hflx_ppm_outer_0_6_para.mx = 1;
  hflx_ppm_outer_0_6_para.my = 2;
  hflx_ppm_outer_0_6_para.mz = 32;
  hflx_ppm_outer_0_6_para.advptqy = &advpt->qy[Proc.lev_hw - 0+hflx_ppm_outer_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_6_para.ox];
  hflx_ppm_outer_0_6_para.advptqx = &advpt->qx[Proc.lev_hw - 0+hflx_ppm_outer_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_6_para.ox];
  hflx_ppm_outer_0_6_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_outer_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_6_para.ox];
  hflx_ppm_outer_0_6_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_outer_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_6_para.ox];
  hflx_ppm_outer_0_6_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_outer_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_6_para.ox];
  hflx_ppm_outer_0_6_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_outer_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_6_para.ox];
  hflx_ppm_outer_0_6_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_outer_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_6_para.ox];
  hflx_ppm_outer_0_6_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_outer_0_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_6_para.ox];
  
  athread_spawn(hflx_ppm_outer_0_6, &hflx_ppm_outer_0_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_0_7_info hflx_ppm_outer_0_7_para;
  hflx_ppm_outer_0_7_para.lz = 32 - 0;
  hflx_ppm_outer_0_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_outer_0_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_0_7_para.oz = 0;
  hflx_ppm_outer_0_7_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_outer_0_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_0_7_para.hx = Proc.lon_hw;
  hflx_ppm_outer_0_7_para.hy = Proc.lat_hw;
  hflx_ppm_outer_0_7_para.hz = 0;
  hflx_ppm_outer_0_7_para.bx = 64;
  hflx_ppm_outer_0_7_para.by = 1;
  hflx_ppm_outer_0_7_para.bz = 1;
  hflx_ppm_outer_0_7_para.mx = 1;
  hflx_ppm_outer_0_7_para.my = 2;
  hflx_ppm_outer_0_7_para.mz = 32;
  hflx_ppm_outer_0_7_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+hflx_ppm_outer_0_7_para.oz][Proc.lat_hw -hflx_ppm_outer_0_7_para.hy +hflx_ppm_outer_0_7_para.oy][Proc.lon_hw -hflx_ppm_outer_0_7_para.hx +hflx_ppm_outer_0_7_para.ox];
  hflx_ppm_outer_0_7_para.advptqy = &advpt->qy[Proc.lev_hw - 0+hflx_ppm_outer_0_7_para.oz][Proc.lat_hw -hflx_ppm_outer_0_7_para.hy +hflx_ppm_outer_0_7_para.oy][Proc.lon_hw -hflx_ppm_outer_0_7_para.hx +hflx_ppm_outer_0_7_para.ox];
  hflx_ppm_outer_0_7_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+hflx_ppm_outer_0_7_para.oz][Proc.lat_hw -hflx_ppm_outer_0_7_para.hy +hflx_ppm_outer_0_7_para.oy][Proc.lon_hw -hflx_ppm_outer_0_7_para.hx +hflx_ppm_outer_0_7_para.ox];
  hflx_ppm_outer_0_7_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_outer_0_7_para.oz][Proc.lat_hw -hflx_ppm_outer_0_7_para.hy +hflx_ppm_outer_0_7_para.oy][Proc.lon_hw -hflx_ppm_outer_0_7_para.hx +hflx_ppm_outer_0_7_para.ox];
  hflx_ppm_outer_0_7_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_outer_0_7_para.oz][Proc.lat_hw -hflx_ppm_outer_0_7_para.hy +hflx_ppm_outer_0_7_para.oy][Proc.lon_hw -hflx_ppm_outer_0_7_para.hx +hflx_ppm_outer_0_7_para.ox];
  hflx_ppm_outer_0_7_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_outer_0_7_para.oz][Proc.lat_hw -hflx_ppm_outer_0_7_para.hy +hflx_ppm_outer_0_7_para.oy][Proc.lon_hw -hflx_ppm_outer_0_7_para.hx +hflx_ppm_outer_0_7_para.ox];
  hflx_ppm_outer_0_7_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+hflx_ppm_outer_0_7_para.oz][Proc.lat_hw -hflx_ppm_outer_0_7_para.hy +hflx_ppm_outer_0_7_para.oy][Proc.lon_hw -hflx_ppm_outer_0_7_para.hx +hflx_ppm_outer_0_7_para.ox];
  
  athread_spawn(hflx_ppm_outer_0_7, &hflx_ppm_outer_0_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerptf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lon[0][0][0], &Proc.FieldReq[async_ptf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_0_8_info hflx_ppm_outer_0_8_para;
  hflx_ppm_outer_0_8_para.lz = 32 - 0;
  hflx_ppm_outer_0_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_0_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_0_8_para.oz = 0;
  hflx_ppm_outer_0_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_0_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_0_8_para.hx = 0;
  hflx_ppm_outer_0_8_para.hy = 1;
  hflx_ppm_outer_0_8_para.hz = 0;
  hflx_ppm_outer_0_8_para.bx = 256;
  hflx_ppm_outer_0_8_para.by = 8;
  hflx_ppm_outer_0_8_para.bz = 1;
  hflx_ppm_outer_0_8_para.mx = 1;
  hflx_ppm_outer_0_8_para.my = 2;
  hflx_ppm_outer_0_8_para.mz = 32;
  hflx_ppm_outer_0_8_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+hflx_ppm_outer_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_8_para.ox];
  hflx_ppm_outer_0_8_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+hflx_ppm_outer_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_8_para.ox];
  hflx_ppm_outer_0_8_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_outer_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_8_para.ox];
  hflx_ppm_outer_0_8_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_outer_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_8_para.ox];
  hflx_ppm_outer_0_8_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_outer_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_8_para.ox];
  hflx_ppm_outer_0_8_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+hflx_ppm_outer_0_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_8_para.ox];
  
  athread_spawn(hflx_ppm_outer_0_8, &hflx_ppm_outer_0_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerptf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lat[0][0][0], &Proc.FieldReq[async_ptf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_0_12_info calc_grad_ptf_0_12_para;
  calc_grad_ptf_0_12_para.lz = 32 - 0;
  calc_grad_ptf_0_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_ptf_0_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_0_12_para.oz = 0;
  calc_grad_ptf_0_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_ptf_0_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_0_12_para.hx = 1;
  calc_grad_ptf_0_12_para.hy = 0;
  calc_grad_ptf_0_12_para.hz = 0;
  calc_grad_ptf_0_12_para.bx = 256;
  calc_grad_ptf_0_12_para.by = 8;
  calc_grad_ptf_0_12_para.bz = 1;
  calc_grad_ptf_0_12_para.mx = 1;
  calc_grad_ptf_0_12_para.my = 2;
  calc_grad_ptf_0_12_para.mz = 32;
  calc_grad_ptf_0_12_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+calc_grad_ptf_0_12_para.oz][Proc.lat_hw -0+calc_grad_ptf_0_12_para.oy][Proc.lon_hw -1+calc_grad_ptf_0_12_para.ox];
  calc_grad_ptf_0_12_para.tend1dptfdlon = &tend1->dptfdlon[Proc.lev_hw - 0+calc_grad_ptf_0_12_para.oz][Proc.lat_hw -0+calc_grad_ptf_0_12_para.oy][Proc.lon_hw -1+calc_grad_ptf_0_12_para.ox];
  calc_grad_ptf_0_12_para.le_lon = &mesh->le_lon[0][0][0];
  calc_grad_ptf_0_12_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_ptf_0_12, &calc_grad_ptf_0_12_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfdptfdlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_0_13_info calc_grad_ptf_0_13_para;
  calc_grad_ptf_0_13_para.lz = 32 - 0;
  calc_grad_ptf_0_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_ptf_0_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_0_13_para.oz = 0;
  calc_grad_ptf_0_13_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_ptf_0_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_0_13_para.hx = 0;
  calc_grad_ptf_0_13_para.hy = 1;
  calc_grad_ptf_0_13_para.hz = 0;
  calc_grad_ptf_0_13_para.bx = 256;
  calc_grad_ptf_0_13_para.by = 8;
  calc_grad_ptf_0_13_para.bz = 1;
  calc_grad_ptf_0_13_para.mx = 1;
  calc_grad_ptf_0_13_para.my = 2;
  calc_grad_ptf_0_13_para.mz = 32;
  calc_grad_ptf_0_13_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+calc_grad_ptf_0_13_para.oz][Proc.lat_hw -1+calc_grad_ptf_0_13_para.oy][Proc.lon_hw -0+calc_grad_ptf_0_13_para.ox];
  calc_grad_ptf_0_13_para.tend1dptfdlat = &tend1->dptfdlat[Proc.lev_hw - 0+calc_grad_ptf_0_13_para.oz][Proc.lat_hw -1+calc_grad_ptf_0_13_para.oy][Proc.lon_hw -0+calc_grad_ptf_0_13_para.ox];
  calc_grad_ptf_0_13_para.le_lat = &mesh->le_lat[0][0][0];
  calc_grad_ptf_0_13_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_ptf_0_13, &calc_grad_ptf_0_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfdptfdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_0_14_info calc_grad_ptf_0_14_para;
  calc_grad_ptf_0_14_para.lz = 32 - 0;
  calc_grad_ptf_0_14_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_grad_ptf_0_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_0_14_para.oz = 0;
  calc_grad_ptf_0_14_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_ptf_0_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_0_14_para.hx = 0;
  calc_grad_ptf_0_14_para.hy = 1;
  calc_grad_ptf_0_14_para.hz = 0;
  calc_grad_ptf_0_14_para.bx = 256;
  calc_grad_ptf_0_14_para.by = 8;
  calc_grad_ptf_0_14_para.bz = 1;
  calc_grad_ptf_0_14_para.mx = 1;
  calc_grad_ptf_0_14_para.my = 2;
  calc_grad_ptf_0_14_para.mz = 32;
  calc_grad_ptf_0_14_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+calc_grad_ptf_0_14_para.oz][Proc.lat_hw -1+calc_grad_ptf_0_14_para.oy][Proc.lon_hw -0+calc_grad_ptf_0_14_para.ox];
  calc_grad_ptf_0_14_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_grad_ptf_0_14_para.oz][Proc.lat_hw -1+calc_grad_ptf_0_14_para.oy][Proc.lon_hw -0+calc_grad_ptf_0_14_para.ox];
  
  athread_spawn(calc_grad_ptf_0_14, &calc_grad_ptf_0_14_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptftmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_0_15_info calc_grad_ptf_0_15_para;
  calc_grad_ptf_0_15_para.lz = 32 - 0;
  calc_grad_ptf_0_15_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  calc_grad_ptf_0_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_0_15_para.oz = 0;
  calc_grad_ptf_0_15_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_ptf_0_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_0_15_para.hx = 0;
  calc_grad_ptf_0_15_para.hy = 0;
  calc_grad_ptf_0_15_para.hz = 0;
  calc_grad_ptf_0_15_para.bx = 256;
  calc_grad_ptf_0_15_para.by = 8;
  calc_grad_ptf_0_15_para.bz = 1;
  calc_grad_ptf_0_15_para.mx = 1;
  calc_grad_ptf_0_15_para.my = 2;
  calc_grad_ptf_0_15_para.mz = 32;
  calc_grad_ptf_0_15_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_grad_ptf_0_15_para.oz][Proc.lat_hw -0+calc_grad_ptf_0_15_para.oy][Proc.lon_hw -0+calc_grad_ptf_0_15_para.ox];
  calc_grad_ptf_0_15_para.tend1dptfdlat = &tend1->dptfdlat[Proc.lev_hw - 0+calc_grad_ptf_0_15_para.oz][Proc.lat_hw -0+calc_grad_ptf_0_15_para.oy][Proc.lon_hw -0+calc_grad_ptf_0_15_para.ox];
  calc_grad_ptf_0_15_para.le_lat = &mesh->le_lat[0][0][0];
  calc_grad_ptf_0_15_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_ptf_0_15, &calc_grad_ptf_0_15_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfdptfdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=-1+Proc.lev_hw; k<0+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->pt[k][j][i] = ((2 * star_state->pt[(k + 1)][j][i]) - star_state->pt[(k + 2)][j][i]);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=-2+Proc.lev_hw; k<-1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->pt[k][j][i] = ((2 * star_state->pt[(k + 1)][j][i]) - star_state->pt[(k + 2)][j][i]);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_0_16_info calc_grad_ptf_0_16_para;
  calc_grad_ptf_0_16_para.lz = 34 - 32;
  calc_grad_ptf_0_16_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_grad_ptf_0_16_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_0_16_para.oz = 32;
  calc_grad_ptf_0_16_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_ptf_0_16_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_0_16_para.hx = 2;
  calc_grad_ptf_0_16_para.hy = 0;
  calc_grad_ptf_0_16_para.hz = 2;
  calc_grad_ptf_0_16_para.bx = 256;
  calc_grad_ptf_0_16_para.by = 1;
  calc_grad_ptf_0_16_para.bz = 4;
  calc_grad_ptf_0_16_para.mx = 1;
  calc_grad_ptf_0_16_para.my = 8;
  calc_grad_ptf_0_16_para.mz = 8;
  calc_grad_ptf_0_16_para.star_statept = &star_state->pt[Proc.lev_hw - 2+calc_grad_ptf_0_16_para.oz][Proc.lat_hw -0+calc_grad_ptf_0_16_para.oy][Proc.lon_hw -2+calc_grad_ptf_0_16_para.ox];
  
  athread_spawn(calc_grad_ptf_0_16, &calc_grad_ptf_0_16_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        buf = ppm(star_state->pt[(k - 2)][j][i],star_state->pt[(k - 1)][j][i],star_state->pt[k][j][i],star_state->pt[(k + 1)][j][i],star_state->pt[(k + 2)][j][i]);
        advpt->qlx[k][j][i] = buf.x;
        advpt->dqx[k][j][i] = buf.y;
        advpt->q6x[k][j][i] = buf.z;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=1+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        ci = (int)(advpt->cflz[k][j][i]);
        cf = (advpt->cflz[k][j][i] - ci);
        if ((advpt->cflz[k][j][i] > 0))
        {
          s1 = (1.0 - cf);
          s2 = 1.0;
          ds1 = (s2 - s1);
          ds2 = (pow(s2,2) - pow(s1,2));
          ds3 = (pow(s2,3) - pow(s1,3));
          cursum = 0.0;
          for (l=(k - ci);l<((k - 1) + 1);l+=1){
            cursum = (cursum + star_state->pt[l][j][i]);
          }
          star_state->ptf_lev[k][j][i] = ((advpt->we[k][j][i] * (((cursum + (advpt->qlx[((k - ci) - 1)][j][i] * ds1)) + ((0.5 * advpt->dqx[((k - ci) - 1)][j][i]) * ds2)) + (advpt->q6x[((k - ci) - 1)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / advpt->cflz[k][j][i]);
        }
        else
        {
          if ((advpt->cflz[k][j][i] < 0))
          {
            s1 = 0.0;
            s2 = -cf;
            ds1 = (s2 - s1);
            ds2 = (pow(s2,2) - pow(s1,2));
            ds3 = (pow(s2,3) - pow(s1,3));
            for (l=k;l<(((k - ci) - 1) + 1);l+=1){
              cursum = (cursum + star_state->pt[l][j][i]);
            }
            star_state->ptf_lev[k][j][i] = ((-advpt->we[k][j][i] * (((cursum + (advpt->qlx[(k - ci)][j][i] * ds1)) + ((0.5 * advpt->dqx[(k - ci)][j][i]) * ds2)) + (advpt->q6x[(k - ci)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / advpt->cflz[k][j][i]);
          }
          else
          {
            star_state->ptf_lev[k][j][i] = 0.0;
          }
        }
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmptf_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_0_17_info calc_grad_ptf_0_17_para;
  calc_grad_ptf_0_17_para.lz = 32 - 0;
  calc_grad_ptf_0_17_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_grad_ptf_0_17_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_0_17_para.oz = 0;
  calc_grad_ptf_0_17_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_ptf_0_17_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_0_17_para.hx = 0;
  calc_grad_ptf_0_17_para.hy = 0;
  calc_grad_ptf_0_17_para.hz = 1;
  calc_grad_ptf_0_17_para.bx = 256;
  calc_grad_ptf_0_17_para.by = 1;
  calc_grad_ptf_0_17_para.bz = 4;
  calc_grad_ptf_0_17_para.mx = 1;
  calc_grad_ptf_0_17_para.my = 8;
  calc_grad_ptf_0_17_para.mz = 8;
  calc_grad_ptf_0_17_para.star_stateptf_lev = &star_state->ptf_lev[Proc.lev_hw - 1+calc_grad_ptf_0_17_para.oz][Proc.lat_hw -0+calc_grad_ptf_0_17_para.oy][Proc.lon_hw -0+calc_grad_ptf_0_17_para.ox];
  calc_grad_ptf_0_17_para.tend1dptfdlev = &tend1->dptfdlev[Proc.lev_hw - 1+calc_grad_ptf_0_17_para.oz][Proc.lat_hw -0+calc_grad_ptf_0_17_para.oy][Proc.lon_hw -0+calc_grad_ptf_0_17_para.ox];
  
  athread_spawn(calc_grad_ptf_0_17, &calc_grad_ptf_0_17_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfdptfdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_coriolis_0_4_info calc_coriolis_0_4_para;
  calc_coriolis_0_4_para.lz = 32 - 0;
  calc_coriolis_0_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_coriolis_0_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_coriolis_0_4_para.oz = 0;
  calc_coriolis_0_4_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_coriolis_0_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_coriolis_0_4_para.hx = 1;
  calc_coriolis_0_4_para.hy = 1;
  calc_coriolis_0_4_para.hz = 0;
  calc_coriolis_0_4_para.bx = 256;
  calc_coriolis_0_4_para.by = 8;
  calc_coriolis_0_4_para.bz = 1;
  calc_coriolis_0_4_para.mx = 1;
  calc_coriolis_0_4_para.my = 2;
  calc_coriolis_0_4_para.mz = 32;
  calc_coriolis_0_4_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_coriolis_0_4_para.oz][Proc.lat_hw -1+calc_coriolis_0_4_para.oy][Proc.lon_hw -1+calc_coriolis_0_4_para.ox];
  calc_coriolis_0_4_para.star_statepv_lat = &star_state->pv_lat[Proc.lev_hw - 0+calc_coriolis_0_4_para.oz][Proc.lat_hw -1+calc_coriolis_0_4_para.oy][Proc.lon_hw -1+calc_coriolis_0_4_para.ox];
  calc_coriolis_0_4_para.star_statepv_lon = &star_state->pv_lon[Proc.lev_hw - 0+calc_coriolis_0_4_para.oz][Proc.lat_hw -1+calc_coriolis_0_4_para.oy][Proc.lon_hw -1+calc_coriolis_0_4_para.ox];
  calc_coriolis_0_4_para.tend1qhu = &tend1->qhu[Proc.lev_hw - 0+calc_coriolis_0_4_para.oz][Proc.lat_hw -1+calc_coriolis_0_4_para.oy][Proc.lon_hw -1+calc_coriolis_0_4_para.ox];
  calc_coriolis_0_4_para.half_tangent_wgt_0 = &mesh->half_tangent_wgt_0[0][0][0];
  calc_coriolis_0_4_para.half_tangent_wgt_1 = &mesh->half_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_coriolis_0_4, &calc_coriolis_0_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_coriolisqhuTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_coriolis_0_5_info calc_coriolis_0_5_para;
  calc_coriolis_0_5_para.lz = 32 - 0;
  calc_coriolis_0_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_coriolis_0_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_coriolis_0_5_para.oz = 0;
  calc_coriolis_0_5_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_coriolis_0_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_coriolis_0_5_para.hx = 1;
  calc_coriolis_0_5_para.hy = 1;
  calc_coriolis_0_5_para.hz = 0;
  calc_coriolis_0_5_para.bx = 256;
  calc_coriolis_0_5_para.by = 8;
  calc_coriolis_0_5_para.bz = 1;
  calc_coriolis_0_5_para.mx = 1;
  calc_coriolis_0_5_para.my = 2;
  calc_coriolis_0_5_para.mz = 32;
  calc_coriolis_0_5_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_coriolis_0_5_para.oz][Proc.lat_hw -1+calc_coriolis_0_5_para.oy][Proc.lon_hw -1+calc_coriolis_0_5_para.ox];
  calc_coriolis_0_5_para.star_statepv_lon = &star_state->pv_lon[Proc.lev_hw - 0+calc_coriolis_0_5_para.oz][Proc.lat_hw -1+calc_coriolis_0_5_para.oy][Proc.lon_hw -1+calc_coriolis_0_5_para.ox];
  calc_coriolis_0_5_para.star_statepv_lat = &star_state->pv_lat[Proc.lev_hw - 0+calc_coriolis_0_5_para.oz][Proc.lat_hw -1+calc_coriolis_0_5_para.oy][Proc.lon_hw -1+calc_coriolis_0_5_para.ox];
  calc_coriolis_0_5_para.tend1qhv = &tend1->qhv[Proc.lev_hw - 0+calc_coriolis_0_5_para.oz][Proc.lat_hw -1+calc_coriolis_0_5_para.oy][Proc.lon_hw -1+calc_coriolis_0_5_para.ox];
  calc_coriolis_0_5_para.full_tangent_wgt_0 = &mesh->full_tangent_wgt_0[0][0][0];
  calc_coriolis_0_5_para.full_tangent_wgt_1 = &mesh->full_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_coriolis_0_5, &calc_coriolis_0_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_coriolisqhvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ke_0_4_info calc_grad_ke_0_4_para;
  calc_grad_ke_0_4_para.lz = 32 - 0;
  calc_grad_ke_0_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_ke_0_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ke_0_4_para.oz = 0;
  calc_grad_ke_0_4_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_ke_0_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ke_0_4_para.hx = 1;
  calc_grad_ke_0_4_para.hy = 1;
  calc_grad_ke_0_4_para.hz = 0;
  calc_grad_ke_0_4_para.bx = 256;
  calc_grad_ke_0_4_para.by = 8;
  calc_grad_ke_0_4_para.bz = 1;
  calc_grad_ke_0_4_para.mx = 1;
  calc_grad_ke_0_4_para.my = 2;
  calc_grad_ke_0_4_para.mz = 32;
  calc_grad_ke_0_4_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_grad_ke_0_4_para.oz][Proc.lat_hw -1+calc_grad_ke_0_4_para.oy][Proc.lon_hw -1+calc_grad_ke_0_4_para.ox];
  calc_grad_ke_0_4_para.tend1dkedlon = &tend1->dkedlon[Proc.lev_hw - 0+calc_grad_ke_0_4_para.oz][Proc.lat_hw -1+calc_grad_ke_0_4_para.oy][Proc.lon_hw -1+calc_grad_ke_0_4_para.ox];
  calc_grad_ke_0_4_para.de_lon = &mesh->de_lon[0][0][0];
  
  athread_spawn(calc_grad_ke_0_4, &calc_grad_ke_0_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_kedkedlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ke_0_5_info calc_grad_ke_0_5_para;
  calc_grad_ke_0_5_para.lz = 32 - 0;
  calc_grad_ke_0_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_grad_ke_0_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ke_0_5_para.oz = 0;
  calc_grad_ke_0_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_ke_0_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ke_0_5_para.hx = 1;
  calc_grad_ke_0_5_para.hy = 1;
  calc_grad_ke_0_5_para.hz = 0;
  calc_grad_ke_0_5_para.bx = 256;
  calc_grad_ke_0_5_para.by = 8;
  calc_grad_ke_0_5_para.bz = 1;
  calc_grad_ke_0_5_para.mx = 1;
  calc_grad_ke_0_5_para.my = 2;
  calc_grad_ke_0_5_para.mz = 32;
  calc_grad_ke_0_5_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_grad_ke_0_5_para.oz][Proc.lat_hw -1+calc_grad_ke_0_5_para.oy][Proc.lon_hw -1+calc_grad_ke_0_5_para.ox];
  calc_grad_ke_0_5_para.tend1dkedlat = &tend1->dkedlat[Proc.lev_hw - 0+calc_grad_ke_0_5_para.oz][Proc.lat_hw -1+calc_grad_ke_0_5_para.oy][Proc.lon_hw -1+calc_grad_ke_0_5_para.ox];
  calc_grad_ke_0_5_para.de_lat = &mesh->de_lat[0][0][0];
  
  athread_spawn(calc_grad_ke_0_5, &calc_grad_ke_0_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_kedkedlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  tendPara = tendPara;
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_forward_0_6_info calc_tend_forward_0_6_para;
  calc_tend_forward_0_6_para.lz = 32 - 0;
  calc_tend_forward_0_6_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_tend_forward_0_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_forward_0_6_para.oz = 0;
  calc_tend_forward_0_6_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_tend_forward_0_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_forward_0_6_para.hx = 1;
  calc_tend_forward_0_6_para.hy = 1;
  calc_tend_forward_0_6_para.hz = 0;
  calc_tend_forward_0_6_para.bx = 256;
  calc_tend_forward_0_6_para.by = 8;
  calc_tend_forward_0_6_para.bz = 1;
  calc_tend_forward_0_6_para.mx = 1;
  calc_tend_forward_0_6_para.my = 2;
  calc_tend_forward_0_6_para.mz = 32;
  calc_tend_forward_0_6_para.tend1qhv = &tend1->qhv[Proc.lev_hw - 0+calc_tend_forward_0_6_para.oz][Proc.lat_hw -1+calc_tend_forward_0_6_para.oy][Proc.lon_hw -1+calc_tend_forward_0_6_para.ox];
  calc_tend_forward_0_6_para.tend1dkedlon = &tend1->dkedlon[Proc.lev_hw - 0+calc_tend_forward_0_6_para.oz][Proc.lat_hw -1+calc_tend_forward_0_6_para.oy][Proc.lon_hw -1+calc_tend_forward_0_6_para.ox];
  calc_tend_forward_0_6_para.tend1wedudlev = &tend1->wedudlev[Proc.lev_hw - 0+calc_tend_forward_0_6_para.oz][Proc.lat_hw -1+calc_tend_forward_0_6_para.oy][Proc.lon_hw -1+calc_tend_forward_0_6_para.ox];
  calc_tend_forward_0_6_para.tend1du = &tend1->du[Proc.lev_hw - 0+calc_tend_forward_0_6_para.oz][Proc.lat_hw -1+calc_tend_forward_0_6_para.oy][Proc.lon_hw -1+calc_tend_forward_0_6_para.ox];
  
  athread_spawn(calc_tend_forward_0_6, &calc_tend_forward_0_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_forwardduTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend1->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_forward_0_7_info calc_tend_forward_0_7_para;
  calc_tend_forward_0_7_para.lz = 32 - 0;
  calc_tend_forward_0_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_tend_forward_0_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_forward_0_7_para.oz = 0;
  calc_tend_forward_0_7_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_tend_forward_0_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_forward_0_7_para.hx = 1;
  calc_tend_forward_0_7_para.hy = 1;
  calc_tend_forward_0_7_para.hz = 0;
  calc_tend_forward_0_7_para.bx = 256;
  calc_tend_forward_0_7_para.by = 8;
  calc_tend_forward_0_7_para.bz = 1;
  calc_tend_forward_0_7_para.mx = 1;
  calc_tend_forward_0_7_para.my = 2;
  calc_tend_forward_0_7_para.mz = 32;
  calc_tend_forward_0_7_para.tend1qhu = &tend1->qhu[Proc.lev_hw - 0+calc_tend_forward_0_7_para.oz][Proc.lat_hw -1+calc_tend_forward_0_7_para.oy][Proc.lon_hw -1+calc_tend_forward_0_7_para.ox];
  calc_tend_forward_0_7_para.tend1dkedlat = &tend1->dkedlat[Proc.lev_hw - 0+calc_tend_forward_0_7_para.oz][Proc.lat_hw -1+calc_tend_forward_0_7_para.oy][Proc.lon_hw -1+calc_tend_forward_0_7_para.ox];
  calc_tend_forward_0_7_para.tend1wedvdlev = &tend1->wedvdlev[Proc.lev_hw - 0+calc_tend_forward_0_7_para.oz][Proc.lat_hw -1+calc_tend_forward_0_7_para.oy][Proc.lon_hw -1+calc_tend_forward_0_7_para.ox];
  calc_tend_forward_0_7_para.tend1dv = &tend1->dv[Proc.lev_hw - 0+calc_tend_forward_0_7_para.oz][Proc.lat_hw -1+calc_tend_forward_0_7_para.oy][Proc.lon_hw -1+calc_tend_forward_0_7_para.ox];
  
  athread_spawn(calc_tend_forward_0_7, &calc_tend_forward_0_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_forwarddvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend1->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_forward_0_8_info calc_tend_forward_0_8_para;
  calc_tend_forward_0_8_para.lz = 32 - 0;
  calc_tend_forward_0_8_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_tend_forward_0_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_forward_0_8_para.oz = 0;
  calc_tend_forward_0_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_tend_forward_0_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_forward_0_8_para.hx = 1;
  calc_tend_forward_0_8_para.hy = 1;
  calc_tend_forward_0_8_para.hz = 0;
  calc_tend_forward_0_8_para.bx = 256;
  calc_tend_forward_0_8_para.by = 8;
  calc_tend_forward_0_8_para.bz = 1;
  calc_tend_forward_0_8_para.mx = 1;
  calc_tend_forward_0_8_para.my = 2;
  calc_tend_forward_0_8_para.mz = 32;
  calc_tend_forward_0_8_para.tend1dptfdlon = &tend1->dptfdlon[Proc.lev_hw - 0+calc_tend_forward_0_8_para.oz][Proc.lat_hw -1+calc_tend_forward_0_8_para.oy][Proc.lon_hw -1+calc_tend_forward_0_8_para.ox];
  calc_tend_forward_0_8_para.tend1dptfdlat = &tend1->dptfdlat[Proc.lev_hw - 0+calc_tend_forward_0_8_para.oz][Proc.lat_hw -1+calc_tend_forward_0_8_para.oy][Proc.lon_hw -1+calc_tend_forward_0_8_para.ox];
  calc_tend_forward_0_8_para.tend1dptfdlev = &tend1->dptfdlev[Proc.lev_hw - 0+calc_tend_forward_0_8_para.oz][Proc.lat_hw -1+calc_tend_forward_0_8_para.oy][Proc.lon_hw -1+calc_tend_forward_0_8_para.ox];
  calc_tend_forward_0_8_para.tend1dpt = &tend1->dpt[Proc.lev_hw - 0+calc_tend_forward_0_8_para.oz][Proc.lat_hw -1+calc_tend_forward_0_8_para.oy][Proc.lon_hw -1+calc_tend_forward_0_8_para.ox];
  
  athread_spawn(calc_tend_forward_0_8, &calc_tend_forward_0_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_forwarddptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend1->dpt[0][0][0], &Proc.FieldReq[async_dpt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  (tendPara->phs) = 1;
  (tendPara->pt) = 1;
  tendPara = tendPara;
  dt = dt;
  if ((tendPara->phs))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,0,&tend1->dphs[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &tend1->dphs[0][0][0], &Proc.FieldReq[async_dphs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        new_state->phs[0][j][i] = (old_state->phs[0][j][i] + (dt * tend1->dphs[0][j][i]));
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statephsTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &new_state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_0_15_info calc_ph_0_15_para;
    calc_ph_0_15_para.lz = 33 - 0;
    calc_ph_0_15_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_0_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_0_15_para.oz = 0;
    calc_ph_0_15_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_0_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_0_15_para.hx = 1;
    calc_ph_0_15_para.hy = 1;
    calc_ph_0_15_para.hz = 0;
    calc_ph_0_15_para.bx = 256;
    calc_ph_0_15_para.by = 8;
    calc_ph_0_15_para.bz = 1;
    calc_ph_0_15_para.mx = 1;
    calc_ph_0_15_para.my = 2;
    calc_ph_0_15_para.mz = 32;
    calc_ph_0_15_para.new_statephs = &new_state->phs[0][Proc.lat_hw -1+calc_ph_0_15_para.oy][Proc.lon_hw -1+calc_ph_0_15_para.ox];
    calc_ph_0_15_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_0_15_para.oz][Proc.lat_hw -1+calc_ph_0_15_para.oy][Proc.lon_hw -1+calc_ph_0_15_para.ox];
    calc_ph_0_15_para.hyai = &mesh->hyai[0][0][0];
    calc_ph_0_15_para.hybi = &mesh->hybi[0][0][0];
    
    athread_spawn(calc_ph_0_15, &calc_ph_0_15_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_0_16_info calc_ph_0_16_para;
    calc_ph_0_16_para.lz = 33 - 0;
    calc_ph_0_16_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_0_16_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_0_16_para.oz = 0;
    calc_ph_0_16_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_0_16_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_0_16_para.hx = 1;
    calc_ph_0_16_para.hy = 1;
    calc_ph_0_16_para.hz = 0;
    calc_ph_0_16_para.bx = 256;
    calc_ph_0_16_para.by = 8;
    calc_ph_0_16_para.bz = 1;
    calc_ph_0_16_para.mx = 1;
    calc_ph_0_16_para.my = 2;
    calc_ph_0_16_para.mz = 32;
    calc_ph_0_16_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_0_16_para.oz][Proc.lat_hw -1+calc_ph_0_16_para.oy][Proc.lon_hw -1+calc_ph_0_16_para.ox];
    calc_ph_0_16_para.new_stateph_exn_lev = &new_state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_0_16_para.oz][Proc.lat_hw -1+calc_ph_0_16_para.oy][Proc.lon_hw -1+calc_ph_0_16_para.ox];
    
    athread_spawn(calc_ph_0_16, &calc_ph_0_16_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_exn_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_0_17_info calc_ph_0_17_para;
    calc_ph_0_17_para.lz = 32 - 0;
    calc_ph_0_17_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_0_17_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_0_17_para.oz = 0;
    calc_ph_0_17_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_0_17_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_0_17_para.hx = 0;
    calc_ph_0_17_para.hy = 0;
    calc_ph_0_17_para.hz = 1;
    calc_ph_0_17_para.bx = 256;
    calc_ph_0_17_para.by = 1;
    calc_ph_0_17_para.bz = 4;
    calc_ph_0_17_para.mx = 1;
    calc_ph_0_17_para.my = 8;
    calc_ph_0_17_para.mz = 8;
    calc_ph_0_17_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_ph_0_17_para.oz][Proc.lat_hw -0+calc_ph_0_17_para.oy][Proc.lon_hw -0+calc_ph_0_17_para.ox];
    calc_ph_0_17_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_ph_0_17_para.oz][Proc.lat_hw -0+calc_ph_0_17_para.oy][Proc.lon_hw -0+calc_ph_0_17_para.ox];
    
    athread_spawn(calc_ph_0_17, &calc_ph_0_17_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phphTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_36_info calc_m_0_36_para;
    calc_m_0_36_para.lz = 32 - 0;
    calc_m_0_36_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_36_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_36_para.oz = 0;
    calc_m_0_36_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_36_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_36_para.hx = 1;
    calc_m_0_36_para.hy = 0;
    calc_m_0_36_para.hz = 1;
    calc_m_0_36_para.bx = 256;
    calc_m_0_36_para.by = 1;
    calc_m_0_36_para.bz = 4;
    calc_m_0_36_para.mx = 1;
    calc_m_0_36_para.my = 8;
    calc_m_0_36_para.mz = 8;
    calc_m_0_36_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_0_36_para.oz][Proc.lat_hw -0+calc_m_0_36_para.oy][Proc.lon_hw -1+calc_m_0_36_para.ox];
    calc_m_0_36_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_0_36_para.oz][Proc.lat_hw -0+calc_m_0_36_para.oy][Proc.lon_hw -1+calc_m_0_36_para.ox];
    
    athread_spawn(calc_m_0_36, &calc_m_0_36_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_37_info calc_m_0_37_para;
    calc_m_0_37_para.lz = 32 - 1;
    calc_m_0_37_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_37_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_37_para.oz = 1;
    calc_m_0_37_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_37_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_37_para.hx = 0;
    calc_m_0_37_para.hy = 0;
    calc_m_0_37_para.hz = 1;
    calc_m_0_37_para.bx = 256;
    calc_m_0_37_para.by = 1;
    calc_m_0_37_para.bz = 4;
    calc_m_0_37_para.mx = 1;
    calc_m_0_37_para.my = 8;
    calc_m_0_37_para.mz = 8;
    calc_m_0_37_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_0_37_para.oz][Proc.lat_hw -0+calc_m_0_37_para.oy][Proc.lon_hw -0+calc_m_0_37_para.ox];
    calc_m_0_37_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_0_37_para.oz][Proc.lat_hw -0+calc_m_0_37_para.oy][Proc.lon_hw -0+calc_m_0_37_para.ox];
    
    athread_spawn(calc_m_0_37, &calc_m_0_37_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_38_info calc_m_0_38_para;
    calc_m_0_38_para.lz = 1 - 0;
    calc_m_0_38_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_38_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_38_para.oz = 0;
    calc_m_0_38_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_38_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_38_para.hx = 0;
    calc_m_0_38_para.hy = 0;
    calc_m_0_38_para.hz = 0;
    calc_m_0_38_para.bx = 256;
    calc_m_0_38_para.by = 8;
    calc_m_0_38_para.bz = 1;
    calc_m_0_38_para.mx = 1;
    calc_m_0_38_para.my = 2;
    calc_m_0_38_para.mz = 32;
    calc_m_0_38_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_0_38_para.oz][Proc.lat_hw -0+calc_m_0_38_para.oy][Proc.lon_hw -0+calc_m_0_38_para.ox];
    calc_m_0_38_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_0_38_para.oz][Proc.lat_hw -0+calc_m_0_38_para.oy][Proc.lon_hw -0+calc_m_0_38_para.ox];
    calc_m_0_38_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_0_38_para.oz][Proc.lat_hw -0+calc_m_0_38_para.oy][Proc.lon_hw -0+calc_m_0_38_para.ox];
    
    athread_spawn(calc_m_0_38, &calc_m_0_38_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_39_info calc_m_0_39_para;
    calc_m_0_39_para.lz = 33 - 32;
    calc_m_0_39_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_39_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_39_para.oz = 32;
    calc_m_0_39_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_39_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_39_para.hx = 0;
    calc_m_0_39_para.hy = 0;
    calc_m_0_39_para.hz = 1;
    calc_m_0_39_para.bx = 256;
    calc_m_0_39_para.by = 1;
    calc_m_0_39_para.bz = 4;
    calc_m_0_39_para.mx = 1;
    calc_m_0_39_para.my = 8;
    calc_m_0_39_para.mz = 8;
    calc_m_0_39_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_0_39_para.oz][Proc.lat_hw -0+calc_m_0_39_para.oy][Proc.lon_hw -0+calc_m_0_39_para.ox];
    calc_m_0_39_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_0_39_para.oz][Proc.lat_hw -0+calc_m_0_39_para.oy][Proc.lon_hw -0+calc_m_0_39_para.ox];
    calc_m_0_39_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_0_39_para.oz][Proc.lat_hw -0+calc_m_0_39_para.oy][Proc.lon_hw -0+calc_m_0_39_para.ox];
    
    athread_spawn(calc_m_0_39, &calc_m_0_39_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_0_9_info averageCellToLonEdge_0_9_para;
    averageCellToLonEdge_0_9_para.lz = 32 - 0;
    averageCellToLonEdge_0_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_0_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_0_9_para.oz = 0;
    averageCellToLonEdge_0_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_0_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_0_9_para.hx = 1;
    averageCellToLonEdge_0_9_para.hy = 1;
    averageCellToLonEdge_0_9_para.hz = 0;
    averageCellToLonEdge_0_9_para.bx = 256;
    averageCellToLonEdge_0_9_para.by = 8;
    averageCellToLonEdge_0_9_para.bz = 1;
    averageCellToLonEdge_0_9_para.mx = 1;
    averageCellToLonEdge_0_9_para.my = 2;
    averageCellToLonEdge_0_9_para.mz = 32;
    averageCellToLonEdge_0_9_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_0_9_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_9_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_9_para.ox];
    averageCellToLonEdge_0_9_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_0_9_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_9_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_9_para.ox];
    
    athread_spawn(averageCellToLonEdge_0_9, &averageCellToLonEdge_0_9_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_0_9_info averageCellToLatEdge_0_9_para;
    averageCellToLatEdge_0_9_para.lz = 32 - 0;
    averageCellToLatEdge_0_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_0_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_0_9_para.oz = 0;
    averageCellToLatEdge_0_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_0_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_0_9_para.hx = 1;
    averageCellToLatEdge_0_9_para.hy = 1;
    averageCellToLatEdge_0_9_para.hz = 0;
    averageCellToLatEdge_0_9_para.bx = 256;
    averageCellToLatEdge_0_9_para.by = 8;
    averageCellToLatEdge_0_9_para.bz = 1;
    averageCellToLatEdge_0_9_para.mx = 1;
    averageCellToLatEdge_0_9_para.my = 2;
    averageCellToLatEdge_0_9_para.mz = 32;
    averageCellToLatEdge_0_9_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_0_9_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_9_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_9_para.ox];
    averageCellToLatEdge_0_9_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_0_9_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_9_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_9_para.ox];
    
    athread_spawn(averageCellToLatEdge_0_9, &averageCellToLatEdge_0_9_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_0_9_info interpCellToVtx_0_9_para;
    interpCellToVtx_0_9_para.lz = 32 - 0;
    interpCellToVtx_0_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_0_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_0_9_para.oz = 0;
    interpCellToVtx_0_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_0_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_0_9_para.hx = 1;
    interpCellToVtx_0_9_para.hy = 1;
    interpCellToVtx_0_9_para.hz = 0;
    interpCellToVtx_0_9_para.bx = 256;
    interpCellToVtx_0_9_para.by = 8;
    interpCellToVtx_0_9_para.bz = 1;
    interpCellToVtx_0_9_para.mx = 1;
    interpCellToVtx_0_9_para.my = 2;
    interpCellToVtx_0_9_para.mz = 32;
    interpCellToVtx_0_9_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_0_9_para.oz][Proc.lat_hw -1+interpCellToVtx_0_9_para.oy][Proc.lon_hw -1+interpCellToVtx_0_9_para.ox];
    interpCellToVtx_0_9_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_0_9_para.oz][Proc.lat_hw -1+interpCellToVtx_0_9_para.oy][Proc.lon_hw -1+interpCellToVtx_0_9_para.ox];
    interpCellToVtx_0_9_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_0_9_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_0_9_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_0_9, &interpCellToVtx_0_9_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->pt))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,1,&tend1->dpt[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend1->dpt[0][0][0], &Proc.FieldReq[async_dpt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_pt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_0_16_info update_state_0_16_para;
    update_state_0_16_para.lz = 32 - 0;
    update_state_0_16_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_0_16_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_0_16_para.oz = 0;
    update_state_0_16_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_0_16_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_0_16_para.hx = 2;
    update_state_0_16_para.hy = 2;
    update_state_0_16_para.hz = 0;
    update_state_0_16_para.bx = 256;
    update_state_0_16_para.by = 8;
    update_state_0_16_para.bz = 1;
    update_state_0_16_para.mx = 1;
    update_state_0_16_para.my = 2;
    update_state_0_16_para.mz = 32;
    update_state_0_16_para.old_statept = &old_state->pt[Proc.lev_hw - 0+update_state_0_16_para.oz][Proc.lat_hw -2+update_state_0_16_para.oy][Proc.lon_hw -2+update_state_0_16_para.ox];
    update_state_0_16_para.old_statem = &old_state->m[Proc.lev_hw - 0+update_state_0_16_para.oz][Proc.lat_hw -2+update_state_0_16_para.oy][Proc.lon_hw -2+update_state_0_16_para.ox];
    update_state_0_16_para.tend1dpt = &tend1->dpt[Proc.lev_hw - 0+update_state_0_16_para.oz][Proc.lat_hw -2+update_state_0_16_para.oy][Proc.lon_hw -2+update_state_0_16_para.ox];
    update_state_0_16_para.new_statem = &new_state->m[Proc.lev_hw - 0+update_state_0_16_para.oz][Proc.lat_hw -2+update_state_0_16_para.oy][Proc.lon_hw -2+update_state_0_16_para.ox];
    update_state_0_16_para.new_statept = &new_state->pt[Proc.lev_hw - 0+update_state_0_16_para.oz][Proc.lat_hw -2+update_state_0_16_para.oy][Proc.lon_hw -2+update_state_0_16_para.ox];
    update_state_0_16_para.dt = dt;
    
    athread_spawn(update_state_0_16, &update_state_0_16_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateptTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->gz))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_0_17_info update_state_0_17_para;
    update_state_0_17_para.lz = 32 - 0;
    update_state_0_17_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_0_17_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_0_17_para.oz = 0;
    update_state_0_17_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_0_17_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_0_17_para.hx = 0;
    update_state_0_17_para.hy = 0;
    update_state_0_17_para.hz = 0;
    update_state_0_17_para.bx = 256;
    update_state_0_17_para.by = 8;
    update_state_0_17_para.bz = 1;
    update_state_0_17_para.mx = 1;
    update_state_0_17_para.my = 2;
    update_state_0_17_para.mz = 32;
    update_state_0_17_para.old_stategz = &old_state->gz[Proc.lev_hw - 0+update_state_0_17_para.oz][Proc.lat_hw -0+update_state_0_17_para.oy][Proc.lon_hw -0+update_state_0_17_para.ox];
    update_state_0_17_para.tend1dgz = &tend1->dgz[Proc.lev_hw - 0+update_state_0_17_para.oz][Proc.lat_hw -0+update_state_0_17_para.oy][Proc.lon_hw -0+update_state_0_17_para.ox];
    update_state_0_17_para.new_stategz = &new_state->gz[Proc.lev_hw - 0+update_state_0_17_para.oz][Proc.lat_hw -0+update_state_0_17_para.oy][Proc.lon_hw -0+update_state_0_17_para.ox];
    update_state_0_17_para.dt = dt;
    
    athread_spawn(update_state_0_17, &update_state_0_17_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stategzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_40_info calc_m_0_40_para;
    calc_m_0_40_para.lz = 32 - 0;
    calc_m_0_40_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_40_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_40_para.oz = 0;
    calc_m_0_40_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_40_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_40_para.hx = 1;
    calc_m_0_40_para.hy = 0;
    calc_m_0_40_para.hz = 1;
    calc_m_0_40_para.bx = 256;
    calc_m_0_40_para.by = 1;
    calc_m_0_40_para.bz = 4;
    calc_m_0_40_para.mx = 1;
    calc_m_0_40_para.my = 8;
    calc_m_0_40_para.mz = 8;
    calc_m_0_40_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_0_40_para.oz][Proc.lat_hw -0+calc_m_0_40_para.oy][Proc.lon_hw -1+calc_m_0_40_para.ox];
    calc_m_0_40_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_0_40_para.oz][Proc.lat_hw -0+calc_m_0_40_para.oy][Proc.lon_hw -1+calc_m_0_40_para.ox];
    
    athread_spawn(calc_m_0_40, &calc_m_0_40_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_41_info calc_m_0_41_para;
    calc_m_0_41_para.lz = 32 - 1;
    calc_m_0_41_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_41_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_41_para.oz = 1;
    calc_m_0_41_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_41_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_41_para.hx = 0;
    calc_m_0_41_para.hy = 0;
    calc_m_0_41_para.hz = 1;
    calc_m_0_41_para.bx = 256;
    calc_m_0_41_para.by = 1;
    calc_m_0_41_para.bz = 4;
    calc_m_0_41_para.mx = 1;
    calc_m_0_41_para.my = 8;
    calc_m_0_41_para.mz = 8;
    calc_m_0_41_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_0_41_para.oz][Proc.lat_hw -0+calc_m_0_41_para.oy][Proc.lon_hw -0+calc_m_0_41_para.ox];
    calc_m_0_41_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_0_41_para.oz][Proc.lat_hw -0+calc_m_0_41_para.oy][Proc.lon_hw -0+calc_m_0_41_para.ox];
    
    athread_spawn(calc_m_0_41, &calc_m_0_41_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_42_info calc_m_0_42_para;
    calc_m_0_42_para.lz = 1 - 0;
    calc_m_0_42_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_42_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_42_para.oz = 0;
    calc_m_0_42_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_42_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_42_para.hx = 0;
    calc_m_0_42_para.hy = 0;
    calc_m_0_42_para.hz = 0;
    calc_m_0_42_para.bx = 256;
    calc_m_0_42_para.by = 8;
    calc_m_0_42_para.bz = 1;
    calc_m_0_42_para.mx = 1;
    calc_m_0_42_para.my = 2;
    calc_m_0_42_para.mz = 32;
    calc_m_0_42_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_0_42_para.oz][Proc.lat_hw -0+calc_m_0_42_para.oy][Proc.lon_hw -0+calc_m_0_42_para.ox];
    calc_m_0_42_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_0_42_para.oz][Proc.lat_hw -0+calc_m_0_42_para.oy][Proc.lon_hw -0+calc_m_0_42_para.ox];
    calc_m_0_42_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_0_42_para.oz][Proc.lat_hw -0+calc_m_0_42_para.oy][Proc.lon_hw -0+calc_m_0_42_para.ox];
    
    athread_spawn(calc_m_0_42, &calc_m_0_42_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_43_info calc_m_0_43_para;
    calc_m_0_43_para.lz = 33 - 32;
    calc_m_0_43_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_43_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_43_para.oz = 32;
    calc_m_0_43_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_43_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_43_para.hx = 0;
    calc_m_0_43_para.hy = 0;
    calc_m_0_43_para.hz = 1;
    calc_m_0_43_para.bx = 256;
    calc_m_0_43_para.by = 1;
    calc_m_0_43_para.bz = 4;
    calc_m_0_43_para.mx = 1;
    calc_m_0_43_para.my = 8;
    calc_m_0_43_para.mz = 8;
    calc_m_0_43_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_0_43_para.oz][Proc.lat_hw -0+calc_m_0_43_para.oy][Proc.lon_hw -0+calc_m_0_43_para.ox];
    calc_m_0_43_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_0_43_para.oz][Proc.lat_hw -0+calc_m_0_43_para.oy][Proc.lon_hw -0+calc_m_0_43_para.ox];
    calc_m_0_43_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_0_43_para.oz][Proc.lat_hw -0+calc_m_0_43_para.oy][Proc.lon_hw -0+calc_m_0_43_para.ox];
    
    athread_spawn(calc_m_0_43, &calc_m_0_43_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_0_10_info averageCellToLonEdge_0_10_para;
    averageCellToLonEdge_0_10_para.lz = 32 - 0;
    averageCellToLonEdge_0_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_0_10_para.oz = 0;
    averageCellToLonEdge_0_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_0_10_para.hx = 1;
    averageCellToLonEdge_0_10_para.hy = 1;
    averageCellToLonEdge_0_10_para.hz = 0;
    averageCellToLonEdge_0_10_para.bx = 256;
    averageCellToLonEdge_0_10_para.by = 8;
    averageCellToLonEdge_0_10_para.bz = 1;
    averageCellToLonEdge_0_10_para.mx = 1;
    averageCellToLonEdge_0_10_para.my = 2;
    averageCellToLonEdge_0_10_para.mz = 32;
    averageCellToLonEdge_0_10_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_0_10_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_10_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_10_para.ox];
    averageCellToLonEdge_0_10_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_0_10_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_10_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_10_para.ox];
    
    athread_spawn(averageCellToLonEdge_0_10, &averageCellToLonEdge_0_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_0_10_info averageCellToLatEdge_0_10_para;
    averageCellToLatEdge_0_10_para.lz = 32 - 0;
    averageCellToLatEdge_0_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_0_10_para.oz = 0;
    averageCellToLatEdge_0_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_0_10_para.hx = 1;
    averageCellToLatEdge_0_10_para.hy = 1;
    averageCellToLatEdge_0_10_para.hz = 0;
    averageCellToLatEdge_0_10_para.bx = 256;
    averageCellToLatEdge_0_10_para.by = 8;
    averageCellToLatEdge_0_10_para.bz = 1;
    averageCellToLatEdge_0_10_para.mx = 1;
    averageCellToLatEdge_0_10_para.my = 2;
    averageCellToLatEdge_0_10_para.mz = 32;
    averageCellToLatEdge_0_10_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_0_10_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_10_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_10_para.ox];
    averageCellToLatEdge_0_10_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_0_10_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_10_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_10_para.ox];
    
    athread_spawn(averageCellToLatEdge_0_10, &averageCellToLatEdge_0_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_0_10_info interpCellToVtx_0_10_para;
    interpCellToVtx_0_10_para.lz = 32 - 0;
    interpCellToVtx_0_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_0_10_para.oz = 0;
    interpCellToVtx_0_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_0_10_para.hx = 1;
    interpCellToVtx_0_10_para.hy = 1;
    interpCellToVtx_0_10_para.hz = 0;
    interpCellToVtx_0_10_para.bx = 256;
    interpCellToVtx_0_10_para.by = 8;
    interpCellToVtx_0_10_para.bz = 1;
    interpCellToVtx_0_10_para.mx = 1;
    interpCellToVtx_0_10_para.my = 2;
    interpCellToVtx_0_10_para.mz = 32;
    interpCellToVtx_0_10_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_0_10_para.oz][Proc.lat_hw -1+interpCellToVtx_0_10_para.oy][Proc.lon_hw -1+interpCellToVtx_0_10_para.ox];
    interpCellToVtx_0_10_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_0_10_para.oz][Proc.lat_hw -1+interpCellToVtx_0_10_para.oy][Proc.lon_hw -1+interpCellToVtx_0_10_para.ox];
    interpCellToVtx_0_10_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_0_10_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_0_10_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_0_10, &interpCellToVtx_0_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if (((tendPara->u) && (tendPara->v)))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lon_edge(0,&tend1->du[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lon_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend1->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lat_edge(0,&tend1->dv[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lat_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend1->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_0_18_info update_state_0_18_para;
    update_state_0_18_para.lz = 32 - 0;
    update_state_0_18_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    update_state_0_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_0_18_para.oz = 0;
    update_state_0_18_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    update_state_0_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_0_18_para.hx = 1;
    update_state_0_18_para.hy = 1;
    update_state_0_18_para.hz = 0;
    update_state_0_18_para.bx = 256;
    update_state_0_18_para.by = 8;
    update_state_0_18_para.bz = 1;
    update_state_0_18_para.mx = 1;
    update_state_0_18_para.my = 2;
    update_state_0_18_para.mz = 32;
    update_state_0_18_para.old_stateu_lon = &old_state->u_lon[Proc.lev_hw - 0+update_state_0_18_para.oz][Proc.lat_hw -1+update_state_0_18_para.oy][Proc.lon_hw -1+update_state_0_18_para.ox];
    update_state_0_18_para.tend1du = &tend1->du[Proc.lev_hw - 0+update_state_0_18_para.oz][Proc.lat_hw -1+update_state_0_18_para.oy][Proc.lon_hw -1+update_state_0_18_para.ox];
    update_state_0_18_para.new_stateu_lon = &new_state->u_lon[Proc.lev_hw - 0+update_state_0_18_para.oz][Proc.lat_hw -1+update_state_0_18_para.oy][Proc.lon_hw -1+update_state_0_18_para.ox];
    update_state_0_18_para.dt = dt;
    
    athread_spawn(update_state_0_18, &update_state_0_18_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateu_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_0_19_info update_state_0_19_para;
    update_state_0_19_para.lz = 32 - 0;
    update_state_0_19_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    update_state_0_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_0_19_para.oz = 0;
    update_state_0_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_0_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_0_19_para.hx = 1;
    update_state_0_19_para.hy = 1;
    update_state_0_19_para.hz = 0;
    update_state_0_19_para.bx = 256;
    update_state_0_19_para.by = 8;
    update_state_0_19_para.bz = 1;
    update_state_0_19_para.mx = 1;
    update_state_0_19_para.my = 2;
    update_state_0_19_para.mz = 32;
    update_state_0_19_para.old_statev_lat = &old_state->v_lat[Proc.lev_hw - 0+update_state_0_19_para.oz][Proc.lat_hw -1+update_state_0_19_para.oy][Proc.lon_hw -1+update_state_0_19_para.ox];
    update_state_0_19_para.tend1dv = &tend1->dv[Proc.lev_hw - 0+update_state_0_19_para.oz][Proc.lat_hw -1+update_state_0_19_para.oy][Proc.lon_hw -1+update_state_0_19_para.ox];
    update_state_0_19_para.new_statev_lat = &new_state->v_lat[Proc.lev_hw - 0+update_state_0_19_para.oz][Proc.lat_hw -1+update_state_0_19_para.oy][Proc.lon_hw -1+update_state_0_19_para.ox];
    update_state_0_19_para.dt = dt;
    
    athread_spawn(update_state_0_19, &update_state_0_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statev_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  tendPara = tendPara;
  advPara = advPara;
  dt = dt;
  tendPara = tendPara;
  (tendPara->u) = 0;
  (tendPara->v) = 0;
  (tendPara->pt) = 0;
  (tendPara->gz) = 0;
  (tendPara->phs) = 0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_t_0_3_info calc_t_0_3_para;
  calc_t_0_3_para.lz = 32 - 0;
  calc_t_0_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_t_0_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_t_0_3_para.oz = 0;
  calc_t_0_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_t_0_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_t_0_3_para.hx = 2;
  calc_t_0_3_para.hy = 2;
  calc_t_0_3_para.hz = 0;
  calc_t_0_3_para.bx = 256;
  calc_t_0_3_para.by = 8;
  calc_t_0_3_para.bz = 1;
  calc_t_0_3_para.mx = 1;
  calc_t_0_3_para.my = 2;
  calc_t_0_3_para.mz = 32;
  calc_t_0_3_para.new_statept = &new_state->pt[Proc.lev_hw - 0+calc_t_0_3_para.oz][Proc.lat_hw -2+calc_t_0_3_para.oy][Proc.lon_hw -2+calc_t_0_3_para.ox];
  calc_t_0_3_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_t_0_3_para.oz][Proc.lat_hw -2+calc_t_0_3_para.oy][Proc.lon_hw -2+calc_t_0_3_para.ox];
  calc_t_0_3_para.new_stateqv = &new_state->qv[Proc.lev_hw - 0+calc_t_0_3_para.oz][Proc.lat_hw -2+calc_t_0_3_para.oy][Proc.lon_hw -2+calc_t_0_3_para.ox];
  calc_t_0_3_para.new_statet = &new_state->t[Proc.lev_hw - 0+calc_t_0_3_para.oz][Proc.lat_hw -2+calc_t_0_3_para.oy][Proc.lon_hw -2+calc_t_0_3_para.ox];
  
  athread_spawn(calc_t_0_3, &calc_t_0_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_ttTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_gz_lev_0_3_info calc_gz_lev_0_3_para;
  calc_gz_lev_0_3_para.lz = 32 - 0;
  calc_gz_lev_0_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_gz_lev_0_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_gz_lev_0_3_para.oz = 0;
  calc_gz_lev_0_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_gz_lev_0_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_gz_lev_0_3_para.hx = 1;
  calc_gz_lev_0_3_para.hy = 0;
  calc_gz_lev_0_3_para.hz = Proc.lev_hw;
  calc_gz_lev_0_3_para.bx = 64;
  calc_gz_lev_0_3_para.by = 1;
  calc_gz_lev_0_3_para.bz = 32;
  calc_gz_lev_0_3_para.mx = 8;
  calc_gz_lev_0_3_para.my = 8;
  calc_gz_lev_0_3_para.mz = 1;
  calc_gz_lev_0_3_para.new_statet = &new_state->t[Proc.lev_hw - calc_gz_lev_0_3_para.hz+calc_gz_lev_0_3_para.oz][Proc.lat_hw -0+calc_gz_lev_0_3_para.oy][Proc.lon_hw -1+calc_gz_lev_0_3_para.ox];
  calc_gz_lev_0_3_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - calc_gz_lev_0_3_para.hz+calc_gz_lev_0_3_para.oz][Proc.lat_hw -0+calc_gz_lev_0_3_para.oy][Proc.lon_hw -1+calc_gz_lev_0_3_para.ox];
  calc_gz_lev_0_3_para.staticvgzs = &staticv->gzs[0][Proc.lat_hw -0+calc_gz_lev_0_3_para.oy][Proc.lon_hw -1+calc_gz_lev_0_3_para.ox];
  calc_gz_lev_0_3_para.new_stategz_lev = &new_state->gz_lev[Proc.lev_hw - calc_gz_lev_0_3_para.hz+calc_gz_lev_0_3_para.oz][Proc.lat_hw -0+calc_gz_lev_0_3_para.oy][Proc.lon_hw -1+calc_gz_lev_0_3_para.ox];
  
  athread_spawn(calc_gz_lev_0_3, &calc_gz_lev_0_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_gz_levgz_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &new_state->gz_lev[0][0][0], &Proc.FieldReq[async_gz_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qm]);
  HaloWait(Proc,&Proc.FieldReq[async_ph_exn_lev]);
  HaloWait(Proc,&Proc.FieldReq[async_gz_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  pgf_lin97_0_2_info pgf_lin97_0_2_para;
  pgf_lin97_0_2_para.lz = 32 - 0;
  pgf_lin97_0_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  pgf_lin97_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  pgf_lin97_0_2_para.oz = 0;
  pgf_lin97_0_2_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  pgf_lin97_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  pgf_lin97_0_2_para.hx = 1;
  pgf_lin97_0_2_para.hy = 0;
  pgf_lin97_0_2_para.hz = 1;
  pgf_lin97_0_2_para.bx = 256;
  pgf_lin97_0_2_para.by = 1;
  pgf_lin97_0_2_para.bz = 4;
  pgf_lin97_0_2_para.mx = 1;
  pgf_lin97_0_2_para.my = 8;
  pgf_lin97_0_2_para.mz = 8;
  pgf_lin97_0_2_para.new_stateqm = &new_state->qm[Proc.lev_hw - 1+pgf_lin97_0_2_para.oz][Proc.lat_hw -0+pgf_lin97_0_2_para.oy][Proc.lon_hw -1+pgf_lin97_0_2_para.ox];
  pgf_lin97_0_2_para.new_stateph_exn_lev = &new_state->ph_exn_lev[Proc.lev_hw - 1+pgf_lin97_0_2_para.oz][Proc.lat_hw -0+pgf_lin97_0_2_para.oy][Proc.lon_hw -1+pgf_lin97_0_2_para.ox];
  pgf_lin97_0_2_para.new_stategz_lev = &new_state->gz_lev[Proc.lev_hw - 1+pgf_lin97_0_2_para.oz][Proc.lat_hw -0+pgf_lin97_0_2_para.oy][Proc.lon_hw -1+pgf_lin97_0_2_para.ox];
  pgf_lin97_0_2_para.tend2pgf_lon = &tend2->pgf_lon[Proc.lev_hw - 1+pgf_lin97_0_2_para.oz][Proc.lat_hw -0+pgf_lin97_0_2_para.oy][Proc.lon_hw -1+pgf_lin97_0_2_para.ox];
  pgf_lin97_0_2_para.de_lon = &mesh->de_lon[0][0][0];
  
  athread_spawn(pgf_lin97_0_2, &pgf_lin97_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  pgf_lin97pgf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qm]);
  HaloWait(Proc,&Proc.FieldReq[async_ph_exn_lev]);
  HaloWait(Proc,&Proc.FieldReq[async_gz_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tl = (1 + (0.5 * (new_state->qm[k][j][i] + new_state->qm[k][(j + 1)][i])));
        dph1 = (new_state->ph_exn_lev[(k + 1)][(j + 1)][i] - new_state->ph_exn_lev[k][j][i]);
        dph2 = (new_state->ph_exn_lev[(k + 1)][j][i] - new_state->ph_exn_lev[k][(j + 1)][i]);
        dgz1 = (new_state->gz_lev[(k + 1)][j][i] - new_state->gz_lev[k][(j + 1)][i]);
        dgz2 = (new_state->gz_lev[k][j][i] - new_state->gz_lev[(k + 1)][(j + 1)][i]);
        tend2->pgf_lat[k][j][i] = (((-((dph1 * dgz1) + (dph2 * dgz2)) / mesh->de_lat[0][j][0]) / (dph1 + dph2)) / tl);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  pgf_lin97pgf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  tendPara = tendPara;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_du]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_backward_0_4_info calc_tend_backward_0_4_para;
  calc_tend_backward_0_4_para.lz = 32 - 0;
  calc_tend_backward_0_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_tend_backward_0_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_backward_0_4_para.oz = 0;
  calc_tend_backward_0_4_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_tend_backward_0_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_backward_0_4_para.hx = 1;
  calc_tend_backward_0_4_para.hy = 1;
  calc_tend_backward_0_4_para.hz = 0;
  calc_tend_backward_0_4_para.bx = 256;
  calc_tend_backward_0_4_para.by = 8;
  calc_tend_backward_0_4_para.bz = 1;
  calc_tend_backward_0_4_para.mx = 1;
  calc_tend_backward_0_4_para.my = 2;
  calc_tend_backward_0_4_para.mz = 32;
  calc_tend_backward_0_4_para.tend1du = &tend1->du[Proc.lev_hw - 0+calc_tend_backward_0_4_para.oz][Proc.lat_hw -1+calc_tend_backward_0_4_para.oy][Proc.lon_hw -1+calc_tend_backward_0_4_para.ox];
  calc_tend_backward_0_4_para.tend2pgf_lon = &tend2->pgf_lon[Proc.lev_hw - 0+calc_tend_backward_0_4_para.oz][Proc.lat_hw -1+calc_tend_backward_0_4_para.oy][Proc.lon_hw -1+calc_tend_backward_0_4_para.ox];
  calc_tend_backward_0_4_para.tend2du = &tend2->du[Proc.lev_hw - 0+calc_tend_backward_0_4_para.oz][Proc.lat_hw -1+calc_tend_backward_0_4_para.oy][Proc.lon_hw -1+calc_tend_backward_0_4_para.ox];
  
  athread_spawn(calc_tend_backward_0_4, &calc_tend_backward_0_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_backwardduTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend2->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_dv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_backward_0_5_info calc_tend_backward_0_5_para;
  calc_tend_backward_0_5_para.lz = 32 - 0;
  calc_tend_backward_0_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_tend_backward_0_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_backward_0_5_para.oz = 0;
  calc_tend_backward_0_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_tend_backward_0_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_backward_0_5_para.hx = 1;
  calc_tend_backward_0_5_para.hy = 1;
  calc_tend_backward_0_5_para.hz = 0;
  calc_tend_backward_0_5_para.bx = 256;
  calc_tend_backward_0_5_para.by = 8;
  calc_tend_backward_0_5_para.bz = 1;
  calc_tend_backward_0_5_para.mx = 1;
  calc_tend_backward_0_5_para.my = 2;
  calc_tend_backward_0_5_para.mz = 32;
  calc_tend_backward_0_5_para.tend1dv = &tend1->dv[Proc.lev_hw - 0+calc_tend_backward_0_5_para.oz][Proc.lat_hw -1+calc_tend_backward_0_5_para.oy][Proc.lon_hw -1+calc_tend_backward_0_5_para.ox];
  calc_tend_backward_0_5_para.tend2pgf_lat = &tend2->pgf_lat[Proc.lev_hw - 0+calc_tend_backward_0_5_para.oz][Proc.lat_hw -1+calc_tend_backward_0_5_para.oy][Proc.lon_hw -1+calc_tend_backward_0_5_para.ox];
  calc_tend_backward_0_5_para.tend2dv = &tend2->dv[Proc.lev_hw - 0+calc_tend_backward_0_5_para.oz][Proc.lat_hw -1+calc_tend_backward_0_5_para.oy][Proc.lon_hw -1+calc_tend_backward_0_5_para.ox];
  
  athread_spawn(calc_tend_backward_0_5, &calc_tend_backward_0_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_backwarddvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend2->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  (tendPara->u) = 1;
  (tendPara->v) = 1;
  tendPara = tendPara;
  dt = dt;
  if ((tendPara->phs))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,0,&tend2->dphs[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &tend2->dphs[0][0][0], &Proc.FieldReq[async_dphs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        new_state->phs[0][j][i] = (old_state->phs[0][j][i] + (dt * tend2->dphs[0][j][i]));
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statephsTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &new_state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_0_18_info calc_ph_0_18_para;
    calc_ph_0_18_para.lz = 33 - 0;
    calc_ph_0_18_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_0_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_0_18_para.oz = 0;
    calc_ph_0_18_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_0_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_0_18_para.hx = 1;
    calc_ph_0_18_para.hy = 1;
    calc_ph_0_18_para.hz = 0;
    calc_ph_0_18_para.bx = 256;
    calc_ph_0_18_para.by = 8;
    calc_ph_0_18_para.bz = 1;
    calc_ph_0_18_para.mx = 1;
    calc_ph_0_18_para.my = 2;
    calc_ph_0_18_para.mz = 32;
    calc_ph_0_18_para.new_statephs = &new_state->phs[0][Proc.lat_hw -1+calc_ph_0_18_para.oy][Proc.lon_hw -1+calc_ph_0_18_para.ox];
    calc_ph_0_18_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_0_18_para.oz][Proc.lat_hw -1+calc_ph_0_18_para.oy][Proc.lon_hw -1+calc_ph_0_18_para.ox];
    calc_ph_0_18_para.hyai = &mesh->hyai[0][0][0];
    calc_ph_0_18_para.hybi = &mesh->hybi[0][0][0];
    
    athread_spawn(calc_ph_0_18, &calc_ph_0_18_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_0_19_info calc_ph_0_19_para;
    calc_ph_0_19_para.lz = 33 - 0;
    calc_ph_0_19_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_0_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_0_19_para.oz = 0;
    calc_ph_0_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_0_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_0_19_para.hx = 1;
    calc_ph_0_19_para.hy = 1;
    calc_ph_0_19_para.hz = 0;
    calc_ph_0_19_para.bx = 256;
    calc_ph_0_19_para.by = 8;
    calc_ph_0_19_para.bz = 1;
    calc_ph_0_19_para.mx = 1;
    calc_ph_0_19_para.my = 2;
    calc_ph_0_19_para.mz = 32;
    calc_ph_0_19_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_0_19_para.oz][Proc.lat_hw -1+calc_ph_0_19_para.oy][Proc.lon_hw -1+calc_ph_0_19_para.ox];
    calc_ph_0_19_para.new_stateph_exn_lev = &new_state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_0_19_para.oz][Proc.lat_hw -1+calc_ph_0_19_para.oy][Proc.lon_hw -1+calc_ph_0_19_para.ox];
    
    athread_spawn(calc_ph_0_19, &calc_ph_0_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_exn_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_0_20_info calc_ph_0_20_para;
    calc_ph_0_20_para.lz = 32 - 0;
    calc_ph_0_20_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_0_20_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_0_20_para.oz = 0;
    calc_ph_0_20_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_0_20_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_0_20_para.hx = 0;
    calc_ph_0_20_para.hy = 0;
    calc_ph_0_20_para.hz = 1;
    calc_ph_0_20_para.bx = 256;
    calc_ph_0_20_para.by = 1;
    calc_ph_0_20_para.bz = 4;
    calc_ph_0_20_para.mx = 1;
    calc_ph_0_20_para.my = 8;
    calc_ph_0_20_para.mz = 8;
    calc_ph_0_20_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_ph_0_20_para.oz][Proc.lat_hw -0+calc_ph_0_20_para.oy][Proc.lon_hw -0+calc_ph_0_20_para.ox];
    calc_ph_0_20_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_ph_0_20_para.oz][Proc.lat_hw -0+calc_ph_0_20_para.oy][Proc.lon_hw -0+calc_ph_0_20_para.ox];
    
    athread_spawn(calc_ph_0_20, &calc_ph_0_20_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phphTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_44_info calc_m_0_44_para;
    calc_m_0_44_para.lz = 32 - 0;
    calc_m_0_44_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_44_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_44_para.oz = 0;
    calc_m_0_44_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_44_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_44_para.hx = 1;
    calc_m_0_44_para.hy = 0;
    calc_m_0_44_para.hz = 1;
    calc_m_0_44_para.bx = 256;
    calc_m_0_44_para.by = 1;
    calc_m_0_44_para.bz = 4;
    calc_m_0_44_para.mx = 1;
    calc_m_0_44_para.my = 8;
    calc_m_0_44_para.mz = 8;
    calc_m_0_44_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_0_44_para.oz][Proc.lat_hw -0+calc_m_0_44_para.oy][Proc.lon_hw -1+calc_m_0_44_para.ox];
    calc_m_0_44_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_0_44_para.oz][Proc.lat_hw -0+calc_m_0_44_para.oy][Proc.lon_hw -1+calc_m_0_44_para.ox];
    
    athread_spawn(calc_m_0_44, &calc_m_0_44_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_45_info calc_m_0_45_para;
    calc_m_0_45_para.lz = 32 - 1;
    calc_m_0_45_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_45_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_45_para.oz = 1;
    calc_m_0_45_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_45_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_45_para.hx = 0;
    calc_m_0_45_para.hy = 0;
    calc_m_0_45_para.hz = 1;
    calc_m_0_45_para.bx = 256;
    calc_m_0_45_para.by = 1;
    calc_m_0_45_para.bz = 4;
    calc_m_0_45_para.mx = 1;
    calc_m_0_45_para.my = 8;
    calc_m_0_45_para.mz = 8;
    calc_m_0_45_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_0_45_para.oz][Proc.lat_hw -0+calc_m_0_45_para.oy][Proc.lon_hw -0+calc_m_0_45_para.ox];
    calc_m_0_45_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_0_45_para.oz][Proc.lat_hw -0+calc_m_0_45_para.oy][Proc.lon_hw -0+calc_m_0_45_para.ox];
    
    athread_spawn(calc_m_0_45, &calc_m_0_45_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_46_info calc_m_0_46_para;
    calc_m_0_46_para.lz = 1 - 0;
    calc_m_0_46_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_46_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_46_para.oz = 0;
    calc_m_0_46_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_46_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_46_para.hx = 0;
    calc_m_0_46_para.hy = 0;
    calc_m_0_46_para.hz = 0;
    calc_m_0_46_para.bx = 256;
    calc_m_0_46_para.by = 8;
    calc_m_0_46_para.bz = 1;
    calc_m_0_46_para.mx = 1;
    calc_m_0_46_para.my = 2;
    calc_m_0_46_para.mz = 32;
    calc_m_0_46_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_0_46_para.oz][Proc.lat_hw -0+calc_m_0_46_para.oy][Proc.lon_hw -0+calc_m_0_46_para.ox];
    calc_m_0_46_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_0_46_para.oz][Proc.lat_hw -0+calc_m_0_46_para.oy][Proc.lon_hw -0+calc_m_0_46_para.ox];
    calc_m_0_46_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_0_46_para.oz][Proc.lat_hw -0+calc_m_0_46_para.oy][Proc.lon_hw -0+calc_m_0_46_para.ox];
    
    athread_spawn(calc_m_0_46, &calc_m_0_46_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_47_info calc_m_0_47_para;
    calc_m_0_47_para.lz = 33 - 32;
    calc_m_0_47_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_47_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_47_para.oz = 32;
    calc_m_0_47_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_47_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_47_para.hx = 0;
    calc_m_0_47_para.hy = 0;
    calc_m_0_47_para.hz = 1;
    calc_m_0_47_para.bx = 256;
    calc_m_0_47_para.by = 1;
    calc_m_0_47_para.bz = 4;
    calc_m_0_47_para.mx = 1;
    calc_m_0_47_para.my = 8;
    calc_m_0_47_para.mz = 8;
    calc_m_0_47_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_0_47_para.oz][Proc.lat_hw -0+calc_m_0_47_para.oy][Proc.lon_hw -0+calc_m_0_47_para.ox];
    calc_m_0_47_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_0_47_para.oz][Proc.lat_hw -0+calc_m_0_47_para.oy][Proc.lon_hw -0+calc_m_0_47_para.ox];
    calc_m_0_47_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_0_47_para.oz][Proc.lat_hw -0+calc_m_0_47_para.oy][Proc.lon_hw -0+calc_m_0_47_para.ox];
    
    athread_spawn(calc_m_0_47, &calc_m_0_47_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_0_11_info averageCellToLonEdge_0_11_para;
    averageCellToLonEdge_0_11_para.lz = 32 - 0;
    averageCellToLonEdge_0_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_0_11_para.oz = 0;
    averageCellToLonEdge_0_11_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_0_11_para.hx = 1;
    averageCellToLonEdge_0_11_para.hy = 1;
    averageCellToLonEdge_0_11_para.hz = 0;
    averageCellToLonEdge_0_11_para.bx = 256;
    averageCellToLonEdge_0_11_para.by = 8;
    averageCellToLonEdge_0_11_para.bz = 1;
    averageCellToLonEdge_0_11_para.mx = 1;
    averageCellToLonEdge_0_11_para.my = 2;
    averageCellToLonEdge_0_11_para.mz = 32;
    averageCellToLonEdge_0_11_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_0_11_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_11_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_11_para.ox];
    averageCellToLonEdge_0_11_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_0_11_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_11_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_11_para.ox];
    
    athread_spawn(averageCellToLonEdge_0_11, &averageCellToLonEdge_0_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_0_11_info averageCellToLatEdge_0_11_para;
    averageCellToLatEdge_0_11_para.lz = 32 - 0;
    averageCellToLatEdge_0_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_0_11_para.oz = 0;
    averageCellToLatEdge_0_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_0_11_para.hx = 1;
    averageCellToLatEdge_0_11_para.hy = 1;
    averageCellToLatEdge_0_11_para.hz = 0;
    averageCellToLatEdge_0_11_para.bx = 256;
    averageCellToLatEdge_0_11_para.by = 8;
    averageCellToLatEdge_0_11_para.bz = 1;
    averageCellToLatEdge_0_11_para.mx = 1;
    averageCellToLatEdge_0_11_para.my = 2;
    averageCellToLatEdge_0_11_para.mz = 32;
    averageCellToLatEdge_0_11_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_0_11_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_11_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_11_para.ox];
    averageCellToLatEdge_0_11_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_0_11_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_11_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_11_para.ox];
    
    athread_spawn(averageCellToLatEdge_0_11, &averageCellToLatEdge_0_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_0_11_info interpCellToVtx_0_11_para;
    interpCellToVtx_0_11_para.lz = 32 - 0;
    interpCellToVtx_0_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_0_11_para.oz = 0;
    interpCellToVtx_0_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_0_11_para.hx = 1;
    interpCellToVtx_0_11_para.hy = 1;
    interpCellToVtx_0_11_para.hz = 0;
    interpCellToVtx_0_11_para.bx = 256;
    interpCellToVtx_0_11_para.by = 8;
    interpCellToVtx_0_11_para.bz = 1;
    interpCellToVtx_0_11_para.mx = 1;
    interpCellToVtx_0_11_para.my = 2;
    interpCellToVtx_0_11_para.mz = 32;
    interpCellToVtx_0_11_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_0_11_para.oz][Proc.lat_hw -1+interpCellToVtx_0_11_para.oy][Proc.lon_hw -1+interpCellToVtx_0_11_para.ox];
    interpCellToVtx_0_11_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_0_11_para.oz][Proc.lat_hw -1+interpCellToVtx_0_11_para.oy][Proc.lon_hw -1+interpCellToVtx_0_11_para.ox];
    interpCellToVtx_0_11_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_0_11_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_0_11_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_0_11, &interpCellToVtx_0_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->pt))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,1,&tend2->dpt[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend2->dpt[0][0][0], &Proc.FieldReq[async_dpt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_pt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_0_20_info update_state_0_20_para;
    update_state_0_20_para.lz = 32 - 0;
    update_state_0_20_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_0_20_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_0_20_para.oz = 0;
    update_state_0_20_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_0_20_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_0_20_para.hx = 2;
    update_state_0_20_para.hy = 2;
    update_state_0_20_para.hz = 0;
    update_state_0_20_para.bx = 256;
    update_state_0_20_para.by = 8;
    update_state_0_20_para.bz = 1;
    update_state_0_20_para.mx = 1;
    update_state_0_20_para.my = 2;
    update_state_0_20_para.mz = 32;
    update_state_0_20_para.old_statept = &old_state->pt[Proc.lev_hw - 0+update_state_0_20_para.oz][Proc.lat_hw -2+update_state_0_20_para.oy][Proc.lon_hw -2+update_state_0_20_para.ox];
    update_state_0_20_para.old_statem = &old_state->m[Proc.lev_hw - 0+update_state_0_20_para.oz][Proc.lat_hw -2+update_state_0_20_para.oy][Proc.lon_hw -2+update_state_0_20_para.ox];
    update_state_0_20_para.tend2dpt = &tend2->dpt[Proc.lev_hw - 0+update_state_0_20_para.oz][Proc.lat_hw -2+update_state_0_20_para.oy][Proc.lon_hw -2+update_state_0_20_para.ox];
    update_state_0_20_para.new_statem = &new_state->m[Proc.lev_hw - 0+update_state_0_20_para.oz][Proc.lat_hw -2+update_state_0_20_para.oy][Proc.lon_hw -2+update_state_0_20_para.ox];
    update_state_0_20_para.new_statept = &new_state->pt[Proc.lev_hw - 0+update_state_0_20_para.oz][Proc.lat_hw -2+update_state_0_20_para.oy][Proc.lon_hw -2+update_state_0_20_para.ox];
    update_state_0_20_para.dt = dt;
    
    athread_spawn(update_state_0_20, &update_state_0_20_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateptTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->gz))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_0_21_info update_state_0_21_para;
    update_state_0_21_para.lz = 32 - 0;
    update_state_0_21_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_0_21_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_0_21_para.oz = 0;
    update_state_0_21_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_0_21_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_0_21_para.hx = 0;
    update_state_0_21_para.hy = 0;
    update_state_0_21_para.hz = 0;
    update_state_0_21_para.bx = 256;
    update_state_0_21_para.by = 8;
    update_state_0_21_para.bz = 1;
    update_state_0_21_para.mx = 1;
    update_state_0_21_para.my = 2;
    update_state_0_21_para.mz = 32;
    update_state_0_21_para.old_stategz = &old_state->gz[Proc.lev_hw - 0+update_state_0_21_para.oz][Proc.lat_hw -0+update_state_0_21_para.oy][Proc.lon_hw -0+update_state_0_21_para.ox];
    update_state_0_21_para.tend2dgz = &tend2->dgz[Proc.lev_hw - 0+update_state_0_21_para.oz][Proc.lat_hw -0+update_state_0_21_para.oy][Proc.lon_hw -0+update_state_0_21_para.ox];
    update_state_0_21_para.new_stategz = &new_state->gz[Proc.lev_hw - 0+update_state_0_21_para.oz][Proc.lat_hw -0+update_state_0_21_para.oy][Proc.lon_hw -0+update_state_0_21_para.ox];
    update_state_0_21_para.dt = dt;
    
    athread_spawn(update_state_0_21, &update_state_0_21_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stategzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_48_info calc_m_0_48_para;
    calc_m_0_48_para.lz = 32 - 0;
    calc_m_0_48_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_48_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_48_para.oz = 0;
    calc_m_0_48_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_48_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_48_para.hx = 1;
    calc_m_0_48_para.hy = 0;
    calc_m_0_48_para.hz = 1;
    calc_m_0_48_para.bx = 256;
    calc_m_0_48_para.by = 1;
    calc_m_0_48_para.bz = 4;
    calc_m_0_48_para.mx = 1;
    calc_m_0_48_para.my = 8;
    calc_m_0_48_para.mz = 8;
    calc_m_0_48_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_0_48_para.oz][Proc.lat_hw -0+calc_m_0_48_para.oy][Proc.lon_hw -1+calc_m_0_48_para.ox];
    calc_m_0_48_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_0_48_para.oz][Proc.lat_hw -0+calc_m_0_48_para.oy][Proc.lon_hw -1+calc_m_0_48_para.ox];
    
    athread_spawn(calc_m_0_48, &calc_m_0_48_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_49_info calc_m_0_49_para;
    calc_m_0_49_para.lz = 32 - 1;
    calc_m_0_49_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_49_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_49_para.oz = 1;
    calc_m_0_49_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_49_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_49_para.hx = 0;
    calc_m_0_49_para.hy = 0;
    calc_m_0_49_para.hz = 1;
    calc_m_0_49_para.bx = 256;
    calc_m_0_49_para.by = 1;
    calc_m_0_49_para.bz = 4;
    calc_m_0_49_para.mx = 1;
    calc_m_0_49_para.my = 8;
    calc_m_0_49_para.mz = 8;
    calc_m_0_49_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_0_49_para.oz][Proc.lat_hw -0+calc_m_0_49_para.oy][Proc.lon_hw -0+calc_m_0_49_para.ox];
    calc_m_0_49_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_0_49_para.oz][Proc.lat_hw -0+calc_m_0_49_para.oy][Proc.lon_hw -0+calc_m_0_49_para.ox];
    
    athread_spawn(calc_m_0_49, &calc_m_0_49_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_50_info calc_m_0_50_para;
    calc_m_0_50_para.lz = 1 - 0;
    calc_m_0_50_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_50_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_50_para.oz = 0;
    calc_m_0_50_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_50_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_50_para.hx = 0;
    calc_m_0_50_para.hy = 0;
    calc_m_0_50_para.hz = 0;
    calc_m_0_50_para.bx = 256;
    calc_m_0_50_para.by = 8;
    calc_m_0_50_para.bz = 1;
    calc_m_0_50_para.mx = 1;
    calc_m_0_50_para.my = 2;
    calc_m_0_50_para.mz = 32;
    calc_m_0_50_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_0_50_para.oz][Proc.lat_hw -0+calc_m_0_50_para.oy][Proc.lon_hw -0+calc_m_0_50_para.ox];
    calc_m_0_50_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_0_50_para.oz][Proc.lat_hw -0+calc_m_0_50_para.oy][Proc.lon_hw -0+calc_m_0_50_para.ox];
    calc_m_0_50_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_0_50_para.oz][Proc.lat_hw -0+calc_m_0_50_para.oy][Proc.lon_hw -0+calc_m_0_50_para.ox];
    
    athread_spawn(calc_m_0_50, &calc_m_0_50_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_0_51_info calc_m_0_51_para;
    calc_m_0_51_para.lz = 33 - 32;
    calc_m_0_51_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_0_51_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_0_51_para.oz = 32;
    calc_m_0_51_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_0_51_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_0_51_para.hx = 0;
    calc_m_0_51_para.hy = 0;
    calc_m_0_51_para.hz = 1;
    calc_m_0_51_para.bx = 256;
    calc_m_0_51_para.by = 1;
    calc_m_0_51_para.bz = 4;
    calc_m_0_51_para.mx = 1;
    calc_m_0_51_para.my = 8;
    calc_m_0_51_para.mz = 8;
    calc_m_0_51_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_0_51_para.oz][Proc.lat_hw -0+calc_m_0_51_para.oy][Proc.lon_hw -0+calc_m_0_51_para.ox];
    calc_m_0_51_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_0_51_para.oz][Proc.lat_hw -0+calc_m_0_51_para.oy][Proc.lon_hw -0+calc_m_0_51_para.ox];
    calc_m_0_51_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_0_51_para.oz][Proc.lat_hw -0+calc_m_0_51_para.oy][Proc.lon_hw -0+calc_m_0_51_para.ox];
    
    athread_spawn(calc_m_0_51, &calc_m_0_51_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_0_12_info averageCellToLonEdge_0_12_para;
    averageCellToLonEdge_0_12_para.lz = 32 - 0;
    averageCellToLonEdge_0_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_0_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_0_12_para.oz = 0;
    averageCellToLonEdge_0_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_0_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_0_12_para.hx = 1;
    averageCellToLonEdge_0_12_para.hy = 1;
    averageCellToLonEdge_0_12_para.hz = 0;
    averageCellToLonEdge_0_12_para.bx = 256;
    averageCellToLonEdge_0_12_para.by = 8;
    averageCellToLonEdge_0_12_para.bz = 1;
    averageCellToLonEdge_0_12_para.mx = 1;
    averageCellToLonEdge_0_12_para.my = 2;
    averageCellToLonEdge_0_12_para.mz = 32;
    averageCellToLonEdge_0_12_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_0_12_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_12_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_12_para.ox];
    averageCellToLonEdge_0_12_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_0_12_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_12_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_12_para.ox];
    
    athread_spawn(averageCellToLonEdge_0_12, &averageCellToLonEdge_0_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_0_12_info averageCellToLatEdge_0_12_para;
    averageCellToLatEdge_0_12_para.lz = 32 - 0;
    averageCellToLatEdge_0_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_0_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_0_12_para.oz = 0;
    averageCellToLatEdge_0_12_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_0_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_0_12_para.hx = 1;
    averageCellToLatEdge_0_12_para.hy = 1;
    averageCellToLatEdge_0_12_para.hz = 0;
    averageCellToLatEdge_0_12_para.bx = 256;
    averageCellToLatEdge_0_12_para.by = 8;
    averageCellToLatEdge_0_12_para.bz = 1;
    averageCellToLatEdge_0_12_para.mx = 1;
    averageCellToLatEdge_0_12_para.my = 2;
    averageCellToLatEdge_0_12_para.mz = 32;
    averageCellToLatEdge_0_12_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_0_12_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_12_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_12_para.ox];
    averageCellToLatEdge_0_12_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_0_12_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_12_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_12_para.ox];
    
    athread_spawn(averageCellToLatEdge_0_12, &averageCellToLatEdge_0_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_0_12_info interpCellToVtx_0_12_para;
    interpCellToVtx_0_12_para.lz = 32 - 0;
    interpCellToVtx_0_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_0_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_0_12_para.oz = 0;
    interpCellToVtx_0_12_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_0_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_0_12_para.hx = 1;
    interpCellToVtx_0_12_para.hy = 1;
    interpCellToVtx_0_12_para.hz = 0;
    interpCellToVtx_0_12_para.bx = 256;
    interpCellToVtx_0_12_para.by = 8;
    interpCellToVtx_0_12_para.bz = 1;
    interpCellToVtx_0_12_para.mx = 1;
    interpCellToVtx_0_12_para.my = 2;
    interpCellToVtx_0_12_para.mz = 32;
    interpCellToVtx_0_12_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_0_12_para.oz][Proc.lat_hw -1+interpCellToVtx_0_12_para.oy][Proc.lon_hw -1+interpCellToVtx_0_12_para.ox];
    interpCellToVtx_0_12_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_0_12_para.oz][Proc.lat_hw -1+interpCellToVtx_0_12_para.oy][Proc.lon_hw -1+interpCellToVtx_0_12_para.ox];
    interpCellToVtx_0_12_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_0_12_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_0_12_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_0_12, &interpCellToVtx_0_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if (((tendPara->u) && (tendPara->v)))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lon_edge(0,&tend2->du[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lon_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend2->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lat_edge(0,&tend2->dv[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lat_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend2->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_0_22_info update_state_0_22_para;
    update_state_0_22_para.lz = 32 - 0;
    update_state_0_22_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    update_state_0_22_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_0_22_para.oz = 0;
    update_state_0_22_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    update_state_0_22_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_0_22_para.hx = 1;
    update_state_0_22_para.hy = 1;
    update_state_0_22_para.hz = 0;
    update_state_0_22_para.bx = 256;
    update_state_0_22_para.by = 8;
    update_state_0_22_para.bz = 1;
    update_state_0_22_para.mx = 1;
    update_state_0_22_para.my = 2;
    update_state_0_22_para.mz = 32;
    update_state_0_22_para.old_stateu_lon = &old_state->u_lon[Proc.lev_hw - 0+update_state_0_22_para.oz][Proc.lat_hw -1+update_state_0_22_para.oy][Proc.lon_hw -1+update_state_0_22_para.ox];
    update_state_0_22_para.tend2du = &tend2->du[Proc.lev_hw - 0+update_state_0_22_para.oz][Proc.lat_hw -1+update_state_0_22_para.oy][Proc.lon_hw -1+update_state_0_22_para.ox];
    update_state_0_22_para.new_stateu_lon = &new_state->u_lon[Proc.lev_hw - 0+update_state_0_22_para.oz][Proc.lat_hw -1+update_state_0_22_para.oy][Proc.lon_hw -1+update_state_0_22_para.ox];
    update_state_0_22_para.dt = dt;
    
    athread_spawn(update_state_0_22, &update_state_0_22_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateu_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_0_23_info update_state_0_23_para;
    update_state_0_23_para.lz = 32 - 0;
    update_state_0_23_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    update_state_0_23_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_0_23_para.oz = 0;
    update_state_0_23_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_0_23_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_0_23_para.hx = 1;
    update_state_0_23_para.hy = 1;
    update_state_0_23_para.hz = 0;
    update_state_0_23_para.bx = 256;
    update_state_0_23_para.by = 8;
    update_state_0_23_para.bz = 1;
    update_state_0_23_para.mx = 1;
    update_state_0_23_para.my = 2;
    update_state_0_23_para.mz = 32;
    update_state_0_23_para.old_statev_lat = &old_state->v_lat[Proc.lev_hw - 0+update_state_0_23_para.oz][Proc.lat_hw -1+update_state_0_23_para.oy][Proc.lon_hw -1+update_state_0_23_para.ox];
    update_state_0_23_para.tend2dv = &tend2->dv[Proc.lev_hw - 0+update_state_0_23_para.oz][Proc.lat_hw -1+update_state_0_23_para.oy][Proc.lon_hw -1+update_state_0_23_para.ox];
    update_state_0_23_para.new_statev_lat = &new_state->v_lat[Proc.lev_hw - 0+update_state_0_23_para.oz][Proc.lat_hw -1+update_state_0_23_para.oy][Proc.lon_hw -1+update_state_0_23_para.ox];
    update_state_0_23_para.dt = dt;
    
    athread_spawn(update_state_0_23, &update_state_0_23_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statev_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
}

void damp_run_0(struct HybridStateField* state, struct HybridTendField* tend, struct HybridMeshField* mesh, double dt)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_div]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->u_lon[k][j][i] = (state->u_lon[k][j][i] + ((mesh->c_lon[k][j][0] * (state->div[k][j][(i + 1)] - state->div[k][j][i])) / mesh->de_lon[0][j][0]));
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  div_damp_runu_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_div]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->v_lat[k][j][i] = (state->v_lat[k][j][i] + ((mesh->c_lat[k][j][0] * (state->div[k][(j + 1)][i] - state->div[k][j][i])) / mesh->de_lat[0][j][0]));
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  div_damp_runv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  dt = dt;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_0_0_info smag_damp_run_0_0_para;
  smag_damp_run_0_0_para.lz = 32 - 0;
  smag_damp_run_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_0_0_para.oz = 0;
  smag_damp_run_0_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_0_0_para.hx = 1;
  smag_damp_run_0_0_para.hy = 1;
  smag_damp_run_0_0_para.hz = 0;
  smag_damp_run_0_0_para.bx = 256;
  smag_damp_run_0_0_para.by = 8;
  smag_damp_run_0_0_para.bz = 1;
  smag_damp_run_0_0_para.mx = 1;
  smag_damp_run_0_0_para.my = 2;
  smag_damp_run_0_0_para.mz = 32;
  smag_damp_run_0_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_0_0_para.oz][Proc.lat_hw -1+smag_damp_run_0_0_para.oy][Proc.lon_hw -1+smag_damp_run_0_0_para.ox];
  smag_damp_run_0_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_0_0_para.oz][Proc.lat_hw -1+smag_damp_run_0_0_para.oy][Proc.lon_hw -1+smag_damp_run_0_0_para.ox];
  smag_damp_run_0_0_para.statesmag_t = &state->smag_t[Proc.lev_hw - 0+smag_damp_run_0_0_para.oz][Proc.lat_hw -1+smag_damp_run_0_0_para.oy][Proc.lon_hw -1+smag_damp_run_0_0_para.ox];
  smag_damp_run_0_0_para.de_lon = &mesh->de_lon[0][0][0];
  smag_damp_run_0_0_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  smag_damp_run_0_0_para.le_lon = &mesh->le_lon[0][0][0];
  smag_damp_run_0_0_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_0_0, &smag_damp_run_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_tTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->smag_t[0][0][0], &Proc.FieldReq[async_smag_t], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_0_1_info smag_damp_run_0_1_para;
  smag_damp_run_0_1_para.lz = 32 - 0;
  smag_damp_run_0_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  smag_damp_run_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_0_1_para.oz = 0;
  smag_damp_run_0_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  smag_damp_run_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_0_1_para.hx = 1;
  smag_damp_run_0_1_para.hy = 1;
  smag_damp_run_0_1_para.hz = 0;
  smag_damp_run_0_1_para.bx = 256;
  smag_damp_run_0_1_para.by = 8;
  smag_damp_run_0_1_para.bz = 1;
  smag_damp_run_0_1_para.mx = 1;
  smag_damp_run_0_1_para.my = 2;
  smag_damp_run_0_1_para.mz = 32;
  smag_damp_run_0_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_0_1_para.oz][Proc.lat_hw -1+smag_damp_run_0_1_para.oy][Proc.lon_hw -1+smag_damp_run_0_1_para.ox];
  smag_damp_run_0_1_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_0_1_para.oz][Proc.lat_hw -1+smag_damp_run_0_1_para.oy][Proc.lon_hw -1+smag_damp_run_0_1_para.ox];
  smag_damp_run_0_1_para.statesmag_s = &state->smag_s[Proc.lev_hw - 0+smag_damp_run_0_1_para.oz][Proc.lat_hw -1+smag_damp_run_0_1_para.oy][Proc.lon_hw -1+smag_damp_run_0_1_para.ox];
  smag_damp_run_0_1_para.le_lat = &mesh->le_lat[0][0][0];
  smag_damp_run_0_1_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  smag_damp_run_0_1_para.de_lat = &mesh->de_lat[0][0][0];
  smag_damp_run_0_1_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_0_1, &smag_damp_run_0_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_sTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->smag_s[0][0][0], &Proc.FieldReq[async_smag_s], false, false, true, true, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_smag_t]);
  HaloWait(Proc,&Proc.FieldReq[async_smag_s]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_0_2_info smag_damp_run_0_2_para;
  smag_damp_run_0_2_para.lz = 32 - 0;
  smag_damp_run_0_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_0_2_para.oz = 0;
  smag_damp_run_0_2_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_0_2_para.hx = 1;
  smag_damp_run_0_2_para.hy = 1;
  smag_damp_run_0_2_para.hz = 0;
  smag_damp_run_0_2_para.bx = 256;
  smag_damp_run_0_2_para.by = 8;
  smag_damp_run_0_2_para.bz = 1;
  smag_damp_run_0_2_para.mx = 1;
  smag_damp_run_0_2_para.my = 2;
  smag_damp_run_0_2_para.mz = 32;
  smag_damp_run_0_2_para.statesmag_t = &state->smag_t[Proc.lev_hw - 0+smag_damp_run_0_2_para.oz][Proc.lat_hw -1+smag_damp_run_0_2_para.oy][Proc.lon_hw -1+smag_damp_run_0_2_para.ox];
  smag_damp_run_0_2_para.statesmag_s = &state->smag_s[Proc.lev_hw - 0+smag_damp_run_0_2_para.oz][Proc.lat_hw -1+smag_damp_run_0_2_para.oy][Proc.lon_hw -1+smag_damp_run_0_2_para.ox];
  smag_damp_run_0_2_para.statekmh_lon = &state->kmh_lon[Proc.lev_hw - 0+smag_damp_run_0_2_para.oz][Proc.lat_hw -1+smag_damp_run_0_2_para.oy][Proc.lon_hw -1+smag_damp_run_0_2_para.ox];
  smag_damp_run_0_2_para.de_lon = &mesh->de_lon[0][0][0];
  smag_damp_run_0_2_para.le_lon = &mesh->le_lon[0][0][0];
  
  athread_spawn(smag_damp_run_0_2, &smag_damp_run_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runkmh_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_smag_t]);
  HaloWait(Proc,&Proc.FieldReq[async_smag_s]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_0_3_info smag_damp_run_0_3_para;
  smag_damp_run_0_3_para.lz = 32 - 0;
  smag_damp_run_0_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  smag_damp_run_0_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_0_3_para.oz = 0;
  smag_damp_run_0_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  smag_damp_run_0_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_0_3_para.hx = 1;
  smag_damp_run_0_3_para.hy = 1;
  smag_damp_run_0_3_para.hz = 0;
  smag_damp_run_0_3_para.bx = 256;
  smag_damp_run_0_3_para.by = 8;
  smag_damp_run_0_3_para.bz = 1;
  smag_damp_run_0_3_para.mx = 1;
  smag_damp_run_0_3_para.my = 2;
  smag_damp_run_0_3_para.mz = 32;
  smag_damp_run_0_3_para.statesmag_t = &state->smag_t[Proc.lev_hw - 0+smag_damp_run_0_3_para.oz][Proc.lat_hw -1+smag_damp_run_0_3_para.oy][Proc.lon_hw -1+smag_damp_run_0_3_para.ox];
  smag_damp_run_0_3_para.statesmag_s = &state->smag_s[Proc.lev_hw - 0+smag_damp_run_0_3_para.oz][Proc.lat_hw -1+smag_damp_run_0_3_para.oy][Proc.lon_hw -1+smag_damp_run_0_3_para.ox];
  smag_damp_run_0_3_para.statekmh_lat = &state->kmh_lat[Proc.lev_hw - 0+smag_damp_run_0_3_para.oz][Proc.lat_hw -1+smag_damp_run_0_3_para.oy][Proc.lon_hw -1+smag_damp_run_0_3_para.ox];
  smag_damp_run_0_3_para.le_lat = &mesh->le_lat[0][0][0];
  smag_damp_run_0_3_para.de_lat = &mesh->de_lat[0][0][0];
  
  athread_spawn(smag_damp_run_0_3, &smag_damp_run_0_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runkmh_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_0_4_info smag_damp_run_0_4_para;
  smag_damp_run_0_4_para.lz = 32 - 0;
  smag_damp_run_0_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_0_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_0_4_para.oz = 0;
  smag_damp_run_0_4_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_0_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_0_4_para.hx = 1;
  smag_damp_run_0_4_para.hy = 1;
  smag_damp_run_0_4_para.hz = 0;
  smag_damp_run_0_4_para.bx = 256;
  smag_damp_run_0_4_para.by = 8;
  smag_damp_run_0_4_para.bz = 1;
  smag_damp_run_0_4_para.mx = 1;
  smag_damp_run_0_4_para.my = 2;
  smag_damp_run_0_4_para.mz = 32;
  smag_damp_run_0_4_para.statekmh_lon = &state->kmh_lon[Proc.lev_hw - 0+smag_damp_run_0_4_para.oz][Proc.lat_hw -1+smag_damp_run_0_4_para.oy][Proc.lon_hw -1+smag_damp_run_0_4_para.ox];
  smag_damp_run_0_4_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_0_4_para.oz][Proc.lat_hw -1+smag_damp_run_0_4_para.oy][Proc.lon_hw -1+smag_damp_run_0_4_para.ox];
  smag_damp_run_0_4_para.tendsmag_dudt = &tend->smag_dudt[Proc.lev_hw - 0+smag_damp_run_0_4_para.oz][Proc.lat_hw -1+smag_damp_run_0_4_para.oy][Proc.lon_hw -1+smag_damp_run_0_4_para.ox];
  smag_damp_run_0_4_para.de_lon = &mesh->de_lon[0][0][0];
  smag_damp_run_0_4_para.de_lat = &mesh->de_lat[0][0][0];
  smag_damp_run_0_4_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  smag_damp_run_0_4_para.le_lon = &mesh->le_lon[0][0][0];
  smag_damp_run_0_4_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_0_4, &smag_damp_run_0_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_dudtTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_0_5_info smag_damp_run_0_5_para;
  smag_damp_run_0_5_para.lz = 32 - 0;
  smag_damp_run_0_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_0_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_0_5_para.oz = 0;
  smag_damp_run_0_5_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_0_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_0_5_para.hx = 1;
  smag_damp_run_0_5_para.hy = 1;
  smag_damp_run_0_5_para.hz = 0;
  smag_damp_run_0_5_para.bx = 256;
  smag_damp_run_0_5_para.by = 8;
  smag_damp_run_0_5_para.bz = 1;
  smag_damp_run_0_5_para.mx = 1;
  smag_damp_run_0_5_para.my = 2;
  smag_damp_run_0_5_para.mz = 32;
  smag_damp_run_0_5_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_0_5_para.oz][Proc.lat_hw -1+smag_damp_run_0_5_para.oy][Proc.lon_hw -1+smag_damp_run_0_5_para.ox];
  smag_damp_run_0_5_para.tendsmag_dudt = &tend->smag_dudt[Proc.lev_hw - 0+smag_damp_run_0_5_para.oz][Proc.lat_hw -1+smag_damp_run_0_5_para.oy][Proc.lon_hw -1+smag_damp_run_0_5_para.ox];
  smag_damp_run_0_5_para.dt = dt;
  
  athread_spawn(smag_damp_run_0_5, &smag_damp_run_0_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runu_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_0_6_info smag_damp_run_0_6_para;
  smag_damp_run_0_6_para.lz = 32 - 0;
  smag_damp_run_0_6_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  smag_damp_run_0_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_0_6_para.oz = 0;
  smag_damp_run_0_6_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  smag_damp_run_0_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_0_6_para.hx = 1;
  smag_damp_run_0_6_para.hy = 1;
  smag_damp_run_0_6_para.hz = 0;
  smag_damp_run_0_6_para.bx = 256;
  smag_damp_run_0_6_para.by = 8;
  smag_damp_run_0_6_para.bz = 1;
  smag_damp_run_0_6_para.mx = 1;
  smag_damp_run_0_6_para.my = 2;
  smag_damp_run_0_6_para.mz = 32;
  smag_damp_run_0_6_para.statekmh_lat = &state->kmh_lat[Proc.lev_hw - 0+smag_damp_run_0_6_para.oz][Proc.lat_hw -1+smag_damp_run_0_6_para.oy][Proc.lon_hw -1+smag_damp_run_0_6_para.ox];
  smag_damp_run_0_6_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_0_6_para.oz][Proc.lat_hw -1+smag_damp_run_0_6_para.oy][Proc.lon_hw -1+smag_damp_run_0_6_para.ox];
  smag_damp_run_0_6_para.tendsmag_dvdt = &tend->smag_dvdt[Proc.lev_hw - 0+smag_damp_run_0_6_para.oz][Proc.lat_hw -1+smag_damp_run_0_6_para.oy][Proc.lon_hw -1+smag_damp_run_0_6_para.ox];
  smag_damp_run_0_6_para.le_lat = &mesh->le_lat[0][0][0];
  
  athread_spawn(smag_damp_run_0_6, &smag_damp_run_0_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_dvdtTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_0_7_info smag_damp_run_0_7_para;
  smag_damp_run_0_7_para.lz = 32 - 0;
  smag_damp_run_0_7_para.ly = MIN(Proc.lat_end+1, 1198) - MAX(Proc.lat_beg, 1);
  smag_damp_run_0_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_0_7_para.oz = 0;
  smag_damp_run_0_7_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_0_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_0_7_para.hx = 1;
  smag_damp_run_0_7_para.hy = 1;
  smag_damp_run_0_7_para.hz = 0;
  smag_damp_run_0_7_para.bx = 256;
  smag_damp_run_0_7_para.by = 8;
  smag_damp_run_0_7_para.bz = 1;
  smag_damp_run_0_7_para.mx = 1;
  smag_damp_run_0_7_para.my = 2;
  smag_damp_run_0_7_para.mz = 32;
  smag_damp_run_0_7_para.statekmh_lat = &state->kmh_lat[Proc.lev_hw - 0+smag_damp_run_0_7_para.oz][Proc.lat_hw -1+smag_damp_run_0_7_para.oy][Proc.lon_hw -1+smag_damp_run_0_7_para.ox];
  smag_damp_run_0_7_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_0_7_para.oz][Proc.lat_hw -1+smag_damp_run_0_7_para.oy][Proc.lon_hw -1+smag_damp_run_0_7_para.ox];
  smag_damp_run_0_7_para.tendsmag_dvdt = &tend->smag_dvdt[Proc.lev_hw - 0+smag_damp_run_0_7_para.oz][Proc.lat_hw -1+smag_damp_run_0_7_para.oy][Proc.lon_hw -1+smag_damp_run_0_7_para.ox];
  smag_damp_run_0_7_para.le_lat = &mesh->le_lat[0][0][0];
  smag_damp_run_0_7_para.le_lon = &mesh->le_lon[0][0][0];
  smag_damp_run_0_7_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  smag_damp_run_0_7_para.de_lat = &mesh->de_lat[0][0][0];
  smag_damp_run_0_7_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_0_7, &smag_damp_run_0_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_dvdtTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_0_8_info smag_damp_run_0_8_para;
  smag_damp_run_0_8_para.lz = 32 - 0;
  smag_damp_run_0_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  smag_damp_run_0_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_0_8_para.oz = 0;
  smag_damp_run_0_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  smag_damp_run_0_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_0_8_para.hx = 1;
  smag_damp_run_0_8_para.hy = 1;
  smag_damp_run_0_8_para.hz = 0;
  smag_damp_run_0_8_para.bx = 256;
  smag_damp_run_0_8_para.by = 8;
  smag_damp_run_0_8_para.bz = 1;
  smag_damp_run_0_8_para.mx = 1;
  smag_damp_run_0_8_para.my = 2;
  smag_damp_run_0_8_para.mz = 32;
  smag_damp_run_0_8_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_0_8_para.oz][Proc.lat_hw -1+smag_damp_run_0_8_para.oy][Proc.lon_hw -1+smag_damp_run_0_8_para.ox];
  smag_damp_run_0_8_para.tendsmag_dvdt = &tend->smag_dvdt[Proc.lev_hw - 0+smag_damp_run_0_8_para.oz][Proc.lat_hw -1+smag_damp_run_0_8_para.oy][Proc.lon_hw -1+smag_damp_run_0_8_para.ox];
  smag_damp_run_0_8_para.dt = dt;
  
  athread_spawn(smag_damp_run_0_8, &smag_damp_run_0_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  trickypt_0_0_info trickypt_0_0_para;
  trickypt_0_0_para.lz = 32 - 0;
  trickypt_0_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  trickypt_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  trickypt_0_0_para.oz = 0;
  trickypt_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  trickypt_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  trickypt_0_0_para.hx = 2;
  trickypt_0_0_para.hy = 2;
  trickypt_0_0_para.hz = 0;
  trickypt_0_0_para.bx = 256;
  trickypt_0_0_para.by = 8;
  trickypt_0_0_para.bz = 1;
  trickypt_0_0_para.mx = 1;
  trickypt_0_0_para.my = 2;
  trickypt_0_0_para.mz = 32;
  trickypt_0_0_para.statept = &state->pt[Proc.lev_hw - 0+trickypt_0_0_para.oz][Proc.lat_hw -2+trickypt_0_0_para.oy][Proc.lon_hw -2+trickypt_0_0_para.ox];
  trickypt_0_0_para.statem = &state->m[Proc.lev_hw - 0+trickypt_0_0_para.oz][Proc.lat_hw -2+trickypt_0_0_para.oy][Proc.lon_hw -2+trickypt_0_0_para.ox];
  
  athread_spawn(trickypt_0_0, &trickypt_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  trickyptptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_phs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_On_Cell(1,0,&state->phs[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_On_CellTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_2d_D(Proc, &state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_phs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_0_21_info calc_ph_0_21_para;
  calc_ph_0_21_para.lz = 33 - 0;
  calc_ph_0_21_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_0_21_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_0_21_para.oz = 0;
  calc_ph_0_21_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_0_21_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_0_21_para.hx = 1;
  calc_ph_0_21_para.hy = 1;
  calc_ph_0_21_para.hz = 0;
  calc_ph_0_21_para.bx = 256;
  calc_ph_0_21_para.by = 8;
  calc_ph_0_21_para.bz = 1;
  calc_ph_0_21_para.mx = 1;
  calc_ph_0_21_para.my = 2;
  calc_ph_0_21_para.mz = 32;
  calc_ph_0_21_para.statephs = &state->phs[0][Proc.lat_hw -1+calc_ph_0_21_para.oy][Proc.lon_hw -1+calc_ph_0_21_para.ox];
  calc_ph_0_21_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_0_21_para.oz][Proc.lat_hw -1+calc_ph_0_21_para.oy][Proc.lon_hw -1+calc_ph_0_21_para.ox];
  calc_ph_0_21_para.hyai = &mesh->hyai[0][0][0];
  calc_ph_0_21_para.hybi = &mesh->hybi[0][0][0];
  
  athread_spawn(calc_ph_0_21, &calc_ph_0_21_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_0_22_info calc_ph_0_22_para;
  calc_ph_0_22_para.lz = 33 - 0;
  calc_ph_0_22_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_0_22_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_0_22_para.oz = 0;
  calc_ph_0_22_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_0_22_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_0_22_para.hx = 1;
  calc_ph_0_22_para.hy = 1;
  calc_ph_0_22_para.hz = 0;
  calc_ph_0_22_para.bx = 256;
  calc_ph_0_22_para.by = 8;
  calc_ph_0_22_para.bz = 1;
  calc_ph_0_22_para.mx = 1;
  calc_ph_0_22_para.my = 2;
  calc_ph_0_22_para.mz = 32;
  calc_ph_0_22_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_0_22_para.oz][Proc.lat_hw -1+calc_ph_0_22_para.oy][Proc.lon_hw -1+calc_ph_0_22_para.ox];
  calc_ph_0_22_para.stateph_exn_lev = &state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_0_22_para.oz][Proc.lat_hw -1+calc_ph_0_22_para.oy][Proc.lon_hw -1+calc_ph_0_22_para.ox];
  
  athread_spawn(calc_ph_0_22, &calc_ph_0_22_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_exn_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_0_23_info calc_ph_0_23_para;
  calc_ph_0_23_para.lz = 32 - 0;
  calc_ph_0_23_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_0_23_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_0_23_para.oz = 0;
  calc_ph_0_23_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_0_23_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_0_23_para.hx = 0;
  calc_ph_0_23_para.hy = 0;
  calc_ph_0_23_para.hz = 1;
  calc_ph_0_23_para.bx = 256;
  calc_ph_0_23_para.by = 1;
  calc_ph_0_23_para.bz = 4;
  calc_ph_0_23_para.mx = 1;
  calc_ph_0_23_para.my = 8;
  calc_ph_0_23_para.mz = 8;
  calc_ph_0_23_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_ph_0_23_para.oz][Proc.lat_hw -0+calc_ph_0_23_para.oy][Proc.lon_hw -0+calc_ph_0_23_para.ox];
  calc_ph_0_23_para.stateph = &state->ph[Proc.lev_hw - 1+calc_ph_0_23_para.oz][Proc.lat_hw -0+calc_ph_0_23_para.oy][Proc.lon_hw -0+calc_ph_0_23_para.ox];
  
  athread_spawn(calc_ph_0_23, &calc_ph_0_23_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phphTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_0_52_info calc_m_0_52_para;
  calc_m_0_52_para.lz = 32 - 0;
  calc_m_0_52_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_0_52_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_0_52_para.oz = 0;
  calc_m_0_52_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_0_52_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_0_52_para.hx = 1;
  calc_m_0_52_para.hy = 0;
  calc_m_0_52_para.hz = 1;
  calc_m_0_52_para.bx = 256;
  calc_m_0_52_para.by = 1;
  calc_m_0_52_para.bz = 4;
  calc_m_0_52_para.mx = 1;
  calc_m_0_52_para.my = 8;
  calc_m_0_52_para.mz = 8;
  calc_m_0_52_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_0_52_para.oz][Proc.lat_hw -0+calc_m_0_52_para.oy][Proc.lon_hw -1+calc_m_0_52_para.ox];
  calc_m_0_52_para.statem = &state->m[Proc.lev_hw - 1+calc_m_0_52_para.oz][Proc.lat_hw -0+calc_m_0_52_para.oy][Proc.lon_hw -1+calc_m_0_52_para.ox];
  
  athread_spawn(calc_m_0_52, &calc_m_0_52_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mmTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_0_53_info calc_m_0_53_para;
  calc_m_0_53_para.lz = 32 - 1;
  calc_m_0_53_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_0_53_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_0_53_para.oz = 1;
  calc_m_0_53_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_0_53_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_0_53_para.hx = 0;
  calc_m_0_53_para.hy = 0;
  calc_m_0_53_para.hz = 1;
  calc_m_0_53_para.bx = 256;
  calc_m_0_53_para.by = 1;
  calc_m_0_53_para.bz = 4;
  calc_m_0_53_para.mx = 1;
  calc_m_0_53_para.my = 8;
  calc_m_0_53_para.mz = 8;
  calc_m_0_53_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_0_53_para.oz][Proc.lat_hw -0+calc_m_0_53_para.oy][Proc.lon_hw -0+calc_m_0_53_para.ox];
  calc_m_0_53_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_0_53_para.oz][Proc.lat_hw -0+calc_m_0_53_para.oy][Proc.lon_hw -0+calc_m_0_53_para.ox];
  
  athread_spawn(calc_m_0_53, &calc_m_0_53_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_0_54_info calc_m_0_54_para;
  calc_m_0_54_para.lz = 1 - 0;
  calc_m_0_54_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_0_54_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_0_54_para.oz = 0;
  calc_m_0_54_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_0_54_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_0_54_para.hx = 0;
  calc_m_0_54_para.hy = 0;
  calc_m_0_54_para.hz = 0;
  calc_m_0_54_para.bx = 256;
  calc_m_0_54_para.by = 8;
  calc_m_0_54_para.bz = 1;
  calc_m_0_54_para.mx = 1;
  calc_m_0_54_para.my = 2;
  calc_m_0_54_para.mz = 32;
  calc_m_0_54_para.stateph = &state->ph[Proc.lev_hw - 0+calc_m_0_54_para.oz][Proc.lat_hw -0+calc_m_0_54_para.oy][Proc.lon_hw -0+calc_m_0_54_para.ox];
  calc_m_0_54_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_m_0_54_para.oz][Proc.lat_hw -0+calc_m_0_54_para.oy][Proc.lon_hw -0+calc_m_0_54_para.ox];
  calc_m_0_54_para.statem_lev = &state->m_lev[Proc.lev_hw - 0+calc_m_0_54_para.oz][Proc.lat_hw -0+calc_m_0_54_para.oy][Proc.lon_hw -0+calc_m_0_54_para.ox];
  
  athread_spawn(calc_m_0_54, &calc_m_0_54_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_0_55_info calc_m_0_55_para;
  calc_m_0_55_para.lz = 33 - 32;
  calc_m_0_55_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_0_55_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_0_55_para.oz = 32;
  calc_m_0_55_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_0_55_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_0_55_para.hx = 0;
  calc_m_0_55_para.hy = 0;
  calc_m_0_55_para.hz = 1;
  calc_m_0_55_para.bx = 256;
  calc_m_0_55_para.by = 1;
  calc_m_0_55_para.bz = 4;
  calc_m_0_55_para.mx = 1;
  calc_m_0_55_para.my = 8;
  calc_m_0_55_para.mz = 8;
  calc_m_0_55_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_0_55_para.oz][Proc.lat_hw -0+calc_m_0_55_para.oy][Proc.lon_hw -0+calc_m_0_55_para.ox];
  calc_m_0_55_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_0_55_para.oz][Proc.lat_hw -0+calc_m_0_55_para.oy][Proc.lon_hw -0+calc_m_0_55_para.ox];
  calc_m_0_55_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_0_55_para.oz][Proc.lat_hw -0+calc_m_0_55_para.oy][Proc.lon_hw -0+calc_m_0_55_para.ox];
  
  athread_spawn(calc_m_0_55, &calc_m_0_55_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLonEdge_0_13_info averageCellToLonEdge_0_13_para;
  averageCellToLonEdge_0_13_para.lz = 32 - 0;
  averageCellToLonEdge_0_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  averageCellToLonEdge_0_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLonEdge_0_13_para.oz = 0;
  averageCellToLonEdge_0_13_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  averageCellToLonEdge_0_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLonEdge_0_13_para.hx = 1;
  averageCellToLonEdge_0_13_para.hy = 1;
  averageCellToLonEdge_0_13_para.hz = 0;
  averageCellToLonEdge_0_13_para.bx = 256;
  averageCellToLonEdge_0_13_para.by = 8;
  averageCellToLonEdge_0_13_para.bz = 1;
  averageCellToLonEdge_0_13_para.mx = 1;
  averageCellToLonEdge_0_13_para.my = 2;
  averageCellToLonEdge_0_13_para.mz = 32;
  averageCellToLonEdge_0_13_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLonEdge_0_13_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_13_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_13_para.ox];
  averageCellToLonEdge_0_13_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_0_13_para.oz][Proc.lat_hw -1+averageCellToLonEdge_0_13_para.oy][Proc.lon_hw -1+averageCellToLonEdge_0_13_para.ox];
  
  athread_spawn(averageCellToLonEdge_0_13, &averageCellToLonEdge_0_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLatEdge_0_13_info averageCellToLatEdge_0_13_para;
  averageCellToLatEdge_0_13_para.lz = 32 - 0;
  averageCellToLatEdge_0_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  averageCellToLatEdge_0_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLatEdge_0_13_para.oz = 0;
  averageCellToLatEdge_0_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  averageCellToLatEdge_0_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLatEdge_0_13_para.hx = 1;
  averageCellToLatEdge_0_13_para.hy = 1;
  averageCellToLatEdge_0_13_para.hz = 0;
  averageCellToLatEdge_0_13_para.bx = 256;
  averageCellToLatEdge_0_13_para.by = 8;
  averageCellToLatEdge_0_13_para.bz = 1;
  averageCellToLatEdge_0_13_para.mx = 1;
  averageCellToLatEdge_0_13_para.my = 2;
  averageCellToLatEdge_0_13_para.mz = 32;
  averageCellToLatEdge_0_13_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLatEdge_0_13_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_13_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_13_para.ox];
  averageCellToLatEdge_0_13_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_0_13_para.oz][Proc.lat_hw -1+averageCellToLatEdge_0_13_para.oy][Proc.lon_hw -1+averageCellToLatEdge_0_13_para.ox];
  
  athread_spawn(averageCellToLatEdge_0_13, &averageCellToLatEdge_0_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interpCellToVtx_0_13_info interpCellToVtx_0_13_para;
  interpCellToVtx_0_13_para.lz = 32 - 0;
  interpCellToVtx_0_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interpCellToVtx_0_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interpCellToVtx_0_13_para.oz = 0;
  interpCellToVtx_0_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interpCellToVtx_0_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interpCellToVtx_0_13_para.hx = 1;
  interpCellToVtx_0_13_para.hy = 1;
  interpCellToVtx_0_13_para.hz = 0;
  interpCellToVtx_0_13_para.bx = 256;
  interpCellToVtx_0_13_para.by = 8;
  interpCellToVtx_0_13_para.bz = 1;
  interpCellToVtx_0_13_para.mx = 1;
  interpCellToVtx_0_13_para.my = 2;
  interpCellToVtx_0_13_para.mz = 32;
  interpCellToVtx_0_13_para.statem = &state->m[Proc.lev_hw - 0+interpCellToVtx_0_13_para.oz][Proc.lat_hw -1+interpCellToVtx_0_13_para.oy][Proc.lon_hw -1+interpCellToVtx_0_13_para.ox];
  interpCellToVtx_0_13_para.statem_vtx = &state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_0_13_para.oz][Proc.lat_hw -1+interpCellToVtx_0_13_para.oy][Proc.lon_hw -1+interpCellToVtx_0_13_para.ox];
  interpCellToVtx_0_13_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  interpCellToVtx_0_13_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  interpCellToVtx_0_13_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(interpCellToVtx_0_13, &interpCellToVtx_0_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_On_Cell(2,1,&state->pt[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_On_CellTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  pole_damp_run_0_0_info pole_damp_run_0_0_para;
  pole_damp_run_0_0_para.lz = 32 - 0;
  pole_damp_run_0_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  pole_damp_run_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  pole_damp_run_0_0_para.oz = 0;
  pole_damp_run_0_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  pole_damp_run_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  pole_damp_run_0_0_para.hx = 2;
  pole_damp_run_0_0_para.hy = 2;
  pole_damp_run_0_0_para.hz = 0;
  pole_damp_run_0_0_para.bx = 256;
  pole_damp_run_0_0_para.by = 8;
  pole_damp_run_0_0_para.bz = 1;
  pole_damp_run_0_0_para.mx = 1;
  pole_damp_run_0_0_para.my = 2;
  pole_damp_run_0_0_para.mz = 32;
  pole_damp_run_0_0_para.statept = &state->pt[Proc.lev_hw - 0+pole_damp_run_0_0_para.oz][Proc.lat_hw -2+pole_damp_run_0_0_para.oy][Proc.lon_hw -2+pole_damp_run_0_0_para.ox];
  pole_damp_run_0_0_para.statem = &state->m[Proc.lev_hw - 0+pole_damp_run_0_0_para.oz][Proc.lat_hw -2+pole_damp_run_0_0_para.oy][Proc.lon_hw -2+pole_damp_run_0_0_para.ox];
  
  athread_spawn(pole_damp_run_0_0, &pole_damp_run_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  pole_damp_runptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_on_lon_edge(3,&state->u_lon[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_on_lon_edgeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_on_lat_edge(3,&state->v_lat[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_on_lat_edgeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void c2a_0(struct HybridStateField* state)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  c2a_0_1_info c2a_0_1_para;
  c2a_0_1_para.lz = 32 - 0;
  c2a_0_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  c2a_0_1_para.lx = MIN(Proc.lon_end+1, 2399) - MAX(Proc.lon_beg, 0);
  c2a_0_1_para.oz = 0;
  c2a_0_1_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  c2a_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  c2a_0_1_para.hx = 1;
  c2a_0_1_para.hy = 1;
  c2a_0_1_para.hz = 0;
  c2a_0_1_para.bx = 256;
  c2a_0_1_para.by = 8;
  c2a_0_1_para.bz = 1;
  c2a_0_1_para.mx = 1;
  c2a_0_1_para.my = 2;
  c2a_0_1_para.mz = 32;
  c2a_0_1_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+c2a_0_1_para.oz][Proc.lat_hw -1+c2a_0_1_para.oy][Proc.lon_hw -1+c2a_0_1_para.ox];
  c2a_0_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+c2a_0_1_para.oz][Proc.lat_hw -1+c2a_0_1_para.oy][Proc.lon_hw -1+c2a_0_1_para.ox];
  c2a_0_1_para.stateu = &state->u[Proc.lev_hw - 0+c2a_0_1_para.oz][Proc.lat_hw -1+c2a_0_1_para.oy][Proc.lon_hw -1+c2a_0_1_para.ox];
  c2a_0_1_para.statev = &state->v[Proc.lev_hw - 0+c2a_0_1_para.oz][Proc.lat_hw -1+c2a_0_1_para.oy][Proc.lon_hw -1+c2a_0_1_para.ox];
  
  athread_spawn(c2a_0_1, &c2a_0_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  c2auTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void timeadvance_0()
{
  Time_Advance();
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Time_AdvanceTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void adv_run_0(struct HybridStateField* state_old, struct HybridStateField* state_new, struct HybridAdvField* adv, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  double cursum, cf, s1, s2, ds1, ds2, ds3;
  int k, j, i, ci, l;
  double *tmp_state_old_tmpsum, *tmp_state_new_tmpsum;
  struct Vector3 buf;
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  if (((advPara->uv_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_60_info accum_uv_cell_0_60_para;
    accum_uv_cell_0_60_para.lz = 32 - 0;
    accum_uv_cell_0_60_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_60_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_60_para.oz = 0;
    accum_uv_cell_0_60_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_60_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_60_para.hx = 1;
    accum_uv_cell_0_60_para.hy = 0;
    accum_uv_cell_0_60_para.hz = 0;
    accum_uv_cell_0_60_para.bx = 256;
    accum_uv_cell_0_60_para.by = 8;
    accum_uv_cell_0_60_para.bz = 1;
    accum_uv_cell_0_60_para.mx = 1;
    accum_uv_cell_0_60_para.my = 2;
    accum_uv_cell_0_60_para.mz = 32;
    accum_uv_cell_0_60_para.advu0 = &adv->u0[Proc.lev_hw - 0+accum_uv_cell_0_60_para.oz][Proc.lat_hw -0+accum_uv_cell_0_60_para.oy][Proc.lon_hw -1+accum_uv_cell_0_60_para.ox];
    accum_uv_cell_0_60_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_0_60_para.oz][Proc.lat_hw -0+accum_uv_cell_0_60_para.oy][Proc.lon_hw -1+accum_uv_cell_0_60_para.ox];
    
    athread_spawn(accum_uv_cell_0_60, &accum_uv_cell_0_60_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_61_info accum_uv_cell_0_61_para;
    accum_uv_cell_0_61_para.lz = 32 - 0;
    accum_uv_cell_0_61_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_61_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_61_para.oz = 0;
    accum_uv_cell_0_61_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_61_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_61_para.hx = 0;
    accum_uv_cell_0_61_para.hy = 1;
    accum_uv_cell_0_61_para.hz = 0;
    accum_uv_cell_0_61_para.bx = 256;
    accum_uv_cell_0_61_para.by = 8;
    accum_uv_cell_0_61_para.bz = 1;
    accum_uv_cell_0_61_para.mx = 1;
    accum_uv_cell_0_61_para.my = 2;
    accum_uv_cell_0_61_para.mz = 32;
    accum_uv_cell_0_61_para.advv0 = &adv->v0[Proc.lev_hw - 0+accum_uv_cell_0_61_para.oz][Proc.lat_hw -1+accum_uv_cell_0_61_para.oy][Proc.lon_hw -0+accum_uv_cell_0_61_para.ox];
    accum_uv_cell_0_61_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_0_61_para.oz][Proc.lat_hw -1+accum_uv_cell_0_61_para.oy][Proc.lon_hw -0+accum_uv_cell_0_61_para.ox];
    
    athread_spawn(accum_uv_cell_0_61, &accum_uv_cell_0_61_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->uv_step) = 1;
  }
  if (((advPara->uv_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_62_info accum_uv_cell_0_62_para;
    accum_uv_cell_0_62_para.lz = 32 - 0;
    accum_uv_cell_0_62_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_62_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_62_para.oz = 0;
    accum_uv_cell_0_62_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_62_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_62_para.hx = 1;
    accum_uv_cell_0_62_para.hy = 1;
    accum_uv_cell_0_62_para.hz = 0;
    accum_uv_cell_0_62_para.bx = 256;
    accum_uv_cell_0_62_para.by = 8;
    accum_uv_cell_0_62_para.bz = 1;
    accum_uv_cell_0_62_para.mx = 1;
    accum_uv_cell_0_62_para.my = 2;
    accum_uv_cell_0_62_para.mz = 32;
    accum_uv_cell_0_62_para.state_oldu_lon = &state_old->u_lon[Proc.lev_hw - 0+accum_uv_cell_0_62_para.oz][Proc.lat_hw -1+accum_uv_cell_0_62_para.oy][Proc.lon_hw -1+accum_uv_cell_0_62_para.ox];
    accum_uv_cell_0_62_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_0_62_para.oz][Proc.lat_hw -1+accum_uv_cell_0_62_para.oy][Proc.lon_hw -1+accum_uv_cell_0_62_para.ox];
    
    athread_spawn(accum_uv_cell_0_62, &accum_uv_cell_0_62_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_63_info accum_uv_cell_0_63_para;
    accum_uv_cell_0_63_para.lz = 32 - 0;
    accum_uv_cell_0_63_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_63_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_63_para.oz = 0;
    accum_uv_cell_0_63_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_63_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_63_para.hx = 1;
    accum_uv_cell_0_63_para.hy = 1;
    accum_uv_cell_0_63_para.hz = 0;
    accum_uv_cell_0_63_para.bx = 256;
    accum_uv_cell_0_63_para.by = 8;
    accum_uv_cell_0_63_para.bz = 1;
    accum_uv_cell_0_63_para.mx = 1;
    accum_uv_cell_0_63_para.my = 2;
    accum_uv_cell_0_63_para.mz = 32;
    accum_uv_cell_0_63_para.state_oldv_lat = &state_old->v_lat[Proc.lev_hw - 0+accum_uv_cell_0_63_para.oz][Proc.lat_hw -1+accum_uv_cell_0_63_para.oy][Proc.lon_hw -1+accum_uv_cell_0_63_para.ox];
    accum_uv_cell_0_63_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_0_63_para.oz][Proc.lat_hw -1+accum_uv_cell_0_63_para.oy][Proc.lon_hw -1+accum_uv_cell_0_63_para.ox];
    
    athread_spawn(accum_uv_cell_0_63, &accum_uv_cell_0_63_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->uv_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_64_info accum_uv_cell_0_64_para;
      accum_uv_cell_0_64_para.lz = 32 - 0;
      accum_uv_cell_0_64_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_64_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_64_para.oz = 0;
      accum_uv_cell_0_64_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_64_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_64_para.hx = 1;
      accum_uv_cell_0_64_para.hy = 1;
      accum_uv_cell_0_64_para.hz = 0;
      accum_uv_cell_0_64_para.bx = 256;
      accum_uv_cell_0_64_para.by = 8;
      accum_uv_cell_0_64_para.bz = 1;
      accum_uv_cell_0_64_para.mx = 1;
      accum_uv_cell_0_64_para.my = 2;
      accum_uv_cell_0_64_para.mz = 32;
      accum_uv_cell_0_64_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_0_64_para.oz][Proc.lat_hw -1+accum_uv_cell_0_64_para.oy][Proc.lon_hw -1+accum_uv_cell_0_64_para.ox];
      accum_uv_cell_0_64_para.state_oldu_lon = &state_old->u_lon[Proc.lev_hw - 0+accum_uv_cell_0_64_para.oz][Proc.lat_hw -1+accum_uv_cell_0_64_para.oy][Proc.lon_hw -1+accum_uv_cell_0_64_para.ox];
      accum_uv_cell_0_64_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_0_64, &accum_uv_cell_0_64_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_65_info accum_uv_cell_0_65_para;
      accum_uv_cell_0_65_para.lz = 32 - 0;
      accum_uv_cell_0_65_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_65_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_65_para.oz = 0;
      accum_uv_cell_0_65_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_65_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_65_para.hx = 1;
      accum_uv_cell_0_65_para.hy = 1;
      accum_uv_cell_0_65_para.hz = 0;
      accum_uv_cell_0_65_para.bx = 256;
      accum_uv_cell_0_65_para.by = 8;
      accum_uv_cell_0_65_para.bz = 1;
      accum_uv_cell_0_65_para.mx = 1;
      accum_uv_cell_0_65_para.my = 2;
      accum_uv_cell_0_65_para.mz = 32;
      accum_uv_cell_0_65_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_0_65_para.oz][Proc.lat_hw -1+accum_uv_cell_0_65_para.oy][Proc.lon_hw -1+accum_uv_cell_0_65_para.ox];
      accum_uv_cell_0_65_para.state_oldv_lat = &state_old->v_lat[Proc.lev_hw - 0+accum_uv_cell_0_65_para.oz][Proc.lat_hw -1+accum_uv_cell_0_65_para.oy][Proc.lon_hw -1+accum_uv_cell_0_65_para.ox];
      accum_uv_cell_0_65_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_0_65, &accum_uv_cell_0_65_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_66_info accum_uv_cell_0_66_para;
      accum_uv_cell_0_66_para.lz = 32 - 0;
      accum_uv_cell_0_66_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_66_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_66_para.oz = 0;
      accum_uv_cell_0_66_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_66_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_66_para.hx = 1;
      accum_uv_cell_0_66_para.hy = 0;
      accum_uv_cell_0_66_para.hz = 0;
      accum_uv_cell_0_66_para.bx = 256;
      accum_uv_cell_0_66_para.by = 8;
      accum_uv_cell_0_66_para.bz = 1;
      accum_uv_cell_0_66_para.mx = 1;
      accum_uv_cell_0_66_para.my = 2;
      accum_uv_cell_0_66_para.mz = 32;
      accum_uv_cell_0_66_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_0_66_para.oz][Proc.lat_hw -0+accum_uv_cell_0_66_para.oy][Proc.lon_hw -1+accum_uv_cell_0_66_para.ox];
      accum_uv_cell_0_66_para.advu0 = &adv->u0[Proc.lev_hw - 0+accum_uv_cell_0_66_para.oz][Proc.lat_hw -0+accum_uv_cell_0_66_para.oy][Proc.lon_hw -1+accum_uv_cell_0_66_para.ox];
      
      athread_spawn(accum_uv_cell_0_66, &accum_uv_cell_0_66_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellu0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_67_info accum_uv_cell_0_67_para;
      accum_uv_cell_0_67_para.lz = 32 - 0;
      accum_uv_cell_0_67_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_67_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_67_para.oz = 0;
      accum_uv_cell_0_67_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_67_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_67_para.hx = 0;
      accum_uv_cell_0_67_para.hy = 1;
      accum_uv_cell_0_67_para.hz = 0;
      accum_uv_cell_0_67_para.bx = 256;
      accum_uv_cell_0_67_para.by = 8;
      accum_uv_cell_0_67_para.bz = 1;
      accum_uv_cell_0_67_para.mx = 1;
      accum_uv_cell_0_67_para.my = 2;
      accum_uv_cell_0_67_para.mz = 32;
      accum_uv_cell_0_67_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_0_67_para.oz][Proc.lat_hw -1+accum_uv_cell_0_67_para.oy][Proc.lon_hw -0+accum_uv_cell_0_67_para.ox];
      accum_uv_cell_0_67_para.advv0 = &adv->v0[Proc.lev_hw - 0+accum_uv_cell_0_67_para.oz][Proc.lat_hw -1+accum_uv_cell_0_67_para.oy][Proc.lon_hw -0+accum_uv_cell_0_67_para.ox];
      
      athread_spawn(accum_uv_cell_0_67, &accum_uv_cell_0_67_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellv0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_68_info accum_uv_cell_0_68_para;
      accum_uv_cell_0_68_para.lz = 32 - 0;
      accum_uv_cell_0_68_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_68_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_68_para.oz = 0;
      accum_uv_cell_0_68_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_68_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_68_para.hx = 1;
      accum_uv_cell_0_68_para.hy = 1;
      accum_uv_cell_0_68_para.hz = 0;
      accum_uv_cell_0_68_para.bx = 256;
      accum_uv_cell_0_68_para.by = 8;
      accum_uv_cell_0_68_para.bz = 1;
      accum_uv_cell_0_68_para.mx = 1;
      accum_uv_cell_0_68_para.my = 2;
      accum_uv_cell_0_68_para.mz = 32;
      accum_uv_cell_0_68_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_0_68_para.oz][Proc.lat_hw -1+accum_uv_cell_0_68_para.oy][Proc.lon_hw -1+accum_uv_cell_0_68_para.ox];
      accum_uv_cell_0_68_para.state_oldu_lon = &state_old->u_lon[Proc.lev_hw - 0+accum_uv_cell_0_68_para.oz][Proc.lat_hw -1+accum_uv_cell_0_68_para.oy][Proc.lon_hw -1+accum_uv_cell_0_68_para.ox];
      
      athread_spawn(accum_uv_cell_0_68, &accum_uv_cell_0_68_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_0_69_info accum_uv_cell_0_69_para;
      accum_uv_cell_0_69_para.lz = 32 - 0;
      accum_uv_cell_0_69_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_0_69_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_0_69_para.oz = 0;
      accum_uv_cell_0_69_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_0_69_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_0_69_para.hx = 1;
      accum_uv_cell_0_69_para.hy = 1;
      accum_uv_cell_0_69_para.hz = 0;
      accum_uv_cell_0_69_para.bx = 256;
      accum_uv_cell_0_69_para.by = 8;
      accum_uv_cell_0_69_para.bz = 1;
      accum_uv_cell_0_69_para.mx = 1;
      accum_uv_cell_0_69_para.my = 2;
      accum_uv_cell_0_69_para.mz = 32;
      accum_uv_cell_0_69_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_0_69_para.oz][Proc.lat_hw -1+accum_uv_cell_0_69_para.oy][Proc.lon_hw -1+accum_uv_cell_0_69_para.ox];
      accum_uv_cell_0_69_para.state_oldv_lat = &state_old->v_lat[Proc.lev_hw - 0+accum_uv_cell_0_69_para.oz][Proc.lat_hw -1+accum_uv_cell_0_69_para.oy][Proc.lon_hw -1+accum_uv_cell_0_69_para.ox];
      
      athread_spawn(accum_uv_cell_0_69, &accum_uv_cell_0_69_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->uv_step) = 0;
  }
  else
  {
    (advPara->uv_step) = ((advPara->uv_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->uv_step) > (advPara->nstep))))
  {
    if (!(advPara->dynamic))
    {
      (advPara->uv_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_70_info accum_uv_cell_0_70_para;
    accum_uv_cell_0_70_para.lz = 32 - 0;
    accum_uv_cell_0_70_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_0_70_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_70_para.oz = 0;
    accum_uv_cell_0_70_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_0_70_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_70_para.hx = 1;
    accum_uv_cell_0_70_para.hy = 0;
    accum_uv_cell_0_70_para.hz = 0;
    accum_uv_cell_0_70_para.bx = 256;
    accum_uv_cell_0_70_para.by = 8;
    accum_uv_cell_0_70_para.bz = 1;
    accum_uv_cell_0_70_para.mx = 1;
    accum_uv_cell_0_70_para.my = 2;
    accum_uv_cell_0_70_para.mz = 32;
    accum_uv_cell_0_70_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_0_70_para.oz][Proc.lat_hw -0+accum_uv_cell_0_70_para.oy][Proc.lon_hw -1+accum_uv_cell_0_70_para.ox];
    accum_uv_cell_0_70_para.advcflx = &adv->cflx[Proc.lev_hw - 0+accum_uv_cell_0_70_para.oz][Proc.lat_hw -0+accum_uv_cell_0_70_para.oy][Proc.lon_hw -1+accum_uv_cell_0_70_para.ox];
    accum_uv_cell_0_70_para.de_lon = &mesh->de_lon[0][0][0];
    accum_uv_cell_0_70_para.dt = dt;
    
    athread_spawn(accum_uv_cell_0_70, &accum_uv_cell_0_70_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_71_info accum_uv_cell_0_71_para;
    accum_uv_cell_0_71_para.lz = 32 - 0;
    accum_uv_cell_0_71_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_71_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_71_para.oz = 0;
    accum_uv_cell_0_71_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_71_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_71_para.hx = 0;
    accum_uv_cell_0_71_para.hy = 1;
    accum_uv_cell_0_71_para.hz = 0;
    accum_uv_cell_0_71_para.bx = 256;
    accum_uv_cell_0_71_para.by = 8;
    accum_uv_cell_0_71_para.bz = 1;
    accum_uv_cell_0_71_para.mx = 1;
    accum_uv_cell_0_71_para.my = 2;
    accum_uv_cell_0_71_para.mz = 32;
    accum_uv_cell_0_71_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_0_71_para.oz][Proc.lat_hw -1+accum_uv_cell_0_71_para.oy][Proc.lon_hw -0+accum_uv_cell_0_71_para.ox];
    accum_uv_cell_0_71_para.advcfly = &adv->cfly[Proc.lev_hw - 0+accum_uv_cell_0_71_para.oz][Proc.lat_hw -1+accum_uv_cell_0_71_para.oy][Proc.lon_hw -0+accum_uv_cell_0_71_para.ox];
    accum_uv_cell_0_71_para.de_lat = &mesh->de_lat[0][0][0];
    accum_uv_cell_0_71_para.dt = dt;
    
    athread_spawn(accum_uv_cell_0_71, &accum_uv_cell_0_71_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_72_info accum_uv_cell_0_72_para;
    accum_uv_cell_0_72_para.lz = 32 - 0;
    accum_uv_cell_0_72_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_0_72_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_72_para.oz = 0;
    accum_uv_cell_0_72_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_0_72_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_72_para.hx = 1;
    accum_uv_cell_0_72_para.hy = 1;
    accum_uv_cell_0_72_para.hz = 0;
    accum_uv_cell_0_72_para.bx = 256;
    accum_uv_cell_0_72_para.by = 8;
    accum_uv_cell_0_72_para.bz = 1;
    accum_uv_cell_0_72_para.mx = 1;
    accum_uv_cell_0_72_para.my = 2;
    accum_uv_cell_0_72_para.mz = 32;
    accum_uv_cell_0_72_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_0_72_para.oz][Proc.lat_hw -1+accum_uv_cell_0_72_para.oy][Proc.lon_hw -1+accum_uv_cell_0_72_para.ox];
    accum_uv_cell_0_72_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_0_72_para.oz][Proc.lat_hw -1+accum_uv_cell_0_72_para.oy][Proc.lon_hw -1+accum_uv_cell_0_72_para.ox];
    accum_uv_cell_0_72_para.advdivx = &adv->divx[Proc.lev_hw - 0+accum_uv_cell_0_72_para.oz][Proc.lat_hw -1+accum_uv_cell_0_72_para.oy][Proc.lon_hw -1+accum_uv_cell_0_72_para.ox];
    accum_uv_cell_0_72_para.advdivy = &adv->divy[Proc.lev_hw - 0+accum_uv_cell_0_72_para.oz][Proc.lat_hw -1+accum_uv_cell_0_72_para.oy][Proc.lon_hw -1+accum_uv_cell_0_72_para.ox];
    accum_uv_cell_0_72_para.le_lon = &mesh->le_lon[0][0][0];
    accum_uv_cell_0_72_para.area_cell = &mesh->area_cell[0][0][0];
    accum_uv_cell_0_72_para.le_lat = &mesh->le_lat[0][0][0];
    
    athread_spawn(accum_uv_cell_0_72, &accum_uv_cell_0_72_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_73_info accum_uv_cell_0_73_para;
    accum_uv_cell_0_73_para.lz = 32 - 0;
    accum_uv_cell_0_73_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_73_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_73_para.oz = 0;
    accum_uv_cell_0_73_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_73_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_73_para.hx = 0;
    accum_uv_cell_0_73_para.hy = 1;
    accum_uv_cell_0_73_para.hz = 0;
    accum_uv_cell_0_73_para.bx = 256;
    accum_uv_cell_0_73_para.by = 8;
    accum_uv_cell_0_73_para.bz = 1;
    accum_uv_cell_0_73_para.mx = 1;
    accum_uv_cell_0_73_para.my = 2;
    accum_uv_cell_0_73_para.mz = 32;
    accum_uv_cell_0_73_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_0_73_para.oz][Proc.lat_hw -1+accum_uv_cell_0_73_para.oy][Proc.lon_hw -0+accum_uv_cell_0_73_para.ox];
    accum_uv_cell_0_73_para.state_oldtmpsum = &state_old->tmpsum[Proc.lev_hw - 0+accum_uv_cell_0_73_para.oz][Proc.lat_hw -1+accum_uv_cell_0_73_para.oy][Proc.lon_hw -0+accum_uv_cell_0_73_para.ox];
    
    athread_spawn(accum_uv_cell_0_73, &accum_uv_cell_0_73_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celltmpsumTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    // SumCall:state_old->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
    tmp_state_old_tmpsum = allocate_1d_array_D(32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          tmp_state_old_tmpsum[k-Proc.lev_hw]=tmp_state_old_tmpsum[k-Proc.lev_hw]+state_old->tmpsum[k][j][i];
        }
      }
    }
    Zonal_Sum_1d_D(Proc, &tmp_state_old_tmpsum,32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          state_old->tmpsum[k][j][i]=tmp_state_old_tmpsum[k-Proc.lev_hw];
        }
      }
    }
    free_1d_array_D(tmp_state_old_tmpsum,32);
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_0_74_info accum_uv_cell_0_74_para;
    accum_uv_cell_0_74_para.lz = 32 - 0;
    accum_uv_cell_0_74_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_0_74_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_0_74_para.oz = 0;
    accum_uv_cell_0_74_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_0_74_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_0_74_para.hx = 0;
    accum_uv_cell_0_74_para.hy = 0;
    accum_uv_cell_0_74_para.hz = 0;
    accum_uv_cell_0_74_para.bx = 256;
    accum_uv_cell_0_74_para.by = 8;
    accum_uv_cell_0_74_para.bz = 1;
    accum_uv_cell_0_74_para.mx = 1;
    accum_uv_cell_0_74_para.my = 2;
    accum_uv_cell_0_74_para.mz = 32;
    accum_uv_cell_0_74_para.state_oldtmpsum = &state_old->tmpsum[Proc.lev_hw - 0+accum_uv_cell_0_74_para.oz][Proc.lat_hw -0+accum_uv_cell_0_74_para.oy][Proc.lon_hw -0+accum_uv_cell_0_74_para.ox];
    accum_uv_cell_0_74_para.advdivy = &adv->divy[Proc.lev_hw - 0+accum_uv_cell_0_74_para.oz][Proc.lat_hw -0+accum_uv_cell_0_74_para.oy][Proc.lon_hw -0+accum_uv_cell_0_74_para.ox];
    accum_uv_cell_0_74_para.le_lat = &mesh->le_lat[0][0][0];
    accum_uv_cell_0_74_para.area_cell = &mesh->area_cell[0][0][0];
    
    athread_spawn(accum_uv_cell_0_74, &accum_uv_cell_0_74_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    
  }
  advPara = advPara;
  if (((advPara->mf_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          adv->mfx[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          adv->mfy[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->mf_step) = 1;
  }
  if (((advPara->mf_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_0_24_info accum_mf_cell_0_24_para;
    accum_mf_cell_0_24_para.lz = 32 - 0;
    accum_mf_cell_0_24_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_0_24_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_0_24_para.oz = 0;
    accum_mf_cell_0_24_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_0_24_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_0_24_para.hx = 1;
    accum_mf_cell_0_24_para.hy = 1;
    accum_mf_cell_0_24_para.hz = 0;
    accum_mf_cell_0_24_para.bx = 256;
    accum_mf_cell_0_24_para.by = 8;
    accum_mf_cell_0_24_para.bz = 1;
    accum_mf_cell_0_24_para.mx = 1;
    accum_mf_cell_0_24_para.my = 2;
    accum_mf_cell_0_24_para.mz = 32;
    accum_mf_cell_0_24_para.state_oldmfx_lon = &state_old->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_0_24_para.oz][Proc.lat_hw -1+accum_mf_cell_0_24_para.oy][Proc.lon_hw -1+accum_mf_cell_0_24_para.ox];
    accum_mf_cell_0_24_para.advmfx = &adv->mfx[Proc.lev_hw - 0+accum_mf_cell_0_24_para.oz][Proc.lat_hw -1+accum_mf_cell_0_24_para.oy][Proc.lon_hw -1+accum_mf_cell_0_24_para.ox];
    
    athread_spawn(accum_mf_cell_0_24, &accum_mf_cell_0_24_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_0_25_info accum_mf_cell_0_25_para;
    accum_mf_cell_0_25_para.lz = 32 - 0;
    accum_mf_cell_0_25_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_0_25_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_0_25_para.oz = 0;
    accum_mf_cell_0_25_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_0_25_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_0_25_para.hx = 1;
    accum_mf_cell_0_25_para.hy = 1;
    accum_mf_cell_0_25_para.hz = 0;
    accum_mf_cell_0_25_para.bx = 256;
    accum_mf_cell_0_25_para.by = 8;
    accum_mf_cell_0_25_para.bz = 1;
    accum_mf_cell_0_25_para.mx = 1;
    accum_mf_cell_0_25_para.my = 2;
    accum_mf_cell_0_25_para.mz = 32;
    accum_mf_cell_0_25_para.state_oldmfy_lat = &state_old->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_0_25_para.oz][Proc.lat_hw -1+accum_mf_cell_0_25_para.oy][Proc.lon_hw -1+accum_mf_cell_0_25_para.ox];
    accum_mf_cell_0_25_para.advmfy = &adv->mfy[Proc.lev_hw - 0+accum_mf_cell_0_25_para.oz][Proc.lat_hw -1+accum_mf_cell_0_25_para.oy][Proc.lon_hw -1+accum_mf_cell_0_25_para.ox];
    
    athread_spawn(accum_mf_cell_0_25, &accum_mf_cell_0_25_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->mf_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_26_info accum_mf_cell_0_26_para;
      accum_mf_cell_0_26_para.lz = 32 - 0;
      accum_mf_cell_0_26_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_26_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_26_para.oz = 0;
      accum_mf_cell_0_26_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_26_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_26_para.hx = 1;
      accum_mf_cell_0_26_para.hy = 1;
      accum_mf_cell_0_26_para.hz = 0;
      accum_mf_cell_0_26_para.bx = 256;
      accum_mf_cell_0_26_para.by = 8;
      accum_mf_cell_0_26_para.bz = 1;
      accum_mf_cell_0_26_para.mx = 1;
      accum_mf_cell_0_26_para.my = 2;
      accum_mf_cell_0_26_para.mz = 32;
      accum_mf_cell_0_26_para.advmfx = &adv->mfx[Proc.lev_hw - 0+accum_mf_cell_0_26_para.oz][Proc.lat_hw -1+accum_mf_cell_0_26_para.oy][Proc.lon_hw -1+accum_mf_cell_0_26_para.ox];
      accum_mf_cell_0_26_para.state_oldmfx_lon = &state_old->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_0_26_para.oz][Proc.lat_hw -1+accum_mf_cell_0_26_para.oy][Proc.lon_hw -1+accum_mf_cell_0_26_para.ox];
      accum_mf_cell_0_26_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_0_26, &accum_mf_cell_0_26_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_27_info accum_mf_cell_0_27_para;
      accum_mf_cell_0_27_para.lz = 32 - 0;
      accum_mf_cell_0_27_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_27_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_27_para.oz = 0;
      accum_mf_cell_0_27_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_27_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_27_para.hx = 1;
      accum_mf_cell_0_27_para.hy = 1;
      accum_mf_cell_0_27_para.hz = 0;
      accum_mf_cell_0_27_para.bx = 256;
      accum_mf_cell_0_27_para.by = 8;
      accum_mf_cell_0_27_para.bz = 1;
      accum_mf_cell_0_27_para.mx = 1;
      accum_mf_cell_0_27_para.my = 2;
      accum_mf_cell_0_27_para.mz = 32;
      accum_mf_cell_0_27_para.advmfy = &adv->mfy[Proc.lev_hw - 0+accum_mf_cell_0_27_para.oz][Proc.lat_hw -1+accum_mf_cell_0_27_para.oy][Proc.lon_hw -1+accum_mf_cell_0_27_para.ox];
      accum_mf_cell_0_27_para.state_oldmfy_lat = &state_old->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_0_27_para.oz][Proc.lat_hw -1+accum_mf_cell_0_27_para.oy][Proc.lon_hw -1+accum_mf_cell_0_27_para.ox];
      accum_mf_cell_0_27_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_0_27, &accum_mf_cell_0_27_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_28_info accum_mf_cell_0_28_para;
      accum_mf_cell_0_28_para.lz = 32 - 0;
      accum_mf_cell_0_28_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_28_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_28_para.oz = 0;
      accum_mf_cell_0_28_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_28_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_28_para.hx = 1;
      accum_mf_cell_0_28_para.hy = 1;
      accum_mf_cell_0_28_para.hz = 0;
      accum_mf_cell_0_28_para.bx = 256;
      accum_mf_cell_0_28_para.by = 8;
      accum_mf_cell_0_28_para.bz = 1;
      accum_mf_cell_0_28_para.mx = 1;
      accum_mf_cell_0_28_para.my = 2;
      accum_mf_cell_0_28_para.mz = 32;
      accum_mf_cell_0_28_para.advmfx = &adv->mfx[Proc.lev_hw - 0+accum_mf_cell_0_28_para.oz][Proc.lat_hw -1+accum_mf_cell_0_28_para.oy][Proc.lon_hw -1+accum_mf_cell_0_28_para.ox];
      accum_mf_cell_0_28_para.state_oldmfx_lon = &state_old->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_0_28_para.oz][Proc.lat_hw -1+accum_mf_cell_0_28_para.oy][Proc.lon_hw -1+accum_mf_cell_0_28_para.ox];
      
      athread_spawn(accum_mf_cell_0_28, &accum_mf_cell_0_28_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_0_29_info accum_mf_cell_0_29_para;
      accum_mf_cell_0_29_para.lz = 32 - 0;
      accum_mf_cell_0_29_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_0_29_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_0_29_para.oz = 0;
      accum_mf_cell_0_29_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_0_29_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_0_29_para.hx = 1;
      accum_mf_cell_0_29_para.hy = 1;
      accum_mf_cell_0_29_para.hz = 0;
      accum_mf_cell_0_29_para.bx = 256;
      accum_mf_cell_0_29_para.by = 8;
      accum_mf_cell_0_29_para.bz = 1;
      accum_mf_cell_0_29_para.mx = 1;
      accum_mf_cell_0_29_para.my = 2;
      accum_mf_cell_0_29_para.mz = 32;
      accum_mf_cell_0_29_para.advmfy = &adv->mfy[Proc.lev_hw - 0+accum_mf_cell_0_29_para.oz][Proc.lat_hw -1+accum_mf_cell_0_29_para.oy][Proc.lon_hw -1+accum_mf_cell_0_29_para.ox];
      accum_mf_cell_0_29_para.state_oldmfy_lat = &state_old->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_0_29_para.oz][Proc.lat_hw -1+accum_mf_cell_0_29_para.oy][Proc.lon_hw -1+accum_mf_cell_0_29_para.ox];
      
      athread_spawn(accum_mf_cell_0_29, &accum_mf_cell_0_29_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->mf_step) = 0;
  }
  else
  {
    (advPara->mf_step) = ((advPara->mf_step) + 1);
  }
  if ((!(advPara->dynamic) && ((advPara->mf_step) > (advPara->nstep))))
  {
    (advPara->mf_step) = -1;
  }
  advPara = advPara;
  dt = dt;
  if (((advPara->we_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_0_15_info accum_we_lev_0_15_para;
    accum_we_lev_0_15_para.lz = 33 - 0;
    accum_we_lev_0_15_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_0_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_0_15_para.oz = 0;
    accum_we_lev_0_15_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_0_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_0_15_para.hx = 0;
    accum_we_lev_0_15_para.hy = 0;
    accum_we_lev_0_15_para.hz = 0;
    accum_we_lev_0_15_para.bx = 256;
    accum_we_lev_0_15_para.by = 8;
    accum_we_lev_0_15_para.bz = 1;
    accum_we_lev_0_15_para.mx = 1;
    accum_we_lev_0_15_para.my = 2;
    accum_we_lev_0_15_para.mz = 32;
    accum_we_lev_0_15_para.advwe0 = &adv->we0[Proc.lev_hw - 0+accum_we_lev_0_15_para.oz][Proc.lat_hw -0+accum_we_lev_0_15_para.oy][Proc.lon_hw -0+accum_we_lev_0_15_para.ox];
    accum_we_lev_0_15_para.advm0 = &adv->m0[Proc.lev_hw - 0+accum_we_lev_0_15_para.oz][Proc.lat_hw -0+accum_we_lev_0_15_para.oy][Proc.lon_hw -0+accum_we_lev_0_15_para.ox];
    accum_we_lev_0_15_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_0_15_para.oz][Proc.lat_hw -0+accum_we_lev_0_15_para.oy][Proc.lon_hw -0+accum_we_lev_0_15_para.ox];
    accum_we_lev_0_15_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_0_15_para.oz][Proc.lat_hw -0+accum_we_lev_0_15_para.oy][Proc.lon_hw -0+accum_we_lev_0_15_para.ox];
    
    athread_spawn(accum_we_lev_0_15, &accum_we_lev_0_15_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->we_step) = 1;
  }
  if (((advPara->we_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_0_16_info accum_we_lev_0_16_para;
    accum_we_lev_0_16_para.lz = 33 - 0;
    accum_we_lev_0_16_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_0_16_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_0_16_para.oz = 0;
    accum_we_lev_0_16_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_0_16_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_0_16_para.hx = 1;
    accum_we_lev_0_16_para.hy = 1;
    accum_we_lev_0_16_para.hz = 0;
    accum_we_lev_0_16_para.bx = 256;
    accum_we_lev_0_16_para.by = 8;
    accum_we_lev_0_16_para.bz = 1;
    accum_we_lev_0_16_para.mx = 1;
    accum_we_lev_0_16_para.my = 2;
    accum_we_lev_0_16_para.mz = 32;
    accum_we_lev_0_16_para.state_oldwe_lev = &state_old->we_lev[Proc.lev_hw - 0+accum_we_lev_0_16_para.oz][Proc.lat_hw -1+accum_we_lev_0_16_para.oy][Proc.lon_hw -1+accum_we_lev_0_16_para.ox];
    accum_we_lev_0_16_para.state_oldm_lev = &state_old->m_lev[Proc.lev_hw - 0+accum_we_lev_0_16_para.oz][Proc.lat_hw -1+accum_we_lev_0_16_para.oy][Proc.lon_hw -1+accum_we_lev_0_16_para.ox];
    accum_we_lev_0_16_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_0_16_para.oz][Proc.lat_hw -1+accum_we_lev_0_16_para.oy][Proc.lon_hw -1+accum_we_lev_0_16_para.ox];
    accum_we_lev_0_16_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_0_16_para.oz][Proc.lat_hw -1+accum_we_lev_0_16_para.oy][Proc.lon_hw -1+accum_we_lev_0_16_para.ox];
    
    athread_spawn(accum_we_lev_0_16, &accum_we_lev_0_16_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->we_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_0_17_info accum_we_lev_0_17_para;
      accum_we_lev_0_17_para.lz = 33 - 0;
      accum_we_lev_0_17_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_0_17_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_0_17_para.oz = 0;
      accum_we_lev_0_17_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_0_17_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_0_17_para.hx = 1;
      accum_we_lev_0_17_para.hy = 1;
      accum_we_lev_0_17_para.hz = 0;
      accum_we_lev_0_17_para.bx = 256;
      accum_we_lev_0_17_para.by = 8;
      accum_we_lev_0_17_para.bz = 1;
      accum_we_lev_0_17_para.mx = 1;
      accum_we_lev_0_17_para.my = 2;
      accum_we_lev_0_17_para.mz = 32;
      accum_we_lev_0_17_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_0_17_para.oz][Proc.lat_hw -1+accum_we_lev_0_17_para.oy][Proc.lon_hw -1+accum_we_lev_0_17_para.ox];
      accum_we_lev_0_17_para.state_oldwe_lev = &state_old->we_lev[Proc.lev_hw - 0+accum_we_lev_0_17_para.oz][Proc.lat_hw -1+accum_we_lev_0_17_para.oy][Proc.lon_hw -1+accum_we_lev_0_17_para.ox];
      accum_we_lev_0_17_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_0_17_para.oz][Proc.lat_hw -1+accum_we_lev_0_17_para.oy][Proc.lon_hw -1+accum_we_lev_0_17_para.ox];
      accum_we_lev_0_17_para.state_oldm_lev = &state_old->m_lev[Proc.lev_hw - 0+accum_we_lev_0_17_para.oz][Proc.lat_hw -1+accum_we_lev_0_17_para.oy][Proc.lon_hw -1+accum_we_lev_0_17_para.ox];
      accum_we_lev_0_17_para.advwe0 = &adv->we0[Proc.lev_hw - 0+accum_we_lev_0_17_para.oz][Proc.lat_hw -1+accum_we_lev_0_17_para.oy][Proc.lon_hw -1+accum_we_lev_0_17_para.ox];
      accum_we_lev_0_17_para.advm0 = &adv->m0[Proc.lev_hw - 0+accum_we_lev_0_17_para.oz][Proc.lat_hw -1+accum_we_lev_0_17_para.oy][Proc.lon_hw -1+accum_we_lev_0_17_para.ox];
      accum_we_lev_0_17_para.nstep = advPara->nstep;
      
      athread_spawn(accum_we_lev_0_17, &accum_we_lev_0_17_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_0_18_info accum_we_lev_0_18_para;
      accum_we_lev_0_18_para.lz = 33 - 0;
      accum_we_lev_0_18_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_0_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_0_18_para.oz = 0;
      accum_we_lev_0_18_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_0_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_0_18_para.hx = 1;
      accum_we_lev_0_18_para.hy = 1;
      accum_we_lev_0_18_para.hz = 0;
      accum_we_lev_0_18_para.bx = 256;
      accum_we_lev_0_18_para.by = 8;
      accum_we_lev_0_18_para.bz = 1;
      accum_we_lev_0_18_para.mx = 1;
      accum_we_lev_0_18_para.my = 2;
      accum_we_lev_0_18_para.mz = 32;
      accum_we_lev_0_18_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_0_18_para.oz][Proc.lat_hw -1+accum_we_lev_0_18_para.oy][Proc.lon_hw -1+accum_we_lev_0_18_para.ox];
      accum_we_lev_0_18_para.state_oldwe_lev = &state_old->we_lev[Proc.lev_hw - 0+accum_we_lev_0_18_para.oz][Proc.lat_hw -1+accum_we_lev_0_18_para.oy][Proc.lon_hw -1+accum_we_lev_0_18_para.ox];
      accum_we_lev_0_18_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_0_18_para.oz][Proc.lat_hw -1+accum_we_lev_0_18_para.oy][Proc.lon_hw -1+accum_we_lev_0_18_para.ox];
      accum_we_lev_0_18_para.state_oldm_lev = &state_old->m_lev[Proc.lev_hw - 0+accum_we_lev_0_18_para.oz][Proc.lat_hw -1+accum_we_lev_0_18_para.oy][Proc.lon_hw -1+accum_we_lev_0_18_para.ox];
      
      athread_spawn(accum_we_lev_0_18, &accum_we_lev_0_18_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->we_step) = 0;
  }
  else
  {
    (advPara->we_step) = ((advPara->we_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->we_step) > (advPara->nstep))))
  {
    if (((advPara->dynamic) == 0))
    {
      (advPara->we_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_0_19_info accum_we_lev_0_19_para;
    accum_we_lev_0_19_para.lz = 32 - 1;
    accum_we_lev_0_19_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_0_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_0_19_para.oz = 1;
    accum_we_lev_0_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_0_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_0_19_para.hx = 0;
    accum_we_lev_0_19_para.hy = 0;
    accum_we_lev_0_19_para.hz = 0;
    accum_we_lev_0_19_para.bx = 256;
    accum_we_lev_0_19_para.by = 8;
    accum_we_lev_0_19_para.bz = 1;
    accum_we_lev_0_19_para.mx = 1;
    accum_we_lev_0_19_para.my = 2;
    accum_we_lev_0_19_para.mz = 32;
    accum_we_lev_0_19_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_0_19_para.oz][Proc.lat_hw -0+accum_we_lev_0_19_para.oy][Proc.lon_hw -0+accum_we_lev_0_19_para.ox];
    accum_we_lev_0_19_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_0_19_para.oz][Proc.lat_hw -0+accum_we_lev_0_19_para.oy][Proc.lon_hw -0+accum_we_lev_0_19_para.ox];
    accum_we_lev_0_19_para.advcflz = &adv->cflz[Proc.lev_hw - 0+accum_we_lev_0_19_para.oz][Proc.lat_hw -0+accum_we_lev_0_19_para.oy][Proc.lon_hw -0+accum_we_lev_0_19_para.ox];
    accum_we_lev_0_19_para.dt = dt;
    
    athread_spawn(accum_we_lev_0_19, &accum_we_lev_0_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levcflzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  dt = dt;
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_0_9_info hflx_ppm_inner_0_9_para;
  hflx_ppm_inner_0_9_para.lz = 32 - 0;
  hflx_ppm_inner_0_9_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_0_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_0_9_para.oz = 0;
  hflx_ppm_inner_0_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_0_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_0_9_para.hx = 2;
  hflx_ppm_inner_0_9_para.hy = 2;
  hflx_ppm_inner_0_9_para.hz = 0;
  hflx_ppm_inner_0_9_para.bx = 256;
  hflx_ppm_inner_0_9_para.by = 8;
  hflx_ppm_inner_0_9_para.bz = 1;
  hflx_ppm_inner_0_9_para.mx = 1;
  hflx_ppm_inner_0_9_para.my = 2;
  hflx_ppm_inner_0_9_para.mz = 32;
  hflx_ppm_inner_0_9_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+hflx_ppm_inner_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_9_para.ox];
  hflx_ppm_inner_0_9_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_inner_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_9_para.ox];
  hflx_ppm_inner_0_9_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_inner_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_9_para.ox];
  hflx_ppm_inner_0_9_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_inner_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_9_para.ox];
  hflx_ppm_inner_0_9_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_inner_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_9_para.ox];
  hflx_ppm_inner_0_9_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_inner_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_9_para.ox];
  hflx_ppm_inner_0_9_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_inner_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_0_9_para.ox];
  
  athread_spawn(hflx_ppm_inner_0_9, &hflx_ppm_inner_0_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_uu]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_0_10_info hflx_ppm_inner_0_10_para;
  hflx_ppm_inner_0_10_para.lz = 32 - 0;
  hflx_ppm_inner_0_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_inner_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_0_10_para.oz = 0;
  hflx_ppm_inner_0_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_inner_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_0_10_para.hx = Proc.lon_hw;
  hflx_ppm_inner_0_10_para.hy = Proc.lat_hw;
  hflx_ppm_inner_0_10_para.hz = 0;
  hflx_ppm_inner_0_10_para.bx = 64;
  hflx_ppm_inner_0_10_para.by = 1;
  hflx_ppm_inner_0_10_para.bz = 1;
  hflx_ppm_inner_0_10_para.mx = 1;
  hflx_ppm_inner_0_10_para.my = 2;
  hflx_ppm_inner_0_10_para.mz = 32;
  hflx_ppm_inner_0_10_para.advcflx = &adv->cflx[Proc.lev_hw - 0+hflx_ppm_inner_0_10_para.oz][Proc.lat_hw -hflx_ppm_inner_0_10_para.hy +hflx_ppm_inner_0_10_para.oy][Proc.lon_hw -hflx_ppm_inner_0_10_para.hx +hflx_ppm_inner_0_10_para.ox];
  hflx_ppm_inner_0_10_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+hflx_ppm_inner_0_10_para.oz][Proc.lat_hw -hflx_ppm_inner_0_10_para.hy +hflx_ppm_inner_0_10_para.oy][Proc.lon_hw -hflx_ppm_inner_0_10_para.hx +hflx_ppm_inner_0_10_para.ox];
  hflx_ppm_inner_0_10_para.advuu = &adv->uu[Proc.lev_hw - 0+hflx_ppm_inner_0_10_para.oz][Proc.lat_hw -hflx_ppm_inner_0_10_para.hy +hflx_ppm_inner_0_10_para.oy][Proc.lon_hw -hflx_ppm_inner_0_10_para.hx +hflx_ppm_inner_0_10_para.ox];
  hflx_ppm_inner_0_10_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_inner_0_10_para.oz][Proc.lat_hw -hflx_ppm_inner_0_10_para.hy +hflx_ppm_inner_0_10_para.oy][Proc.lon_hw -hflx_ppm_inner_0_10_para.hx +hflx_ppm_inner_0_10_para.ox];
  hflx_ppm_inner_0_10_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_inner_0_10_para.oz][Proc.lat_hw -hflx_ppm_inner_0_10_para.hy +hflx_ppm_inner_0_10_para.oy][Proc.lon_hw -hflx_ppm_inner_0_10_para.hx +hflx_ppm_inner_0_10_para.ox];
  hflx_ppm_inner_0_10_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_inner_0_10_para.oz][Proc.lat_hw -hflx_ppm_inner_0_10_para.hy +hflx_ppm_inner_0_10_para.oy][Proc.lon_hw -hflx_ppm_inner_0_10_para.hx +hflx_ppm_inner_0_10_para.ox];
  hflx_ppm_inner_0_10_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+hflx_ppm_inner_0_10_para.oz][Proc.lat_hw -hflx_ppm_inner_0_10_para.hy +hflx_ppm_inner_0_10_para.oy][Proc.lon_hw -hflx_ppm_inner_0_10_para.hx +hflx_ppm_inner_0_10_para.ox];
  
  athread_spawn(hflx_ppm_inner_0_10, &hflx_ppm_inner_0_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqmf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lon[0][0][0], &Proc.FieldReq[async_qmf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_vv]);
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_0_11_info hflx_ppm_inner_0_11_para;
  hflx_ppm_inner_0_11_para.lz = 32 - 0;
  hflx_ppm_inner_0_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_0_11_para.oz = 0;
  hflx_ppm_inner_0_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_0_11_para.hx = 0;
  hflx_ppm_inner_0_11_para.hy = 1;
  hflx_ppm_inner_0_11_para.hz = 0;
  hflx_ppm_inner_0_11_para.bx = 256;
  hflx_ppm_inner_0_11_para.by = 8;
  hflx_ppm_inner_0_11_para.bz = 1;
  hflx_ppm_inner_0_11_para.mx = 1;
  hflx_ppm_inner_0_11_para.my = 2;
  hflx_ppm_inner_0_11_para.mz = 32;
  hflx_ppm_inner_0_11_para.advcfly = &adv->cfly[Proc.lev_hw - 0+hflx_ppm_inner_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_11_para.ox];
  hflx_ppm_inner_0_11_para.advvv = &adv->vv[Proc.lev_hw - 0+hflx_ppm_inner_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_11_para.ox];
  hflx_ppm_inner_0_11_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_inner_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_11_para.ox];
  hflx_ppm_inner_0_11_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_inner_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_11_para.ox];
  hflx_ppm_inner_0_11_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_inner_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_11_para.ox];
  hflx_ppm_inner_0_11_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+hflx_ppm_inner_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_0_11_para.ox];
  
  athread_spawn(hflx_ppm_inner_0_11, &hflx_ppm_inner_0_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqmf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lat[0][0][0], &Proc.FieldReq[async_qmf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_0_9_info ffsl_calc_tracer_hflx_0_9_para;
  ffsl_calc_tracer_hflx_0_9_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_0_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  ffsl_calc_tracer_hflx_0_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_0_9_para.oz = 0;
  ffsl_calc_tracer_hflx_0_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_0_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_0_9_para.hx = 2;
  ffsl_calc_tracer_hflx_0_9_para.hy = 2;
  ffsl_calc_tracer_hflx_0_9_para.hz = 0;
  ffsl_calc_tracer_hflx_0_9_para.bx = 256;
  ffsl_calc_tracer_hflx_0_9_para.by = 8;
  ffsl_calc_tracer_hflx_0_9_para.bz = 1;
  ffsl_calc_tracer_hflx_0_9_para.mx = 1;
  ffsl_calc_tracer_hflx_0_9_para.my = 2;
  ffsl_calc_tracer_hflx_0_9_para.mz = 32;
  ffsl_calc_tracer_hflx_0_9_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_9_para.ox];
  ffsl_calc_tracer_hflx_0_9_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_9_para.ox];
  ffsl_calc_tracer_hflx_0_9_para.advdivx = &adv->divx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_9_para.ox];
  ffsl_calc_tracer_hflx_0_9_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_9_para.ox];
  ffsl_calc_tracer_hflx_0_9_para.advdivy = &adv->divy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_9_para.ox];
  ffsl_calc_tracer_hflx_0_9_para.advqx = &adv->qx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_9_para.ox];
  ffsl_calc_tracer_hflx_0_9_para.advqy = &adv->qy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_9_para.ox];
  ffsl_calc_tracer_hflx_0_9_para.le_lon = &mesh->le_lon[0][0][0];
  ffsl_calc_tracer_hflx_0_9_para.area_cell = &mesh->area_cell[0][0][0];
  ffsl_calc_tracer_hflx_0_9_para.le_lat = &mesh->le_lat[0][0][0];
  ffsl_calc_tracer_hflx_0_9_para.dt = dt;
  
  athread_spawn(ffsl_calc_tracer_hflx_0_9, &ffsl_calc_tracer_hflx_0_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxqxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_0_10_info ffsl_calc_tracer_hflx_0_10_para;
  ffsl_calc_tracer_hflx_0_10_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_0_10_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  ffsl_calc_tracer_hflx_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_0_10_para.oz = 0;
  ffsl_calc_tracer_hflx_0_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_0_10_para.hx = 0;
  ffsl_calc_tracer_hflx_0_10_para.hy = 1;
  ffsl_calc_tracer_hflx_0_10_para.hz = 0;
  ffsl_calc_tracer_hflx_0_10_para.bx = 256;
  ffsl_calc_tracer_hflx_0_10_para.by = 8;
  ffsl_calc_tracer_hflx_0_10_para.bz = 1;
  ffsl_calc_tracer_hflx_0_10_para.mx = 1;
  ffsl_calc_tracer_hflx_0_10_para.my = 2;
  ffsl_calc_tracer_hflx_0_10_para.mz = 32;
  ffsl_calc_tracer_hflx_0_10_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_10_para.oz][Proc.lat_hw -1+ffsl_calc_tracer_hflx_0_10_para.oy][Proc.lon_hw -0+ffsl_calc_tracer_hflx_0_10_para.ox];
  ffsl_calc_tracer_hflx_0_10_para.state_oldtmpsum = &state_old->tmpsum[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_10_para.oz][Proc.lat_hw -1+ffsl_calc_tracer_hflx_0_10_para.oy][Proc.lon_hw -0+ffsl_calc_tracer_hflx_0_10_para.ox];
  
  athread_spawn(ffsl_calc_tracer_hflx_0_10, &ffsl_calc_tracer_hflx_0_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxtmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:state_old->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
  tmp_state_old_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_state_old_tmpsum[k-Proc.lev_hw]=tmp_state_old_tmpsum[k-Proc.lev_hw]+state_old->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_state_old_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state_old->tmpsum[k][j][i]=tmp_state_old_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_state_old_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_0_11_info ffsl_calc_tracer_hflx_0_11_para;
  ffsl_calc_tracer_hflx_0_11_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_0_11_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  ffsl_calc_tracer_hflx_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_0_11_para.oz = 0;
  ffsl_calc_tracer_hflx_0_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_0_11_para.hx = 2;
  ffsl_calc_tracer_hflx_0_11_para.hy = 2;
  ffsl_calc_tracer_hflx_0_11_para.hz = 0;
  ffsl_calc_tracer_hflx_0_11_para.bx = 256;
  ffsl_calc_tracer_hflx_0_11_para.by = 8;
  ffsl_calc_tracer_hflx_0_11_para.bz = 1;
  ffsl_calc_tracer_hflx_0_11_para.mx = 1;
  ffsl_calc_tracer_hflx_0_11_para.my = 2;
  ffsl_calc_tracer_hflx_0_11_para.mz = 32;
  ffsl_calc_tracer_hflx_0_11_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_11_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_11_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_11_para.ox];
  ffsl_calc_tracer_hflx_0_11_para.state_oldtmpsum = &state_old->tmpsum[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_11_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_11_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_11_para.ox];
  ffsl_calc_tracer_hflx_0_11_para.advdivy = &adv->divy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_11_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_11_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_11_para.ox];
  ffsl_calc_tracer_hflx_0_11_para.advqx = &adv->qx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_11_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_11_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_11_para.ox];
  ffsl_calc_tracer_hflx_0_11_para.advqy = &adv->qy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_0_11_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_0_11_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_0_11_para.ox];
  ffsl_calc_tracer_hflx_0_11_para.le_lat = &mesh->le_lat[0][0][0];
  ffsl_calc_tracer_hflx_0_11_para.area_cell = &mesh->area_cell[0][0][0];
  ffsl_calc_tracer_hflx_0_11_para.dt = dt;
  
  athread_spawn(ffsl_calc_tracer_hflx_0_11, &ffsl_calc_tracer_hflx_0_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxqxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qx[0][0][0], &Proc.FieldReq[async_qx], true, true, true, false, false, true, true, true);
  UpdateHalo_3d_D(Proc, &adv->qy[0][0][0], &Proc.FieldReq[async_qy], true, true, true, true, true, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qx]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_0_9_info hflx_ppm_outer_0_9_para;
  hflx_ppm_outer_0_9_para.lz = 32 - 0;
  hflx_ppm_outer_0_9_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_0_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_0_9_para.oz = 0;
  hflx_ppm_outer_0_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_0_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_0_9_para.hx = 2;
  hflx_ppm_outer_0_9_para.hy = 2;
  hflx_ppm_outer_0_9_para.hz = 0;
  hflx_ppm_outer_0_9_para.bx = 256;
  hflx_ppm_outer_0_9_para.by = 8;
  hflx_ppm_outer_0_9_para.bz = 1;
  hflx_ppm_outer_0_9_para.mx = 1;
  hflx_ppm_outer_0_9_para.my = 2;
  hflx_ppm_outer_0_9_para.mz = 32;
  hflx_ppm_outer_0_9_para.advqy = &adv->qy[Proc.lev_hw - 0+hflx_ppm_outer_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_9_para.ox];
  hflx_ppm_outer_0_9_para.advqx = &adv->qx[Proc.lev_hw - 0+hflx_ppm_outer_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_9_para.ox];
  hflx_ppm_outer_0_9_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_outer_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_9_para.ox];
  hflx_ppm_outer_0_9_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_outer_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_9_para.ox];
  hflx_ppm_outer_0_9_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_outer_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_9_para.ox];
  hflx_ppm_outer_0_9_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_outer_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_9_para.ox];
  hflx_ppm_outer_0_9_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_outer_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_9_para.ox];
  hflx_ppm_outer_0_9_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_outer_0_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_0_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_0_9_para.ox];
  
  athread_spawn(hflx_ppm_outer_0_9, &hflx_ppm_outer_0_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_0_10_info hflx_ppm_outer_0_10_para;
  hflx_ppm_outer_0_10_para.lz = 32 - 0;
  hflx_ppm_outer_0_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_outer_0_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_0_10_para.oz = 0;
  hflx_ppm_outer_0_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_outer_0_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_0_10_para.hx = Proc.lon_hw;
  hflx_ppm_outer_0_10_para.hy = Proc.lat_hw;
  hflx_ppm_outer_0_10_para.hz = 0;
  hflx_ppm_outer_0_10_para.bx = 64;
  hflx_ppm_outer_0_10_para.by = 1;
  hflx_ppm_outer_0_10_para.bz = 1;
  hflx_ppm_outer_0_10_para.mx = 1;
  hflx_ppm_outer_0_10_para.my = 2;
  hflx_ppm_outer_0_10_para.mz = 32;
  hflx_ppm_outer_0_10_para.advcflx = &adv->cflx[Proc.lev_hw - 0+hflx_ppm_outer_0_10_para.oz][Proc.lat_hw -hflx_ppm_outer_0_10_para.hy +hflx_ppm_outer_0_10_para.oy][Proc.lon_hw -hflx_ppm_outer_0_10_para.hx +hflx_ppm_outer_0_10_para.ox];
  hflx_ppm_outer_0_10_para.advqy = &adv->qy[Proc.lev_hw - 0+hflx_ppm_outer_0_10_para.oz][Proc.lat_hw -hflx_ppm_outer_0_10_para.hy +hflx_ppm_outer_0_10_para.oy][Proc.lon_hw -hflx_ppm_outer_0_10_para.hx +hflx_ppm_outer_0_10_para.ox];
  hflx_ppm_outer_0_10_para.advmfx = &adv->mfx[Proc.lev_hw - 0+hflx_ppm_outer_0_10_para.oz][Proc.lat_hw -hflx_ppm_outer_0_10_para.hy +hflx_ppm_outer_0_10_para.oy][Proc.lon_hw -hflx_ppm_outer_0_10_para.hx +hflx_ppm_outer_0_10_para.ox];
  hflx_ppm_outer_0_10_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_outer_0_10_para.oz][Proc.lat_hw -hflx_ppm_outer_0_10_para.hy +hflx_ppm_outer_0_10_para.oy][Proc.lon_hw -hflx_ppm_outer_0_10_para.hx +hflx_ppm_outer_0_10_para.ox];
  hflx_ppm_outer_0_10_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_outer_0_10_para.oz][Proc.lat_hw -hflx_ppm_outer_0_10_para.hy +hflx_ppm_outer_0_10_para.oy][Proc.lon_hw -hflx_ppm_outer_0_10_para.hx +hflx_ppm_outer_0_10_para.ox];
  hflx_ppm_outer_0_10_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_outer_0_10_para.oz][Proc.lat_hw -hflx_ppm_outer_0_10_para.hy +hflx_ppm_outer_0_10_para.oy][Proc.lon_hw -hflx_ppm_outer_0_10_para.hx +hflx_ppm_outer_0_10_para.ox];
  hflx_ppm_outer_0_10_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+hflx_ppm_outer_0_10_para.oz][Proc.lat_hw -hflx_ppm_outer_0_10_para.hy +hflx_ppm_outer_0_10_para.oy][Proc.lon_hw -hflx_ppm_outer_0_10_para.hx +hflx_ppm_outer_0_10_para.ox];
  
  athread_spawn(hflx_ppm_outer_0_10, &hflx_ppm_outer_0_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqmf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lon[0][0][0], &Proc.FieldReq[async_qmf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_0_11_info hflx_ppm_outer_0_11_para;
  hflx_ppm_outer_0_11_para.lz = 32 - 0;
  hflx_ppm_outer_0_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_0_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_0_11_para.oz = 0;
  hflx_ppm_outer_0_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_0_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_0_11_para.hx = 0;
  hflx_ppm_outer_0_11_para.hy = 1;
  hflx_ppm_outer_0_11_para.hz = 0;
  hflx_ppm_outer_0_11_para.bx = 256;
  hflx_ppm_outer_0_11_para.by = 8;
  hflx_ppm_outer_0_11_para.bz = 1;
  hflx_ppm_outer_0_11_para.mx = 1;
  hflx_ppm_outer_0_11_para.my = 2;
  hflx_ppm_outer_0_11_para.mz = 32;
  hflx_ppm_outer_0_11_para.advcfly = &adv->cfly[Proc.lev_hw - 0+hflx_ppm_outer_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_11_para.ox];
  hflx_ppm_outer_0_11_para.advmfy = &adv->mfy[Proc.lev_hw - 0+hflx_ppm_outer_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_11_para.ox];
  hflx_ppm_outer_0_11_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_outer_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_11_para.ox];
  hflx_ppm_outer_0_11_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_outer_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_11_para.ox];
  hflx_ppm_outer_0_11_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_outer_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_11_para.ox];
  hflx_ppm_outer_0_11_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+hflx_ppm_outer_0_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_0_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_0_11_para.ox];
  
  athread_spawn(hflx_ppm_outer_0_11, &hflx_ppm_outer_0_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqmf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lat[0][0][0], &Proc.FieldReq[async_qmf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_0_0_info adv_run_0_0_para;
  adv_run_0_0_para.lz = 32 - 0;
  adv_run_0_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  adv_run_0_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_0_0_para.oz = 0;
  adv_run_0_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  adv_run_0_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_0_0_para.hx = 2;
  adv_run_0_0_para.hy = 2;
  adv_run_0_0_para.hz = 0;
  adv_run_0_0_para.bx = 256;
  adv_run_0_0_para.by = 8;
  adv_run_0_0_para.bz = 1;
  adv_run_0_0_para.mx = 1;
  adv_run_0_0_para.my = 2;
  adv_run_0_0_para.mz = 32;
  adv_run_0_0_para.advold_m = &adv->old_m[Proc.lev_hw - 0+adv_run_0_0_para.oz][Proc.lat_hw -2+adv_run_0_0_para.oy][Proc.lon_hw -2+adv_run_0_0_para.ox];
  adv_run_0_0_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+adv_run_0_0_para.oz][Proc.lat_hw -2+adv_run_0_0_para.oy][Proc.lon_hw -2+adv_run_0_0_para.ox];
  adv_run_0_0_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+adv_run_0_0_para.oz][Proc.lat_hw -2+adv_run_0_0_para.oy][Proc.lon_hw -2+adv_run_0_0_para.ox];
  adv_run_0_0_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+adv_run_0_0_para.oz][Proc.lat_hw -2+adv_run_0_0_para.oy][Proc.lon_hw -2+adv_run_0_0_para.ox];
  adv_run_0_0_para.state_newqv = &state_new->qv[Proc.lev_hw - 0+adv_run_0_0_para.oz][Proc.lat_hw -2+adv_run_0_0_para.oy][Proc.lon_hw -2+adv_run_0_0_para.ox];
  adv_run_0_0_para.le_lon = &mesh->le_lon[0][0][0];
  adv_run_0_0_para.le_lat = &mesh->le_lat[0][0][0];
  adv_run_0_0_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(adv_run_0_0, &adv_run_0_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_0_1_info adv_run_0_1_para;
  adv_run_0_1_para.lz = 32 - 0;
  adv_run_0_1_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  adv_run_0_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_0_1_para.oz = 0;
  adv_run_0_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  adv_run_0_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_0_1_para.hx = 0;
  adv_run_0_1_para.hy = 1;
  adv_run_0_1_para.hz = 0;
  adv_run_0_1_para.bx = 256;
  adv_run_0_1_para.by = 8;
  adv_run_0_1_para.bz = 1;
  adv_run_0_1_para.mx = 1;
  adv_run_0_1_para.my = 2;
  adv_run_0_1_para.mz = 32;
  adv_run_0_1_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+adv_run_0_1_para.oz][Proc.lat_hw -1+adv_run_0_1_para.oy][Proc.lon_hw -0+adv_run_0_1_para.ox];
  adv_run_0_1_para.state_newtmpsum = &state_new->tmpsum[Proc.lev_hw - 0+adv_run_0_1_para.oz][Proc.lat_hw -1+adv_run_0_1_para.oy][Proc.lon_hw -0+adv_run_0_1_para.ox];
  
  athread_spawn(adv_run_0_1, &adv_run_0_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runtmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:state_new->tmpsum.[0, 0, 32, 0, 0, 1, 1, 0, 2400]
  tmp_state_new_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_state_new_tmpsum[k-Proc.lev_hw]=tmp_state_new_tmpsum[k-Proc.lev_hw]+state_new->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_state_new_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state_new->tmpsum[k][j][i]=tmp_state_new_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_state_new_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_0_2_info adv_run_0_2_para;
  adv_run_0_2_para.lz = 32 - 0;
  adv_run_0_2_para.ly = MIN(Proc.lat_end+1, 1) - MAX(Proc.lat_beg, 0);
  adv_run_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_0_2_para.oz = 0;
  adv_run_0_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  adv_run_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_0_2_para.hx = 2;
  adv_run_0_2_para.hy = 2;
  adv_run_0_2_para.hz = 0;
  adv_run_0_2_para.bx = 256;
  adv_run_0_2_para.by = 8;
  adv_run_0_2_para.bz = 1;
  adv_run_0_2_para.mx = 1;
  adv_run_0_2_para.my = 2;
  adv_run_0_2_para.mz = 32;
  adv_run_0_2_para.advold_m = &adv->old_m[Proc.lev_hw - 0+adv_run_0_2_para.oz][Proc.lat_hw -2+adv_run_0_2_para.oy][Proc.lon_hw -2+adv_run_0_2_para.ox];
  adv_run_0_2_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+adv_run_0_2_para.oz][Proc.lat_hw -2+adv_run_0_2_para.oy][Proc.lon_hw -2+adv_run_0_2_para.ox];
  adv_run_0_2_para.state_newtmpsum = &state_new->tmpsum[Proc.lev_hw - 0+adv_run_0_2_para.oz][Proc.lat_hw -2+adv_run_0_2_para.oy][Proc.lon_hw -2+adv_run_0_2_para.ox];
  adv_run_0_2_para.state_newqv = &state_new->qv[Proc.lev_hw - 0+adv_run_0_2_para.oz][Proc.lat_hw -2+adv_run_0_2_para.oy][Proc.lon_hw -2+adv_run_0_2_para.ox];
  adv_run_0_2_para.le_lat = &mesh->le_lat[0][0][0];
  adv_run_0_2_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(adv_run_0_2, &adv_run_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_0_3_info adv_run_0_3_para;
  adv_run_0_3_para.lz = 32 - 0;
  adv_run_0_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  adv_run_0_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_0_3_para.oz = 0;
  adv_run_0_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  adv_run_0_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_0_3_para.hx = 2;
  adv_run_0_3_para.hy = 2;
  adv_run_0_3_para.hz = 0;
  adv_run_0_3_para.bx = 256;
  adv_run_0_3_para.by = 8;
  adv_run_0_3_para.bz = 1;
  adv_run_0_3_para.mx = 1;
  adv_run_0_3_para.my = 2;
  adv_run_0_3_para.mz = 32;
  adv_run_0_3_para.state_newqv = &state_new->qv[Proc.lev_hw - 0+adv_run_0_3_para.oz][Proc.lat_hw -2+adv_run_0_3_para.oy][Proc.lon_hw -2+adv_run_0_3_para.ox];
  adv_run_0_3_para.state_oldm = &state_old->m[Proc.lev_hw - 0+adv_run_0_3_para.oz][Proc.lat_hw -2+adv_run_0_3_para.oy][Proc.lon_hw -2+adv_run_0_3_para.ox];
  
  athread_spawn(adv_run_0_3, &adv_run_0_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        buf = ppm(state_new->qv[(k - 2)][j][i],state_new->qv[(k - 1)][j][i],state_new->qv[k][j][i],state_new->qv[(k + 1)][j][i],state_new->qv[(k + 2)][j][i]);
        adv->qlx[k][j][i] = buf.x;
        adv->dqx[k][j][i] = buf.y;
        adv->q6x[k][j][i] = buf.z;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=1+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        ci = (int)(adv->cflz[k][j][i]);
        cf = (adv->cflz[k][j][i] - ci);
        if ((adv->cflz[k][j][i] > 0))
        {
          s1 = (1.0 - cf);
          s2 = 1.0;
          ds1 = (s2 - s1);
          ds2 = (pow(s2,2) - pow(s1,2));
          ds3 = (pow(s2,3) - pow(s1,3));
          cursum = 0.0;
          for (l=(k - ci);l<((k - 1) + 1);l+=1){
            cursum = (cursum + state_new->qv[l][j][i]);
          }
          adv->qmf_lev[k][j][i] = ((adv->we[k][j][i] * (((cursum + (adv->qlx[((k - ci) - 1)][j][i] * ds1)) + ((0.5 * adv->dqx[((k - ci) - 1)][j][i]) * ds2)) + (adv->q6x[((k - ci) - 1)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / adv->cflz[k][j][i]);
        }
        else
        {
          if ((adv->cflz[k][j][i] < 0))
          {
            s1 = 0.0;
            s2 = -cf;
            ds1 = (s2 - s1);
            ds2 = (pow(s2,2) - pow(s1,2));
            ds3 = (pow(s2,3) - pow(s1,3));
            for (l=k;l<(((k - ci) - 1) + 1);l+=1){
              cursum = (cursum + state_new->qv[l][j][i]);
            }
            adv->qmf_lev[k][j][i] = ((-adv->we[k][j][i] * (((cursum + (adv->qlx[(k - ci)][j][i] * ds1)) + ((0.5 * adv->dqx[(k - ci)][j][i]) * ds2)) + (adv->q6x[(k - ci)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / adv->cflz[k][j][i]);
          }
          else
          {
            adv->qmf_lev[k][j][i] = 0.0;
          }
        }
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmqmf_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_0_4_info adv_run_0_4_para;
  adv_run_0_4_para.lz = 32 - 0;
  adv_run_0_4_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  adv_run_0_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_0_4_para.oz = 0;
  adv_run_0_4_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  adv_run_0_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_0_4_para.hx = 2;
  adv_run_0_4_para.hy = 0;
  adv_run_0_4_para.hz = 2;
  adv_run_0_4_para.bx = 256;
  adv_run_0_4_para.by = 1;
  adv_run_0_4_para.bz = 4;
  adv_run_0_4_para.mx = 1;
  adv_run_0_4_para.my = 8;
  adv_run_0_4_para.mz = 8;
  adv_run_0_4_para.state_newqv = &state_new->qv[Proc.lev_hw - 2+adv_run_0_4_para.oz][Proc.lat_hw -0+adv_run_0_4_para.oy][Proc.lon_hw -2+adv_run_0_4_para.ox];
  adv_run_0_4_para.state_oldm = &state_old->m[Proc.lev_hw - 2+adv_run_0_4_para.oz][Proc.lat_hw -0+adv_run_0_4_para.oy][Proc.lon_hw -2+adv_run_0_4_para.ox];
  adv_run_0_4_para.advqmf_lev = &adv->qmf_lev[Proc.lev_hw - 2+adv_run_0_4_para.oz][Proc.lat_hw -0+adv_run_0_4_para.oy][Proc.lon_hw -2+adv_run_0_4_para.ox];
  
  athread_spawn(adv_run_0_4, &adv_run_0_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_On_Cell(1,1,&state_new->qv[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_On_CellTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state_new->qv[0][0][0], &Proc.FieldReq[async_qv], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_0_5_info adv_run_0_5_para;
  adv_run_0_5_para.lz = 32 - 0;
  adv_run_0_5_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  adv_run_0_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_0_5_para.oz = 0;
  adv_run_0_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  adv_run_0_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_0_5_para.hx = 2;
  adv_run_0_5_para.hy = 2;
  adv_run_0_5_para.hz = 0;
  adv_run_0_5_para.bx = 256;
  adv_run_0_5_para.by = 8;
  adv_run_0_5_para.bz = 1;
  adv_run_0_5_para.mx = 1;
  adv_run_0_5_para.my = 2;
  adv_run_0_5_para.mz = 32;
  adv_run_0_5_para.state_newqv = &state_new->qv[Proc.lev_hw - 0+adv_run_0_5_para.oz][Proc.lat_hw -2+adv_run_0_5_para.oy][Proc.lon_hw -2+adv_run_0_5_para.ox];
  adv_run_0_5_para.state_oldm = &state_old->m[Proc.lev_hw - 0+adv_run_0_5_para.oz][Proc.lat_hw -2+adv_run_0_5_para.oy][Proc.lon_hw -2+adv_run_0_5_para.ox];
  
  athread_spawn(adv_run_0_5, &adv_run_0_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state_new->qv[0][0][0], &Proc.FieldReq[async_qv], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  copy_old_m_0_2_info copy_old_m_0_2_para;
  copy_old_m_0_2_para.lz = 32 - 0;
  copy_old_m_0_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  copy_old_m_0_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  copy_old_m_0_2_para.oz = 0;
  copy_old_m_0_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  copy_old_m_0_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  copy_old_m_0_2_para.hx = 1;
  copy_old_m_0_2_para.hy = 1;
  copy_old_m_0_2_para.hz = 0;
  copy_old_m_0_2_para.bx = 256;
  copy_old_m_0_2_para.by = 8;
  copy_old_m_0_2_para.bz = 1;
  copy_old_m_0_2_para.mx = 1;
  copy_old_m_0_2_para.my = 2;
  copy_old_m_0_2_para.mz = 32;
  copy_old_m_0_2_para.state_oldm = &state_old->m[Proc.lev_hw - 0+copy_old_m_0_2_para.oz][Proc.lat_hw -1+copy_old_m_0_2_para.oy][Proc.lon_hw -1+copy_old_m_0_2_para.ox];
  copy_old_m_0_2_para.advold_m = &adv->old_m[Proc.lev_hw - 0+copy_old_m_0_2_para.oz][Proc.lat_hw -1+copy_old_m_0_2_para.oy][Proc.lon_hw -1+copy_old_m_0_2_para.ox];
  
  athread_spawn(copy_old_m_0_2, &copy_old_m_0_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  copy_old_mold_mTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void Diagnose_State_0(struct HybridStateField* state)
{
  Diagnose(state,10);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  DiagnoseTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void ncIO_Read_1(struct HybridStateField* state, struct HybridStaticField* staticv)
{
  int nid;
  nid = ncOpenFile("gmcore.restart.DSL.15.nc",0);
  ncGetVar(nid, "u_lon", 0, 32, Proc.lev_hw, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.half_nlon, Proc.lon_hw, &(state->u_lon[0][0][0]));
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  
  ncGetVar(nid, "v_lat", 0, 32, Proc.lev_hw, Proc.lat_beg, Proc.half_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(state->v_lat[0][0][0]));
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  
  ncGetVar(nid, "pt", 0, 32, Proc.lev_hw, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(state->pt[0][0][0]));
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  
  ncGetVar(nid, "phs", 0, 1, 0, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(state->phs[0][0][0]));
  UpdateHalo_2d_D(Proc, &state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
  
  ncGetVar(nid, "gzs", 0, 1, 0, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(staticv->gzs[0][0][0]));
  UpdateHalo_2d_D(Proc, &staticv->gzs[0][0][0], &Proc.FieldReq[async_gzs], true, true, true, true, true, true, false);
  
  ncCloseFile(nid);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ncCloseFileTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void spaceOperatorInit_1(struct HybridStaticField* staticv, struct HybridMeshField* mesh)
{
  int j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=MAX(Proc.lat_beg, 1)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
    for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
      staticv->dzsdlon[0][j][i] = (((staticv->gzs[0][j][(i + 1)] - staticv->gzs[0][j][i]) / 9.80616) / mesh->de_lon[0][j][0]);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  prepareStaticdzsdlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
    for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
      staticv->dzsdlat[0][j][i] = (((staticv->gzs[0][(j + 1)][i] - staticv->gzs[0][j][i]) / 9.80616) / mesh->de_lat[0][j][0]);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  prepareStaticdzsdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void gzlevInit_1(struct HybridStateField* state, struct HybridStaticField* staticv)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=32+Proc.lev_hw; k<33+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->gz_lev[k][j][i] = staticv->gzs[0][j][i];
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  preparegzlevgz_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_2d_D(Proc, &state->gz_lev[32 + Proc.lev_hw][0][0], &Proc.FieldReq[async_gz_lev], true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void uvInit_1(struct HybridStateField* state)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  c2a_1_0_info c2a_1_0_para;
  c2a_1_0_para.lz = 32 - 0;
  c2a_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  c2a_1_0_para.lx = MIN(Proc.lon_end+1, 2399) - MAX(Proc.lon_beg, 0);
  c2a_1_0_para.oz = 0;
  c2a_1_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  c2a_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  c2a_1_0_para.hx = 1;
  c2a_1_0_para.hy = 1;
  c2a_1_0_para.hz = 0;
  c2a_1_0_para.bx = 256;
  c2a_1_0_para.by = 8;
  c2a_1_0_para.bz = 1;
  c2a_1_0_para.mx = 1;
  c2a_1_0_para.my = 2;
  c2a_1_0_para.mz = 32;
  c2a_1_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+c2a_1_0_para.oz][Proc.lat_hw -1+c2a_1_0_para.oy][Proc.lon_hw -1+c2a_1_0_para.ox];
  c2a_1_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+c2a_1_0_para.oz][Proc.lat_hw -1+c2a_1_0_para.oy][Proc.lon_hw -1+c2a_1_0_para.ox];
  c2a_1_0_para.stateu = &state->u[Proc.lev_hw - 0+c2a_1_0_para.oz][Proc.lat_hw -1+c2a_1_0_para.oy][Proc.lon_hw -1+c2a_1_0_para.ox];
  c2a_1_0_para.statev = &state->v[Proc.lev_hw - 0+c2a_1_0_para.oz][Proc.lat_hw -1+c2a_1_0_para.oy][Proc.lon_hw -1+c2a_1_0_para.ox];
  
  athread_spawn(c2a_1_0, &c2a_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  c2auTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void operatorPrepareNull_1(struct HybridStateField* state, struct HybridStaticField* staticv, struct HybridAdvField* advpt, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  int k, j, i, l;
  double b, dgz;
  struct Vector4 ke_vtx;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_phs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_1_0_info calc_ph_1_0_para;
  calc_ph_1_0_para.lz = 33 - 0;
  calc_ph_1_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_1_0_para.oz = 0;
  calc_ph_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_1_0_para.hx = 1;
  calc_ph_1_0_para.hy = 1;
  calc_ph_1_0_para.hz = 0;
  calc_ph_1_0_para.bx = 256;
  calc_ph_1_0_para.by = 8;
  calc_ph_1_0_para.bz = 1;
  calc_ph_1_0_para.mx = 1;
  calc_ph_1_0_para.my = 2;
  calc_ph_1_0_para.mz = 32;
  calc_ph_1_0_para.statephs = &state->phs[0][Proc.lat_hw -1+calc_ph_1_0_para.oy][Proc.lon_hw -1+calc_ph_1_0_para.ox];
  calc_ph_1_0_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_1_0_para.oz][Proc.lat_hw -1+calc_ph_1_0_para.oy][Proc.lon_hw -1+calc_ph_1_0_para.ox];
  calc_ph_1_0_para.hyai = &mesh->hyai[0][0][0];
  calc_ph_1_0_para.hybi = &mesh->hybi[0][0][0];
  
  athread_spawn(calc_ph_1_0, &calc_ph_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_1_1_info calc_ph_1_1_para;
  calc_ph_1_1_para.lz = 33 - 0;
  calc_ph_1_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_1_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_1_1_para.oz = 0;
  calc_ph_1_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_1_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_1_1_para.hx = 1;
  calc_ph_1_1_para.hy = 1;
  calc_ph_1_1_para.hz = 0;
  calc_ph_1_1_para.bx = 256;
  calc_ph_1_1_para.by = 8;
  calc_ph_1_1_para.bz = 1;
  calc_ph_1_1_para.mx = 1;
  calc_ph_1_1_para.my = 2;
  calc_ph_1_1_para.mz = 32;
  calc_ph_1_1_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_1_1_para.oz][Proc.lat_hw -1+calc_ph_1_1_para.oy][Proc.lon_hw -1+calc_ph_1_1_para.ox];
  calc_ph_1_1_para.stateph_exn_lev = &state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_1_1_para.oz][Proc.lat_hw -1+calc_ph_1_1_para.oy][Proc.lon_hw -1+calc_ph_1_1_para.ox];
  
  athread_spawn(calc_ph_1_1, &calc_ph_1_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_exn_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_1_2_info calc_ph_1_2_para;
  calc_ph_1_2_para.lz = 32 - 0;
  calc_ph_1_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_1_2_para.oz = 0;
  calc_ph_1_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_1_2_para.hx = 0;
  calc_ph_1_2_para.hy = 0;
  calc_ph_1_2_para.hz = 1;
  calc_ph_1_2_para.bx = 256;
  calc_ph_1_2_para.by = 1;
  calc_ph_1_2_para.bz = 4;
  calc_ph_1_2_para.mx = 1;
  calc_ph_1_2_para.my = 8;
  calc_ph_1_2_para.mz = 8;
  calc_ph_1_2_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_ph_1_2_para.oz][Proc.lat_hw -0+calc_ph_1_2_para.oy][Proc.lon_hw -0+calc_ph_1_2_para.ox];
  calc_ph_1_2_para.stateph = &state->ph[Proc.lev_hw - 1+calc_ph_1_2_para.oz][Proc.lat_hw -0+calc_ph_1_2_para.oy][Proc.lon_hw -0+calc_ph_1_2_para.ox];
  
  athread_spawn(calc_ph_1_2, &calc_ph_1_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phphTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_1_0_info calc_m_1_0_para;
  calc_m_1_0_para.lz = 32 - 0;
  calc_m_1_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_1_0_para.oz = 0;
  calc_m_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_1_0_para.hx = 1;
  calc_m_1_0_para.hy = 0;
  calc_m_1_0_para.hz = 1;
  calc_m_1_0_para.bx = 256;
  calc_m_1_0_para.by = 1;
  calc_m_1_0_para.bz = 4;
  calc_m_1_0_para.mx = 1;
  calc_m_1_0_para.my = 8;
  calc_m_1_0_para.mz = 8;
  calc_m_1_0_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_1_0_para.oz][Proc.lat_hw -0+calc_m_1_0_para.oy][Proc.lon_hw -1+calc_m_1_0_para.ox];
  calc_m_1_0_para.statem = &state->m[Proc.lev_hw - 1+calc_m_1_0_para.oz][Proc.lat_hw -0+calc_m_1_0_para.oy][Proc.lon_hw -1+calc_m_1_0_para.ox];
  
  athread_spawn(calc_m_1_0, &calc_m_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mmTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_1_1_info calc_m_1_1_para;
  calc_m_1_1_para.lz = 32 - 1;
  calc_m_1_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_1_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_1_1_para.oz = 1;
  calc_m_1_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_1_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_1_1_para.hx = 0;
  calc_m_1_1_para.hy = 0;
  calc_m_1_1_para.hz = 1;
  calc_m_1_1_para.bx = 256;
  calc_m_1_1_para.by = 1;
  calc_m_1_1_para.bz = 4;
  calc_m_1_1_para.mx = 1;
  calc_m_1_1_para.my = 8;
  calc_m_1_1_para.mz = 8;
  calc_m_1_1_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_1_1_para.oz][Proc.lat_hw -0+calc_m_1_1_para.oy][Proc.lon_hw -0+calc_m_1_1_para.ox];
  calc_m_1_1_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_1_1_para.oz][Proc.lat_hw -0+calc_m_1_1_para.oy][Proc.lon_hw -0+calc_m_1_1_para.ox];
  
  athread_spawn(calc_m_1_1, &calc_m_1_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_1_2_info calc_m_1_2_para;
  calc_m_1_2_para.lz = 1 - 0;
  calc_m_1_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_1_2_para.oz = 0;
  calc_m_1_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_1_2_para.hx = 0;
  calc_m_1_2_para.hy = 0;
  calc_m_1_2_para.hz = 0;
  calc_m_1_2_para.bx = 256;
  calc_m_1_2_para.by = 8;
  calc_m_1_2_para.bz = 1;
  calc_m_1_2_para.mx = 1;
  calc_m_1_2_para.my = 2;
  calc_m_1_2_para.mz = 32;
  calc_m_1_2_para.stateph = &state->ph[Proc.lev_hw - 0+calc_m_1_2_para.oz][Proc.lat_hw -0+calc_m_1_2_para.oy][Proc.lon_hw -0+calc_m_1_2_para.ox];
  calc_m_1_2_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_m_1_2_para.oz][Proc.lat_hw -0+calc_m_1_2_para.oy][Proc.lon_hw -0+calc_m_1_2_para.ox];
  calc_m_1_2_para.statem_lev = &state->m_lev[Proc.lev_hw - 0+calc_m_1_2_para.oz][Proc.lat_hw -0+calc_m_1_2_para.oy][Proc.lon_hw -0+calc_m_1_2_para.ox];
  
  athread_spawn(calc_m_1_2, &calc_m_1_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_1_3_info calc_m_1_3_para;
  calc_m_1_3_para.lz = 33 - 32;
  calc_m_1_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_1_3_para.oz = 32;
  calc_m_1_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_1_3_para.hx = 0;
  calc_m_1_3_para.hy = 0;
  calc_m_1_3_para.hz = 1;
  calc_m_1_3_para.bx = 256;
  calc_m_1_3_para.by = 1;
  calc_m_1_3_para.bz = 4;
  calc_m_1_3_para.mx = 1;
  calc_m_1_3_para.my = 8;
  calc_m_1_3_para.mz = 8;
  calc_m_1_3_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_1_3_para.oz][Proc.lat_hw -0+calc_m_1_3_para.oy][Proc.lon_hw -0+calc_m_1_3_para.ox];
  calc_m_1_3_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_1_3_para.oz][Proc.lat_hw -0+calc_m_1_3_para.oy][Proc.lon_hw -0+calc_m_1_3_para.ox];
  calc_m_1_3_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_1_3_para.oz][Proc.lat_hw -0+calc_m_1_3_para.oy][Proc.lon_hw -0+calc_m_1_3_para.ox];
  
  athread_spawn(calc_m_1_3, &calc_m_1_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLonEdge_1_0_info averageCellToLonEdge_1_0_para;
  averageCellToLonEdge_1_0_para.lz = 32 - 0;
  averageCellToLonEdge_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  averageCellToLonEdge_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLonEdge_1_0_para.oz = 0;
  averageCellToLonEdge_1_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  averageCellToLonEdge_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLonEdge_1_0_para.hx = 1;
  averageCellToLonEdge_1_0_para.hy = 1;
  averageCellToLonEdge_1_0_para.hz = 0;
  averageCellToLonEdge_1_0_para.bx = 256;
  averageCellToLonEdge_1_0_para.by = 8;
  averageCellToLonEdge_1_0_para.bz = 1;
  averageCellToLonEdge_1_0_para.mx = 1;
  averageCellToLonEdge_1_0_para.my = 2;
  averageCellToLonEdge_1_0_para.mz = 32;
  averageCellToLonEdge_1_0_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLonEdge_1_0_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_0_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_0_para.ox];
  averageCellToLonEdge_1_0_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_1_0_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_0_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_0_para.ox];
  
  athread_spawn(averageCellToLonEdge_1_0, &averageCellToLonEdge_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLatEdge_1_0_info averageCellToLatEdge_1_0_para;
  averageCellToLatEdge_1_0_para.lz = 32 - 0;
  averageCellToLatEdge_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  averageCellToLatEdge_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLatEdge_1_0_para.oz = 0;
  averageCellToLatEdge_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  averageCellToLatEdge_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLatEdge_1_0_para.hx = 1;
  averageCellToLatEdge_1_0_para.hy = 1;
  averageCellToLatEdge_1_0_para.hz = 0;
  averageCellToLatEdge_1_0_para.bx = 256;
  averageCellToLatEdge_1_0_para.by = 8;
  averageCellToLatEdge_1_0_para.bz = 1;
  averageCellToLatEdge_1_0_para.mx = 1;
  averageCellToLatEdge_1_0_para.my = 2;
  averageCellToLatEdge_1_0_para.mz = 32;
  averageCellToLatEdge_1_0_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLatEdge_1_0_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_0_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_0_para.ox];
  averageCellToLatEdge_1_0_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_1_0_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_0_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_0_para.ox];
  
  athread_spawn(averageCellToLatEdge_1_0, &averageCellToLatEdge_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interpCellToVtx_1_0_info interpCellToVtx_1_0_para;
  interpCellToVtx_1_0_para.lz = 32 - 0;
  interpCellToVtx_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interpCellToVtx_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interpCellToVtx_1_0_para.oz = 0;
  interpCellToVtx_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interpCellToVtx_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interpCellToVtx_1_0_para.hx = 1;
  interpCellToVtx_1_0_para.hy = 1;
  interpCellToVtx_1_0_para.hz = 0;
  interpCellToVtx_1_0_para.bx = 256;
  interpCellToVtx_1_0_para.by = 8;
  interpCellToVtx_1_0_para.bz = 1;
  interpCellToVtx_1_0_para.mx = 1;
  interpCellToVtx_1_0_para.my = 2;
  interpCellToVtx_1_0_para.mz = 32;
  interpCellToVtx_1_0_para.statem = &state->m[Proc.lev_hw - 0+interpCellToVtx_1_0_para.oz][Proc.lat_hw -1+interpCellToVtx_1_0_para.oy][Proc.lon_hw -1+interpCellToVtx_1_0_para.ox];
  interpCellToVtx_1_0_para.statem_vtx = &state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_1_0_para.oz][Proc.lat_hw -1+interpCellToVtx_1_0_para.oy][Proc.lon_hw -1+interpCellToVtx_1_0_para.ox];
  interpCellToVtx_1_0_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  interpCellToVtx_1_0_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  interpCellToVtx_1_0_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(interpCellToVtx_1_0, &interpCellToVtx_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_t_1_0_info calc_t_1_0_para;
  calc_t_1_0_para.lz = 32 - 0;
  calc_t_1_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_t_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_t_1_0_para.oz = 0;
  calc_t_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_t_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_t_1_0_para.hx = 2;
  calc_t_1_0_para.hy = 2;
  calc_t_1_0_para.hz = 0;
  calc_t_1_0_para.bx = 256;
  calc_t_1_0_para.by = 8;
  calc_t_1_0_para.bz = 1;
  calc_t_1_0_para.mx = 1;
  calc_t_1_0_para.my = 2;
  calc_t_1_0_para.mz = 32;
  calc_t_1_0_para.statept = &state->pt[Proc.lev_hw - 0+calc_t_1_0_para.oz][Proc.lat_hw -2+calc_t_1_0_para.oy][Proc.lon_hw -2+calc_t_1_0_para.ox];
  calc_t_1_0_para.stateph = &state->ph[Proc.lev_hw - 0+calc_t_1_0_para.oz][Proc.lat_hw -2+calc_t_1_0_para.oy][Proc.lon_hw -2+calc_t_1_0_para.ox];
  calc_t_1_0_para.stateqv = &state->qv[Proc.lev_hw - 0+calc_t_1_0_para.oz][Proc.lat_hw -2+calc_t_1_0_para.oy][Proc.lon_hw -2+calc_t_1_0_para.ox];
  calc_t_1_0_para.statet = &state->t[Proc.lev_hw - 0+calc_t_1_0_para.oz][Proc.lat_hw -2+calc_t_1_0_para.oy][Proc.lon_hw -2+calc_t_1_0_para.ox];
  
  athread_spawn(calc_t_1_0, &calc_t_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_ttTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  if (((advPara->uv_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_0_info accum_uv_cell_1_0_para;
    accum_uv_cell_1_0_para.lz = 32 - 0;
    accum_uv_cell_1_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_0_para.oz = 0;
    accum_uv_cell_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_0_para.hx = 1;
    accum_uv_cell_1_0_para.hy = 0;
    accum_uv_cell_1_0_para.hz = 0;
    accum_uv_cell_1_0_para.bx = 256;
    accum_uv_cell_1_0_para.by = 8;
    accum_uv_cell_1_0_para.bz = 1;
    accum_uv_cell_1_0_para.mx = 1;
    accum_uv_cell_1_0_para.my = 2;
    accum_uv_cell_1_0_para.mz = 32;
    accum_uv_cell_1_0_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_1_0_para.oz][Proc.lat_hw -0+accum_uv_cell_1_0_para.oy][Proc.lon_hw -1+accum_uv_cell_1_0_para.ox];
    accum_uv_cell_1_0_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_0_para.oz][Proc.lat_hw -0+accum_uv_cell_1_0_para.oy][Proc.lon_hw -1+accum_uv_cell_1_0_para.ox];
    
    athread_spawn(accum_uv_cell_1_0, &accum_uv_cell_1_0_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_1_info accum_uv_cell_1_1_para;
    accum_uv_cell_1_1_para.lz = 32 - 0;
    accum_uv_cell_1_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_1_para.oz = 0;
    accum_uv_cell_1_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_1_para.hx = 0;
    accum_uv_cell_1_1_para.hy = 1;
    accum_uv_cell_1_1_para.hz = 0;
    accum_uv_cell_1_1_para.bx = 256;
    accum_uv_cell_1_1_para.by = 8;
    accum_uv_cell_1_1_para.bz = 1;
    accum_uv_cell_1_1_para.mx = 1;
    accum_uv_cell_1_1_para.my = 2;
    accum_uv_cell_1_1_para.mz = 32;
    accum_uv_cell_1_1_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_1_1_para.oz][Proc.lat_hw -1+accum_uv_cell_1_1_para.oy][Proc.lon_hw -0+accum_uv_cell_1_1_para.ox];
    accum_uv_cell_1_1_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_1_para.oz][Proc.lat_hw -1+accum_uv_cell_1_1_para.oy][Proc.lon_hw -0+accum_uv_cell_1_1_para.ox];
    
    athread_spawn(accum_uv_cell_1_1, &accum_uv_cell_1_1_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->uv_step) = 1;
  }
  if (((advPara->uv_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_2_info accum_uv_cell_1_2_para;
    accum_uv_cell_1_2_para.lz = 32 - 0;
    accum_uv_cell_1_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_2_para.oz = 0;
    accum_uv_cell_1_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_2_para.hx = 1;
    accum_uv_cell_1_2_para.hy = 1;
    accum_uv_cell_1_2_para.hz = 0;
    accum_uv_cell_1_2_para.bx = 256;
    accum_uv_cell_1_2_para.by = 8;
    accum_uv_cell_1_2_para.bz = 1;
    accum_uv_cell_1_2_para.mx = 1;
    accum_uv_cell_1_2_para.my = 2;
    accum_uv_cell_1_2_para.mz = 32;
    accum_uv_cell_1_2_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+accum_uv_cell_1_2_para.oz][Proc.lat_hw -1+accum_uv_cell_1_2_para.oy][Proc.lon_hw -1+accum_uv_cell_1_2_para.ox];
    accum_uv_cell_1_2_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_2_para.oz][Proc.lat_hw -1+accum_uv_cell_1_2_para.oy][Proc.lon_hw -1+accum_uv_cell_1_2_para.ox];
    
    athread_spawn(accum_uv_cell_1_2, &accum_uv_cell_1_2_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_3_info accum_uv_cell_1_3_para;
    accum_uv_cell_1_3_para.lz = 32 - 0;
    accum_uv_cell_1_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_3_para.oz = 0;
    accum_uv_cell_1_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_3_para.hx = 1;
    accum_uv_cell_1_3_para.hy = 1;
    accum_uv_cell_1_3_para.hz = 0;
    accum_uv_cell_1_3_para.bx = 256;
    accum_uv_cell_1_3_para.by = 8;
    accum_uv_cell_1_3_para.bz = 1;
    accum_uv_cell_1_3_para.mx = 1;
    accum_uv_cell_1_3_para.my = 2;
    accum_uv_cell_1_3_para.mz = 32;
    accum_uv_cell_1_3_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+accum_uv_cell_1_3_para.oz][Proc.lat_hw -1+accum_uv_cell_1_3_para.oy][Proc.lon_hw -1+accum_uv_cell_1_3_para.ox];
    accum_uv_cell_1_3_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_3_para.oz][Proc.lat_hw -1+accum_uv_cell_1_3_para.oy][Proc.lon_hw -1+accum_uv_cell_1_3_para.ox];
    
    athread_spawn(accum_uv_cell_1_3, &accum_uv_cell_1_3_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->uv_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_4_info accum_uv_cell_1_4_para;
      accum_uv_cell_1_4_para.lz = 32 - 0;
      accum_uv_cell_1_4_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_4_para.oz = 0;
      accum_uv_cell_1_4_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_4_para.hx = 1;
      accum_uv_cell_1_4_para.hy = 1;
      accum_uv_cell_1_4_para.hz = 0;
      accum_uv_cell_1_4_para.bx = 256;
      accum_uv_cell_1_4_para.by = 8;
      accum_uv_cell_1_4_para.bz = 1;
      accum_uv_cell_1_4_para.mx = 1;
      accum_uv_cell_1_4_para.my = 2;
      accum_uv_cell_1_4_para.mz = 32;
      accum_uv_cell_1_4_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_4_para.oz][Proc.lat_hw -1+accum_uv_cell_1_4_para.oy][Proc.lon_hw -1+accum_uv_cell_1_4_para.ox];
      accum_uv_cell_1_4_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+accum_uv_cell_1_4_para.oz][Proc.lat_hw -1+accum_uv_cell_1_4_para.oy][Proc.lon_hw -1+accum_uv_cell_1_4_para.ox];
      accum_uv_cell_1_4_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_1_4, &accum_uv_cell_1_4_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_5_info accum_uv_cell_1_5_para;
      accum_uv_cell_1_5_para.lz = 32 - 0;
      accum_uv_cell_1_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_5_para.oz = 0;
      accum_uv_cell_1_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_5_para.hx = 1;
      accum_uv_cell_1_5_para.hy = 1;
      accum_uv_cell_1_5_para.hz = 0;
      accum_uv_cell_1_5_para.bx = 256;
      accum_uv_cell_1_5_para.by = 8;
      accum_uv_cell_1_5_para.bz = 1;
      accum_uv_cell_1_5_para.mx = 1;
      accum_uv_cell_1_5_para.my = 2;
      accum_uv_cell_1_5_para.mz = 32;
      accum_uv_cell_1_5_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_5_para.oz][Proc.lat_hw -1+accum_uv_cell_1_5_para.oy][Proc.lon_hw -1+accum_uv_cell_1_5_para.ox];
      accum_uv_cell_1_5_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+accum_uv_cell_1_5_para.oz][Proc.lat_hw -1+accum_uv_cell_1_5_para.oy][Proc.lon_hw -1+accum_uv_cell_1_5_para.ox];
      accum_uv_cell_1_5_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_1_5, &accum_uv_cell_1_5_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_6_info accum_uv_cell_1_6_para;
      accum_uv_cell_1_6_para.lz = 32 - 0;
      accum_uv_cell_1_6_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_6_para.oz = 0;
      accum_uv_cell_1_6_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_6_para.hx = 1;
      accum_uv_cell_1_6_para.hy = 0;
      accum_uv_cell_1_6_para.hz = 0;
      accum_uv_cell_1_6_para.bx = 256;
      accum_uv_cell_1_6_para.by = 8;
      accum_uv_cell_1_6_para.bz = 1;
      accum_uv_cell_1_6_para.mx = 1;
      accum_uv_cell_1_6_para.my = 2;
      accum_uv_cell_1_6_para.mz = 32;
      accum_uv_cell_1_6_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_6_para.oz][Proc.lat_hw -0+accum_uv_cell_1_6_para.oy][Proc.lon_hw -1+accum_uv_cell_1_6_para.ox];
      accum_uv_cell_1_6_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_1_6_para.oz][Proc.lat_hw -0+accum_uv_cell_1_6_para.oy][Proc.lon_hw -1+accum_uv_cell_1_6_para.ox];
      
      athread_spawn(accum_uv_cell_1_6, &accum_uv_cell_1_6_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellu0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_7_info accum_uv_cell_1_7_para;
      accum_uv_cell_1_7_para.lz = 32 - 0;
      accum_uv_cell_1_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_7_para.oz = 0;
      accum_uv_cell_1_7_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_7_para.hx = 0;
      accum_uv_cell_1_7_para.hy = 1;
      accum_uv_cell_1_7_para.hz = 0;
      accum_uv_cell_1_7_para.bx = 256;
      accum_uv_cell_1_7_para.by = 8;
      accum_uv_cell_1_7_para.bz = 1;
      accum_uv_cell_1_7_para.mx = 1;
      accum_uv_cell_1_7_para.my = 2;
      accum_uv_cell_1_7_para.mz = 32;
      accum_uv_cell_1_7_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_7_para.oz][Proc.lat_hw -1+accum_uv_cell_1_7_para.oy][Proc.lon_hw -0+accum_uv_cell_1_7_para.ox];
      accum_uv_cell_1_7_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_1_7_para.oz][Proc.lat_hw -1+accum_uv_cell_1_7_para.oy][Proc.lon_hw -0+accum_uv_cell_1_7_para.ox];
      
      athread_spawn(accum_uv_cell_1_7, &accum_uv_cell_1_7_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellv0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_8_info accum_uv_cell_1_8_para;
      accum_uv_cell_1_8_para.lz = 32 - 0;
      accum_uv_cell_1_8_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_8_para.oz = 0;
      accum_uv_cell_1_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_8_para.hx = 1;
      accum_uv_cell_1_8_para.hy = 1;
      accum_uv_cell_1_8_para.hz = 0;
      accum_uv_cell_1_8_para.bx = 256;
      accum_uv_cell_1_8_para.by = 8;
      accum_uv_cell_1_8_para.bz = 1;
      accum_uv_cell_1_8_para.mx = 1;
      accum_uv_cell_1_8_para.my = 2;
      accum_uv_cell_1_8_para.mz = 32;
      accum_uv_cell_1_8_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_8_para.oz][Proc.lat_hw -1+accum_uv_cell_1_8_para.oy][Proc.lon_hw -1+accum_uv_cell_1_8_para.ox];
      accum_uv_cell_1_8_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+accum_uv_cell_1_8_para.oz][Proc.lat_hw -1+accum_uv_cell_1_8_para.oy][Proc.lon_hw -1+accum_uv_cell_1_8_para.ox];
      
      athread_spawn(accum_uv_cell_1_8, &accum_uv_cell_1_8_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_9_info accum_uv_cell_1_9_para;
      accum_uv_cell_1_9_para.lz = 32 - 0;
      accum_uv_cell_1_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_9_para.oz = 0;
      accum_uv_cell_1_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_9_para.hx = 1;
      accum_uv_cell_1_9_para.hy = 1;
      accum_uv_cell_1_9_para.hz = 0;
      accum_uv_cell_1_9_para.bx = 256;
      accum_uv_cell_1_9_para.by = 8;
      accum_uv_cell_1_9_para.bz = 1;
      accum_uv_cell_1_9_para.mx = 1;
      accum_uv_cell_1_9_para.my = 2;
      accum_uv_cell_1_9_para.mz = 32;
      accum_uv_cell_1_9_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_9_para.oz][Proc.lat_hw -1+accum_uv_cell_1_9_para.oy][Proc.lon_hw -1+accum_uv_cell_1_9_para.ox];
      accum_uv_cell_1_9_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+accum_uv_cell_1_9_para.oz][Proc.lat_hw -1+accum_uv_cell_1_9_para.oy][Proc.lon_hw -1+accum_uv_cell_1_9_para.ox];
      
      athread_spawn(accum_uv_cell_1_9, &accum_uv_cell_1_9_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->uv_step) = 0;
  }
  else
  {
    (advPara->uv_step) = ((advPara->uv_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->uv_step) > (advPara->nstep))))
  {
    if (!(advPara->dynamic))
    {
      (advPara->uv_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_10_info accum_uv_cell_1_10_para;
    accum_uv_cell_1_10_para.lz = 32 - 0;
    accum_uv_cell_1_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_1_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_10_para.oz = 0;
    accum_uv_cell_1_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_1_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_10_para.hx = 1;
    accum_uv_cell_1_10_para.hy = 0;
    accum_uv_cell_1_10_para.hz = 0;
    accum_uv_cell_1_10_para.bx = 256;
    accum_uv_cell_1_10_para.by = 8;
    accum_uv_cell_1_10_para.bz = 1;
    accum_uv_cell_1_10_para.mx = 1;
    accum_uv_cell_1_10_para.my = 2;
    accum_uv_cell_1_10_para.mz = 32;
    accum_uv_cell_1_10_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_10_para.oz][Proc.lat_hw -0+accum_uv_cell_1_10_para.oy][Proc.lon_hw -1+accum_uv_cell_1_10_para.ox];
    accum_uv_cell_1_10_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+accum_uv_cell_1_10_para.oz][Proc.lat_hw -0+accum_uv_cell_1_10_para.oy][Proc.lon_hw -1+accum_uv_cell_1_10_para.ox];
    accum_uv_cell_1_10_para.de_lon = &mesh->de_lon[0][0][0];
    accum_uv_cell_1_10_para.dt = dt;
    
    athread_spawn(accum_uv_cell_1_10, &accum_uv_cell_1_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_11_info accum_uv_cell_1_11_para;
    accum_uv_cell_1_11_para.lz = 32 - 0;
    accum_uv_cell_1_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_11_para.oz = 0;
    accum_uv_cell_1_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_11_para.hx = 0;
    accum_uv_cell_1_11_para.hy = 1;
    accum_uv_cell_1_11_para.hz = 0;
    accum_uv_cell_1_11_para.bx = 256;
    accum_uv_cell_1_11_para.by = 8;
    accum_uv_cell_1_11_para.bz = 1;
    accum_uv_cell_1_11_para.mx = 1;
    accum_uv_cell_1_11_para.my = 2;
    accum_uv_cell_1_11_para.mz = 32;
    accum_uv_cell_1_11_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_11_para.oz][Proc.lat_hw -1+accum_uv_cell_1_11_para.oy][Proc.lon_hw -0+accum_uv_cell_1_11_para.ox];
    accum_uv_cell_1_11_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+accum_uv_cell_1_11_para.oz][Proc.lat_hw -1+accum_uv_cell_1_11_para.oy][Proc.lon_hw -0+accum_uv_cell_1_11_para.ox];
    accum_uv_cell_1_11_para.de_lat = &mesh->de_lat[0][0][0];
    accum_uv_cell_1_11_para.dt = dt;
    
    athread_spawn(accum_uv_cell_1_11, &accum_uv_cell_1_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_12_info accum_uv_cell_1_12_para;
    accum_uv_cell_1_12_para.lz = 32 - 0;
    accum_uv_cell_1_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_1_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_12_para.oz = 0;
    accum_uv_cell_1_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_1_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_12_para.hx = 1;
    accum_uv_cell_1_12_para.hy = 1;
    accum_uv_cell_1_12_para.hz = 0;
    accum_uv_cell_1_12_para.bx = 256;
    accum_uv_cell_1_12_para.by = 8;
    accum_uv_cell_1_12_para.bz = 1;
    accum_uv_cell_1_12_para.mx = 1;
    accum_uv_cell_1_12_para.my = 2;
    accum_uv_cell_1_12_para.mz = 32;
    accum_uv_cell_1_12_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_12_para.oz][Proc.lat_hw -1+accum_uv_cell_1_12_para.oy][Proc.lon_hw -1+accum_uv_cell_1_12_para.ox];
    accum_uv_cell_1_12_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_12_para.oz][Proc.lat_hw -1+accum_uv_cell_1_12_para.oy][Proc.lon_hw -1+accum_uv_cell_1_12_para.ox];
    accum_uv_cell_1_12_para.advptdivx = &advpt->divx[Proc.lev_hw - 0+accum_uv_cell_1_12_para.oz][Proc.lat_hw -1+accum_uv_cell_1_12_para.oy][Proc.lon_hw -1+accum_uv_cell_1_12_para.ox];
    accum_uv_cell_1_12_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+accum_uv_cell_1_12_para.oz][Proc.lat_hw -1+accum_uv_cell_1_12_para.oy][Proc.lon_hw -1+accum_uv_cell_1_12_para.ox];
    accum_uv_cell_1_12_para.le_lon = &mesh->le_lon[0][0][0];
    accum_uv_cell_1_12_para.area_cell = &mesh->area_cell[0][0][0];
    accum_uv_cell_1_12_para.le_lat = &mesh->le_lat[0][0][0];
    
    athread_spawn(accum_uv_cell_1_12, &accum_uv_cell_1_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    
    
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_1_0_info calc_mf_1_0_para;
  calc_mf_1_0_para.lz = 32 - 0;
  calc_mf_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_1_0_para.oz = 0;
  calc_mf_1_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_1_0_para.hx = 1;
  calc_mf_1_0_para.hy = 1;
  calc_mf_1_0_para.hz = 0;
  calc_mf_1_0_para.bx = 256;
  calc_mf_1_0_para.by = 8;
  calc_mf_1_0_para.bz = 1;
  calc_mf_1_0_para.mx = 1;
  calc_mf_1_0_para.my = 2;
  calc_mf_1_0_para.mz = 32;
  calc_mf_1_0_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+calc_mf_1_0_para.oz][Proc.lat_hw -1+calc_mf_1_0_para.oy][Proc.lon_hw -1+calc_mf_1_0_para.ox];
  calc_mf_1_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_mf_1_0_para.oz][Proc.lat_hw -1+calc_mf_1_0_para.oy][Proc.lon_hw -1+calc_mf_1_0_para.ox];
  calc_mf_1_0_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+calc_mf_1_0_para.oz][Proc.lat_hw -1+calc_mf_1_0_para.oy][Proc.lon_hw -1+calc_mf_1_0_para.ox];
  
  athread_spawn(calc_mf_1_0, &calc_mf_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->mfx_lon[0][0][0], &Proc.FieldReq[async_mfx_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_1_1_info calc_mf_1_1_para;
  calc_mf_1_1_para.lz = 32 - 0;
  calc_mf_1_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_1_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_1_1_para.oz = 0;
  calc_mf_1_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_1_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_1_1_para.hx = 1;
  calc_mf_1_1_para.hy = 1;
  calc_mf_1_1_para.hz = 0;
  calc_mf_1_1_para.bx = 256;
  calc_mf_1_1_para.by = 8;
  calc_mf_1_1_para.bz = 1;
  calc_mf_1_1_para.mx = 1;
  calc_mf_1_1_para.my = 2;
  calc_mf_1_1_para.mz = 32;
  calc_mf_1_1_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+calc_mf_1_1_para.oz][Proc.lat_hw -1+calc_mf_1_1_para.oy][Proc.lon_hw -1+calc_mf_1_1_para.ox];
  calc_mf_1_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_mf_1_1_para.oz][Proc.lat_hw -1+calc_mf_1_1_para.oy][Proc.lon_hw -1+calc_mf_1_1_para.ox];
  calc_mf_1_1_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+calc_mf_1_1_para.oz][Proc.lat_hw -1+calc_mf_1_1_para.oy][Proc.lon_hw -1+calc_mf_1_1_para.ox];
  
  athread_spawn(calc_mf_1_1, &calc_mf_1_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->mfy_lat[0][0][0], &Proc.FieldReq[async_mfy_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  if (((advPara->mf_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfx[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfy[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->mf_step) = 1;
  }
  if (((advPara->mf_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_1_0_info accum_mf_cell_1_0_para;
    accum_mf_cell_1_0_para.lz = 32 - 0;
    accum_mf_cell_1_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_1_0_para.oz = 0;
    accum_mf_cell_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_1_0_para.hx = 1;
    accum_mf_cell_1_0_para.hy = 1;
    accum_mf_cell_1_0_para.hz = 0;
    accum_mf_cell_1_0_para.bx = 256;
    accum_mf_cell_1_0_para.by = 8;
    accum_mf_cell_1_0_para.bz = 1;
    accum_mf_cell_1_0_para.mx = 1;
    accum_mf_cell_1_0_para.my = 2;
    accum_mf_cell_1_0_para.mz = 32;
    accum_mf_cell_1_0_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_1_0_para.oz][Proc.lat_hw -1+accum_mf_cell_1_0_para.oy][Proc.lon_hw -1+accum_mf_cell_1_0_para.ox];
    accum_mf_cell_1_0_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_1_0_para.oz][Proc.lat_hw -1+accum_mf_cell_1_0_para.oy][Proc.lon_hw -1+accum_mf_cell_1_0_para.ox];
    
    athread_spawn(accum_mf_cell_1_0, &accum_mf_cell_1_0_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_1_1_info accum_mf_cell_1_1_para;
    accum_mf_cell_1_1_para.lz = 32 - 0;
    accum_mf_cell_1_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_1_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_1_1_para.oz = 0;
    accum_mf_cell_1_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_1_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_1_1_para.hx = 1;
    accum_mf_cell_1_1_para.hy = 1;
    accum_mf_cell_1_1_para.hz = 0;
    accum_mf_cell_1_1_para.bx = 256;
    accum_mf_cell_1_1_para.by = 8;
    accum_mf_cell_1_1_para.bz = 1;
    accum_mf_cell_1_1_para.mx = 1;
    accum_mf_cell_1_1_para.my = 2;
    accum_mf_cell_1_1_para.mz = 32;
    accum_mf_cell_1_1_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_1_1_para.oz][Proc.lat_hw -1+accum_mf_cell_1_1_para.oy][Proc.lon_hw -1+accum_mf_cell_1_1_para.ox];
    accum_mf_cell_1_1_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_1_1_para.oz][Proc.lat_hw -1+accum_mf_cell_1_1_para.oy][Proc.lon_hw -1+accum_mf_cell_1_1_para.ox];
    
    athread_spawn(accum_mf_cell_1_1, &accum_mf_cell_1_1_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->mf_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_2_info accum_mf_cell_1_2_para;
      accum_mf_cell_1_2_para.lz = 32 - 0;
      accum_mf_cell_1_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_2_para.oz = 0;
      accum_mf_cell_1_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_2_para.hx = 1;
      accum_mf_cell_1_2_para.hy = 1;
      accum_mf_cell_1_2_para.hz = 0;
      accum_mf_cell_1_2_para.bx = 256;
      accum_mf_cell_1_2_para.by = 8;
      accum_mf_cell_1_2_para.bz = 1;
      accum_mf_cell_1_2_para.mx = 1;
      accum_mf_cell_1_2_para.my = 2;
      accum_mf_cell_1_2_para.mz = 32;
      accum_mf_cell_1_2_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_1_2_para.oz][Proc.lat_hw -1+accum_mf_cell_1_2_para.oy][Proc.lon_hw -1+accum_mf_cell_1_2_para.ox];
      accum_mf_cell_1_2_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_1_2_para.oz][Proc.lat_hw -1+accum_mf_cell_1_2_para.oy][Proc.lon_hw -1+accum_mf_cell_1_2_para.ox];
      accum_mf_cell_1_2_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_1_2, &accum_mf_cell_1_2_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_3_info accum_mf_cell_1_3_para;
      accum_mf_cell_1_3_para.lz = 32 - 0;
      accum_mf_cell_1_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_3_para.oz = 0;
      accum_mf_cell_1_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_3_para.hx = 1;
      accum_mf_cell_1_3_para.hy = 1;
      accum_mf_cell_1_3_para.hz = 0;
      accum_mf_cell_1_3_para.bx = 256;
      accum_mf_cell_1_3_para.by = 8;
      accum_mf_cell_1_3_para.bz = 1;
      accum_mf_cell_1_3_para.mx = 1;
      accum_mf_cell_1_3_para.my = 2;
      accum_mf_cell_1_3_para.mz = 32;
      accum_mf_cell_1_3_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_1_3_para.oz][Proc.lat_hw -1+accum_mf_cell_1_3_para.oy][Proc.lon_hw -1+accum_mf_cell_1_3_para.ox];
      accum_mf_cell_1_3_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_1_3_para.oz][Proc.lat_hw -1+accum_mf_cell_1_3_para.oy][Proc.lon_hw -1+accum_mf_cell_1_3_para.ox];
      accum_mf_cell_1_3_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_1_3, &accum_mf_cell_1_3_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_4_info accum_mf_cell_1_4_para;
      accum_mf_cell_1_4_para.lz = 32 - 0;
      accum_mf_cell_1_4_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_4_para.oz = 0;
      accum_mf_cell_1_4_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_4_para.hx = 1;
      accum_mf_cell_1_4_para.hy = 1;
      accum_mf_cell_1_4_para.hz = 0;
      accum_mf_cell_1_4_para.bx = 256;
      accum_mf_cell_1_4_para.by = 8;
      accum_mf_cell_1_4_para.bz = 1;
      accum_mf_cell_1_4_para.mx = 1;
      accum_mf_cell_1_4_para.my = 2;
      accum_mf_cell_1_4_para.mz = 32;
      accum_mf_cell_1_4_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_1_4_para.oz][Proc.lat_hw -1+accum_mf_cell_1_4_para.oy][Proc.lon_hw -1+accum_mf_cell_1_4_para.ox];
      accum_mf_cell_1_4_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_1_4_para.oz][Proc.lat_hw -1+accum_mf_cell_1_4_para.oy][Proc.lon_hw -1+accum_mf_cell_1_4_para.ox];
      
      athread_spawn(accum_mf_cell_1_4, &accum_mf_cell_1_4_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_5_info accum_mf_cell_1_5_para;
      accum_mf_cell_1_5_para.lz = 32 - 0;
      accum_mf_cell_1_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_5_para.oz = 0;
      accum_mf_cell_1_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_5_para.hx = 1;
      accum_mf_cell_1_5_para.hy = 1;
      accum_mf_cell_1_5_para.hz = 0;
      accum_mf_cell_1_5_para.bx = 256;
      accum_mf_cell_1_5_para.by = 8;
      accum_mf_cell_1_5_para.bz = 1;
      accum_mf_cell_1_5_para.mx = 1;
      accum_mf_cell_1_5_para.my = 2;
      accum_mf_cell_1_5_para.mz = 32;
      accum_mf_cell_1_5_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_1_5_para.oz][Proc.lat_hw -1+accum_mf_cell_1_5_para.oy][Proc.lon_hw -1+accum_mf_cell_1_5_para.ox];
      accum_mf_cell_1_5_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_1_5_para.oz][Proc.lat_hw -1+accum_mf_cell_1_5_para.oy][Proc.lon_hw -1+accum_mf_cell_1_5_para.ox];
      
      athread_spawn(accum_mf_cell_1_5, &accum_mf_cell_1_5_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->mf_step) = 0;
  }
  else
  {
    (advPara->mf_step) = ((advPara->mf_step) + 1);
  }
  if ((!(advPara->dynamic) && ((advPara->mf_step) > (advPara->nstep))))
  {
    (advPara->mf_step) = -1;
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_1_2_info calc_mf_1_2_para;
  calc_mf_1_2_para.lz = 32 - 0;
  calc_mf_1_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_1_2_para.oz = 0;
  calc_mf_1_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_1_2_para.hx = 1;
  calc_mf_1_2_para.hy = 1;
  calc_mf_1_2_para.hz = 0;
  calc_mf_1_2_para.bx = 256;
  calc_mf_1_2_para.by = 8;
  calc_mf_1_2_para.bz = 1;
  calc_mf_1_2_para.mx = 1;
  calc_mf_1_2_para.my = 2;
  calc_mf_1_2_para.mz = 32;
  calc_mf_1_2_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+calc_mf_1_2_para.oz][Proc.lat_hw -1+calc_mf_1_2_para.oy][Proc.lon_hw -1+calc_mf_1_2_para.ox];
  calc_mf_1_2_para.statemfx_lat = &state->mfx_lat[Proc.lev_hw - 0+calc_mf_1_2_para.oz][Proc.lat_hw -1+calc_mf_1_2_para.oy][Proc.lon_hw -1+calc_mf_1_2_para.ox];
  calc_mf_1_2_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+calc_mf_1_2_para.oz][Proc.lat_hw -1+calc_mf_1_2_para.oy][Proc.lon_hw -1+calc_mf_1_2_para.ox];
  calc_mf_1_2_para.stateu_lat = &state->u_lat[Proc.lev_hw - 0+calc_mf_1_2_para.oz][Proc.lat_hw -1+calc_mf_1_2_para.oy][Proc.lon_hw -1+calc_mf_1_2_para.ox];
  calc_mf_1_2_para.half_tangent_wgt_0 = &mesh->half_tangent_wgt_0[0][0][0];
  calc_mf_1_2_para.half_tangent_wgt_1 = &mesh->half_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_1_2, &calc_mf_1_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_1_3_info calc_mf_1_3_para;
  calc_mf_1_3_para.lz = 32 - 0;
  calc_mf_1_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_1_3_para.oz = 0;
  calc_mf_1_3_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_1_3_para.hx = 1;
  calc_mf_1_3_para.hy = 1;
  calc_mf_1_3_para.hz = 0;
  calc_mf_1_3_para.bx = 256;
  calc_mf_1_3_para.by = 8;
  calc_mf_1_3_para.bz = 1;
  calc_mf_1_3_para.mx = 1;
  calc_mf_1_3_para.my = 2;
  calc_mf_1_3_para.mz = 32;
  calc_mf_1_3_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+calc_mf_1_3_para.oz][Proc.lat_hw -1+calc_mf_1_3_para.oy][Proc.lon_hw -1+calc_mf_1_3_para.ox];
  calc_mf_1_3_para.statemfy_lon = &state->mfy_lon[Proc.lev_hw - 0+calc_mf_1_3_para.oz][Proc.lat_hw -1+calc_mf_1_3_para.oy][Proc.lon_hw -1+calc_mf_1_3_para.ox];
  calc_mf_1_3_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+calc_mf_1_3_para.oz][Proc.lat_hw -1+calc_mf_1_3_para.oy][Proc.lon_hw -1+calc_mf_1_3_para.ox];
  calc_mf_1_3_para.statev_lon = &state->v_lon[Proc.lev_hw - 0+calc_mf_1_3_para.oz][Proc.lat_hw -1+calc_mf_1_3_para.oy][Proc.lon_hw -1+calc_mf_1_3_para.ox];
  calc_mf_1_3_para.full_tangent_wgt_0 = &mesh->full_tangent_wgt_0[0][0][0];
  calc_mf_1_3_para.full_tangent_wgt_1 = &mesh->full_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_1_3, &calc_mf_1_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  ke_vtx = (struct Vector4){0.0,0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_1_0_info calc_ke_1_0_para;
  calc_ke_1_0_para.lz = 32 - 0;
  calc_ke_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_1_0_para.oz = 0;
  calc_ke_1_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_1_0_para.hx = 1;
  calc_ke_1_0_para.hy = 1;
  calc_ke_1_0_para.hz = 0;
  calc_ke_1_0_para.bx = 256;
  calc_ke_1_0_para.by = 8;
  calc_ke_1_0_para.bz = 1;
  calc_ke_1_0_para.mx = 1;
  calc_ke_1_0_para.my = 2;
  calc_ke_1_0_para.mz = 32;
  calc_ke_1_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_ke_1_0_para.oz][Proc.lat_hw -1+calc_ke_1_0_para.oy][Proc.lon_hw -1+calc_ke_1_0_para.ox];
  calc_ke_1_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_ke_1_0_para.oz][Proc.lat_hw -1+calc_ke_1_0_para.oy][Proc.lon_hw -1+calc_ke_1_0_para.ox];
  calc_ke_1_0_para.stateke = &state->ke[Proc.lev_hw - 0+calc_ke_1_0_para.oz][Proc.lat_hw -1+calc_ke_1_0_para.oy][Proc.lon_hw -1+calc_ke_1_0_para.ox];
  calc_ke_1_0_para.area_lon_west = &mesh->area_lon_west[0][0][0];
  calc_ke_1_0_para.area_lon_east = &mesh->area_lon_east[0][0][0];
  calc_ke_1_0_para.area_lat_north = &mesh->area_lat_north[0][0][0];
  calc_ke_1_0_para.area_lat_south = &mesh->area_lat_south[0][0][0];
  calc_ke_1_0_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_1_0, &calc_ke_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_1_1_info calc_ke_1_1_para;
  calc_ke_1_1_para.lz = 32 - 0;
  calc_ke_1_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_1_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_1_1_para.oz = 0;
  calc_ke_1_1_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_1_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_1_1_para.hx = 1;
  calc_ke_1_1_para.hy = 1;
  calc_ke_1_1_para.hz = 0;
  calc_ke_1_1_para.bx = 256;
  calc_ke_1_1_para.by = 8;
  calc_ke_1_1_para.bz = 1;
  calc_ke_1_1_para.mx = 1;
  calc_ke_1_1_para.my = 2;
  calc_ke_1_1_para.mz = 32;
  calc_ke_1_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_ke_1_1_para.oz][Proc.lat_hw -1+calc_ke_1_1_para.oy][Proc.lon_hw -1+calc_ke_1_1_para.ox];
  calc_ke_1_1_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_ke_1_1_para.oz][Proc.lat_hw -1+calc_ke_1_1_para.oy][Proc.lon_hw -1+calc_ke_1_1_para.ox];
  calc_ke_1_1_para.stateke = &state->ke[Proc.lev_hw - 0+calc_ke_1_1_para.oz][Proc.lat_hw -1+calc_ke_1_1_para.oy][Proc.lon_hw -1+calc_ke_1_1_para.ox];
  calc_ke_1_1_para.area_lat_east = &mesh->area_lat_east[0][0][0];
  calc_ke_1_1_para.area_lat_west = &mesh->area_lat_west[0][0][0];
  calc_ke_1_1_para.area_lon_north = &mesh->area_lon_north[0][0][0];
  calc_ke_1_1_para.area_lon_south = &mesh->area_lon_south[0][0][0];
  calc_ke_1_1_para.area_vtx = &mesh->area_vtx[0][0][0];
  calc_ke_1_1_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  calc_ke_1_1_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  calc_ke_1_1_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_1_1, &calc_ke_1_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->ke[0][0][0], &Proc.FieldReq[async_ke], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_1_0_info calc_vor_1_0_para;
  calc_vor_1_0_para.lz = 32 - 0;
  calc_vor_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_vor_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_1_0_para.oz = 0;
  calc_vor_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_vor_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_1_0_para.hx = 1;
  calc_vor_1_0_para.hy = 1;
  calc_vor_1_0_para.hz = 0;
  calc_vor_1_0_para.bx = 256;
  calc_vor_1_0_para.by = 8;
  calc_vor_1_0_para.bz = 1;
  calc_vor_1_0_para.mx = 1;
  calc_vor_1_0_para.my = 2;
  calc_vor_1_0_para.mz = 32;
  calc_vor_1_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_vor_1_0_para.oz][Proc.lat_hw -1+calc_vor_1_0_para.oy][Proc.lon_hw -1+calc_vor_1_0_para.ox];
  calc_vor_1_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_vor_1_0_para.oz][Proc.lat_hw -1+calc_vor_1_0_para.oy][Proc.lon_hw -1+calc_vor_1_0_para.ox];
  calc_vor_1_0_para.statevor = &state->vor[Proc.lev_hw - 0+calc_vor_1_0_para.oz][Proc.lat_hw -1+calc_vor_1_0_para.oy][Proc.lon_hw -1+calc_vor_1_0_para.ox];
  calc_vor_1_0_para.de_lon = &mesh->de_lon[0][0][0];
  calc_vor_1_0_para.de_lat = &mesh->de_lat[0][0][0];
  calc_vor_1_0_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(calc_vor_1_0, &calc_vor_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vorvorTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_pv_1_0_info calc_pv_1_0_para;
  calc_pv_1_0_para.lz = 32 - 0;
  calc_pv_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_pv_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_pv_1_0_para.oz = 0;
  calc_pv_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_pv_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_pv_1_0_para.hx = 2;
  calc_pv_1_0_para.hy = 2;
  calc_pv_1_0_para.hz = 0;
  calc_pv_1_0_para.bx = 256;
  calc_pv_1_0_para.by = 8;
  calc_pv_1_0_para.bz = 1;
  calc_pv_1_0_para.mx = 1;
  calc_pv_1_0_para.my = 2;
  calc_pv_1_0_para.mz = 32;
  calc_pv_1_0_para.statevor = &state->vor[Proc.lev_hw - 0+calc_pv_1_0_para.oz][Proc.lat_hw -2+calc_pv_1_0_para.oy][Proc.lon_hw -2+calc_pv_1_0_para.ox];
  calc_pv_1_0_para.statem_vtx = &state->m_vtx[Proc.lev_hw - 0+calc_pv_1_0_para.oz][Proc.lat_hw -2+calc_pv_1_0_para.oy][Proc.lon_hw -2+calc_pv_1_0_para.ox];
  calc_pv_1_0_para.statepv = &state->pv[Proc.lev_hw - 0+calc_pv_1_0_para.oz][Proc.lat_hw -2+calc_pv_1_0_para.oy][Proc.lon_hw -2+calc_pv_1_0_para.ox];
  calc_pv_1_0_para.half_f = &mesh->half_f[0][0][0];
  
  athread_spawn(calc_pv_1_0, &calc_pv_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_pvpvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pv[0][0][0], &Proc.FieldReq[async_pv], false, false, true, true, true, true, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_1_0_info interp_pv_upwind_1_0_para;
  interp_pv_upwind_1_0_para.lz = 32 - 0;
  interp_pv_upwind_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  interp_pv_upwind_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_1_0_para.oz = 0;
  interp_pv_upwind_1_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  interp_pv_upwind_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_1_0_para.hx = 2;
  interp_pv_upwind_1_0_para.hy = 2;
  interp_pv_upwind_1_0_para.hz = 0;
  interp_pv_upwind_1_0_para.bx = 256;
  interp_pv_upwind_1_0_para.by = 8;
  interp_pv_upwind_1_0_para.bz = 1;
  interp_pv_upwind_1_0_para.mx = 1;
  interp_pv_upwind_1_0_para.my = 2;
  interp_pv_upwind_1_0_para.mz = 32;
  interp_pv_upwind_1_0_para.statev_lon = &state->v_lon[Proc.lev_hw - 0+interp_pv_upwind_1_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_0_para.ox];
  interp_pv_upwind_1_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+interp_pv_upwind_1_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_0_para.ox];
  interp_pv_upwind_1_0_para.statepv = &state->pv[Proc.lev_hw - 0+interp_pv_upwind_1_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_0_para.ox];
  interp_pv_upwind_1_0_para.statepv_lon = &state->pv_lon[Proc.lev_hw - 0+interp_pv_upwind_1_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_0_para.ox];
  
  athread_spawn(interp_pv_upwind_1_0, &interp_pv_upwind_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pv_lon[0][0][0], &Proc.FieldReq[async_pv_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_1_1_info interp_pv_upwind_1_1_para;
  interp_pv_upwind_1_1_para.lz = 32 - 0;
  interp_pv_upwind_1_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interp_pv_upwind_1_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_1_1_para.oz = 0;
  interp_pv_upwind_1_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interp_pv_upwind_1_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_1_1_para.hx = 2;
  interp_pv_upwind_1_1_para.hy = 2;
  interp_pv_upwind_1_1_para.hz = 0;
  interp_pv_upwind_1_1_para.bx = 256;
  interp_pv_upwind_1_1_para.by = 8;
  interp_pv_upwind_1_1_para.bz = 1;
  interp_pv_upwind_1_1_para.mx = 1;
  interp_pv_upwind_1_1_para.my = 2;
  interp_pv_upwind_1_1_para.mz = 32;
  interp_pv_upwind_1_1_para.stateu_lat = &state->u_lat[Proc.lev_hw - 0+interp_pv_upwind_1_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_1_para.ox];
  interp_pv_upwind_1_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+interp_pv_upwind_1_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_1_para.ox];
  interp_pv_upwind_1_1_para.statepv = &state->pv[Proc.lev_hw - 0+interp_pv_upwind_1_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_1_para.ox];
  interp_pv_upwind_1_1_para.statepv_lat = &state->pv_lat[Proc.lev_hw - 0+interp_pv_upwind_1_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_1_para.ox];
  
  athread_spawn(interp_pv_upwind_1_1, &interp_pv_upwind_1_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pv_lat[0][0][0], &Proc.FieldReq[async_pv_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_1_0_info calc_div_1_0_para;
  calc_div_1_0_para.lz = 32 - 0;
  calc_div_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_div_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_1_0_para.oz = 0;
  calc_div_1_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_div_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_1_0_para.hx = 1;
  calc_div_1_0_para.hy = 1;
  calc_div_1_0_para.hz = 0;
  calc_div_1_0_para.bx = 256;
  calc_div_1_0_para.by = 8;
  calc_div_1_0_para.bz = 1;
  calc_div_1_0_para.mx = 1;
  calc_div_1_0_para.my = 2;
  calc_div_1_0_para.mz = 32;
  calc_div_1_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_div_1_0_para.oz][Proc.lat_hw -1+calc_div_1_0_para.oy][Proc.lon_hw -1+calc_div_1_0_para.ox];
  calc_div_1_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_div_1_0_para.oz][Proc.lat_hw -1+calc_div_1_0_para.oy][Proc.lon_hw -1+calc_div_1_0_para.ox];
  calc_div_1_0_para.statediv = &state->div[Proc.lev_hw - 0+calc_div_1_0_para.oz][Proc.lat_hw -1+calc_div_1_0_para.oy][Proc.lon_hw -1+calc_div_1_0_para.ox];
  calc_div_1_0_para.le_lon = &mesh->le_lon[0][0][0];
  calc_div_1_0_para.le_lat = &mesh->le_lat[0][0][0];
  calc_div_1_0_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_div_1_0, &calc_div_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divdivTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->div[0][0][0], &Proc.FieldReq[async_div], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_gz_lev_1_0_info calc_gz_lev_1_0_para;
  calc_gz_lev_1_0_para.lz = 32 - 0;
  calc_gz_lev_1_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_gz_lev_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_gz_lev_1_0_para.oz = 0;
  calc_gz_lev_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_gz_lev_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_gz_lev_1_0_para.hx = 1;
  calc_gz_lev_1_0_para.hy = 0;
  calc_gz_lev_1_0_para.hz = Proc.lev_hw;
  calc_gz_lev_1_0_para.bx = 64;
  calc_gz_lev_1_0_para.by = 1;
  calc_gz_lev_1_0_para.bz = 32;
  calc_gz_lev_1_0_para.mx = 8;
  calc_gz_lev_1_0_para.my = 8;
  calc_gz_lev_1_0_para.mz = 1;
  calc_gz_lev_1_0_para.statet = &state->t[Proc.lev_hw - calc_gz_lev_1_0_para.hz+calc_gz_lev_1_0_para.oz][Proc.lat_hw -0+calc_gz_lev_1_0_para.oy][Proc.lon_hw -1+calc_gz_lev_1_0_para.ox];
  calc_gz_lev_1_0_para.stateph_lev = &state->ph_lev[Proc.lev_hw - calc_gz_lev_1_0_para.hz+calc_gz_lev_1_0_para.oz][Proc.lat_hw -0+calc_gz_lev_1_0_para.oy][Proc.lon_hw -1+calc_gz_lev_1_0_para.ox];
  calc_gz_lev_1_0_para.staticvgzs = &staticv->gzs[0][Proc.lat_hw -0+calc_gz_lev_1_0_para.oy][Proc.lon_hw -1+calc_gz_lev_1_0_para.ox];
  calc_gz_lev_1_0_para.stategz_lev = &state->gz_lev[Proc.lev_hw - calc_gz_lev_1_0_para.hz+calc_gz_lev_1_0_para.oz][Proc.lat_hw -0+calc_gz_lev_1_0_para.oy][Proc.lon_hw -1+calc_gz_lev_1_0_para.ox];
  
  athread_spawn(calc_gz_lev_1_0, &calc_gz_lev_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_gz_levgz_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->gz_lev[0][0][0], &Proc.FieldReq[async_gz_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void advPrepare_1(struct HybridStateField* state, struct HybridAdvField* advm, struct HybridAdvField* advpt)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  copy_old_m_1_0_info copy_old_m_1_0_para;
  copy_old_m_1_0_para.lz = 32 - 0;
  copy_old_m_1_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  copy_old_m_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  copy_old_m_1_0_para.oz = 0;
  copy_old_m_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  copy_old_m_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  copy_old_m_1_0_para.hx = 1;
  copy_old_m_1_0_para.hy = 1;
  copy_old_m_1_0_para.hz = 0;
  copy_old_m_1_0_para.bx = 256;
  copy_old_m_1_0_para.by = 8;
  copy_old_m_1_0_para.bz = 1;
  copy_old_m_1_0_para.mx = 1;
  copy_old_m_1_0_para.my = 2;
  copy_old_m_1_0_para.mz = 32;
  copy_old_m_1_0_para.statem = &state->m[Proc.lev_hw - 0+copy_old_m_1_0_para.oz][Proc.lat_hw -1+copy_old_m_1_0_para.oy][Proc.lon_hw -1+copy_old_m_1_0_para.ox];
  copy_old_m_1_0_para.advmold_m = &advm->old_m[Proc.lev_hw - 0+copy_old_m_1_0_para.oz][Proc.lat_hw -1+copy_old_m_1_0_para.oy][Proc.lon_hw -1+copy_old_m_1_0_para.ox];
  
  athread_spawn(copy_old_m_1_0, &copy_old_m_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  copy_old_mold_mTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  copy_old_m_1_1_info copy_old_m_1_1_para;
  copy_old_m_1_1_para.lz = 32 - 0;
  copy_old_m_1_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  copy_old_m_1_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  copy_old_m_1_1_para.oz = 0;
  copy_old_m_1_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  copy_old_m_1_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  copy_old_m_1_1_para.hx = 1;
  copy_old_m_1_1_para.hy = 1;
  copy_old_m_1_1_para.hz = 0;
  copy_old_m_1_1_para.bx = 256;
  copy_old_m_1_1_para.by = 8;
  copy_old_m_1_1_para.bz = 1;
  copy_old_m_1_1_para.mx = 1;
  copy_old_m_1_1_para.my = 2;
  copy_old_m_1_1_para.mz = 32;
  copy_old_m_1_1_para.statem = &state->m[Proc.lev_hw - 0+copy_old_m_1_1_para.oz][Proc.lat_hw -1+copy_old_m_1_1_para.oy][Proc.lon_hw -1+copy_old_m_1_1_para.ox];
  copy_old_m_1_1_para.advptold_m = &advpt->old_m[Proc.lev_hw - 0+copy_old_m_1_1_para.oz][Proc.lat_hw -1+copy_old_m_1_1_para.oy][Proc.lon_hw -1+copy_old_m_1_1_para.ox];
  
  athread_spawn(copy_old_m_1_1, &copy_old_m_1_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  copy_old_mold_mTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void filterinit_1(struct HybridMeshField* mesh, double dt)
{
  Filter_Init(mesh,dt);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_InitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void stepForwardBackward_1(struct HybridStateField* old_state, struct HybridStateField* star_state, struct HybridStateField* new_state, struct HybridStaticField* staticv, struct HybridTendField* tend1, struct HybridTendField* tend2, struct HybridTendPara* tendPara, struct HybridAdvField* advpt, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  double b, mfs, cursum, cf, s1, s2, ds1, ds2, ds3, dgz, tl, dph1, dph2, dgz1, dgz2;
  int k, j, i, l, ci;
  struct Vector4 ke_vtx;
  struct Vector3 buf;
  tendPara = tendPara;
  advPara = advPara;
  dt = dt;
  tendPara = tendPara;
  (tendPara->u) = 0;
  (tendPara->v) = 0;
  (tendPara->pt) = 0;
  (tendPara->gz) = 0;
  (tendPara->phs) = 0;
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  if (((advPara->uv_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_39_info accum_uv_cell_1_39_para;
    accum_uv_cell_1_39_para.lz = 32 - 0;
    accum_uv_cell_1_39_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_39_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_39_para.oz = 0;
    accum_uv_cell_1_39_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_39_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_39_para.hx = 1;
    accum_uv_cell_1_39_para.hy = 0;
    accum_uv_cell_1_39_para.hz = 0;
    accum_uv_cell_1_39_para.bx = 256;
    accum_uv_cell_1_39_para.by = 8;
    accum_uv_cell_1_39_para.bz = 1;
    accum_uv_cell_1_39_para.mx = 1;
    accum_uv_cell_1_39_para.my = 2;
    accum_uv_cell_1_39_para.mz = 32;
    accum_uv_cell_1_39_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_1_39_para.oz][Proc.lat_hw -0+accum_uv_cell_1_39_para.oy][Proc.lon_hw -1+accum_uv_cell_1_39_para.ox];
    accum_uv_cell_1_39_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_39_para.oz][Proc.lat_hw -0+accum_uv_cell_1_39_para.oy][Proc.lon_hw -1+accum_uv_cell_1_39_para.ox];
    
    athread_spawn(accum_uv_cell_1_39, &accum_uv_cell_1_39_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_40_info accum_uv_cell_1_40_para;
    accum_uv_cell_1_40_para.lz = 32 - 0;
    accum_uv_cell_1_40_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_40_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_40_para.oz = 0;
    accum_uv_cell_1_40_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_40_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_40_para.hx = 0;
    accum_uv_cell_1_40_para.hy = 1;
    accum_uv_cell_1_40_para.hz = 0;
    accum_uv_cell_1_40_para.bx = 256;
    accum_uv_cell_1_40_para.by = 8;
    accum_uv_cell_1_40_para.bz = 1;
    accum_uv_cell_1_40_para.mx = 1;
    accum_uv_cell_1_40_para.my = 2;
    accum_uv_cell_1_40_para.mz = 32;
    accum_uv_cell_1_40_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_1_40_para.oz][Proc.lat_hw -1+accum_uv_cell_1_40_para.oy][Proc.lon_hw -0+accum_uv_cell_1_40_para.ox];
    accum_uv_cell_1_40_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_40_para.oz][Proc.lat_hw -1+accum_uv_cell_1_40_para.oy][Proc.lon_hw -0+accum_uv_cell_1_40_para.ox];
    
    athread_spawn(accum_uv_cell_1_40, &accum_uv_cell_1_40_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->uv_step) = 1;
  }
  if (((advPara->uv_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_41_info accum_uv_cell_1_41_para;
    accum_uv_cell_1_41_para.lz = 32 - 0;
    accum_uv_cell_1_41_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_41_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_41_para.oz = 0;
    accum_uv_cell_1_41_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_41_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_41_para.hx = 1;
    accum_uv_cell_1_41_para.hy = 1;
    accum_uv_cell_1_41_para.hz = 0;
    accum_uv_cell_1_41_para.bx = 256;
    accum_uv_cell_1_41_para.by = 8;
    accum_uv_cell_1_41_para.bz = 1;
    accum_uv_cell_1_41_para.mx = 1;
    accum_uv_cell_1_41_para.my = 2;
    accum_uv_cell_1_41_para.mz = 32;
    accum_uv_cell_1_41_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+accum_uv_cell_1_41_para.oz][Proc.lat_hw -1+accum_uv_cell_1_41_para.oy][Proc.lon_hw -1+accum_uv_cell_1_41_para.ox];
    accum_uv_cell_1_41_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_41_para.oz][Proc.lat_hw -1+accum_uv_cell_1_41_para.oy][Proc.lon_hw -1+accum_uv_cell_1_41_para.ox];
    
    athread_spawn(accum_uv_cell_1_41, &accum_uv_cell_1_41_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_42_info accum_uv_cell_1_42_para;
    accum_uv_cell_1_42_para.lz = 32 - 0;
    accum_uv_cell_1_42_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_42_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_42_para.oz = 0;
    accum_uv_cell_1_42_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_42_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_42_para.hx = 1;
    accum_uv_cell_1_42_para.hy = 1;
    accum_uv_cell_1_42_para.hz = 0;
    accum_uv_cell_1_42_para.bx = 256;
    accum_uv_cell_1_42_para.by = 8;
    accum_uv_cell_1_42_para.bz = 1;
    accum_uv_cell_1_42_para.mx = 1;
    accum_uv_cell_1_42_para.my = 2;
    accum_uv_cell_1_42_para.mz = 32;
    accum_uv_cell_1_42_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+accum_uv_cell_1_42_para.oz][Proc.lat_hw -1+accum_uv_cell_1_42_para.oy][Proc.lon_hw -1+accum_uv_cell_1_42_para.ox];
    accum_uv_cell_1_42_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_42_para.oz][Proc.lat_hw -1+accum_uv_cell_1_42_para.oy][Proc.lon_hw -1+accum_uv_cell_1_42_para.ox];
    
    athread_spawn(accum_uv_cell_1_42, &accum_uv_cell_1_42_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->uv_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_43_info accum_uv_cell_1_43_para;
      accum_uv_cell_1_43_para.lz = 32 - 0;
      accum_uv_cell_1_43_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_43_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_43_para.oz = 0;
      accum_uv_cell_1_43_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_43_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_43_para.hx = 1;
      accum_uv_cell_1_43_para.hy = 1;
      accum_uv_cell_1_43_para.hz = 0;
      accum_uv_cell_1_43_para.bx = 256;
      accum_uv_cell_1_43_para.by = 8;
      accum_uv_cell_1_43_para.bz = 1;
      accum_uv_cell_1_43_para.mx = 1;
      accum_uv_cell_1_43_para.my = 2;
      accum_uv_cell_1_43_para.mz = 32;
      accum_uv_cell_1_43_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_43_para.oz][Proc.lat_hw -1+accum_uv_cell_1_43_para.oy][Proc.lon_hw -1+accum_uv_cell_1_43_para.ox];
      accum_uv_cell_1_43_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+accum_uv_cell_1_43_para.oz][Proc.lat_hw -1+accum_uv_cell_1_43_para.oy][Proc.lon_hw -1+accum_uv_cell_1_43_para.ox];
      accum_uv_cell_1_43_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_1_43, &accum_uv_cell_1_43_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_44_info accum_uv_cell_1_44_para;
      accum_uv_cell_1_44_para.lz = 32 - 0;
      accum_uv_cell_1_44_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_44_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_44_para.oz = 0;
      accum_uv_cell_1_44_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_44_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_44_para.hx = 1;
      accum_uv_cell_1_44_para.hy = 1;
      accum_uv_cell_1_44_para.hz = 0;
      accum_uv_cell_1_44_para.bx = 256;
      accum_uv_cell_1_44_para.by = 8;
      accum_uv_cell_1_44_para.bz = 1;
      accum_uv_cell_1_44_para.mx = 1;
      accum_uv_cell_1_44_para.my = 2;
      accum_uv_cell_1_44_para.mz = 32;
      accum_uv_cell_1_44_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_44_para.oz][Proc.lat_hw -1+accum_uv_cell_1_44_para.oy][Proc.lon_hw -1+accum_uv_cell_1_44_para.ox];
      accum_uv_cell_1_44_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+accum_uv_cell_1_44_para.oz][Proc.lat_hw -1+accum_uv_cell_1_44_para.oy][Proc.lon_hw -1+accum_uv_cell_1_44_para.ox];
      accum_uv_cell_1_44_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_1_44, &accum_uv_cell_1_44_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_45_info accum_uv_cell_1_45_para;
      accum_uv_cell_1_45_para.lz = 32 - 0;
      accum_uv_cell_1_45_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_45_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_45_para.oz = 0;
      accum_uv_cell_1_45_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_45_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_45_para.hx = 1;
      accum_uv_cell_1_45_para.hy = 0;
      accum_uv_cell_1_45_para.hz = 0;
      accum_uv_cell_1_45_para.bx = 256;
      accum_uv_cell_1_45_para.by = 8;
      accum_uv_cell_1_45_para.bz = 1;
      accum_uv_cell_1_45_para.mx = 1;
      accum_uv_cell_1_45_para.my = 2;
      accum_uv_cell_1_45_para.mz = 32;
      accum_uv_cell_1_45_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_45_para.oz][Proc.lat_hw -0+accum_uv_cell_1_45_para.oy][Proc.lon_hw -1+accum_uv_cell_1_45_para.ox];
      accum_uv_cell_1_45_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_1_45_para.oz][Proc.lat_hw -0+accum_uv_cell_1_45_para.oy][Proc.lon_hw -1+accum_uv_cell_1_45_para.ox];
      
      athread_spawn(accum_uv_cell_1_45, &accum_uv_cell_1_45_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellu0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_46_info accum_uv_cell_1_46_para;
      accum_uv_cell_1_46_para.lz = 32 - 0;
      accum_uv_cell_1_46_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_46_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_46_para.oz = 0;
      accum_uv_cell_1_46_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_46_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_46_para.hx = 0;
      accum_uv_cell_1_46_para.hy = 1;
      accum_uv_cell_1_46_para.hz = 0;
      accum_uv_cell_1_46_para.bx = 256;
      accum_uv_cell_1_46_para.by = 8;
      accum_uv_cell_1_46_para.bz = 1;
      accum_uv_cell_1_46_para.mx = 1;
      accum_uv_cell_1_46_para.my = 2;
      accum_uv_cell_1_46_para.mz = 32;
      accum_uv_cell_1_46_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_46_para.oz][Proc.lat_hw -1+accum_uv_cell_1_46_para.oy][Proc.lon_hw -0+accum_uv_cell_1_46_para.ox];
      accum_uv_cell_1_46_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_1_46_para.oz][Proc.lat_hw -1+accum_uv_cell_1_46_para.oy][Proc.lon_hw -0+accum_uv_cell_1_46_para.ox];
      
      athread_spawn(accum_uv_cell_1_46, &accum_uv_cell_1_46_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellv0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_47_info accum_uv_cell_1_47_para;
      accum_uv_cell_1_47_para.lz = 32 - 0;
      accum_uv_cell_1_47_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_47_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_47_para.oz = 0;
      accum_uv_cell_1_47_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_47_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_47_para.hx = 1;
      accum_uv_cell_1_47_para.hy = 1;
      accum_uv_cell_1_47_para.hz = 0;
      accum_uv_cell_1_47_para.bx = 256;
      accum_uv_cell_1_47_para.by = 8;
      accum_uv_cell_1_47_para.bz = 1;
      accum_uv_cell_1_47_para.mx = 1;
      accum_uv_cell_1_47_para.my = 2;
      accum_uv_cell_1_47_para.mz = 32;
      accum_uv_cell_1_47_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_47_para.oz][Proc.lat_hw -1+accum_uv_cell_1_47_para.oy][Proc.lon_hw -1+accum_uv_cell_1_47_para.ox];
      accum_uv_cell_1_47_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+accum_uv_cell_1_47_para.oz][Proc.lat_hw -1+accum_uv_cell_1_47_para.oy][Proc.lon_hw -1+accum_uv_cell_1_47_para.ox];
      
      athread_spawn(accum_uv_cell_1_47, &accum_uv_cell_1_47_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_48_info accum_uv_cell_1_48_para;
      accum_uv_cell_1_48_para.lz = 32 - 0;
      accum_uv_cell_1_48_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_48_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_48_para.oz = 0;
      accum_uv_cell_1_48_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_48_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_48_para.hx = 1;
      accum_uv_cell_1_48_para.hy = 1;
      accum_uv_cell_1_48_para.hz = 0;
      accum_uv_cell_1_48_para.bx = 256;
      accum_uv_cell_1_48_para.by = 8;
      accum_uv_cell_1_48_para.bz = 1;
      accum_uv_cell_1_48_para.mx = 1;
      accum_uv_cell_1_48_para.my = 2;
      accum_uv_cell_1_48_para.mz = 32;
      accum_uv_cell_1_48_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_48_para.oz][Proc.lat_hw -1+accum_uv_cell_1_48_para.oy][Proc.lon_hw -1+accum_uv_cell_1_48_para.ox];
      accum_uv_cell_1_48_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+accum_uv_cell_1_48_para.oz][Proc.lat_hw -1+accum_uv_cell_1_48_para.oy][Proc.lon_hw -1+accum_uv_cell_1_48_para.ox];
      
      athread_spawn(accum_uv_cell_1_48, &accum_uv_cell_1_48_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->uv_step) = 0;
  }
  else
  {
    (advPara->uv_step) = ((advPara->uv_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->uv_step) > (advPara->nstep))))
  {
    if (!(advPara->dynamic))
    {
      (advPara->uv_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_49_info accum_uv_cell_1_49_para;
    accum_uv_cell_1_49_para.lz = 32 - 0;
    accum_uv_cell_1_49_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_1_49_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_49_para.oz = 0;
    accum_uv_cell_1_49_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_1_49_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_49_para.hx = 1;
    accum_uv_cell_1_49_para.hy = 0;
    accum_uv_cell_1_49_para.hz = 0;
    accum_uv_cell_1_49_para.bx = 256;
    accum_uv_cell_1_49_para.by = 8;
    accum_uv_cell_1_49_para.bz = 1;
    accum_uv_cell_1_49_para.mx = 1;
    accum_uv_cell_1_49_para.my = 2;
    accum_uv_cell_1_49_para.mz = 32;
    accum_uv_cell_1_49_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_49_para.oz][Proc.lat_hw -0+accum_uv_cell_1_49_para.oy][Proc.lon_hw -1+accum_uv_cell_1_49_para.ox];
    accum_uv_cell_1_49_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+accum_uv_cell_1_49_para.oz][Proc.lat_hw -0+accum_uv_cell_1_49_para.oy][Proc.lon_hw -1+accum_uv_cell_1_49_para.ox];
    accum_uv_cell_1_49_para.de_lon = &mesh->de_lon[0][0][0];
    accum_uv_cell_1_49_para.dt = dt;
    
    athread_spawn(accum_uv_cell_1_49, &accum_uv_cell_1_49_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_50_info accum_uv_cell_1_50_para;
    accum_uv_cell_1_50_para.lz = 32 - 0;
    accum_uv_cell_1_50_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_50_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_50_para.oz = 0;
    accum_uv_cell_1_50_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_50_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_50_para.hx = 0;
    accum_uv_cell_1_50_para.hy = 1;
    accum_uv_cell_1_50_para.hz = 0;
    accum_uv_cell_1_50_para.bx = 256;
    accum_uv_cell_1_50_para.by = 8;
    accum_uv_cell_1_50_para.bz = 1;
    accum_uv_cell_1_50_para.mx = 1;
    accum_uv_cell_1_50_para.my = 2;
    accum_uv_cell_1_50_para.mz = 32;
    accum_uv_cell_1_50_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_50_para.oz][Proc.lat_hw -1+accum_uv_cell_1_50_para.oy][Proc.lon_hw -0+accum_uv_cell_1_50_para.ox];
    accum_uv_cell_1_50_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+accum_uv_cell_1_50_para.oz][Proc.lat_hw -1+accum_uv_cell_1_50_para.oy][Proc.lon_hw -0+accum_uv_cell_1_50_para.ox];
    accum_uv_cell_1_50_para.de_lat = &mesh->de_lat[0][0][0];
    accum_uv_cell_1_50_para.dt = dt;
    
    athread_spawn(accum_uv_cell_1_50, &accum_uv_cell_1_50_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_51_info accum_uv_cell_1_51_para;
    accum_uv_cell_1_51_para.lz = 32 - 0;
    accum_uv_cell_1_51_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_1_51_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_51_para.oz = 0;
    accum_uv_cell_1_51_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_1_51_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_51_para.hx = 1;
    accum_uv_cell_1_51_para.hy = 1;
    accum_uv_cell_1_51_para.hz = 0;
    accum_uv_cell_1_51_para.bx = 256;
    accum_uv_cell_1_51_para.by = 8;
    accum_uv_cell_1_51_para.bz = 1;
    accum_uv_cell_1_51_para.mx = 1;
    accum_uv_cell_1_51_para.my = 2;
    accum_uv_cell_1_51_para.mz = 32;
    accum_uv_cell_1_51_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_1_51_para.oz][Proc.lat_hw -1+accum_uv_cell_1_51_para.oy][Proc.lon_hw -1+accum_uv_cell_1_51_para.ox];
    accum_uv_cell_1_51_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_1_51_para.oz][Proc.lat_hw -1+accum_uv_cell_1_51_para.oy][Proc.lon_hw -1+accum_uv_cell_1_51_para.ox];
    accum_uv_cell_1_51_para.advptdivx = &advpt->divx[Proc.lev_hw - 0+accum_uv_cell_1_51_para.oz][Proc.lat_hw -1+accum_uv_cell_1_51_para.oy][Proc.lon_hw -1+accum_uv_cell_1_51_para.ox];
    accum_uv_cell_1_51_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+accum_uv_cell_1_51_para.oz][Proc.lat_hw -1+accum_uv_cell_1_51_para.oy][Proc.lon_hw -1+accum_uv_cell_1_51_para.ox];
    accum_uv_cell_1_51_para.le_lon = &mesh->le_lon[0][0][0];
    accum_uv_cell_1_51_para.area_cell = &mesh->area_cell[0][0][0];
    accum_uv_cell_1_51_para.le_lat = &mesh->le_lat[0][0][0];
    
    athread_spawn(accum_uv_cell_1_51, &accum_uv_cell_1_51_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    
    
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_1_12_info calc_mf_1_12_para;
  calc_mf_1_12_para.lz = 32 - 0;
  calc_mf_1_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_1_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_1_12_para.oz = 0;
  calc_mf_1_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_1_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_1_12_para.hx = 1;
  calc_mf_1_12_para.hy = 1;
  calc_mf_1_12_para.hz = 0;
  calc_mf_1_12_para.bx = 256;
  calc_mf_1_12_para.by = 8;
  calc_mf_1_12_para.bz = 1;
  calc_mf_1_12_para.mx = 1;
  calc_mf_1_12_para.my = 2;
  calc_mf_1_12_para.mz = 32;
  calc_mf_1_12_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 0+calc_mf_1_12_para.oz][Proc.lat_hw -1+calc_mf_1_12_para.oy][Proc.lon_hw -1+calc_mf_1_12_para.ox];
  calc_mf_1_12_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_mf_1_12_para.oz][Proc.lat_hw -1+calc_mf_1_12_para.oy][Proc.lon_hw -1+calc_mf_1_12_para.ox];
  calc_mf_1_12_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_mf_1_12_para.oz][Proc.lat_hw -1+calc_mf_1_12_para.oy][Proc.lon_hw -1+calc_mf_1_12_para.ox];
  
  athread_spawn(calc_mf_1_12, &calc_mf_1_12_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->mfx_lon[0][0][0], &Proc.FieldReq[async_mfx_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_1_13_info calc_mf_1_13_para;
  calc_mf_1_13_para.lz = 32 - 0;
  calc_mf_1_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_1_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_1_13_para.oz = 0;
  calc_mf_1_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_1_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_1_13_para.hx = 1;
  calc_mf_1_13_para.hy = 1;
  calc_mf_1_13_para.hz = 0;
  calc_mf_1_13_para.bx = 256;
  calc_mf_1_13_para.by = 8;
  calc_mf_1_13_para.bz = 1;
  calc_mf_1_13_para.mx = 1;
  calc_mf_1_13_para.my = 2;
  calc_mf_1_13_para.mz = 32;
  calc_mf_1_13_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 0+calc_mf_1_13_para.oz][Proc.lat_hw -1+calc_mf_1_13_para.oy][Proc.lon_hw -1+calc_mf_1_13_para.ox];
  calc_mf_1_13_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_mf_1_13_para.oz][Proc.lat_hw -1+calc_mf_1_13_para.oy][Proc.lon_hw -1+calc_mf_1_13_para.ox];
  calc_mf_1_13_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_mf_1_13_para.oz][Proc.lat_hw -1+calc_mf_1_13_para.oy][Proc.lon_hw -1+calc_mf_1_13_para.ox];
  
  athread_spawn(calc_mf_1_13, &calc_mf_1_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->mfy_lat[0][0][0], &Proc.FieldReq[async_mfy_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  if (((advPara->mf_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfx[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfy[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->mf_step) = 1;
  }
  if (((advPara->mf_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_1_18_info accum_mf_cell_1_18_para;
    accum_mf_cell_1_18_para.lz = 32 - 0;
    accum_mf_cell_1_18_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_1_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_1_18_para.oz = 0;
    accum_mf_cell_1_18_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_1_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_1_18_para.hx = 1;
    accum_mf_cell_1_18_para.hy = 1;
    accum_mf_cell_1_18_para.hz = 0;
    accum_mf_cell_1_18_para.bx = 256;
    accum_mf_cell_1_18_para.by = 8;
    accum_mf_cell_1_18_para.bz = 1;
    accum_mf_cell_1_18_para.mx = 1;
    accum_mf_cell_1_18_para.my = 2;
    accum_mf_cell_1_18_para.mz = 32;
    accum_mf_cell_1_18_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_1_18_para.oz][Proc.lat_hw -1+accum_mf_cell_1_18_para.oy][Proc.lon_hw -1+accum_mf_cell_1_18_para.ox];
    accum_mf_cell_1_18_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_1_18_para.oz][Proc.lat_hw -1+accum_mf_cell_1_18_para.oy][Proc.lon_hw -1+accum_mf_cell_1_18_para.ox];
    
    athread_spawn(accum_mf_cell_1_18, &accum_mf_cell_1_18_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_1_19_info accum_mf_cell_1_19_para;
    accum_mf_cell_1_19_para.lz = 32 - 0;
    accum_mf_cell_1_19_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_1_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_1_19_para.oz = 0;
    accum_mf_cell_1_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_1_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_1_19_para.hx = 1;
    accum_mf_cell_1_19_para.hy = 1;
    accum_mf_cell_1_19_para.hz = 0;
    accum_mf_cell_1_19_para.bx = 256;
    accum_mf_cell_1_19_para.by = 8;
    accum_mf_cell_1_19_para.bz = 1;
    accum_mf_cell_1_19_para.mx = 1;
    accum_mf_cell_1_19_para.my = 2;
    accum_mf_cell_1_19_para.mz = 32;
    accum_mf_cell_1_19_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_1_19_para.oz][Proc.lat_hw -1+accum_mf_cell_1_19_para.oy][Proc.lon_hw -1+accum_mf_cell_1_19_para.ox];
    accum_mf_cell_1_19_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_1_19_para.oz][Proc.lat_hw -1+accum_mf_cell_1_19_para.oy][Proc.lon_hw -1+accum_mf_cell_1_19_para.ox];
    
    athread_spawn(accum_mf_cell_1_19, &accum_mf_cell_1_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->mf_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_20_info accum_mf_cell_1_20_para;
      accum_mf_cell_1_20_para.lz = 32 - 0;
      accum_mf_cell_1_20_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_20_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_20_para.oz = 0;
      accum_mf_cell_1_20_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_20_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_20_para.hx = 1;
      accum_mf_cell_1_20_para.hy = 1;
      accum_mf_cell_1_20_para.hz = 0;
      accum_mf_cell_1_20_para.bx = 256;
      accum_mf_cell_1_20_para.by = 8;
      accum_mf_cell_1_20_para.bz = 1;
      accum_mf_cell_1_20_para.mx = 1;
      accum_mf_cell_1_20_para.my = 2;
      accum_mf_cell_1_20_para.mz = 32;
      accum_mf_cell_1_20_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_1_20_para.oz][Proc.lat_hw -1+accum_mf_cell_1_20_para.oy][Proc.lon_hw -1+accum_mf_cell_1_20_para.ox];
      accum_mf_cell_1_20_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_1_20_para.oz][Proc.lat_hw -1+accum_mf_cell_1_20_para.oy][Proc.lon_hw -1+accum_mf_cell_1_20_para.ox];
      accum_mf_cell_1_20_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_1_20, &accum_mf_cell_1_20_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_21_info accum_mf_cell_1_21_para;
      accum_mf_cell_1_21_para.lz = 32 - 0;
      accum_mf_cell_1_21_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_21_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_21_para.oz = 0;
      accum_mf_cell_1_21_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_21_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_21_para.hx = 1;
      accum_mf_cell_1_21_para.hy = 1;
      accum_mf_cell_1_21_para.hz = 0;
      accum_mf_cell_1_21_para.bx = 256;
      accum_mf_cell_1_21_para.by = 8;
      accum_mf_cell_1_21_para.bz = 1;
      accum_mf_cell_1_21_para.mx = 1;
      accum_mf_cell_1_21_para.my = 2;
      accum_mf_cell_1_21_para.mz = 32;
      accum_mf_cell_1_21_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_1_21_para.oz][Proc.lat_hw -1+accum_mf_cell_1_21_para.oy][Proc.lon_hw -1+accum_mf_cell_1_21_para.ox];
      accum_mf_cell_1_21_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_1_21_para.oz][Proc.lat_hw -1+accum_mf_cell_1_21_para.oy][Proc.lon_hw -1+accum_mf_cell_1_21_para.ox];
      accum_mf_cell_1_21_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_1_21, &accum_mf_cell_1_21_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_22_info accum_mf_cell_1_22_para;
      accum_mf_cell_1_22_para.lz = 32 - 0;
      accum_mf_cell_1_22_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_22_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_22_para.oz = 0;
      accum_mf_cell_1_22_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_22_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_22_para.hx = 1;
      accum_mf_cell_1_22_para.hy = 1;
      accum_mf_cell_1_22_para.hz = 0;
      accum_mf_cell_1_22_para.bx = 256;
      accum_mf_cell_1_22_para.by = 8;
      accum_mf_cell_1_22_para.bz = 1;
      accum_mf_cell_1_22_para.mx = 1;
      accum_mf_cell_1_22_para.my = 2;
      accum_mf_cell_1_22_para.mz = 32;
      accum_mf_cell_1_22_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_1_22_para.oz][Proc.lat_hw -1+accum_mf_cell_1_22_para.oy][Proc.lon_hw -1+accum_mf_cell_1_22_para.ox];
      accum_mf_cell_1_22_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_1_22_para.oz][Proc.lat_hw -1+accum_mf_cell_1_22_para.oy][Proc.lon_hw -1+accum_mf_cell_1_22_para.ox];
      
      athread_spawn(accum_mf_cell_1_22, &accum_mf_cell_1_22_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_23_info accum_mf_cell_1_23_para;
      accum_mf_cell_1_23_para.lz = 32 - 0;
      accum_mf_cell_1_23_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_23_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_23_para.oz = 0;
      accum_mf_cell_1_23_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_23_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_23_para.hx = 1;
      accum_mf_cell_1_23_para.hy = 1;
      accum_mf_cell_1_23_para.hz = 0;
      accum_mf_cell_1_23_para.bx = 256;
      accum_mf_cell_1_23_para.by = 8;
      accum_mf_cell_1_23_para.bz = 1;
      accum_mf_cell_1_23_para.mx = 1;
      accum_mf_cell_1_23_para.my = 2;
      accum_mf_cell_1_23_para.mz = 32;
      accum_mf_cell_1_23_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_1_23_para.oz][Proc.lat_hw -1+accum_mf_cell_1_23_para.oy][Proc.lon_hw -1+accum_mf_cell_1_23_para.ox];
      accum_mf_cell_1_23_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_1_23_para.oz][Proc.lat_hw -1+accum_mf_cell_1_23_para.oy][Proc.lon_hw -1+accum_mf_cell_1_23_para.ox];
      
      athread_spawn(accum_mf_cell_1_23, &accum_mf_cell_1_23_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->mf_step) = 0;
  }
  else
  {
    (advPara->mf_step) = ((advPara->mf_step) + 1);
  }
  if ((!(advPara->dynamic) && ((advPara->mf_step) > (advPara->nstep))))
  {
    (advPara->mf_step) = -1;
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_1_14_info calc_mf_1_14_para;
  calc_mf_1_14_para.lz = 32 - 0;
  calc_mf_1_14_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_1_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_1_14_para.oz = 0;
  calc_mf_1_14_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_1_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_1_14_para.hx = 1;
  calc_mf_1_14_para.hy = 1;
  calc_mf_1_14_para.hz = 0;
  calc_mf_1_14_para.bx = 256;
  calc_mf_1_14_para.by = 8;
  calc_mf_1_14_para.bz = 1;
  calc_mf_1_14_para.mx = 1;
  calc_mf_1_14_para.my = 2;
  calc_mf_1_14_para.mz = 32;
  calc_mf_1_14_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_mf_1_14_para.oz][Proc.lat_hw -1+calc_mf_1_14_para.oy][Proc.lon_hw -1+calc_mf_1_14_para.ox];
  calc_mf_1_14_para.star_statemfx_lat = &star_state->mfx_lat[Proc.lev_hw - 0+calc_mf_1_14_para.oz][Proc.lat_hw -1+calc_mf_1_14_para.oy][Proc.lon_hw -1+calc_mf_1_14_para.ox];
  calc_mf_1_14_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 0+calc_mf_1_14_para.oz][Proc.lat_hw -1+calc_mf_1_14_para.oy][Proc.lon_hw -1+calc_mf_1_14_para.ox];
  calc_mf_1_14_para.star_stateu_lat = &star_state->u_lat[Proc.lev_hw - 0+calc_mf_1_14_para.oz][Proc.lat_hw -1+calc_mf_1_14_para.oy][Proc.lon_hw -1+calc_mf_1_14_para.ox];
  calc_mf_1_14_para.half_tangent_wgt_0 = &mesh->half_tangent_wgt_0[0][0][0];
  calc_mf_1_14_para.half_tangent_wgt_1 = &mesh->half_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_1_14, &calc_mf_1_14_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_1_15_info calc_mf_1_15_para;
  calc_mf_1_15_para.lz = 32 - 0;
  calc_mf_1_15_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_1_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_1_15_para.oz = 0;
  calc_mf_1_15_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_1_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_1_15_para.hx = 1;
  calc_mf_1_15_para.hy = 1;
  calc_mf_1_15_para.hz = 0;
  calc_mf_1_15_para.bx = 256;
  calc_mf_1_15_para.by = 8;
  calc_mf_1_15_para.bz = 1;
  calc_mf_1_15_para.mx = 1;
  calc_mf_1_15_para.my = 2;
  calc_mf_1_15_para.mz = 32;
  calc_mf_1_15_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_mf_1_15_para.oz][Proc.lat_hw -1+calc_mf_1_15_para.oy][Proc.lon_hw -1+calc_mf_1_15_para.ox];
  calc_mf_1_15_para.star_statemfy_lon = &star_state->mfy_lon[Proc.lev_hw - 0+calc_mf_1_15_para.oz][Proc.lat_hw -1+calc_mf_1_15_para.oy][Proc.lon_hw -1+calc_mf_1_15_para.ox];
  calc_mf_1_15_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 0+calc_mf_1_15_para.oz][Proc.lat_hw -1+calc_mf_1_15_para.oy][Proc.lon_hw -1+calc_mf_1_15_para.ox];
  calc_mf_1_15_para.star_statev_lon = &star_state->v_lon[Proc.lev_hw - 0+calc_mf_1_15_para.oz][Proc.lat_hw -1+calc_mf_1_15_para.oy][Proc.lon_hw -1+calc_mf_1_15_para.ox];
  calc_mf_1_15_para.full_tangent_wgt_0 = &mesh->full_tangent_wgt_0[0][0][0];
  calc_mf_1_15_para.full_tangent_wgt_1 = &mesh->full_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_1_15, &calc_mf_1_15_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  ke_vtx = (struct Vector4){0.0,0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_1_6_info calc_ke_1_6_para;
  calc_ke_1_6_para.lz = 32 - 0;
  calc_ke_1_6_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_1_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_1_6_para.oz = 0;
  calc_ke_1_6_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_1_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_1_6_para.hx = 1;
  calc_ke_1_6_para.hy = 1;
  calc_ke_1_6_para.hz = 0;
  calc_ke_1_6_para.bx = 256;
  calc_ke_1_6_para.by = 8;
  calc_ke_1_6_para.bz = 1;
  calc_ke_1_6_para.mx = 1;
  calc_ke_1_6_para.my = 2;
  calc_ke_1_6_para.mz = 32;
  calc_ke_1_6_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_ke_1_6_para.oz][Proc.lat_hw -1+calc_ke_1_6_para.oy][Proc.lon_hw -1+calc_ke_1_6_para.ox];
  calc_ke_1_6_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_ke_1_6_para.oz][Proc.lat_hw -1+calc_ke_1_6_para.oy][Proc.lon_hw -1+calc_ke_1_6_para.ox];
  calc_ke_1_6_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_ke_1_6_para.oz][Proc.lat_hw -1+calc_ke_1_6_para.oy][Proc.lon_hw -1+calc_ke_1_6_para.ox];
  calc_ke_1_6_para.area_lon_west = &mesh->area_lon_west[0][0][0];
  calc_ke_1_6_para.area_lon_east = &mesh->area_lon_east[0][0][0];
  calc_ke_1_6_para.area_lat_north = &mesh->area_lat_north[0][0][0];
  calc_ke_1_6_para.area_lat_south = &mesh->area_lat_south[0][0][0];
  calc_ke_1_6_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_1_6, &calc_ke_1_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_1_7_info calc_ke_1_7_para;
  calc_ke_1_7_para.lz = 32 - 0;
  calc_ke_1_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_1_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_1_7_para.oz = 0;
  calc_ke_1_7_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_1_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_1_7_para.hx = 1;
  calc_ke_1_7_para.hy = 1;
  calc_ke_1_7_para.hz = 0;
  calc_ke_1_7_para.bx = 256;
  calc_ke_1_7_para.by = 8;
  calc_ke_1_7_para.bz = 1;
  calc_ke_1_7_para.mx = 1;
  calc_ke_1_7_para.my = 2;
  calc_ke_1_7_para.mz = 32;
  calc_ke_1_7_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_ke_1_7_para.oz][Proc.lat_hw -1+calc_ke_1_7_para.oy][Proc.lon_hw -1+calc_ke_1_7_para.ox];
  calc_ke_1_7_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_ke_1_7_para.oz][Proc.lat_hw -1+calc_ke_1_7_para.oy][Proc.lon_hw -1+calc_ke_1_7_para.ox];
  calc_ke_1_7_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_ke_1_7_para.oz][Proc.lat_hw -1+calc_ke_1_7_para.oy][Proc.lon_hw -1+calc_ke_1_7_para.ox];
  calc_ke_1_7_para.area_lat_east = &mesh->area_lat_east[0][0][0];
  calc_ke_1_7_para.area_lat_west = &mesh->area_lat_west[0][0][0];
  calc_ke_1_7_para.area_lon_north = &mesh->area_lon_north[0][0][0];
  calc_ke_1_7_para.area_lon_south = &mesh->area_lon_south[0][0][0];
  calc_ke_1_7_para.area_vtx = &mesh->area_vtx[0][0][0];
  calc_ke_1_7_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  calc_ke_1_7_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  calc_ke_1_7_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_1_7, &calc_ke_1_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ke[0][0][0], &Proc.FieldReq[async_ke], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_1_3_info calc_div_1_3_para;
  calc_div_1_3_para.lz = 32 - 0;
  calc_div_1_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_div_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_1_3_para.oz = 0;
  calc_div_1_3_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_div_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_1_3_para.hx = 1;
  calc_div_1_3_para.hy = 1;
  calc_div_1_3_para.hz = 0;
  calc_div_1_3_para.bx = 256;
  calc_div_1_3_para.by = 8;
  calc_div_1_3_para.bz = 1;
  calc_div_1_3_para.mx = 1;
  calc_div_1_3_para.my = 2;
  calc_div_1_3_para.mz = 32;
  calc_div_1_3_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_div_1_3_para.oz][Proc.lat_hw -1+calc_div_1_3_para.oy][Proc.lon_hw -1+calc_div_1_3_para.ox];
  calc_div_1_3_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_div_1_3_para.oz][Proc.lat_hw -1+calc_div_1_3_para.oy][Proc.lon_hw -1+calc_div_1_3_para.ox];
  calc_div_1_3_para.star_statediv = &star_state->div[Proc.lev_hw - 0+calc_div_1_3_para.oz][Proc.lat_hw -1+calc_div_1_3_para.oy][Proc.lon_hw -1+calc_div_1_3_para.ox];
  calc_div_1_3_para.le_lon = &mesh->le_lon[0][0][0];
  calc_div_1_3_para.le_lat = &mesh->le_lat[0][0][0];
  calc_div_1_3_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_div_1_3, &calc_div_1_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divdivTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->div[0][0][0], &Proc.FieldReq[async_div], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_1_3_info calc_vor_1_3_para;
  calc_vor_1_3_para.lz = 32 - 0;
  calc_vor_1_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_vor_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_1_3_para.oz = 0;
  calc_vor_1_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_vor_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_1_3_para.hx = 1;
  calc_vor_1_3_para.hy = 1;
  calc_vor_1_3_para.hz = 0;
  calc_vor_1_3_para.bx = 256;
  calc_vor_1_3_para.by = 8;
  calc_vor_1_3_para.bz = 1;
  calc_vor_1_3_para.mx = 1;
  calc_vor_1_3_para.my = 2;
  calc_vor_1_3_para.mz = 32;
  calc_vor_1_3_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_vor_1_3_para.oz][Proc.lat_hw -1+calc_vor_1_3_para.oy][Proc.lon_hw -1+calc_vor_1_3_para.ox];
  calc_vor_1_3_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_vor_1_3_para.oz][Proc.lat_hw -1+calc_vor_1_3_para.oy][Proc.lon_hw -1+calc_vor_1_3_para.ox];
  calc_vor_1_3_para.star_statevor = &star_state->vor[Proc.lev_hw - 0+calc_vor_1_3_para.oz][Proc.lat_hw -1+calc_vor_1_3_para.oy][Proc.lon_hw -1+calc_vor_1_3_para.ox];
  calc_vor_1_3_para.de_lon = &mesh->de_lon[0][0][0];
  calc_vor_1_3_para.de_lat = &mesh->de_lat[0][0][0];
  calc_vor_1_3_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(calc_vor_1_3, &calc_vor_1_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vorvorTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_pv_1_3_info calc_pv_1_3_para;
  calc_pv_1_3_para.lz = 32 - 0;
  calc_pv_1_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_pv_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_pv_1_3_para.oz = 0;
  calc_pv_1_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_pv_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_pv_1_3_para.hx = 2;
  calc_pv_1_3_para.hy = 2;
  calc_pv_1_3_para.hz = 0;
  calc_pv_1_3_para.bx = 256;
  calc_pv_1_3_para.by = 8;
  calc_pv_1_3_para.bz = 1;
  calc_pv_1_3_para.mx = 1;
  calc_pv_1_3_para.my = 2;
  calc_pv_1_3_para.mz = 32;
  calc_pv_1_3_para.star_statevor = &star_state->vor[Proc.lev_hw - 0+calc_pv_1_3_para.oz][Proc.lat_hw -2+calc_pv_1_3_para.oy][Proc.lon_hw -2+calc_pv_1_3_para.ox];
  calc_pv_1_3_para.star_statem_vtx = &star_state->m_vtx[Proc.lev_hw - 0+calc_pv_1_3_para.oz][Proc.lat_hw -2+calc_pv_1_3_para.oy][Proc.lon_hw -2+calc_pv_1_3_para.ox];
  calc_pv_1_3_para.star_statepv = &star_state->pv[Proc.lev_hw - 0+calc_pv_1_3_para.oz][Proc.lat_hw -2+calc_pv_1_3_para.oy][Proc.lon_hw -2+calc_pv_1_3_para.ox];
  calc_pv_1_3_para.half_f = &mesh->half_f[0][0][0];
  
  athread_spawn(calc_pv_1_3, &calc_pv_1_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_pvpvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pv[0][0][0], &Proc.FieldReq[async_pv], false, false, true, true, true, true, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_1_6_info interp_pv_upwind_1_6_para;
  interp_pv_upwind_1_6_para.lz = 32 - 0;
  interp_pv_upwind_1_6_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  interp_pv_upwind_1_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_1_6_para.oz = 0;
  interp_pv_upwind_1_6_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  interp_pv_upwind_1_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_1_6_para.hx = 2;
  interp_pv_upwind_1_6_para.hy = 2;
  interp_pv_upwind_1_6_para.hz = 0;
  interp_pv_upwind_1_6_para.bx = 256;
  interp_pv_upwind_1_6_para.by = 8;
  interp_pv_upwind_1_6_para.bz = 1;
  interp_pv_upwind_1_6_para.mx = 1;
  interp_pv_upwind_1_6_para.my = 2;
  interp_pv_upwind_1_6_para.mz = 32;
  interp_pv_upwind_1_6_para.star_statev_lon = &star_state->v_lon[Proc.lev_hw - 0+interp_pv_upwind_1_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_6_para.ox];
  interp_pv_upwind_1_6_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+interp_pv_upwind_1_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_6_para.ox];
  interp_pv_upwind_1_6_para.star_statepv = &star_state->pv[Proc.lev_hw - 0+interp_pv_upwind_1_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_6_para.ox];
  interp_pv_upwind_1_6_para.star_statepv_lon = &star_state->pv_lon[Proc.lev_hw - 0+interp_pv_upwind_1_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_6_para.ox];
  
  athread_spawn(interp_pv_upwind_1_6, &interp_pv_upwind_1_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pv_lon[0][0][0], &Proc.FieldReq[async_pv_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_1_7_info interp_pv_upwind_1_7_para;
  interp_pv_upwind_1_7_para.lz = 32 - 0;
  interp_pv_upwind_1_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interp_pv_upwind_1_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_1_7_para.oz = 0;
  interp_pv_upwind_1_7_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interp_pv_upwind_1_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_1_7_para.hx = 2;
  interp_pv_upwind_1_7_para.hy = 2;
  interp_pv_upwind_1_7_para.hz = 0;
  interp_pv_upwind_1_7_para.bx = 256;
  interp_pv_upwind_1_7_para.by = 8;
  interp_pv_upwind_1_7_para.bz = 1;
  interp_pv_upwind_1_7_para.mx = 1;
  interp_pv_upwind_1_7_para.my = 2;
  interp_pv_upwind_1_7_para.mz = 32;
  interp_pv_upwind_1_7_para.star_stateu_lat = &star_state->u_lat[Proc.lev_hw - 0+interp_pv_upwind_1_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_7_para.ox];
  interp_pv_upwind_1_7_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+interp_pv_upwind_1_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_7_para.ox];
  interp_pv_upwind_1_7_para.star_statepv = &star_state->pv[Proc.lev_hw - 0+interp_pv_upwind_1_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_7_para.ox];
  interp_pv_upwind_1_7_para.star_statepv_lat = &star_state->pv_lat[Proc.lev_hw - 0+interp_pv_upwind_1_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_1_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_1_7_para.ox];
  
  athread_spawn(interp_pv_upwind_1_7, &interp_pv_upwind_1_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pv_lat[0][0][0], &Proc.FieldReq[async_pv_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_mf_1_4_info calc_grad_mf_1_4_para;
  calc_grad_mf_1_4_para.lz = 32 - 0;
  calc_grad_mf_1_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_mf_1_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_mf_1_4_para.oz = 0;
  calc_grad_mf_1_4_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_mf_1_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_mf_1_4_para.hx = 1;
  calc_grad_mf_1_4_para.hy = 1;
  calc_grad_mf_1_4_para.hz = 0;
  calc_grad_mf_1_4_para.bx = 256;
  calc_grad_mf_1_4_para.by = 8;
  calc_grad_mf_1_4_para.bz = 1;
  calc_grad_mf_1_4_para.mx = 1;
  calc_grad_mf_1_4_para.my = 2;
  calc_grad_mf_1_4_para.mz = 32;
  calc_grad_mf_1_4_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_grad_mf_1_4_para.oz][Proc.lat_hw -1+calc_grad_mf_1_4_para.oy][Proc.lon_hw -1+calc_grad_mf_1_4_para.ox];
  calc_grad_mf_1_4_para.tend1dmfdlon = &tend1->dmfdlon[Proc.lev_hw - 0+calc_grad_mf_1_4_para.oz][Proc.lat_hw -1+calc_grad_mf_1_4_para.oy][Proc.lon_hw -1+calc_grad_mf_1_4_para.ox];
  calc_grad_mf_1_4_para.le_lon = &mesh->le_lon[0][0][0];
  calc_grad_mf_1_4_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_mf_1_4, &calc_grad_mf_1_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_mfdmfdlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_mf_1_5_info calc_grad_mf_1_5_para;
  calc_grad_mf_1_5_para.lz = 32 - 0;
  calc_grad_mf_1_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_mf_1_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_mf_1_5_para.oz = 0;
  calc_grad_mf_1_5_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_mf_1_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_mf_1_5_para.hx = 1;
  calc_grad_mf_1_5_para.hy = 1;
  calc_grad_mf_1_5_para.hz = 0;
  calc_grad_mf_1_5_para.bx = 256;
  calc_grad_mf_1_5_para.by = 8;
  calc_grad_mf_1_5_para.bz = 1;
  calc_grad_mf_1_5_para.mx = 1;
  calc_grad_mf_1_5_para.my = 2;
  calc_grad_mf_1_5_para.mz = 32;
  calc_grad_mf_1_5_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_grad_mf_1_5_para.oz][Proc.lat_hw -1+calc_grad_mf_1_5_para.oy][Proc.lon_hw -1+calc_grad_mf_1_5_para.ox];
  calc_grad_mf_1_5_para.tend1dmfdlat = &tend1->dmfdlat[Proc.lev_hw - 0+calc_grad_mf_1_5_para.oz][Proc.lat_hw -1+calc_grad_mf_1_5_para.oy][Proc.lon_hw -1+calc_grad_mf_1_5_para.ox];
  calc_grad_mf_1_5_para.le_lat = &mesh->le_lat[0][0][0];
  calc_grad_mf_1_5_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_mf_1_5, &calc_grad_mf_1_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_mfdmfdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
    for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
      tend1->dphs[0][j][i] = 0.0;
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_dphsdtdphsTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_dphs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tend1->dphs[0][j][i] = ((tend1->dphs[0][j][i] - tend1->dmfdlon[k][j][i]) - tend1->dmfdlat[k][j][i]);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_dphsdtdphsTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_2d_D(Proc, &tend1->dphs[0][0][0], &Proc.FieldReq[async_dphs], true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  dt = dt;
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->we_lev[k][j][i] = 0.0;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_we_levwe_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=32+Proc.lev_hw; k<33+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->we_lev[k][j][i] = 0.0;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_we_levwe_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_dphs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=1+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        mfs = 0.0;
        for (l=0+Proc.lev_hw;l<((k - 1) + 1);l+=1){
          mfs = ((mfs + tend1->dmfdlon[l][j][i]) + tend1->dmfdlat[l][j][i]);
        }
        star_state->we_lev[k][j][i] = (-hybrid_coord_calc_dphdt_lev(mesh->hybi[k][0][0],tend1->dphs[0][j][i]) - mfs);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_we_levwe_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->we_lev[0][0][0], &Proc.FieldReq[async_we_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  dt = dt;
  if (((advPara->we_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_1_10_info accum_we_lev_1_10_para;
    accum_we_lev_1_10_para.lz = 33 - 0;
    accum_we_lev_1_10_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_1_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_1_10_para.oz = 0;
    accum_we_lev_1_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_1_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_1_10_para.hx = 0;
    accum_we_lev_1_10_para.hy = 0;
    accum_we_lev_1_10_para.hz = 0;
    accum_we_lev_1_10_para.bx = 256;
    accum_we_lev_1_10_para.by = 8;
    accum_we_lev_1_10_para.bz = 1;
    accum_we_lev_1_10_para.mx = 1;
    accum_we_lev_1_10_para.my = 2;
    accum_we_lev_1_10_para.mz = 32;
    accum_we_lev_1_10_para.advptwe0 = &advpt->we0[Proc.lev_hw - 0+accum_we_lev_1_10_para.oz][Proc.lat_hw -0+accum_we_lev_1_10_para.oy][Proc.lon_hw -0+accum_we_lev_1_10_para.ox];
    accum_we_lev_1_10_para.advptm0 = &advpt->m0[Proc.lev_hw - 0+accum_we_lev_1_10_para.oz][Proc.lat_hw -0+accum_we_lev_1_10_para.oy][Proc.lon_hw -0+accum_we_lev_1_10_para.ox];
    accum_we_lev_1_10_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_1_10_para.oz][Proc.lat_hw -0+accum_we_lev_1_10_para.oy][Proc.lon_hw -0+accum_we_lev_1_10_para.ox];
    accum_we_lev_1_10_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_1_10_para.oz][Proc.lat_hw -0+accum_we_lev_1_10_para.oy][Proc.lon_hw -0+accum_we_lev_1_10_para.ox];
    
    athread_spawn(accum_we_lev_1_10, &accum_we_lev_1_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->we_step) = 1;
  }
  if (((advPara->we_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_1_11_info accum_we_lev_1_11_para;
    accum_we_lev_1_11_para.lz = 33 - 0;
    accum_we_lev_1_11_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_1_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_1_11_para.oz = 0;
    accum_we_lev_1_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_1_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_1_11_para.hx = 1;
    accum_we_lev_1_11_para.hy = 1;
    accum_we_lev_1_11_para.hz = 0;
    accum_we_lev_1_11_para.bx = 256;
    accum_we_lev_1_11_para.by = 8;
    accum_we_lev_1_11_para.bz = 1;
    accum_we_lev_1_11_para.mx = 1;
    accum_we_lev_1_11_para.my = 2;
    accum_we_lev_1_11_para.mz = 32;
    accum_we_lev_1_11_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+accum_we_lev_1_11_para.oz][Proc.lat_hw -1+accum_we_lev_1_11_para.oy][Proc.lon_hw -1+accum_we_lev_1_11_para.ox];
    accum_we_lev_1_11_para.star_statem_lev = &star_state->m_lev[Proc.lev_hw - 0+accum_we_lev_1_11_para.oz][Proc.lat_hw -1+accum_we_lev_1_11_para.oy][Proc.lon_hw -1+accum_we_lev_1_11_para.ox];
    accum_we_lev_1_11_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_1_11_para.oz][Proc.lat_hw -1+accum_we_lev_1_11_para.oy][Proc.lon_hw -1+accum_we_lev_1_11_para.ox];
    accum_we_lev_1_11_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_1_11_para.oz][Proc.lat_hw -1+accum_we_lev_1_11_para.oy][Proc.lon_hw -1+accum_we_lev_1_11_para.ox];
    
    athread_spawn(accum_we_lev_1_11, &accum_we_lev_1_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->we_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_1_12_info accum_we_lev_1_12_para;
      accum_we_lev_1_12_para.lz = 33 - 0;
      accum_we_lev_1_12_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_1_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_1_12_para.oz = 0;
      accum_we_lev_1_12_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_1_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_1_12_para.hx = 1;
      accum_we_lev_1_12_para.hy = 1;
      accum_we_lev_1_12_para.hz = 0;
      accum_we_lev_1_12_para.bx = 256;
      accum_we_lev_1_12_para.by = 8;
      accum_we_lev_1_12_para.bz = 1;
      accum_we_lev_1_12_para.mx = 1;
      accum_we_lev_1_12_para.my = 2;
      accum_we_lev_1_12_para.mz = 32;
      accum_we_lev_1_12_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_1_12_para.oz][Proc.lat_hw -1+accum_we_lev_1_12_para.oy][Proc.lon_hw -1+accum_we_lev_1_12_para.ox];
      accum_we_lev_1_12_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+accum_we_lev_1_12_para.oz][Proc.lat_hw -1+accum_we_lev_1_12_para.oy][Proc.lon_hw -1+accum_we_lev_1_12_para.ox];
      accum_we_lev_1_12_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_1_12_para.oz][Proc.lat_hw -1+accum_we_lev_1_12_para.oy][Proc.lon_hw -1+accum_we_lev_1_12_para.ox];
      accum_we_lev_1_12_para.star_statem_lev = &star_state->m_lev[Proc.lev_hw - 0+accum_we_lev_1_12_para.oz][Proc.lat_hw -1+accum_we_lev_1_12_para.oy][Proc.lon_hw -1+accum_we_lev_1_12_para.ox];
      accum_we_lev_1_12_para.advptwe0 = &advpt->we0[Proc.lev_hw - 0+accum_we_lev_1_12_para.oz][Proc.lat_hw -1+accum_we_lev_1_12_para.oy][Proc.lon_hw -1+accum_we_lev_1_12_para.ox];
      accum_we_lev_1_12_para.advptm0 = &advpt->m0[Proc.lev_hw - 0+accum_we_lev_1_12_para.oz][Proc.lat_hw -1+accum_we_lev_1_12_para.oy][Proc.lon_hw -1+accum_we_lev_1_12_para.ox];
      accum_we_lev_1_12_para.nstep = advPara->nstep;
      
      athread_spawn(accum_we_lev_1_12, &accum_we_lev_1_12_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_1_13_info accum_we_lev_1_13_para;
      accum_we_lev_1_13_para.lz = 33 - 0;
      accum_we_lev_1_13_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_1_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_1_13_para.oz = 0;
      accum_we_lev_1_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_1_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_1_13_para.hx = 1;
      accum_we_lev_1_13_para.hy = 1;
      accum_we_lev_1_13_para.hz = 0;
      accum_we_lev_1_13_para.bx = 256;
      accum_we_lev_1_13_para.by = 8;
      accum_we_lev_1_13_para.bz = 1;
      accum_we_lev_1_13_para.mx = 1;
      accum_we_lev_1_13_para.my = 2;
      accum_we_lev_1_13_para.mz = 32;
      accum_we_lev_1_13_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_1_13_para.oz][Proc.lat_hw -1+accum_we_lev_1_13_para.oy][Proc.lon_hw -1+accum_we_lev_1_13_para.ox];
      accum_we_lev_1_13_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+accum_we_lev_1_13_para.oz][Proc.lat_hw -1+accum_we_lev_1_13_para.oy][Proc.lon_hw -1+accum_we_lev_1_13_para.ox];
      accum_we_lev_1_13_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_1_13_para.oz][Proc.lat_hw -1+accum_we_lev_1_13_para.oy][Proc.lon_hw -1+accum_we_lev_1_13_para.ox];
      accum_we_lev_1_13_para.star_statem_lev = &star_state->m_lev[Proc.lev_hw - 0+accum_we_lev_1_13_para.oz][Proc.lat_hw -1+accum_we_lev_1_13_para.oy][Proc.lon_hw -1+accum_we_lev_1_13_para.ox];
      
      athread_spawn(accum_we_lev_1_13, &accum_we_lev_1_13_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->we_step) = 0;
  }
  else
  {
    (advPara->we_step) = ((advPara->we_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->we_step) > (advPara->nstep))))
  {
    if (((advPara->dynamic) == 0))
    {
      (advPara->we_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_1_14_info accum_we_lev_1_14_para;
    accum_we_lev_1_14_para.lz = 32 - 1;
    accum_we_lev_1_14_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_1_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_1_14_para.oz = 1;
    accum_we_lev_1_14_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_1_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_1_14_para.hx = 0;
    accum_we_lev_1_14_para.hy = 0;
    accum_we_lev_1_14_para.hz = 0;
    accum_we_lev_1_14_para.bx = 256;
    accum_we_lev_1_14_para.by = 8;
    accum_we_lev_1_14_para.bz = 1;
    accum_we_lev_1_14_para.mx = 1;
    accum_we_lev_1_14_para.my = 2;
    accum_we_lev_1_14_para.mz = 32;
    accum_we_lev_1_14_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_1_14_para.oz][Proc.lat_hw -0+accum_we_lev_1_14_para.oy][Proc.lon_hw -0+accum_we_lev_1_14_para.ox];
    accum_we_lev_1_14_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_1_14_para.oz][Proc.lat_hw -0+accum_we_lev_1_14_para.oy][Proc.lon_hw -0+accum_we_lev_1_14_para.ox];
    accum_we_lev_1_14_para.advptcflz = &advpt->cflz[Proc.lev_hw - 0+accum_we_lev_1_14_para.oz][Proc.lat_hw -0+accum_we_lev_1_14_para.oy][Proc.lon_hw -0+accum_we_lev_1_14_para.ox];
    accum_we_lev_1_14_para.dt = dt;
    
    athread_spawn(accum_we_lev_1_14, &accum_we_lev_1_14_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levcflzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_lev_edge_to_lev_lon_edge_1_2_info interp_lev_edge_to_lev_lon_edge_1_2_para;
  interp_lev_edge_to_lev_lon_edge_1_2_para.lz = 33 - 0;
  interp_lev_edge_to_lev_lon_edge_1_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  interp_lev_edge_to_lev_lon_edge_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_lev_edge_to_lev_lon_edge_1_2_para.oz = 0;
  interp_lev_edge_to_lev_lon_edge_1_2_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  interp_lev_edge_to_lev_lon_edge_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_lev_edge_to_lev_lon_edge_1_2_para.hx = 1;
  interp_lev_edge_to_lev_lon_edge_1_2_para.hy = 1;
  interp_lev_edge_to_lev_lon_edge_1_2_para.hz = 0;
  interp_lev_edge_to_lev_lon_edge_1_2_para.bx = 256;
  interp_lev_edge_to_lev_lon_edge_1_2_para.by = 8;
  interp_lev_edge_to_lev_lon_edge_1_2_para.bz = 1;
  interp_lev_edge_to_lev_lon_edge_1_2_para.mx = 1;
  interp_lev_edge_to_lev_lon_edge_1_2_para.my = 2;
  interp_lev_edge_to_lev_lon_edge_1_2_para.mz = 32;
  interp_lev_edge_to_lev_lon_edge_1_2_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+interp_lev_edge_to_lev_lon_edge_1_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lon_edge_1_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lon_edge_1_2_para.ox];
  interp_lev_edge_to_lev_lon_edge_1_2_para.star_statewe_lev_lon = &star_state->we_lev_lon[Proc.lev_hw - 0+interp_lev_edge_to_lev_lon_edge_1_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lon_edge_1_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lon_edge_1_2_para.ox];
  interp_lev_edge_to_lev_lon_edge_1_2_para.area_lon_west = &mesh->area_lon_west[0][0][0];
  interp_lev_edge_to_lev_lon_edge_1_2_para.area_lon_east = &mesh->area_lon_east[0][0][0];
  interp_lev_edge_to_lev_lon_edge_1_2_para.area_lon = &mesh->area_lon[0][0][0];
  
  athread_spawn(interp_lev_edge_to_lev_lon_edge_1_2, &interp_lev_edge_to_lev_lon_edge_1_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_lev_edge_to_lev_lon_edgewe_lev_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_lev_edge_to_lev_lat_edge_1_2_info interp_lev_edge_to_lev_lat_edge_1_2_para;
  interp_lev_edge_to_lev_lat_edge_1_2_para.lz = 33 - 0;
  interp_lev_edge_to_lev_lat_edge_1_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interp_lev_edge_to_lev_lat_edge_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_lev_edge_to_lev_lat_edge_1_2_para.oz = 0;
  interp_lev_edge_to_lev_lat_edge_1_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interp_lev_edge_to_lev_lat_edge_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_lev_edge_to_lev_lat_edge_1_2_para.hx = 1;
  interp_lev_edge_to_lev_lat_edge_1_2_para.hy = 1;
  interp_lev_edge_to_lev_lat_edge_1_2_para.hz = 0;
  interp_lev_edge_to_lev_lat_edge_1_2_para.bx = 256;
  interp_lev_edge_to_lev_lat_edge_1_2_para.by = 8;
  interp_lev_edge_to_lev_lat_edge_1_2_para.bz = 1;
  interp_lev_edge_to_lev_lat_edge_1_2_para.mx = 1;
  interp_lev_edge_to_lev_lat_edge_1_2_para.my = 2;
  interp_lev_edge_to_lev_lat_edge_1_2_para.mz = 32;
  interp_lev_edge_to_lev_lat_edge_1_2_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+interp_lev_edge_to_lev_lat_edge_1_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lat_edge_1_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lat_edge_1_2_para.ox];
  interp_lev_edge_to_lev_lat_edge_1_2_para.star_statewe_lev_lat = &star_state->we_lev_lat[Proc.lev_hw - 0+interp_lev_edge_to_lev_lat_edge_1_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lat_edge_1_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lat_edge_1_2_para.ox];
  interp_lev_edge_to_lev_lat_edge_1_2_para.area_lat_north = &mesh->area_lat_north[0][0][0];
  interp_lev_edge_to_lev_lat_edge_1_2_para.area_lat_south = &mesh->area_lat_south[0][0][0];
  interp_lev_edge_to_lev_lat_edge_1_2_para.area_lat = &mesh->area_lat[0][0][0];
  
  athread_spawn(interp_lev_edge_to_lev_lat_edge_1_2, &interp_lev_edge_to_lev_lat_edge_1_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_lev_edge_to_lev_lat_edgewe_lev_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_1_8_info calc_wedudlev_wedvdlev_1_8_para;
  calc_wedudlev_wedvdlev_1_8_para.lz = 31 - 1;
  calc_wedudlev_wedvdlev_1_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_wedudlev_wedvdlev_1_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_1_8_para.oz = 1;
  calc_wedudlev_wedvdlev_1_8_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_1_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_1_8_para.hx = 1;
  calc_wedudlev_wedvdlev_1_8_para.hy = 0;
  calc_wedudlev_wedvdlev_1_8_para.hz = 1;
  calc_wedudlev_wedvdlev_1_8_para.bx = 256;
  calc_wedudlev_wedvdlev_1_8_para.by = 1;
  calc_wedudlev_wedvdlev_1_8_para.bz = 4;
  calc_wedudlev_wedvdlev_1_8_para.mx = 1;
  calc_wedudlev_wedvdlev_1_8_para.my = 8;
  calc_wedudlev_wedvdlev_1_8_para.mz = 8;
  calc_wedudlev_wedvdlev_1_8_para.star_statewe_lev_lon = &star_state->we_lev_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_8_para.ox];
  calc_wedudlev_wedvdlev_1_8_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_8_para.ox];
  calc_wedudlev_wedvdlev_1_8_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_8_para.ox];
  calc_wedudlev_wedvdlev_1_8_para.tend1wedudlev = &tend1->wedudlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_8_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_1_8, &calc_wedudlev_wedvdlev_1_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedudlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tend1->wedudlev[k][j][i] = (((star_state->we_lev_lon[(k + 1)][j][i] * (star_state->u_lon[(k + 1)][j][i] - star_state->u_lon[k][j][i])) / star_state->m_lon[k][j][i]) / 2.0);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedudlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_1_9_info calc_wedudlev_wedvdlev_1_9_para;
  calc_wedudlev_wedvdlev_1_9_para.lz = 32 - 31;
  calc_wedudlev_wedvdlev_1_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_wedudlev_wedvdlev_1_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_1_9_para.oz = 31;
  calc_wedudlev_wedvdlev_1_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_1_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_1_9_para.hx = 1;
  calc_wedudlev_wedvdlev_1_9_para.hy = 0;
  calc_wedudlev_wedvdlev_1_9_para.hz = 1;
  calc_wedudlev_wedvdlev_1_9_para.bx = 256;
  calc_wedudlev_wedvdlev_1_9_para.by = 1;
  calc_wedudlev_wedvdlev_1_9_para.bz = 4;
  calc_wedudlev_wedvdlev_1_9_para.mx = 1;
  calc_wedudlev_wedvdlev_1_9_para.my = 8;
  calc_wedudlev_wedvdlev_1_9_para.mz = 8;
  calc_wedudlev_wedvdlev_1_9_para.star_statewe_lev_lon = &star_state->we_lev_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_9_para.ox];
  calc_wedudlev_wedvdlev_1_9_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_9_para.ox];
  calc_wedudlev_wedvdlev_1_9_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_9_para.ox];
  calc_wedudlev_wedvdlev_1_9_para.tend1wedudlev = &tend1->wedudlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_9_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_1_9, &calc_wedudlev_wedvdlev_1_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedudlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_1_10_info calc_wedudlev_wedvdlev_1_10_para;
  calc_wedudlev_wedvdlev_1_10_para.lz = 31 - 1;
  calc_wedudlev_wedvdlev_1_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_wedudlev_wedvdlev_1_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_1_10_para.oz = 1;
  calc_wedudlev_wedvdlev_1_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_1_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_1_10_para.hx = 1;
  calc_wedudlev_wedvdlev_1_10_para.hy = 0;
  calc_wedudlev_wedvdlev_1_10_para.hz = 1;
  calc_wedudlev_wedvdlev_1_10_para.bx = 256;
  calc_wedudlev_wedvdlev_1_10_para.by = 1;
  calc_wedudlev_wedvdlev_1_10_para.bz = 4;
  calc_wedudlev_wedvdlev_1_10_para.mx = 1;
  calc_wedudlev_wedvdlev_1_10_para.my = 8;
  calc_wedudlev_wedvdlev_1_10_para.mz = 8;
  calc_wedudlev_wedvdlev_1_10_para.star_statewe_lev_lat = &star_state->we_lev_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_10_para.ox];
  calc_wedudlev_wedvdlev_1_10_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_10_para.ox];
  calc_wedudlev_wedvdlev_1_10_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_10_para.ox];
  calc_wedudlev_wedvdlev_1_10_para.tend1wedvdlev = &tend1->wedvdlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_10_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_1_10, &calc_wedudlev_wedvdlev_1_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedvdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tend1->wedvdlev[k][j][i] = (((star_state->we_lev_lat[(k + 1)][j][i] * (star_state->v_lat[(k + 1)][j][i] - star_state->v_lat[k][j][i])) / star_state->m_lat[k][j][i]) / 2.0);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedvdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_1_11_info calc_wedudlev_wedvdlev_1_11_para;
  calc_wedudlev_wedvdlev_1_11_para.lz = 32 - 31;
  calc_wedudlev_wedvdlev_1_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_wedudlev_wedvdlev_1_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_1_11_para.oz = 31;
  calc_wedudlev_wedvdlev_1_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_1_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_1_11_para.hx = 1;
  calc_wedudlev_wedvdlev_1_11_para.hy = 0;
  calc_wedudlev_wedvdlev_1_11_para.hz = 1;
  calc_wedudlev_wedvdlev_1_11_para.bx = 256;
  calc_wedudlev_wedvdlev_1_11_para.by = 1;
  calc_wedudlev_wedvdlev_1_11_para.bz = 4;
  calc_wedudlev_wedvdlev_1_11_para.mx = 1;
  calc_wedudlev_wedvdlev_1_11_para.my = 8;
  calc_wedudlev_wedvdlev_1_11_para.mz = 8;
  calc_wedudlev_wedvdlev_1_11_para.star_statewe_lev_lat = &star_state->we_lev_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_11_para.ox];
  calc_wedudlev_wedvdlev_1_11_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_11_para.ox];
  calc_wedudlev_wedvdlev_1_11_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_11_para.ox];
  calc_wedudlev_wedvdlev_1_11_para.tend1wedvdlev = &tend1->wedvdlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_1_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_1_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_1_11_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_1_11, &calc_wedudlev_wedvdlev_1_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedvdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  dt = dt;
  dt = dt;
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_1_6_info hflx_ppm_inner_1_6_para;
  hflx_ppm_inner_1_6_para.lz = 32 - 0;
  hflx_ppm_inner_1_6_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_1_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_1_6_para.oz = 0;
  hflx_ppm_inner_1_6_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_1_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_1_6_para.hx = 2;
  hflx_ppm_inner_1_6_para.hy = 2;
  hflx_ppm_inner_1_6_para.hz = 0;
  hflx_ppm_inner_1_6_para.bx = 256;
  hflx_ppm_inner_1_6_para.by = 8;
  hflx_ppm_inner_1_6_para.bz = 1;
  hflx_ppm_inner_1_6_para.mx = 1;
  hflx_ppm_inner_1_6_para.my = 2;
  hflx_ppm_inner_1_6_para.mz = 32;
  hflx_ppm_inner_1_6_para.star_statept = &star_state->pt[Proc.lev_hw - 0+hflx_ppm_inner_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_6_para.ox];
  hflx_ppm_inner_1_6_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_inner_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_6_para.ox];
  hflx_ppm_inner_1_6_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_inner_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_6_para.ox];
  hflx_ppm_inner_1_6_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_inner_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_6_para.ox];
  hflx_ppm_inner_1_6_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_inner_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_6_para.ox];
  hflx_ppm_inner_1_6_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_inner_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_6_para.ox];
  hflx_ppm_inner_1_6_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_inner_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_6_para.ox];
  
  athread_spawn(hflx_ppm_inner_1_6, &hflx_ppm_inner_1_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_uu]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_1_7_info hflx_ppm_inner_1_7_para;
  hflx_ppm_inner_1_7_para.lz = 32 - 0;
  hflx_ppm_inner_1_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_inner_1_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_1_7_para.oz = 0;
  hflx_ppm_inner_1_7_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_inner_1_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_1_7_para.hx = Proc.lon_hw;
  hflx_ppm_inner_1_7_para.hy = Proc.lat_hw;
  hflx_ppm_inner_1_7_para.hz = 0;
  hflx_ppm_inner_1_7_para.bx = 256;
  hflx_ppm_inner_1_7_para.by = 8;
  hflx_ppm_inner_1_7_para.bz = 1;
  hflx_ppm_inner_1_7_para.mx = 1;
  hflx_ppm_inner_1_7_para.my = 2;
  hflx_ppm_inner_1_7_para.mz = 32;
  hflx_ppm_inner_1_7_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+hflx_ppm_inner_1_7_para.oz][Proc.lat_hw -hflx_ppm_inner_1_7_para.hy +hflx_ppm_inner_1_7_para.oy][Proc.lon_hw -hflx_ppm_inner_1_7_para.hx +hflx_ppm_inner_1_7_para.ox];
  hflx_ppm_inner_1_7_para.star_statept = &star_state->pt[Proc.lev_hw - 0+hflx_ppm_inner_1_7_para.oz][Proc.lat_hw -hflx_ppm_inner_1_7_para.hy +hflx_ppm_inner_1_7_para.oy][Proc.lon_hw -hflx_ppm_inner_1_7_para.hx +hflx_ppm_inner_1_7_para.ox];
  hflx_ppm_inner_1_7_para.advptuu = &advpt->uu[Proc.lev_hw - 0+hflx_ppm_inner_1_7_para.oz][Proc.lat_hw -hflx_ppm_inner_1_7_para.hy +hflx_ppm_inner_1_7_para.oy][Proc.lon_hw -hflx_ppm_inner_1_7_para.hx +hflx_ppm_inner_1_7_para.ox];
  hflx_ppm_inner_1_7_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_inner_1_7_para.oz][Proc.lat_hw -hflx_ppm_inner_1_7_para.hy +hflx_ppm_inner_1_7_para.oy][Proc.lon_hw -hflx_ppm_inner_1_7_para.hx +hflx_ppm_inner_1_7_para.ox];
  hflx_ppm_inner_1_7_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_inner_1_7_para.oz][Proc.lat_hw -hflx_ppm_inner_1_7_para.hy +hflx_ppm_inner_1_7_para.oy][Proc.lon_hw -hflx_ppm_inner_1_7_para.hx +hflx_ppm_inner_1_7_para.ox];
  hflx_ppm_inner_1_7_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_inner_1_7_para.oz][Proc.lat_hw -hflx_ppm_inner_1_7_para.hy +hflx_ppm_inner_1_7_para.oy][Proc.lon_hw -hflx_ppm_inner_1_7_para.hx +hflx_ppm_inner_1_7_para.ox];
  hflx_ppm_inner_1_7_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+hflx_ppm_inner_1_7_para.oz][Proc.lat_hw -hflx_ppm_inner_1_7_para.hy +hflx_ppm_inner_1_7_para.oy][Proc.lon_hw -hflx_ppm_inner_1_7_para.hx +hflx_ppm_inner_1_7_para.ox];
  
  athread_spawn(hflx_ppm_inner_1_7, &hflx_ppm_inner_1_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerptf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lon[0][0][0], &Proc.FieldReq[async_ptf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_vv]);
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_1_8_info hflx_ppm_inner_1_8_para;
  hflx_ppm_inner_1_8_para.lz = 32 - 0;
  hflx_ppm_inner_1_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_1_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_1_8_para.oz = 0;
  hflx_ppm_inner_1_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_1_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_1_8_para.hx = 0;
  hflx_ppm_inner_1_8_para.hy = 1;
  hflx_ppm_inner_1_8_para.hz = 0;
  hflx_ppm_inner_1_8_para.bx = 256;
  hflx_ppm_inner_1_8_para.by = 8;
  hflx_ppm_inner_1_8_para.bz = 1;
  hflx_ppm_inner_1_8_para.mx = 1;
  hflx_ppm_inner_1_8_para.my = 2;
  hflx_ppm_inner_1_8_para.mz = 32;
  hflx_ppm_inner_1_8_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+hflx_ppm_inner_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_8_para.ox];
  hflx_ppm_inner_1_8_para.advptvv = &advpt->vv[Proc.lev_hw - 0+hflx_ppm_inner_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_8_para.ox];
  hflx_ppm_inner_1_8_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_inner_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_8_para.ox];
  hflx_ppm_inner_1_8_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_inner_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_8_para.ox];
  hflx_ppm_inner_1_8_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_inner_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_8_para.ox];
  hflx_ppm_inner_1_8_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+hflx_ppm_inner_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_8_para.ox];
  
  athread_spawn(hflx_ppm_inner_1_8, &hflx_ppm_inner_1_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerptf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lat[0][0][0], &Proc.FieldReq[async_ptf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_1_2_info ffsl_calc_tracer_hflx_1_2_para;
  ffsl_calc_tracer_hflx_1_2_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_1_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  ffsl_calc_tracer_hflx_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_1_2_para.oz = 0;
  ffsl_calc_tracer_hflx_1_2_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_1_2_para.hx = 2;
  ffsl_calc_tracer_hflx_1_2_para.hy = 2;
  ffsl_calc_tracer_hflx_1_2_para.hz = 0;
  ffsl_calc_tracer_hflx_1_2_para.bx = 256;
  ffsl_calc_tracer_hflx_1_2_para.by = 8;
  ffsl_calc_tracer_hflx_1_2_para.bz = 1;
  ffsl_calc_tracer_hflx_1_2_para.mx = 1;
  ffsl_calc_tracer_hflx_1_2_para.my = 2;
  ffsl_calc_tracer_hflx_1_2_para.mz = 32;
  ffsl_calc_tracer_hflx_1_2_para.star_statept = &star_state->pt[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_2_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_2_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_2_para.ox];
  ffsl_calc_tracer_hflx_1_2_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_2_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_2_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_2_para.ox];
  ffsl_calc_tracer_hflx_1_2_para.advptdivx = &advpt->divx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_2_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_2_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_2_para.ox];
  ffsl_calc_tracer_hflx_1_2_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_2_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_2_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_2_para.ox];
  ffsl_calc_tracer_hflx_1_2_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_2_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_2_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_2_para.ox];
  ffsl_calc_tracer_hflx_1_2_para.advptqx = &advpt->qx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_2_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_2_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_2_para.ox];
  ffsl_calc_tracer_hflx_1_2_para.advptqy = &advpt->qy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_2_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_2_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_2_para.ox];
  ffsl_calc_tracer_hflx_1_2_para.le_lon = &mesh->le_lon[0][0][0];
  ffsl_calc_tracer_hflx_1_2_para.area_cell = &mesh->area_cell[0][0][0];
  ffsl_calc_tracer_hflx_1_2_para.le_lat = &mesh->le_lat[0][0][0];
  ffsl_calc_tracer_hflx_1_2_para.dt = dt;
  
  athread_spawn(ffsl_calc_tracer_hflx_1_2, &ffsl_calc_tracer_hflx_1_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxqxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qx[0][0][0], &Proc.FieldReq[async_qx], true, true, true, false, false, true, true, true);
  UpdateHalo_3d_D(Proc, &advpt->qy[0][0][0], &Proc.FieldReq[async_qy], true, true, true, true, true, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qx]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_1_6_info hflx_ppm_outer_1_6_para;
  hflx_ppm_outer_1_6_para.lz = 32 - 0;
  hflx_ppm_outer_1_6_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_1_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_1_6_para.oz = 0;
  hflx_ppm_outer_1_6_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_1_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_1_6_para.hx = 2;
  hflx_ppm_outer_1_6_para.hy = 2;
  hflx_ppm_outer_1_6_para.hz = 0;
  hflx_ppm_outer_1_6_para.bx = 256;
  hflx_ppm_outer_1_6_para.by = 8;
  hflx_ppm_outer_1_6_para.bz = 1;
  hflx_ppm_outer_1_6_para.mx = 1;
  hflx_ppm_outer_1_6_para.my = 2;
  hflx_ppm_outer_1_6_para.mz = 32;
  hflx_ppm_outer_1_6_para.advptqy = &advpt->qy[Proc.lev_hw - 0+hflx_ppm_outer_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_6_para.ox];
  hflx_ppm_outer_1_6_para.advptqx = &advpt->qx[Proc.lev_hw - 0+hflx_ppm_outer_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_6_para.ox];
  hflx_ppm_outer_1_6_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_outer_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_6_para.ox];
  hflx_ppm_outer_1_6_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_outer_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_6_para.ox];
  hflx_ppm_outer_1_6_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_outer_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_6_para.ox];
  hflx_ppm_outer_1_6_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_outer_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_6_para.ox];
  hflx_ppm_outer_1_6_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_outer_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_6_para.ox];
  hflx_ppm_outer_1_6_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_outer_1_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_6_para.ox];
  
  athread_spawn(hflx_ppm_outer_1_6, &hflx_ppm_outer_1_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_1_7_info hflx_ppm_outer_1_7_para;
  hflx_ppm_outer_1_7_para.lz = 32 - 0;
  hflx_ppm_outer_1_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_outer_1_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_1_7_para.oz = 0;
  hflx_ppm_outer_1_7_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_outer_1_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_1_7_para.hx = Proc.lon_hw;
  hflx_ppm_outer_1_7_para.hy = Proc.lat_hw;
  hflx_ppm_outer_1_7_para.hz = 0;
  hflx_ppm_outer_1_7_para.bx = 256;
  hflx_ppm_outer_1_7_para.by = 8;
  hflx_ppm_outer_1_7_para.bz = 1;
  hflx_ppm_outer_1_7_para.mx = 1;
  hflx_ppm_outer_1_7_para.my = 2;
  hflx_ppm_outer_1_7_para.mz = 32;
  hflx_ppm_outer_1_7_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+hflx_ppm_outer_1_7_para.oz][Proc.lat_hw -hflx_ppm_outer_1_7_para.hy +hflx_ppm_outer_1_7_para.oy][Proc.lon_hw -hflx_ppm_outer_1_7_para.hx +hflx_ppm_outer_1_7_para.ox];
  hflx_ppm_outer_1_7_para.advptqy = &advpt->qy[Proc.lev_hw - 0+hflx_ppm_outer_1_7_para.oz][Proc.lat_hw -hflx_ppm_outer_1_7_para.hy +hflx_ppm_outer_1_7_para.oy][Proc.lon_hw -hflx_ppm_outer_1_7_para.hx +hflx_ppm_outer_1_7_para.ox];
  hflx_ppm_outer_1_7_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+hflx_ppm_outer_1_7_para.oz][Proc.lat_hw -hflx_ppm_outer_1_7_para.hy +hflx_ppm_outer_1_7_para.oy][Proc.lon_hw -hflx_ppm_outer_1_7_para.hx +hflx_ppm_outer_1_7_para.ox];
  hflx_ppm_outer_1_7_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_outer_1_7_para.oz][Proc.lat_hw -hflx_ppm_outer_1_7_para.hy +hflx_ppm_outer_1_7_para.oy][Proc.lon_hw -hflx_ppm_outer_1_7_para.hx +hflx_ppm_outer_1_7_para.ox];
  hflx_ppm_outer_1_7_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_outer_1_7_para.oz][Proc.lat_hw -hflx_ppm_outer_1_7_para.hy +hflx_ppm_outer_1_7_para.oy][Proc.lon_hw -hflx_ppm_outer_1_7_para.hx +hflx_ppm_outer_1_7_para.ox];
  hflx_ppm_outer_1_7_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_outer_1_7_para.oz][Proc.lat_hw -hflx_ppm_outer_1_7_para.hy +hflx_ppm_outer_1_7_para.oy][Proc.lon_hw -hflx_ppm_outer_1_7_para.hx +hflx_ppm_outer_1_7_para.ox];
  hflx_ppm_outer_1_7_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+hflx_ppm_outer_1_7_para.oz][Proc.lat_hw -hflx_ppm_outer_1_7_para.hy +hflx_ppm_outer_1_7_para.oy][Proc.lon_hw -hflx_ppm_outer_1_7_para.hx +hflx_ppm_outer_1_7_para.ox];
  
  athread_spawn(hflx_ppm_outer_1_7, &hflx_ppm_outer_1_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerptf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lon[0][0][0], &Proc.FieldReq[async_ptf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_1_8_info hflx_ppm_outer_1_8_para;
  hflx_ppm_outer_1_8_para.lz = 32 - 0;
  hflx_ppm_outer_1_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_1_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_1_8_para.oz = 0;
  hflx_ppm_outer_1_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_1_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_1_8_para.hx = 0;
  hflx_ppm_outer_1_8_para.hy = 1;
  hflx_ppm_outer_1_8_para.hz = 0;
  hflx_ppm_outer_1_8_para.bx = 256;
  hflx_ppm_outer_1_8_para.by = 8;
  hflx_ppm_outer_1_8_para.bz = 1;
  hflx_ppm_outer_1_8_para.mx = 1;
  hflx_ppm_outer_1_8_para.my = 2;
  hflx_ppm_outer_1_8_para.mz = 32;
  hflx_ppm_outer_1_8_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+hflx_ppm_outer_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_8_para.ox];
  hflx_ppm_outer_1_8_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+hflx_ppm_outer_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_8_para.ox];
  hflx_ppm_outer_1_8_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_outer_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_8_para.ox];
  hflx_ppm_outer_1_8_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_outer_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_8_para.ox];
  hflx_ppm_outer_1_8_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_outer_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_8_para.ox];
  hflx_ppm_outer_1_8_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+hflx_ppm_outer_1_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_8_para.ox];
  
  athread_spawn(hflx_ppm_outer_1_8, &hflx_ppm_outer_1_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerptf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lat[0][0][0], &Proc.FieldReq[async_ptf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_1_8_info calc_grad_ptf_1_8_para;
  calc_grad_ptf_1_8_para.lz = 32 - 0;
  calc_grad_ptf_1_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_ptf_1_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_1_8_para.oz = 0;
  calc_grad_ptf_1_8_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_ptf_1_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_1_8_para.hx = 1;
  calc_grad_ptf_1_8_para.hy = 0;
  calc_grad_ptf_1_8_para.hz = 0;
  calc_grad_ptf_1_8_para.bx = 256;
  calc_grad_ptf_1_8_para.by = 8;
  calc_grad_ptf_1_8_para.bz = 1;
  calc_grad_ptf_1_8_para.mx = 1;
  calc_grad_ptf_1_8_para.my = 2;
  calc_grad_ptf_1_8_para.mz = 32;
  calc_grad_ptf_1_8_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+calc_grad_ptf_1_8_para.oz][Proc.lat_hw -0+calc_grad_ptf_1_8_para.oy][Proc.lon_hw -1+calc_grad_ptf_1_8_para.ox];
  calc_grad_ptf_1_8_para.tend1dptfdlon = &tend1->dptfdlon[Proc.lev_hw - 0+calc_grad_ptf_1_8_para.oz][Proc.lat_hw -0+calc_grad_ptf_1_8_para.oy][Proc.lon_hw -1+calc_grad_ptf_1_8_para.ox];
  calc_grad_ptf_1_8_para.le_lon = &mesh->le_lon[0][0][0];
  calc_grad_ptf_1_8_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_ptf_1_8, &calc_grad_ptf_1_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfdptfdlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_1_9_info calc_grad_ptf_1_9_para;
  calc_grad_ptf_1_9_para.lz = 32 - 0;
  calc_grad_ptf_1_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_ptf_1_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_1_9_para.oz = 0;
  calc_grad_ptf_1_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_ptf_1_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_1_9_para.hx = 0;
  calc_grad_ptf_1_9_para.hy = 1;
  calc_grad_ptf_1_9_para.hz = 0;
  calc_grad_ptf_1_9_para.bx = 256;
  calc_grad_ptf_1_9_para.by = 8;
  calc_grad_ptf_1_9_para.bz = 1;
  calc_grad_ptf_1_9_para.mx = 1;
  calc_grad_ptf_1_9_para.my = 2;
  calc_grad_ptf_1_9_para.mz = 32;
  calc_grad_ptf_1_9_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+calc_grad_ptf_1_9_para.oz][Proc.lat_hw -1+calc_grad_ptf_1_9_para.oy][Proc.lon_hw -0+calc_grad_ptf_1_9_para.ox];
  calc_grad_ptf_1_9_para.tend1dptfdlat = &tend1->dptfdlat[Proc.lev_hw - 0+calc_grad_ptf_1_9_para.oz][Proc.lat_hw -1+calc_grad_ptf_1_9_para.oy][Proc.lon_hw -0+calc_grad_ptf_1_9_para.ox];
  calc_grad_ptf_1_9_para.le_lat = &mesh->le_lat[0][0][0];
  calc_grad_ptf_1_9_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_ptf_1_9, &calc_grad_ptf_1_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfdptfdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=-1+Proc.lev_hw; k<0+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->pt[k][j][i] = ((2 * star_state->pt[(k + 1)][j][i]) - star_state->pt[(k + 2)][j][i]);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=-2+Proc.lev_hw; k<-1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->pt[k][j][i] = ((2 * star_state->pt[(k + 1)][j][i]) - star_state->pt[(k + 2)][j][i]);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_1_10_info calc_grad_ptf_1_10_para;
  calc_grad_ptf_1_10_para.lz = 34 - 32;
  calc_grad_ptf_1_10_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_grad_ptf_1_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_1_10_para.oz = 32;
  calc_grad_ptf_1_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_ptf_1_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_1_10_para.hx = 2;
  calc_grad_ptf_1_10_para.hy = 0;
  calc_grad_ptf_1_10_para.hz = 2;
  calc_grad_ptf_1_10_para.bx = 256;
  calc_grad_ptf_1_10_para.by = 1;
  calc_grad_ptf_1_10_para.bz = 4;
  calc_grad_ptf_1_10_para.mx = 1;
  calc_grad_ptf_1_10_para.my = 8;
  calc_grad_ptf_1_10_para.mz = 8;
  calc_grad_ptf_1_10_para.star_statept = &star_state->pt[Proc.lev_hw - 2+calc_grad_ptf_1_10_para.oz][Proc.lat_hw -0+calc_grad_ptf_1_10_para.oy][Proc.lon_hw -2+calc_grad_ptf_1_10_para.ox];
  
  athread_spawn(calc_grad_ptf_1_10, &calc_grad_ptf_1_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        buf = ppm(star_state->pt[(k - 2)][j][i],star_state->pt[(k - 1)][j][i],star_state->pt[k][j][i],star_state->pt[(k + 1)][j][i],star_state->pt[(k + 2)][j][i]);
        advpt->qlx[k][j][i] = buf.x;
        advpt->dqx[k][j][i] = buf.y;
        advpt->q6x[k][j][i] = buf.z;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=1+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        ci = (int)(advpt->cflz[k][j][i]);
        cf = (advpt->cflz[k][j][i] - ci);
        if ((advpt->cflz[k][j][i] > 0))
        {
          s1 = (1.0 - cf);
          s2 = 1.0;
          ds1 = (s2 - s1);
          ds2 = (pow(s2,2) - pow(s1,2));
          ds3 = (pow(s2,3) - pow(s1,3));
          cursum = 0.0;
          for (l=(k - ci);l<((k - 1) + 1);l+=1){
            cursum = (cursum + star_state->pt[l][j][i]);
          }
          star_state->ptf_lev[k][j][i] = ((advpt->we[k][j][i] * (((cursum + (advpt->qlx[((k - ci) - 1)][j][i] * ds1)) + ((0.5 * advpt->dqx[((k - ci) - 1)][j][i]) * ds2)) + (advpt->q6x[((k - ci) - 1)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / advpt->cflz[k][j][i]);
        }
        else
        {
          if ((advpt->cflz[k][j][i] < 0))
          {
            s1 = 0.0;
            s2 = -cf;
            ds1 = (s2 - s1);
            ds2 = (pow(s2,2) - pow(s1,2));
            ds3 = (pow(s2,3) - pow(s1,3));
            for (l=k;l<(((k - ci) - 1) + 1);l+=1){
              cursum = (cursum + star_state->pt[l][j][i]);
            }
            star_state->ptf_lev[k][j][i] = ((-advpt->we[k][j][i] * (((cursum + (advpt->qlx[(k - ci)][j][i] * ds1)) + ((0.5 * advpt->dqx[(k - ci)][j][i]) * ds2)) + (advpt->q6x[(k - ci)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / advpt->cflz[k][j][i]);
          }
          else
          {
            star_state->ptf_lev[k][j][i] = 0.0;
          }
        }
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmptf_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_1_11_info calc_grad_ptf_1_11_para;
  calc_grad_ptf_1_11_para.lz = 32 - 0;
  calc_grad_ptf_1_11_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_grad_ptf_1_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_1_11_para.oz = 0;
  calc_grad_ptf_1_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_ptf_1_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_1_11_para.hx = 0;
  calc_grad_ptf_1_11_para.hy = 0;
  calc_grad_ptf_1_11_para.hz = 1;
  calc_grad_ptf_1_11_para.bx = 256;
  calc_grad_ptf_1_11_para.by = 1;
  calc_grad_ptf_1_11_para.bz = 4;
  calc_grad_ptf_1_11_para.mx = 1;
  calc_grad_ptf_1_11_para.my = 8;
  calc_grad_ptf_1_11_para.mz = 8;
  calc_grad_ptf_1_11_para.star_stateptf_lev = &star_state->ptf_lev[Proc.lev_hw - 1+calc_grad_ptf_1_11_para.oz][Proc.lat_hw -0+calc_grad_ptf_1_11_para.oy][Proc.lon_hw -0+calc_grad_ptf_1_11_para.ox];
  calc_grad_ptf_1_11_para.tend1dptfdlev = &tend1->dptfdlev[Proc.lev_hw - 1+calc_grad_ptf_1_11_para.oz][Proc.lat_hw -0+calc_grad_ptf_1_11_para.oy][Proc.lon_hw -0+calc_grad_ptf_1_11_para.ox];
  
  athread_spawn(calc_grad_ptf_1_11, &calc_grad_ptf_1_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfdptfdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_coriolis_1_4_info calc_coriolis_1_4_para;
  calc_coriolis_1_4_para.lz = 32 - 0;
  calc_coriolis_1_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_coriolis_1_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_coriolis_1_4_para.oz = 0;
  calc_coriolis_1_4_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_coriolis_1_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_coriolis_1_4_para.hx = 1;
  calc_coriolis_1_4_para.hy = 1;
  calc_coriolis_1_4_para.hz = 0;
  calc_coriolis_1_4_para.bx = 256;
  calc_coriolis_1_4_para.by = 8;
  calc_coriolis_1_4_para.bz = 1;
  calc_coriolis_1_4_para.mx = 1;
  calc_coriolis_1_4_para.my = 2;
  calc_coriolis_1_4_para.mz = 32;
  calc_coriolis_1_4_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_coriolis_1_4_para.oz][Proc.lat_hw -1+calc_coriolis_1_4_para.oy][Proc.lon_hw -1+calc_coriolis_1_4_para.ox];
  calc_coriolis_1_4_para.star_statepv_lat = &star_state->pv_lat[Proc.lev_hw - 0+calc_coriolis_1_4_para.oz][Proc.lat_hw -1+calc_coriolis_1_4_para.oy][Proc.lon_hw -1+calc_coriolis_1_4_para.ox];
  calc_coriolis_1_4_para.star_statepv_lon = &star_state->pv_lon[Proc.lev_hw - 0+calc_coriolis_1_4_para.oz][Proc.lat_hw -1+calc_coriolis_1_4_para.oy][Proc.lon_hw -1+calc_coriolis_1_4_para.ox];
  calc_coriolis_1_4_para.tend1qhu = &tend1->qhu[Proc.lev_hw - 0+calc_coriolis_1_4_para.oz][Proc.lat_hw -1+calc_coriolis_1_4_para.oy][Proc.lon_hw -1+calc_coriolis_1_4_para.ox];
  calc_coriolis_1_4_para.half_tangent_wgt_0 = &mesh->half_tangent_wgt_0[0][0][0];
  calc_coriolis_1_4_para.half_tangent_wgt_1 = &mesh->half_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_coriolis_1_4, &calc_coriolis_1_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_coriolisqhuTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_coriolis_1_5_info calc_coriolis_1_5_para;
  calc_coriolis_1_5_para.lz = 32 - 0;
  calc_coriolis_1_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_coriolis_1_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_coriolis_1_5_para.oz = 0;
  calc_coriolis_1_5_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_coriolis_1_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_coriolis_1_5_para.hx = 1;
  calc_coriolis_1_5_para.hy = 1;
  calc_coriolis_1_5_para.hz = 0;
  calc_coriolis_1_5_para.bx = 256;
  calc_coriolis_1_5_para.by = 8;
  calc_coriolis_1_5_para.bz = 1;
  calc_coriolis_1_5_para.mx = 1;
  calc_coriolis_1_5_para.my = 2;
  calc_coriolis_1_5_para.mz = 32;
  calc_coriolis_1_5_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_coriolis_1_5_para.oz][Proc.lat_hw -1+calc_coriolis_1_5_para.oy][Proc.lon_hw -1+calc_coriolis_1_5_para.ox];
  calc_coriolis_1_5_para.star_statepv_lon = &star_state->pv_lon[Proc.lev_hw - 0+calc_coriolis_1_5_para.oz][Proc.lat_hw -1+calc_coriolis_1_5_para.oy][Proc.lon_hw -1+calc_coriolis_1_5_para.ox];
  calc_coriolis_1_5_para.star_statepv_lat = &star_state->pv_lat[Proc.lev_hw - 0+calc_coriolis_1_5_para.oz][Proc.lat_hw -1+calc_coriolis_1_5_para.oy][Proc.lon_hw -1+calc_coriolis_1_5_para.ox];
  calc_coriolis_1_5_para.tend1qhv = &tend1->qhv[Proc.lev_hw - 0+calc_coriolis_1_5_para.oz][Proc.lat_hw -1+calc_coriolis_1_5_para.oy][Proc.lon_hw -1+calc_coriolis_1_5_para.ox];
  calc_coriolis_1_5_para.full_tangent_wgt_0 = &mesh->full_tangent_wgt_0[0][0][0];
  calc_coriolis_1_5_para.full_tangent_wgt_1 = &mesh->full_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_coriolis_1_5, &calc_coriolis_1_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_coriolisqhvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ke_1_4_info calc_grad_ke_1_4_para;
  calc_grad_ke_1_4_para.lz = 32 - 0;
  calc_grad_ke_1_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_ke_1_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ke_1_4_para.oz = 0;
  calc_grad_ke_1_4_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_ke_1_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ke_1_4_para.hx = 1;
  calc_grad_ke_1_4_para.hy = 1;
  calc_grad_ke_1_4_para.hz = 0;
  calc_grad_ke_1_4_para.bx = 256;
  calc_grad_ke_1_4_para.by = 8;
  calc_grad_ke_1_4_para.bz = 1;
  calc_grad_ke_1_4_para.mx = 1;
  calc_grad_ke_1_4_para.my = 2;
  calc_grad_ke_1_4_para.mz = 32;
  calc_grad_ke_1_4_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_grad_ke_1_4_para.oz][Proc.lat_hw -1+calc_grad_ke_1_4_para.oy][Proc.lon_hw -1+calc_grad_ke_1_4_para.ox];
  calc_grad_ke_1_4_para.tend1dkedlon = &tend1->dkedlon[Proc.lev_hw - 0+calc_grad_ke_1_4_para.oz][Proc.lat_hw -1+calc_grad_ke_1_4_para.oy][Proc.lon_hw -1+calc_grad_ke_1_4_para.ox];
  calc_grad_ke_1_4_para.de_lon = &mesh->de_lon[0][0][0];
  
  athread_spawn(calc_grad_ke_1_4, &calc_grad_ke_1_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_kedkedlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ke_1_5_info calc_grad_ke_1_5_para;
  calc_grad_ke_1_5_para.lz = 32 - 0;
  calc_grad_ke_1_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_grad_ke_1_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ke_1_5_para.oz = 0;
  calc_grad_ke_1_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_ke_1_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ke_1_5_para.hx = 1;
  calc_grad_ke_1_5_para.hy = 1;
  calc_grad_ke_1_5_para.hz = 0;
  calc_grad_ke_1_5_para.bx = 256;
  calc_grad_ke_1_5_para.by = 8;
  calc_grad_ke_1_5_para.bz = 1;
  calc_grad_ke_1_5_para.mx = 1;
  calc_grad_ke_1_5_para.my = 2;
  calc_grad_ke_1_5_para.mz = 32;
  calc_grad_ke_1_5_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_grad_ke_1_5_para.oz][Proc.lat_hw -1+calc_grad_ke_1_5_para.oy][Proc.lon_hw -1+calc_grad_ke_1_5_para.ox];
  calc_grad_ke_1_5_para.tend1dkedlat = &tend1->dkedlat[Proc.lev_hw - 0+calc_grad_ke_1_5_para.oz][Proc.lat_hw -1+calc_grad_ke_1_5_para.oy][Proc.lon_hw -1+calc_grad_ke_1_5_para.ox];
  calc_grad_ke_1_5_para.de_lat = &mesh->de_lat[0][0][0];
  
  athread_spawn(calc_grad_ke_1_5, &calc_grad_ke_1_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_kedkedlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  tendPara = tendPara;
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_forward_1_6_info calc_tend_forward_1_6_para;
  calc_tend_forward_1_6_para.lz = 32 - 0;
  calc_tend_forward_1_6_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_tend_forward_1_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_forward_1_6_para.oz = 0;
  calc_tend_forward_1_6_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_tend_forward_1_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_forward_1_6_para.hx = 1;
  calc_tend_forward_1_6_para.hy = 1;
  calc_tend_forward_1_6_para.hz = 0;
  calc_tend_forward_1_6_para.bx = 256;
  calc_tend_forward_1_6_para.by = 8;
  calc_tend_forward_1_6_para.bz = 1;
  calc_tend_forward_1_6_para.mx = 1;
  calc_tend_forward_1_6_para.my = 2;
  calc_tend_forward_1_6_para.mz = 32;
  calc_tend_forward_1_6_para.tend1qhv = &tend1->qhv[Proc.lev_hw - 0+calc_tend_forward_1_6_para.oz][Proc.lat_hw -1+calc_tend_forward_1_6_para.oy][Proc.lon_hw -1+calc_tend_forward_1_6_para.ox];
  calc_tend_forward_1_6_para.tend1dkedlon = &tend1->dkedlon[Proc.lev_hw - 0+calc_tend_forward_1_6_para.oz][Proc.lat_hw -1+calc_tend_forward_1_6_para.oy][Proc.lon_hw -1+calc_tend_forward_1_6_para.ox];
  calc_tend_forward_1_6_para.tend1wedudlev = &tend1->wedudlev[Proc.lev_hw - 0+calc_tend_forward_1_6_para.oz][Proc.lat_hw -1+calc_tend_forward_1_6_para.oy][Proc.lon_hw -1+calc_tend_forward_1_6_para.ox];
  calc_tend_forward_1_6_para.tend1du = &tend1->du[Proc.lev_hw - 0+calc_tend_forward_1_6_para.oz][Proc.lat_hw -1+calc_tend_forward_1_6_para.oy][Proc.lon_hw -1+calc_tend_forward_1_6_para.ox];
  
  athread_spawn(calc_tend_forward_1_6, &calc_tend_forward_1_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_forwardduTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend1->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_forward_1_7_info calc_tend_forward_1_7_para;
  calc_tend_forward_1_7_para.lz = 32 - 0;
  calc_tend_forward_1_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_tend_forward_1_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_forward_1_7_para.oz = 0;
  calc_tend_forward_1_7_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_tend_forward_1_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_forward_1_7_para.hx = 1;
  calc_tend_forward_1_7_para.hy = 1;
  calc_tend_forward_1_7_para.hz = 0;
  calc_tend_forward_1_7_para.bx = 256;
  calc_tend_forward_1_7_para.by = 8;
  calc_tend_forward_1_7_para.bz = 1;
  calc_tend_forward_1_7_para.mx = 1;
  calc_tend_forward_1_7_para.my = 2;
  calc_tend_forward_1_7_para.mz = 32;
  calc_tend_forward_1_7_para.tend1qhu = &tend1->qhu[Proc.lev_hw - 0+calc_tend_forward_1_7_para.oz][Proc.lat_hw -1+calc_tend_forward_1_7_para.oy][Proc.lon_hw -1+calc_tend_forward_1_7_para.ox];
  calc_tend_forward_1_7_para.tend1dkedlat = &tend1->dkedlat[Proc.lev_hw - 0+calc_tend_forward_1_7_para.oz][Proc.lat_hw -1+calc_tend_forward_1_7_para.oy][Proc.lon_hw -1+calc_tend_forward_1_7_para.ox];
  calc_tend_forward_1_7_para.tend1wedvdlev = &tend1->wedvdlev[Proc.lev_hw - 0+calc_tend_forward_1_7_para.oz][Proc.lat_hw -1+calc_tend_forward_1_7_para.oy][Proc.lon_hw -1+calc_tend_forward_1_7_para.ox];
  calc_tend_forward_1_7_para.tend1dv = &tend1->dv[Proc.lev_hw - 0+calc_tend_forward_1_7_para.oz][Proc.lat_hw -1+calc_tend_forward_1_7_para.oy][Proc.lon_hw -1+calc_tend_forward_1_7_para.ox];
  
  athread_spawn(calc_tend_forward_1_7, &calc_tend_forward_1_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_forwarddvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend1->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_forward_1_8_info calc_tend_forward_1_8_para;
  calc_tend_forward_1_8_para.lz = 32 - 0;
  calc_tend_forward_1_8_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_tend_forward_1_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_forward_1_8_para.oz = 0;
  calc_tend_forward_1_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_tend_forward_1_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_forward_1_8_para.hx = 1;
  calc_tend_forward_1_8_para.hy = 1;
  calc_tend_forward_1_8_para.hz = 0;
  calc_tend_forward_1_8_para.bx = 256;
  calc_tend_forward_1_8_para.by = 8;
  calc_tend_forward_1_8_para.bz = 1;
  calc_tend_forward_1_8_para.mx = 1;
  calc_tend_forward_1_8_para.my = 2;
  calc_tend_forward_1_8_para.mz = 32;
  calc_tend_forward_1_8_para.tend1dptfdlon = &tend1->dptfdlon[Proc.lev_hw - 0+calc_tend_forward_1_8_para.oz][Proc.lat_hw -1+calc_tend_forward_1_8_para.oy][Proc.lon_hw -1+calc_tend_forward_1_8_para.ox];
  calc_tend_forward_1_8_para.tend1dptfdlat = &tend1->dptfdlat[Proc.lev_hw - 0+calc_tend_forward_1_8_para.oz][Proc.lat_hw -1+calc_tend_forward_1_8_para.oy][Proc.lon_hw -1+calc_tend_forward_1_8_para.ox];
  calc_tend_forward_1_8_para.tend1dptfdlev = &tend1->dptfdlev[Proc.lev_hw - 0+calc_tend_forward_1_8_para.oz][Proc.lat_hw -1+calc_tend_forward_1_8_para.oy][Proc.lon_hw -1+calc_tend_forward_1_8_para.ox];
  calc_tend_forward_1_8_para.tend1dpt = &tend1->dpt[Proc.lev_hw - 0+calc_tend_forward_1_8_para.oz][Proc.lat_hw -1+calc_tend_forward_1_8_para.oy][Proc.lon_hw -1+calc_tend_forward_1_8_para.ox];
  
  athread_spawn(calc_tend_forward_1_8, &calc_tend_forward_1_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_forwarddptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend1->dpt[0][0][0], &Proc.FieldReq[async_dpt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  (tendPara->phs) = 1;
  (tendPara->pt) = 1;
  tendPara = tendPara;
  dt = dt;
  if ((tendPara->phs))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,0,&tend1->dphs[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &tend1->dphs[0][0][0], &Proc.FieldReq[async_dphs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        new_state->phs[0][j][i] = (old_state->phs[0][j][i] + (dt * tend1->dphs[0][j][i]));
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statephsTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &new_state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_1_15_info calc_ph_1_15_para;
    calc_ph_1_15_para.lz = 33 - 0;
    calc_ph_1_15_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_1_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_1_15_para.oz = 0;
    calc_ph_1_15_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_1_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_1_15_para.hx = 1;
    calc_ph_1_15_para.hy = 1;
    calc_ph_1_15_para.hz = 0;
    calc_ph_1_15_para.bx = 256;
    calc_ph_1_15_para.by = 8;
    calc_ph_1_15_para.bz = 1;
    calc_ph_1_15_para.mx = 1;
    calc_ph_1_15_para.my = 2;
    calc_ph_1_15_para.mz = 32;
    calc_ph_1_15_para.new_statephs = &new_state->phs[0][Proc.lat_hw -1+calc_ph_1_15_para.oy][Proc.lon_hw -1+calc_ph_1_15_para.ox];
    calc_ph_1_15_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_1_15_para.oz][Proc.lat_hw -1+calc_ph_1_15_para.oy][Proc.lon_hw -1+calc_ph_1_15_para.ox];
    calc_ph_1_15_para.hyai = &mesh->hyai[0][0][0];
    calc_ph_1_15_para.hybi = &mesh->hybi[0][0][0];
    
    athread_spawn(calc_ph_1_15, &calc_ph_1_15_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_1_16_info calc_ph_1_16_para;
    calc_ph_1_16_para.lz = 33 - 0;
    calc_ph_1_16_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_1_16_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_1_16_para.oz = 0;
    calc_ph_1_16_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_1_16_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_1_16_para.hx = 1;
    calc_ph_1_16_para.hy = 1;
    calc_ph_1_16_para.hz = 0;
    calc_ph_1_16_para.bx = 256;
    calc_ph_1_16_para.by = 8;
    calc_ph_1_16_para.bz = 1;
    calc_ph_1_16_para.mx = 1;
    calc_ph_1_16_para.my = 2;
    calc_ph_1_16_para.mz = 32;
    calc_ph_1_16_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_1_16_para.oz][Proc.lat_hw -1+calc_ph_1_16_para.oy][Proc.lon_hw -1+calc_ph_1_16_para.ox];
    calc_ph_1_16_para.new_stateph_exn_lev = &new_state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_1_16_para.oz][Proc.lat_hw -1+calc_ph_1_16_para.oy][Proc.lon_hw -1+calc_ph_1_16_para.ox];
    
    athread_spawn(calc_ph_1_16, &calc_ph_1_16_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_exn_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_1_17_info calc_ph_1_17_para;
    calc_ph_1_17_para.lz = 32 - 0;
    calc_ph_1_17_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_1_17_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_1_17_para.oz = 0;
    calc_ph_1_17_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_1_17_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_1_17_para.hx = 0;
    calc_ph_1_17_para.hy = 0;
    calc_ph_1_17_para.hz = 1;
    calc_ph_1_17_para.bx = 256;
    calc_ph_1_17_para.by = 1;
    calc_ph_1_17_para.bz = 4;
    calc_ph_1_17_para.mx = 1;
    calc_ph_1_17_para.my = 8;
    calc_ph_1_17_para.mz = 8;
    calc_ph_1_17_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_ph_1_17_para.oz][Proc.lat_hw -0+calc_ph_1_17_para.oy][Proc.lon_hw -0+calc_ph_1_17_para.ox];
    calc_ph_1_17_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_ph_1_17_para.oz][Proc.lat_hw -0+calc_ph_1_17_para.oy][Proc.lon_hw -0+calc_ph_1_17_para.ox];
    
    athread_spawn(calc_ph_1_17, &calc_ph_1_17_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phphTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_36_info calc_m_1_36_para;
    calc_m_1_36_para.lz = 32 - 0;
    calc_m_1_36_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_36_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_36_para.oz = 0;
    calc_m_1_36_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_36_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_36_para.hx = 1;
    calc_m_1_36_para.hy = 0;
    calc_m_1_36_para.hz = 1;
    calc_m_1_36_para.bx = 256;
    calc_m_1_36_para.by = 1;
    calc_m_1_36_para.bz = 4;
    calc_m_1_36_para.mx = 1;
    calc_m_1_36_para.my = 8;
    calc_m_1_36_para.mz = 8;
    calc_m_1_36_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_1_36_para.oz][Proc.lat_hw -0+calc_m_1_36_para.oy][Proc.lon_hw -1+calc_m_1_36_para.ox];
    calc_m_1_36_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_1_36_para.oz][Proc.lat_hw -0+calc_m_1_36_para.oy][Proc.lon_hw -1+calc_m_1_36_para.ox];
    
    athread_spawn(calc_m_1_36, &calc_m_1_36_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_37_info calc_m_1_37_para;
    calc_m_1_37_para.lz = 32 - 1;
    calc_m_1_37_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_37_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_37_para.oz = 1;
    calc_m_1_37_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_37_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_37_para.hx = 0;
    calc_m_1_37_para.hy = 0;
    calc_m_1_37_para.hz = 1;
    calc_m_1_37_para.bx = 256;
    calc_m_1_37_para.by = 1;
    calc_m_1_37_para.bz = 4;
    calc_m_1_37_para.mx = 1;
    calc_m_1_37_para.my = 8;
    calc_m_1_37_para.mz = 8;
    calc_m_1_37_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_1_37_para.oz][Proc.lat_hw -0+calc_m_1_37_para.oy][Proc.lon_hw -0+calc_m_1_37_para.ox];
    calc_m_1_37_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_1_37_para.oz][Proc.lat_hw -0+calc_m_1_37_para.oy][Proc.lon_hw -0+calc_m_1_37_para.ox];
    
    athread_spawn(calc_m_1_37, &calc_m_1_37_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_38_info calc_m_1_38_para;
    calc_m_1_38_para.lz = 1 - 0;
    calc_m_1_38_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_38_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_38_para.oz = 0;
    calc_m_1_38_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_38_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_38_para.hx = 0;
    calc_m_1_38_para.hy = 0;
    calc_m_1_38_para.hz = 0;
    calc_m_1_38_para.bx = 256;
    calc_m_1_38_para.by = 8;
    calc_m_1_38_para.bz = 1;
    calc_m_1_38_para.mx = 1;
    calc_m_1_38_para.my = 2;
    calc_m_1_38_para.mz = 32;
    calc_m_1_38_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_1_38_para.oz][Proc.lat_hw -0+calc_m_1_38_para.oy][Proc.lon_hw -0+calc_m_1_38_para.ox];
    calc_m_1_38_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_1_38_para.oz][Proc.lat_hw -0+calc_m_1_38_para.oy][Proc.lon_hw -0+calc_m_1_38_para.ox];
    calc_m_1_38_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_1_38_para.oz][Proc.lat_hw -0+calc_m_1_38_para.oy][Proc.lon_hw -0+calc_m_1_38_para.ox];
    
    athread_spawn(calc_m_1_38, &calc_m_1_38_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_39_info calc_m_1_39_para;
    calc_m_1_39_para.lz = 33 - 32;
    calc_m_1_39_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_39_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_39_para.oz = 32;
    calc_m_1_39_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_39_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_39_para.hx = 0;
    calc_m_1_39_para.hy = 0;
    calc_m_1_39_para.hz = 1;
    calc_m_1_39_para.bx = 256;
    calc_m_1_39_para.by = 1;
    calc_m_1_39_para.bz = 4;
    calc_m_1_39_para.mx = 1;
    calc_m_1_39_para.my = 8;
    calc_m_1_39_para.mz = 8;
    calc_m_1_39_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_1_39_para.oz][Proc.lat_hw -0+calc_m_1_39_para.oy][Proc.lon_hw -0+calc_m_1_39_para.ox];
    calc_m_1_39_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_1_39_para.oz][Proc.lat_hw -0+calc_m_1_39_para.oy][Proc.lon_hw -0+calc_m_1_39_para.ox];
    calc_m_1_39_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_1_39_para.oz][Proc.lat_hw -0+calc_m_1_39_para.oy][Proc.lon_hw -0+calc_m_1_39_para.ox];
    
    athread_spawn(calc_m_1_39, &calc_m_1_39_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_1_9_info averageCellToLonEdge_1_9_para;
    averageCellToLonEdge_1_9_para.lz = 32 - 0;
    averageCellToLonEdge_1_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_1_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_1_9_para.oz = 0;
    averageCellToLonEdge_1_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_1_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_1_9_para.hx = 1;
    averageCellToLonEdge_1_9_para.hy = 1;
    averageCellToLonEdge_1_9_para.hz = 0;
    averageCellToLonEdge_1_9_para.bx = 256;
    averageCellToLonEdge_1_9_para.by = 8;
    averageCellToLonEdge_1_9_para.bz = 1;
    averageCellToLonEdge_1_9_para.mx = 1;
    averageCellToLonEdge_1_9_para.my = 2;
    averageCellToLonEdge_1_9_para.mz = 32;
    averageCellToLonEdge_1_9_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_1_9_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_9_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_9_para.ox];
    averageCellToLonEdge_1_9_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_1_9_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_9_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_9_para.ox];
    
    athread_spawn(averageCellToLonEdge_1_9, &averageCellToLonEdge_1_9_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_1_9_info averageCellToLatEdge_1_9_para;
    averageCellToLatEdge_1_9_para.lz = 32 - 0;
    averageCellToLatEdge_1_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_1_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_1_9_para.oz = 0;
    averageCellToLatEdge_1_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_1_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_1_9_para.hx = 1;
    averageCellToLatEdge_1_9_para.hy = 1;
    averageCellToLatEdge_1_9_para.hz = 0;
    averageCellToLatEdge_1_9_para.bx = 256;
    averageCellToLatEdge_1_9_para.by = 8;
    averageCellToLatEdge_1_9_para.bz = 1;
    averageCellToLatEdge_1_9_para.mx = 1;
    averageCellToLatEdge_1_9_para.my = 2;
    averageCellToLatEdge_1_9_para.mz = 32;
    averageCellToLatEdge_1_9_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_1_9_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_9_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_9_para.ox];
    averageCellToLatEdge_1_9_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_1_9_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_9_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_9_para.ox];
    
    athread_spawn(averageCellToLatEdge_1_9, &averageCellToLatEdge_1_9_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_1_9_info interpCellToVtx_1_9_para;
    interpCellToVtx_1_9_para.lz = 32 - 0;
    interpCellToVtx_1_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_1_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_1_9_para.oz = 0;
    interpCellToVtx_1_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_1_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_1_9_para.hx = 1;
    interpCellToVtx_1_9_para.hy = 1;
    interpCellToVtx_1_9_para.hz = 0;
    interpCellToVtx_1_9_para.bx = 256;
    interpCellToVtx_1_9_para.by = 8;
    interpCellToVtx_1_9_para.bz = 1;
    interpCellToVtx_1_9_para.mx = 1;
    interpCellToVtx_1_9_para.my = 2;
    interpCellToVtx_1_9_para.mz = 32;
    interpCellToVtx_1_9_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_1_9_para.oz][Proc.lat_hw -1+interpCellToVtx_1_9_para.oy][Proc.lon_hw -1+interpCellToVtx_1_9_para.ox];
    interpCellToVtx_1_9_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_1_9_para.oz][Proc.lat_hw -1+interpCellToVtx_1_9_para.oy][Proc.lon_hw -1+interpCellToVtx_1_9_para.ox];
    interpCellToVtx_1_9_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_1_9_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_1_9_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_1_9, &interpCellToVtx_1_9_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->pt))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,1,&tend1->dpt[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend1->dpt[0][0][0], &Proc.FieldReq[async_dpt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_pt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_1_16_info update_state_1_16_para;
    update_state_1_16_para.lz = 32 - 0;
    update_state_1_16_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_1_16_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_1_16_para.oz = 0;
    update_state_1_16_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_1_16_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_1_16_para.hx = 2;
    update_state_1_16_para.hy = 2;
    update_state_1_16_para.hz = 0;
    update_state_1_16_para.bx = 256;
    update_state_1_16_para.by = 8;
    update_state_1_16_para.bz = 1;
    update_state_1_16_para.mx = 1;
    update_state_1_16_para.my = 2;
    update_state_1_16_para.mz = 32;
    update_state_1_16_para.old_statept = &old_state->pt[Proc.lev_hw - 0+update_state_1_16_para.oz][Proc.lat_hw -2+update_state_1_16_para.oy][Proc.lon_hw -2+update_state_1_16_para.ox];
    update_state_1_16_para.old_statem = &old_state->m[Proc.lev_hw - 0+update_state_1_16_para.oz][Proc.lat_hw -2+update_state_1_16_para.oy][Proc.lon_hw -2+update_state_1_16_para.ox];
    update_state_1_16_para.tend1dpt = &tend1->dpt[Proc.lev_hw - 0+update_state_1_16_para.oz][Proc.lat_hw -2+update_state_1_16_para.oy][Proc.lon_hw -2+update_state_1_16_para.ox];
    update_state_1_16_para.new_statem = &new_state->m[Proc.lev_hw - 0+update_state_1_16_para.oz][Proc.lat_hw -2+update_state_1_16_para.oy][Proc.lon_hw -2+update_state_1_16_para.ox];
    update_state_1_16_para.new_statept = &new_state->pt[Proc.lev_hw - 0+update_state_1_16_para.oz][Proc.lat_hw -2+update_state_1_16_para.oy][Proc.lon_hw -2+update_state_1_16_para.ox];
    update_state_1_16_para.dt = dt;
    
    athread_spawn(update_state_1_16, &update_state_1_16_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateptTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->gz))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_1_17_info update_state_1_17_para;
    update_state_1_17_para.lz = 32 - 0;
    update_state_1_17_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_1_17_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_1_17_para.oz = 0;
    update_state_1_17_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_1_17_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_1_17_para.hx = 0;
    update_state_1_17_para.hy = 0;
    update_state_1_17_para.hz = 0;
    update_state_1_17_para.bx = 256;
    update_state_1_17_para.by = 8;
    update_state_1_17_para.bz = 1;
    update_state_1_17_para.mx = 1;
    update_state_1_17_para.my = 2;
    update_state_1_17_para.mz = 32;
    update_state_1_17_para.old_stategz = &old_state->gz[Proc.lev_hw - 0+update_state_1_17_para.oz][Proc.lat_hw -0+update_state_1_17_para.oy][Proc.lon_hw -0+update_state_1_17_para.ox];
    update_state_1_17_para.tend1dgz = &tend1->dgz[Proc.lev_hw - 0+update_state_1_17_para.oz][Proc.lat_hw -0+update_state_1_17_para.oy][Proc.lon_hw -0+update_state_1_17_para.ox];
    update_state_1_17_para.new_stategz = &new_state->gz[Proc.lev_hw - 0+update_state_1_17_para.oz][Proc.lat_hw -0+update_state_1_17_para.oy][Proc.lon_hw -0+update_state_1_17_para.ox];
    update_state_1_17_para.dt = dt;
    
    athread_spawn(update_state_1_17, &update_state_1_17_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stategzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_40_info calc_m_1_40_para;
    calc_m_1_40_para.lz = 32 - 0;
    calc_m_1_40_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_40_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_40_para.oz = 0;
    calc_m_1_40_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_40_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_40_para.hx = 1;
    calc_m_1_40_para.hy = 0;
    calc_m_1_40_para.hz = 1;
    calc_m_1_40_para.bx = 256;
    calc_m_1_40_para.by = 1;
    calc_m_1_40_para.bz = 4;
    calc_m_1_40_para.mx = 1;
    calc_m_1_40_para.my = 8;
    calc_m_1_40_para.mz = 8;
    calc_m_1_40_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_1_40_para.oz][Proc.lat_hw -0+calc_m_1_40_para.oy][Proc.lon_hw -1+calc_m_1_40_para.ox];
    calc_m_1_40_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_1_40_para.oz][Proc.lat_hw -0+calc_m_1_40_para.oy][Proc.lon_hw -1+calc_m_1_40_para.ox];
    
    athread_spawn(calc_m_1_40, &calc_m_1_40_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_41_info calc_m_1_41_para;
    calc_m_1_41_para.lz = 32 - 1;
    calc_m_1_41_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_41_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_41_para.oz = 1;
    calc_m_1_41_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_41_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_41_para.hx = 0;
    calc_m_1_41_para.hy = 0;
    calc_m_1_41_para.hz = 1;
    calc_m_1_41_para.bx = 256;
    calc_m_1_41_para.by = 1;
    calc_m_1_41_para.bz = 4;
    calc_m_1_41_para.mx = 1;
    calc_m_1_41_para.my = 8;
    calc_m_1_41_para.mz = 8;
    calc_m_1_41_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_1_41_para.oz][Proc.lat_hw -0+calc_m_1_41_para.oy][Proc.lon_hw -0+calc_m_1_41_para.ox];
    calc_m_1_41_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_1_41_para.oz][Proc.lat_hw -0+calc_m_1_41_para.oy][Proc.lon_hw -0+calc_m_1_41_para.ox];
    
    athread_spawn(calc_m_1_41, &calc_m_1_41_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_42_info calc_m_1_42_para;
    calc_m_1_42_para.lz = 1 - 0;
    calc_m_1_42_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_42_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_42_para.oz = 0;
    calc_m_1_42_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_42_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_42_para.hx = 0;
    calc_m_1_42_para.hy = 0;
    calc_m_1_42_para.hz = 0;
    calc_m_1_42_para.bx = 256;
    calc_m_1_42_para.by = 8;
    calc_m_1_42_para.bz = 1;
    calc_m_1_42_para.mx = 1;
    calc_m_1_42_para.my = 2;
    calc_m_1_42_para.mz = 32;
    calc_m_1_42_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_1_42_para.oz][Proc.lat_hw -0+calc_m_1_42_para.oy][Proc.lon_hw -0+calc_m_1_42_para.ox];
    calc_m_1_42_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_1_42_para.oz][Proc.lat_hw -0+calc_m_1_42_para.oy][Proc.lon_hw -0+calc_m_1_42_para.ox];
    calc_m_1_42_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_1_42_para.oz][Proc.lat_hw -0+calc_m_1_42_para.oy][Proc.lon_hw -0+calc_m_1_42_para.ox];
    
    athread_spawn(calc_m_1_42, &calc_m_1_42_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_43_info calc_m_1_43_para;
    calc_m_1_43_para.lz = 33 - 32;
    calc_m_1_43_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_43_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_43_para.oz = 32;
    calc_m_1_43_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_43_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_43_para.hx = 0;
    calc_m_1_43_para.hy = 0;
    calc_m_1_43_para.hz = 1;
    calc_m_1_43_para.bx = 256;
    calc_m_1_43_para.by = 1;
    calc_m_1_43_para.bz = 4;
    calc_m_1_43_para.mx = 1;
    calc_m_1_43_para.my = 8;
    calc_m_1_43_para.mz = 8;
    calc_m_1_43_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_1_43_para.oz][Proc.lat_hw -0+calc_m_1_43_para.oy][Proc.lon_hw -0+calc_m_1_43_para.ox];
    calc_m_1_43_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_1_43_para.oz][Proc.lat_hw -0+calc_m_1_43_para.oy][Proc.lon_hw -0+calc_m_1_43_para.ox];
    calc_m_1_43_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_1_43_para.oz][Proc.lat_hw -0+calc_m_1_43_para.oy][Proc.lon_hw -0+calc_m_1_43_para.ox];
    
    athread_spawn(calc_m_1_43, &calc_m_1_43_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_1_10_info averageCellToLonEdge_1_10_para;
    averageCellToLonEdge_1_10_para.lz = 32 - 0;
    averageCellToLonEdge_1_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_1_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_1_10_para.oz = 0;
    averageCellToLonEdge_1_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_1_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_1_10_para.hx = 1;
    averageCellToLonEdge_1_10_para.hy = 1;
    averageCellToLonEdge_1_10_para.hz = 0;
    averageCellToLonEdge_1_10_para.bx = 256;
    averageCellToLonEdge_1_10_para.by = 8;
    averageCellToLonEdge_1_10_para.bz = 1;
    averageCellToLonEdge_1_10_para.mx = 1;
    averageCellToLonEdge_1_10_para.my = 2;
    averageCellToLonEdge_1_10_para.mz = 32;
    averageCellToLonEdge_1_10_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_1_10_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_10_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_10_para.ox];
    averageCellToLonEdge_1_10_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_1_10_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_10_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_10_para.ox];
    
    athread_spawn(averageCellToLonEdge_1_10, &averageCellToLonEdge_1_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_1_10_info averageCellToLatEdge_1_10_para;
    averageCellToLatEdge_1_10_para.lz = 32 - 0;
    averageCellToLatEdge_1_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_1_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_1_10_para.oz = 0;
    averageCellToLatEdge_1_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_1_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_1_10_para.hx = 1;
    averageCellToLatEdge_1_10_para.hy = 1;
    averageCellToLatEdge_1_10_para.hz = 0;
    averageCellToLatEdge_1_10_para.bx = 256;
    averageCellToLatEdge_1_10_para.by = 8;
    averageCellToLatEdge_1_10_para.bz = 1;
    averageCellToLatEdge_1_10_para.mx = 1;
    averageCellToLatEdge_1_10_para.my = 2;
    averageCellToLatEdge_1_10_para.mz = 32;
    averageCellToLatEdge_1_10_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_1_10_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_10_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_10_para.ox];
    averageCellToLatEdge_1_10_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_1_10_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_10_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_10_para.ox];
    
    athread_spawn(averageCellToLatEdge_1_10, &averageCellToLatEdge_1_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_1_10_info interpCellToVtx_1_10_para;
    interpCellToVtx_1_10_para.lz = 32 - 0;
    interpCellToVtx_1_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_1_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_1_10_para.oz = 0;
    interpCellToVtx_1_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_1_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_1_10_para.hx = 1;
    interpCellToVtx_1_10_para.hy = 1;
    interpCellToVtx_1_10_para.hz = 0;
    interpCellToVtx_1_10_para.bx = 256;
    interpCellToVtx_1_10_para.by = 8;
    interpCellToVtx_1_10_para.bz = 1;
    interpCellToVtx_1_10_para.mx = 1;
    interpCellToVtx_1_10_para.my = 2;
    interpCellToVtx_1_10_para.mz = 32;
    interpCellToVtx_1_10_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_1_10_para.oz][Proc.lat_hw -1+interpCellToVtx_1_10_para.oy][Proc.lon_hw -1+interpCellToVtx_1_10_para.ox];
    interpCellToVtx_1_10_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_1_10_para.oz][Proc.lat_hw -1+interpCellToVtx_1_10_para.oy][Proc.lon_hw -1+interpCellToVtx_1_10_para.ox];
    interpCellToVtx_1_10_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_1_10_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_1_10_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_1_10, &interpCellToVtx_1_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if (((tendPara->u) && (tendPara->v)))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lon_edge(0,&tend1->du[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lon_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend1->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lat_edge(0,&tend1->dv[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lat_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend1->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_1_18_info update_state_1_18_para;
    update_state_1_18_para.lz = 32 - 0;
    update_state_1_18_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    update_state_1_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_1_18_para.oz = 0;
    update_state_1_18_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    update_state_1_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_1_18_para.hx = 1;
    update_state_1_18_para.hy = 1;
    update_state_1_18_para.hz = 0;
    update_state_1_18_para.bx = 256;
    update_state_1_18_para.by = 8;
    update_state_1_18_para.bz = 1;
    update_state_1_18_para.mx = 1;
    update_state_1_18_para.my = 2;
    update_state_1_18_para.mz = 32;
    update_state_1_18_para.old_stateu_lon = &old_state->u_lon[Proc.lev_hw - 0+update_state_1_18_para.oz][Proc.lat_hw -1+update_state_1_18_para.oy][Proc.lon_hw -1+update_state_1_18_para.ox];
    update_state_1_18_para.tend1du = &tend1->du[Proc.lev_hw - 0+update_state_1_18_para.oz][Proc.lat_hw -1+update_state_1_18_para.oy][Proc.lon_hw -1+update_state_1_18_para.ox];
    update_state_1_18_para.new_stateu_lon = &new_state->u_lon[Proc.lev_hw - 0+update_state_1_18_para.oz][Proc.lat_hw -1+update_state_1_18_para.oy][Proc.lon_hw -1+update_state_1_18_para.ox];
    update_state_1_18_para.dt = dt;
    
    athread_spawn(update_state_1_18, &update_state_1_18_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateu_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_1_19_info update_state_1_19_para;
    update_state_1_19_para.lz = 32 - 0;
    update_state_1_19_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    update_state_1_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_1_19_para.oz = 0;
    update_state_1_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_1_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_1_19_para.hx = 1;
    update_state_1_19_para.hy = 1;
    update_state_1_19_para.hz = 0;
    update_state_1_19_para.bx = 256;
    update_state_1_19_para.by = 8;
    update_state_1_19_para.bz = 1;
    update_state_1_19_para.mx = 1;
    update_state_1_19_para.my = 2;
    update_state_1_19_para.mz = 32;
    update_state_1_19_para.old_statev_lat = &old_state->v_lat[Proc.lev_hw - 0+update_state_1_19_para.oz][Proc.lat_hw -1+update_state_1_19_para.oy][Proc.lon_hw -1+update_state_1_19_para.ox];
    update_state_1_19_para.tend1dv = &tend1->dv[Proc.lev_hw - 0+update_state_1_19_para.oz][Proc.lat_hw -1+update_state_1_19_para.oy][Proc.lon_hw -1+update_state_1_19_para.ox];
    update_state_1_19_para.new_statev_lat = &new_state->v_lat[Proc.lev_hw - 0+update_state_1_19_para.oz][Proc.lat_hw -1+update_state_1_19_para.oy][Proc.lon_hw -1+update_state_1_19_para.ox];
    update_state_1_19_para.dt = dt;
    
    athread_spawn(update_state_1_19, &update_state_1_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statev_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  tendPara = tendPara;
  advPara = advPara;
  dt = dt;
  tendPara = tendPara;
  (tendPara->u) = 0;
  (tendPara->v) = 0;
  (tendPara->pt) = 0;
  (tendPara->gz) = 0;
  (tendPara->phs) = 0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_t_1_3_info calc_t_1_3_para;
  calc_t_1_3_para.lz = 32 - 0;
  calc_t_1_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_t_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_t_1_3_para.oz = 0;
  calc_t_1_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_t_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_t_1_3_para.hx = 2;
  calc_t_1_3_para.hy = 2;
  calc_t_1_3_para.hz = 0;
  calc_t_1_3_para.bx = 256;
  calc_t_1_3_para.by = 8;
  calc_t_1_3_para.bz = 1;
  calc_t_1_3_para.mx = 1;
  calc_t_1_3_para.my = 2;
  calc_t_1_3_para.mz = 32;
  calc_t_1_3_para.new_statept = &new_state->pt[Proc.lev_hw - 0+calc_t_1_3_para.oz][Proc.lat_hw -2+calc_t_1_3_para.oy][Proc.lon_hw -2+calc_t_1_3_para.ox];
  calc_t_1_3_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_t_1_3_para.oz][Proc.lat_hw -2+calc_t_1_3_para.oy][Proc.lon_hw -2+calc_t_1_3_para.ox];
  calc_t_1_3_para.new_stateqv = &new_state->qv[Proc.lev_hw - 0+calc_t_1_3_para.oz][Proc.lat_hw -2+calc_t_1_3_para.oy][Proc.lon_hw -2+calc_t_1_3_para.ox];
  calc_t_1_3_para.new_statet = &new_state->t[Proc.lev_hw - 0+calc_t_1_3_para.oz][Proc.lat_hw -2+calc_t_1_3_para.oy][Proc.lon_hw -2+calc_t_1_3_para.ox];
  
  athread_spawn(calc_t_1_3, &calc_t_1_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_ttTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_gz_lev_1_3_info calc_gz_lev_1_3_para;
  calc_gz_lev_1_3_para.lz = 32 - 0;
  calc_gz_lev_1_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_gz_lev_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_gz_lev_1_3_para.oz = 0;
  calc_gz_lev_1_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_gz_lev_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_gz_lev_1_3_para.hx = 1;
  calc_gz_lev_1_3_para.hy = 0;
  calc_gz_lev_1_3_para.hz = Proc.lev_hw;
  calc_gz_lev_1_3_para.bx = 64;
  calc_gz_lev_1_3_para.by = 1;
  calc_gz_lev_1_3_para.bz = 32;
  calc_gz_lev_1_3_para.mx = 8;
  calc_gz_lev_1_3_para.my = 8;
  calc_gz_lev_1_3_para.mz = 1;
  calc_gz_lev_1_3_para.new_statet = &new_state->t[Proc.lev_hw - calc_gz_lev_1_3_para.hz+calc_gz_lev_1_3_para.oz][Proc.lat_hw -0+calc_gz_lev_1_3_para.oy][Proc.lon_hw -1+calc_gz_lev_1_3_para.ox];
  calc_gz_lev_1_3_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - calc_gz_lev_1_3_para.hz+calc_gz_lev_1_3_para.oz][Proc.lat_hw -0+calc_gz_lev_1_3_para.oy][Proc.lon_hw -1+calc_gz_lev_1_3_para.ox];
  calc_gz_lev_1_3_para.staticvgzs = &staticv->gzs[0][Proc.lat_hw -0+calc_gz_lev_1_3_para.oy][Proc.lon_hw -1+calc_gz_lev_1_3_para.ox];
  calc_gz_lev_1_3_para.new_stategz_lev = &new_state->gz_lev[Proc.lev_hw - calc_gz_lev_1_3_para.hz+calc_gz_lev_1_3_para.oz][Proc.lat_hw -0+calc_gz_lev_1_3_para.oy][Proc.lon_hw -1+calc_gz_lev_1_3_para.ox];
  
  athread_spawn(calc_gz_lev_1_3, &calc_gz_lev_1_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_gz_levgz_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &new_state->gz_lev[0][0][0], &Proc.FieldReq[async_gz_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qm]);
  HaloWait(Proc,&Proc.FieldReq[async_ph_exn_lev]);
  HaloWait(Proc,&Proc.FieldReq[async_gz_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  pgf_lin97_1_2_info pgf_lin97_1_2_para;
  pgf_lin97_1_2_para.lz = 32 - 0;
  pgf_lin97_1_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  pgf_lin97_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  pgf_lin97_1_2_para.oz = 0;
  pgf_lin97_1_2_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  pgf_lin97_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  pgf_lin97_1_2_para.hx = 1;
  pgf_lin97_1_2_para.hy = 0;
  pgf_lin97_1_2_para.hz = 1;
  pgf_lin97_1_2_para.bx = 256;
  pgf_lin97_1_2_para.by = 1;
  pgf_lin97_1_2_para.bz = 4;
  pgf_lin97_1_2_para.mx = 1;
  pgf_lin97_1_2_para.my = 8;
  pgf_lin97_1_2_para.mz = 8;
  pgf_lin97_1_2_para.new_stateqm = &new_state->qm[Proc.lev_hw - 1+pgf_lin97_1_2_para.oz][Proc.lat_hw -0+pgf_lin97_1_2_para.oy][Proc.lon_hw -1+pgf_lin97_1_2_para.ox];
  pgf_lin97_1_2_para.new_stateph_exn_lev = &new_state->ph_exn_lev[Proc.lev_hw - 1+pgf_lin97_1_2_para.oz][Proc.lat_hw -0+pgf_lin97_1_2_para.oy][Proc.lon_hw -1+pgf_lin97_1_2_para.ox];
  pgf_lin97_1_2_para.new_stategz_lev = &new_state->gz_lev[Proc.lev_hw - 1+pgf_lin97_1_2_para.oz][Proc.lat_hw -0+pgf_lin97_1_2_para.oy][Proc.lon_hw -1+pgf_lin97_1_2_para.ox];
  pgf_lin97_1_2_para.tend2pgf_lon = &tend2->pgf_lon[Proc.lev_hw - 1+pgf_lin97_1_2_para.oz][Proc.lat_hw -0+pgf_lin97_1_2_para.oy][Proc.lon_hw -1+pgf_lin97_1_2_para.ox];
  pgf_lin97_1_2_para.de_lon = &mesh->de_lon[0][0][0];
  
  athread_spawn(pgf_lin97_1_2, &pgf_lin97_1_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  pgf_lin97pgf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qm]);
  HaloWait(Proc,&Proc.FieldReq[async_ph_exn_lev]);
  HaloWait(Proc,&Proc.FieldReq[async_gz_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tl = (1 + (0.5 * (new_state->qm[k][j][i] + new_state->qm[k][(j + 1)][i])));
        dph1 = (new_state->ph_exn_lev[(k + 1)][(j + 1)][i] - new_state->ph_exn_lev[k][j][i]);
        dph2 = (new_state->ph_exn_lev[(k + 1)][j][i] - new_state->ph_exn_lev[k][(j + 1)][i]);
        dgz1 = (new_state->gz_lev[(k + 1)][j][i] - new_state->gz_lev[k][(j + 1)][i]);
        dgz2 = (new_state->gz_lev[k][j][i] - new_state->gz_lev[(k + 1)][(j + 1)][i]);
        tend2->pgf_lat[k][j][i] = (((-((dph1 * dgz1) + (dph2 * dgz2)) / mesh->de_lat[0][j][0]) / (dph1 + dph2)) / tl);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  pgf_lin97pgf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  tendPara = tendPara;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_du]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_backward_1_4_info calc_tend_backward_1_4_para;
  calc_tend_backward_1_4_para.lz = 32 - 0;
  calc_tend_backward_1_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_tend_backward_1_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_backward_1_4_para.oz = 0;
  calc_tend_backward_1_4_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_tend_backward_1_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_backward_1_4_para.hx = 1;
  calc_tend_backward_1_4_para.hy = 1;
  calc_tend_backward_1_4_para.hz = 0;
  calc_tend_backward_1_4_para.bx = 256;
  calc_tend_backward_1_4_para.by = 8;
  calc_tend_backward_1_4_para.bz = 1;
  calc_tend_backward_1_4_para.mx = 1;
  calc_tend_backward_1_4_para.my = 2;
  calc_tend_backward_1_4_para.mz = 32;
  calc_tend_backward_1_4_para.tend1du = &tend1->du[Proc.lev_hw - 0+calc_tend_backward_1_4_para.oz][Proc.lat_hw -1+calc_tend_backward_1_4_para.oy][Proc.lon_hw -1+calc_tend_backward_1_4_para.ox];
  calc_tend_backward_1_4_para.tend2pgf_lon = &tend2->pgf_lon[Proc.lev_hw - 0+calc_tend_backward_1_4_para.oz][Proc.lat_hw -1+calc_tend_backward_1_4_para.oy][Proc.lon_hw -1+calc_tend_backward_1_4_para.ox];
  calc_tend_backward_1_4_para.tend2du = &tend2->du[Proc.lev_hw - 0+calc_tend_backward_1_4_para.oz][Proc.lat_hw -1+calc_tend_backward_1_4_para.oy][Proc.lon_hw -1+calc_tend_backward_1_4_para.ox];
  
  athread_spawn(calc_tend_backward_1_4, &calc_tend_backward_1_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_backwardduTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend2->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_dv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_backward_1_5_info calc_tend_backward_1_5_para;
  calc_tend_backward_1_5_para.lz = 32 - 0;
  calc_tend_backward_1_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_tend_backward_1_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_backward_1_5_para.oz = 0;
  calc_tend_backward_1_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_tend_backward_1_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_backward_1_5_para.hx = 1;
  calc_tend_backward_1_5_para.hy = 1;
  calc_tend_backward_1_5_para.hz = 0;
  calc_tend_backward_1_5_para.bx = 256;
  calc_tend_backward_1_5_para.by = 8;
  calc_tend_backward_1_5_para.bz = 1;
  calc_tend_backward_1_5_para.mx = 1;
  calc_tend_backward_1_5_para.my = 2;
  calc_tend_backward_1_5_para.mz = 32;
  calc_tend_backward_1_5_para.tend1dv = &tend1->dv[Proc.lev_hw - 0+calc_tend_backward_1_5_para.oz][Proc.lat_hw -1+calc_tend_backward_1_5_para.oy][Proc.lon_hw -1+calc_tend_backward_1_5_para.ox];
  calc_tend_backward_1_5_para.tend2pgf_lat = &tend2->pgf_lat[Proc.lev_hw - 0+calc_tend_backward_1_5_para.oz][Proc.lat_hw -1+calc_tend_backward_1_5_para.oy][Proc.lon_hw -1+calc_tend_backward_1_5_para.ox];
  calc_tend_backward_1_5_para.tend2dv = &tend2->dv[Proc.lev_hw - 0+calc_tend_backward_1_5_para.oz][Proc.lat_hw -1+calc_tend_backward_1_5_para.oy][Proc.lon_hw -1+calc_tend_backward_1_5_para.ox];
  
  athread_spawn(calc_tend_backward_1_5, &calc_tend_backward_1_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_backwarddvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend2->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  (tendPara->u) = 1;
  (tendPara->v) = 1;
  tendPara = tendPara;
  dt = dt;
  if ((tendPara->phs))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,0,&tend2->dphs[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &tend2->dphs[0][0][0], &Proc.FieldReq[async_dphs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        new_state->phs[0][j][i] = (old_state->phs[0][j][i] + (dt * tend2->dphs[0][j][i]));
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statephsTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &new_state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_1_18_info calc_ph_1_18_para;
    calc_ph_1_18_para.lz = 33 - 0;
    calc_ph_1_18_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_1_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_1_18_para.oz = 0;
    calc_ph_1_18_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_1_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_1_18_para.hx = 1;
    calc_ph_1_18_para.hy = 1;
    calc_ph_1_18_para.hz = 0;
    calc_ph_1_18_para.bx = 256;
    calc_ph_1_18_para.by = 8;
    calc_ph_1_18_para.bz = 1;
    calc_ph_1_18_para.mx = 1;
    calc_ph_1_18_para.my = 2;
    calc_ph_1_18_para.mz = 32;
    calc_ph_1_18_para.new_statephs = &new_state->phs[0][Proc.lat_hw -1+calc_ph_1_18_para.oy][Proc.lon_hw -1+calc_ph_1_18_para.ox];
    calc_ph_1_18_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_1_18_para.oz][Proc.lat_hw -1+calc_ph_1_18_para.oy][Proc.lon_hw -1+calc_ph_1_18_para.ox];
    calc_ph_1_18_para.hyai = &mesh->hyai[0][0][0];
    calc_ph_1_18_para.hybi = &mesh->hybi[0][0][0];
    
    athread_spawn(calc_ph_1_18, &calc_ph_1_18_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_1_19_info calc_ph_1_19_para;
    calc_ph_1_19_para.lz = 33 - 0;
    calc_ph_1_19_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_1_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_1_19_para.oz = 0;
    calc_ph_1_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_1_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_1_19_para.hx = 1;
    calc_ph_1_19_para.hy = 1;
    calc_ph_1_19_para.hz = 0;
    calc_ph_1_19_para.bx = 256;
    calc_ph_1_19_para.by = 8;
    calc_ph_1_19_para.bz = 1;
    calc_ph_1_19_para.mx = 1;
    calc_ph_1_19_para.my = 2;
    calc_ph_1_19_para.mz = 32;
    calc_ph_1_19_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_1_19_para.oz][Proc.lat_hw -1+calc_ph_1_19_para.oy][Proc.lon_hw -1+calc_ph_1_19_para.ox];
    calc_ph_1_19_para.new_stateph_exn_lev = &new_state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_1_19_para.oz][Proc.lat_hw -1+calc_ph_1_19_para.oy][Proc.lon_hw -1+calc_ph_1_19_para.ox];
    
    athread_spawn(calc_ph_1_19, &calc_ph_1_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_exn_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_1_20_info calc_ph_1_20_para;
    calc_ph_1_20_para.lz = 32 - 0;
    calc_ph_1_20_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_1_20_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_1_20_para.oz = 0;
    calc_ph_1_20_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_1_20_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_1_20_para.hx = 0;
    calc_ph_1_20_para.hy = 0;
    calc_ph_1_20_para.hz = 1;
    calc_ph_1_20_para.bx = 256;
    calc_ph_1_20_para.by = 1;
    calc_ph_1_20_para.bz = 4;
    calc_ph_1_20_para.mx = 1;
    calc_ph_1_20_para.my = 8;
    calc_ph_1_20_para.mz = 8;
    calc_ph_1_20_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_ph_1_20_para.oz][Proc.lat_hw -0+calc_ph_1_20_para.oy][Proc.lon_hw -0+calc_ph_1_20_para.ox];
    calc_ph_1_20_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_ph_1_20_para.oz][Proc.lat_hw -0+calc_ph_1_20_para.oy][Proc.lon_hw -0+calc_ph_1_20_para.ox];
    
    athread_spawn(calc_ph_1_20, &calc_ph_1_20_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phphTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_44_info calc_m_1_44_para;
    calc_m_1_44_para.lz = 32 - 0;
    calc_m_1_44_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_44_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_44_para.oz = 0;
    calc_m_1_44_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_44_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_44_para.hx = 1;
    calc_m_1_44_para.hy = 0;
    calc_m_1_44_para.hz = 1;
    calc_m_1_44_para.bx = 256;
    calc_m_1_44_para.by = 1;
    calc_m_1_44_para.bz = 4;
    calc_m_1_44_para.mx = 1;
    calc_m_1_44_para.my = 8;
    calc_m_1_44_para.mz = 8;
    calc_m_1_44_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_1_44_para.oz][Proc.lat_hw -0+calc_m_1_44_para.oy][Proc.lon_hw -1+calc_m_1_44_para.ox];
    calc_m_1_44_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_1_44_para.oz][Proc.lat_hw -0+calc_m_1_44_para.oy][Proc.lon_hw -1+calc_m_1_44_para.ox];
    
    athread_spawn(calc_m_1_44, &calc_m_1_44_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_45_info calc_m_1_45_para;
    calc_m_1_45_para.lz = 32 - 1;
    calc_m_1_45_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_45_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_45_para.oz = 1;
    calc_m_1_45_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_45_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_45_para.hx = 0;
    calc_m_1_45_para.hy = 0;
    calc_m_1_45_para.hz = 1;
    calc_m_1_45_para.bx = 256;
    calc_m_1_45_para.by = 1;
    calc_m_1_45_para.bz = 4;
    calc_m_1_45_para.mx = 1;
    calc_m_1_45_para.my = 8;
    calc_m_1_45_para.mz = 8;
    calc_m_1_45_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_1_45_para.oz][Proc.lat_hw -0+calc_m_1_45_para.oy][Proc.lon_hw -0+calc_m_1_45_para.ox];
    calc_m_1_45_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_1_45_para.oz][Proc.lat_hw -0+calc_m_1_45_para.oy][Proc.lon_hw -0+calc_m_1_45_para.ox];
    
    athread_spawn(calc_m_1_45, &calc_m_1_45_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_46_info calc_m_1_46_para;
    calc_m_1_46_para.lz = 1 - 0;
    calc_m_1_46_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_46_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_46_para.oz = 0;
    calc_m_1_46_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_46_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_46_para.hx = 0;
    calc_m_1_46_para.hy = 0;
    calc_m_1_46_para.hz = 0;
    calc_m_1_46_para.bx = 256;
    calc_m_1_46_para.by = 8;
    calc_m_1_46_para.bz = 1;
    calc_m_1_46_para.mx = 1;
    calc_m_1_46_para.my = 2;
    calc_m_1_46_para.mz = 32;
    calc_m_1_46_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_1_46_para.oz][Proc.lat_hw -0+calc_m_1_46_para.oy][Proc.lon_hw -0+calc_m_1_46_para.ox];
    calc_m_1_46_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_1_46_para.oz][Proc.lat_hw -0+calc_m_1_46_para.oy][Proc.lon_hw -0+calc_m_1_46_para.ox];
    calc_m_1_46_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_1_46_para.oz][Proc.lat_hw -0+calc_m_1_46_para.oy][Proc.lon_hw -0+calc_m_1_46_para.ox];
    
    athread_spawn(calc_m_1_46, &calc_m_1_46_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_47_info calc_m_1_47_para;
    calc_m_1_47_para.lz = 33 - 32;
    calc_m_1_47_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_47_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_47_para.oz = 32;
    calc_m_1_47_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_47_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_47_para.hx = 0;
    calc_m_1_47_para.hy = 0;
    calc_m_1_47_para.hz = 1;
    calc_m_1_47_para.bx = 256;
    calc_m_1_47_para.by = 1;
    calc_m_1_47_para.bz = 4;
    calc_m_1_47_para.mx = 1;
    calc_m_1_47_para.my = 8;
    calc_m_1_47_para.mz = 8;
    calc_m_1_47_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_1_47_para.oz][Proc.lat_hw -0+calc_m_1_47_para.oy][Proc.lon_hw -0+calc_m_1_47_para.ox];
    calc_m_1_47_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_1_47_para.oz][Proc.lat_hw -0+calc_m_1_47_para.oy][Proc.lon_hw -0+calc_m_1_47_para.ox];
    calc_m_1_47_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_1_47_para.oz][Proc.lat_hw -0+calc_m_1_47_para.oy][Proc.lon_hw -0+calc_m_1_47_para.ox];
    
    athread_spawn(calc_m_1_47, &calc_m_1_47_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_1_11_info averageCellToLonEdge_1_11_para;
    averageCellToLonEdge_1_11_para.lz = 32 - 0;
    averageCellToLonEdge_1_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_1_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_1_11_para.oz = 0;
    averageCellToLonEdge_1_11_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_1_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_1_11_para.hx = 1;
    averageCellToLonEdge_1_11_para.hy = 1;
    averageCellToLonEdge_1_11_para.hz = 0;
    averageCellToLonEdge_1_11_para.bx = 256;
    averageCellToLonEdge_1_11_para.by = 8;
    averageCellToLonEdge_1_11_para.bz = 1;
    averageCellToLonEdge_1_11_para.mx = 1;
    averageCellToLonEdge_1_11_para.my = 2;
    averageCellToLonEdge_1_11_para.mz = 32;
    averageCellToLonEdge_1_11_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_1_11_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_11_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_11_para.ox];
    averageCellToLonEdge_1_11_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_1_11_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_11_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_11_para.ox];
    
    athread_spawn(averageCellToLonEdge_1_11, &averageCellToLonEdge_1_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_1_11_info averageCellToLatEdge_1_11_para;
    averageCellToLatEdge_1_11_para.lz = 32 - 0;
    averageCellToLatEdge_1_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_1_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_1_11_para.oz = 0;
    averageCellToLatEdge_1_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_1_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_1_11_para.hx = 1;
    averageCellToLatEdge_1_11_para.hy = 1;
    averageCellToLatEdge_1_11_para.hz = 0;
    averageCellToLatEdge_1_11_para.bx = 256;
    averageCellToLatEdge_1_11_para.by = 8;
    averageCellToLatEdge_1_11_para.bz = 1;
    averageCellToLatEdge_1_11_para.mx = 1;
    averageCellToLatEdge_1_11_para.my = 2;
    averageCellToLatEdge_1_11_para.mz = 32;
    averageCellToLatEdge_1_11_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_1_11_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_11_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_11_para.ox];
    averageCellToLatEdge_1_11_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_1_11_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_11_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_11_para.ox];
    
    athread_spawn(averageCellToLatEdge_1_11, &averageCellToLatEdge_1_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_1_11_info interpCellToVtx_1_11_para;
    interpCellToVtx_1_11_para.lz = 32 - 0;
    interpCellToVtx_1_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_1_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_1_11_para.oz = 0;
    interpCellToVtx_1_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_1_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_1_11_para.hx = 1;
    interpCellToVtx_1_11_para.hy = 1;
    interpCellToVtx_1_11_para.hz = 0;
    interpCellToVtx_1_11_para.bx = 256;
    interpCellToVtx_1_11_para.by = 8;
    interpCellToVtx_1_11_para.bz = 1;
    interpCellToVtx_1_11_para.mx = 1;
    interpCellToVtx_1_11_para.my = 2;
    interpCellToVtx_1_11_para.mz = 32;
    interpCellToVtx_1_11_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_1_11_para.oz][Proc.lat_hw -1+interpCellToVtx_1_11_para.oy][Proc.lon_hw -1+interpCellToVtx_1_11_para.ox];
    interpCellToVtx_1_11_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_1_11_para.oz][Proc.lat_hw -1+interpCellToVtx_1_11_para.oy][Proc.lon_hw -1+interpCellToVtx_1_11_para.ox];
    interpCellToVtx_1_11_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_1_11_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_1_11_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_1_11, &interpCellToVtx_1_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->pt))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,1,&tend2->dpt[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend2->dpt[0][0][0], &Proc.FieldReq[async_dpt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_pt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_1_20_info update_state_1_20_para;
    update_state_1_20_para.lz = 32 - 0;
    update_state_1_20_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_1_20_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_1_20_para.oz = 0;
    update_state_1_20_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_1_20_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_1_20_para.hx = 2;
    update_state_1_20_para.hy = 2;
    update_state_1_20_para.hz = 0;
    update_state_1_20_para.bx = 256;
    update_state_1_20_para.by = 8;
    update_state_1_20_para.bz = 1;
    update_state_1_20_para.mx = 1;
    update_state_1_20_para.my = 2;
    update_state_1_20_para.mz = 32;
    update_state_1_20_para.old_statept = &old_state->pt[Proc.lev_hw - 0+update_state_1_20_para.oz][Proc.lat_hw -2+update_state_1_20_para.oy][Proc.lon_hw -2+update_state_1_20_para.ox];
    update_state_1_20_para.old_statem = &old_state->m[Proc.lev_hw - 0+update_state_1_20_para.oz][Proc.lat_hw -2+update_state_1_20_para.oy][Proc.lon_hw -2+update_state_1_20_para.ox];
    update_state_1_20_para.tend2dpt = &tend2->dpt[Proc.lev_hw - 0+update_state_1_20_para.oz][Proc.lat_hw -2+update_state_1_20_para.oy][Proc.lon_hw -2+update_state_1_20_para.ox];
    update_state_1_20_para.new_statem = &new_state->m[Proc.lev_hw - 0+update_state_1_20_para.oz][Proc.lat_hw -2+update_state_1_20_para.oy][Proc.lon_hw -2+update_state_1_20_para.ox];
    update_state_1_20_para.new_statept = &new_state->pt[Proc.lev_hw - 0+update_state_1_20_para.oz][Proc.lat_hw -2+update_state_1_20_para.oy][Proc.lon_hw -2+update_state_1_20_para.ox];
    update_state_1_20_para.dt = dt;
    
    athread_spawn(update_state_1_20, &update_state_1_20_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateptTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->gz))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_1_21_info update_state_1_21_para;
    update_state_1_21_para.lz = 32 - 0;
    update_state_1_21_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_1_21_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_1_21_para.oz = 0;
    update_state_1_21_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_1_21_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_1_21_para.hx = 0;
    update_state_1_21_para.hy = 0;
    update_state_1_21_para.hz = 0;
    update_state_1_21_para.bx = 256;
    update_state_1_21_para.by = 8;
    update_state_1_21_para.bz = 1;
    update_state_1_21_para.mx = 1;
    update_state_1_21_para.my = 2;
    update_state_1_21_para.mz = 32;
    update_state_1_21_para.old_stategz = &old_state->gz[Proc.lev_hw - 0+update_state_1_21_para.oz][Proc.lat_hw -0+update_state_1_21_para.oy][Proc.lon_hw -0+update_state_1_21_para.ox];
    update_state_1_21_para.tend2dgz = &tend2->dgz[Proc.lev_hw - 0+update_state_1_21_para.oz][Proc.lat_hw -0+update_state_1_21_para.oy][Proc.lon_hw -0+update_state_1_21_para.ox];
    update_state_1_21_para.new_stategz = &new_state->gz[Proc.lev_hw - 0+update_state_1_21_para.oz][Proc.lat_hw -0+update_state_1_21_para.oy][Proc.lon_hw -0+update_state_1_21_para.ox];
    update_state_1_21_para.dt = dt;
    
    athread_spawn(update_state_1_21, &update_state_1_21_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stategzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_48_info calc_m_1_48_para;
    calc_m_1_48_para.lz = 32 - 0;
    calc_m_1_48_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_48_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_48_para.oz = 0;
    calc_m_1_48_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_48_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_48_para.hx = 1;
    calc_m_1_48_para.hy = 0;
    calc_m_1_48_para.hz = 1;
    calc_m_1_48_para.bx = 256;
    calc_m_1_48_para.by = 1;
    calc_m_1_48_para.bz = 4;
    calc_m_1_48_para.mx = 1;
    calc_m_1_48_para.my = 8;
    calc_m_1_48_para.mz = 8;
    calc_m_1_48_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_1_48_para.oz][Proc.lat_hw -0+calc_m_1_48_para.oy][Proc.lon_hw -1+calc_m_1_48_para.ox];
    calc_m_1_48_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_1_48_para.oz][Proc.lat_hw -0+calc_m_1_48_para.oy][Proc.lon_hw -1+calc_m_1_48_para.ox];
    
    athread_spawn(calc_m_1_48, &calc_m_1_48_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_49_info calc_m_1_49_para;
    calc_m_1_49_para.lz = 32 - 1;
    calc_m_1_49_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_49_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_49_para.oz = 1;
    calc_m_1_49_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_49_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_49_para.hx = 0;
    calc_m_1_49_para.hy = 0;
    calc_m_1_49_para.hz = 1;
    calc_m_1_49_para.bx = 256;
    calc_m_1_49_para.by = 1;
    calc_m_1_49_para.bz = 4;
    calc_m_1_49_para.mx = 1;
    calc_m_1_49_para.my = 8;
    calc_m_1_49_para.mz = 8;
    calc_m_1_49_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_1_49_para.oz][Proc.lat_hw -0+calc_m_1_49_para.oy][Proc.lon_hw -0+calc_m_1_49_para.ox];
    calc_m_1_49_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_1_49_para.oz][Proc.lat_hw -0+calc_m_1_49_para.oy][Proc.lon_hw -0+calc_m_1_49_para.ox];
    
    athread_spawn(calc_m_1_49, &calc_m_1_49_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_50_info calc_m_1_50_para;
    calc_m_1_50_para.lz = 1 - 0;
    calc_m_1_50_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_50_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_50_para.oz = 0;
    calc_m_1_50_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_50_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_50_para.hx = 0;
    calc_m_1_50_para.hy = 0;
    calc_m_1_50_para.hz = 0;
    calc_m_1_50_para.bx = 256;
    calc_m_1_50_para.by = 8;
    calc_m_1_50_para.bz = 1;
    calc_m_1_50_para.mx = 1;
    calc_m_1_50_para.my = 2;
    calc_m_1_50_para.mz = 32;
    calc_m_1_50_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_1_50_para.oz][Proc.lat_hw -0+calc_m_1_50_para.oy][Proc.lon_hw -0+calc_m_1_50_para.ox];
    calc_m_1_50_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_1_50_para.oz][Proc.lat_hw -0+calc_m_1_50_para.oy][Proc.lon_hw -0+calc_m_1_50_para.ox];
    calc_m_1_50_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_1_50_para.oz][Proc.lat_hw -0+calc_m_1_50_para.oy][Proc.lon_hw -0+calc_m_1_50_para.ox];
    
    athread_spawn(calc_m_1_50, &calc_m_1_50_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_1_51_info calc_m_1_51_para;
    calc_m_1_51_para.lz = 33 - 32;
    calc_m_1_51_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_1_51_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_1_51_para.oz = 32;
    calc_m_1_51_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_1_51_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_1_51_para.hx = 0;
    calc_m_1_51_para.hy = 0;
    calc_m_1_51_para.hz = 1;
    calc_m_1_51_para.bx = 256;
    calc_m_1_51_para.by = 1;
    calc_m_1_51_para.bz = 4;
    calc_m_1_51_para.mx = 1;
    calc_m_1_51_para.my = 8;
    calc_m_1_51_para.mz = 8;
    calc_m_1_51_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_1_51_para.oz][Proc.lat_hw -0+calc_m_1_51_para.oy][Proc.lon_hw -0+calc_m_1_51_para.ox];
    calc_m_1_51_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_1_51_para.oz][Proc.lat_hw -0+calc_m_1_51_para.oy][Proc.lon_hw -0+calc_m_1_51_para.ox];
    calc_m_1_51_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_1_51_para.oz][Proc.lat_hw -0+calc_m_1_51_para.oy][Proc.lon_hw -0+calc_m_1_51_para.ox];
    
    athread_spawn(calc_m_1_51, &calc_m_1_51_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_1_12_info averageCellToLonEdge_1_12_para;
    averageCellToLonEdge_1_12_para.lz = 32 - 0;
    averageCellToLonEdge_1_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_1_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_1_12_para.oz = 0;
    averageCellToLonEdge_1_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_1_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_1_12_para.hx = 1;
    averageCellToLonEdge_1_12_para.hy = 1;
    averageCellToLonEdge_1_12_para.hz = 0;
    averageCellToLonEdge_1_12_para.bx = 256;
    averageCellToLonEdge_1_12_para.by = 8;
    averageCellToLonEdge_1_12_para.bz = 1;
    averageCellToLonEdge_1_12_para.mx = 1;
    averageCellToLonEdge_1_12_para.my = 2;
    averageCellToLonEdge_1_12_para.mz = 32;
    averageCellToLonEdge_1_12_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_1_12_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_12_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_12_para.ox];
    averageCellToLonEdge_1_12_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_1_12_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_12_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_12_para.ox];
    
    athread_spawn(averageCellToLonEdge_1_12, &averageCellToLonEdge_1_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_1_12_info averageCellToLatEdge_1_12_para;
    averageCellToLatEdge_1_12_para.lz = 32 - 0;
    averageCellToLatEdge_1_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_1_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_1_12_para.oz = 0;
    averageCellToLatEdge_1_12_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_1_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_1_12_para.hx = 1;
    averageCellToLatEdge_1_12_para.hy = 1;
    averageCellToLatEdge_1_12_para.hz = 0;
    averageCellToLatEdge_1_12_para.bx = 256;
    averageCellToLatEdge_1_12_para.by = 8;
    averageCellToLatEdge_1_12_para.bz = 1;
    averageCellToLatEdge_1_12_para.mx = 1;
    averageCellToLatEdge_1_12_para.my = 2;
    averageCellToLatEdge_1_12_para.mz = 32;
    averageCellToLatEdge_1_12_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_1_12_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_12_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_12_para.ox];
    averageCellToLatEdge_1_12_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_1_12_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_12_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_12_para.ox];
    
    athread_spawn(averageCellToLatEdge_1_12, &averageCellToLatEdge_1_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_1_12_info interpCellToVtx_1_12_para;
    interpCellToVtx_1_12_para.lz = 32 - 0;
    interpCellToVtx_1_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_1_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_1_12_para.oz = 0;
    interpCellToVtx_1_12_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_1_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_1_12_para.hx = 1;
    interpCellToVtx_1_12_para.hy = 1;
    interpCellToVtx_1_12_para.hz = 0;
    interpCellToVtx_1_12_para.bx = 256;
    interpCellToVtx_1_12_para.by = 8;
    interpCellToVtx_1_12_para.bz = 1;
    interpCellToVtx_1_12_para.mx = 1;
    interpCellToVtx_1_12_para.my = 2;
    interpCellToVtx_1_12_para.mz = 32;
    interpCellToVtx_1_12_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_1_12_para.oz][Proc.lat_hw -1+interpCellToVtx_1_12_para.oy][Proc.lon_hw -1+interpCellToVtx_1_12_para.ox];
    interpCellToVtx_1_12_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_1_12_para.oz][Proc.lat_hw -1+interpCellToVtx_1_12_para.oy][Proc.lon_hw -1+interpCellToVtx_1_12_para.ox];
    interpCellToVtx_1_12_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_1_12_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_1_12_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_1_12, &interpCellToVtx_1_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if (((tendPara->u) && (tendPara->v)))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lon_edge(0,&tend2->du[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lon_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend2->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lat_edge(0,&tend2->dv[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lat_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend2->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_1_22_info update_state_1_22_para;
    update_state_1_22_para.lz = 32 - 0;
    update_state_1_22_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    update_state_1_22_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_1_22_para.oz = 0;
    update_state_1_22_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    update_state_1_22_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_1_22_para.hx = 1;
    update_state_1_22_para.hy = 1;
    update_state_1_22_para.hz = 0;
    update_state_1_22_para.bx = 256;
    update_state_1_22_para.by = 8;
    update_state_1_22_para.bz = 1;
    update_state_1_22_para.mx = 1;
    update_state_1_22_para.my = 2;
    update_state_1_22_para.mz = 32;
    update_state_1_22_para.old_stateu_lon = &old_state->u_lon[Proc.lev_hw - 0+update_state_1_22_para.oz][Proc.lat_hw -1+update_state_1_22_para.oy][Proc.lon_hw -1+update_state_1_22_para.ox];
    update_state_1_22_para.tend2du = &tend2->du[Proc.lev_hw - 0+update_state_1_22_para.oz][Proc.lat_hw -1+update_state_1_22_para.oy][Proc.lon_hw -1+update_state_1_22_para.ox];
    update_state_1_22_para.new_stateu_lon = &new_state->u_lon[Proc.lev_hw - 0+update_state_1_22_para.oz][Proc.lat_hw -1+update_state_1_22_para.oy][Proc.lon_hw -1+update_state_1_22_para.ox];
    update_state_1_22_para.dt = dt;
    
    athread_spawn(update_state_1_22, &update_state_1_22_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateu_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_1_23_info update_state_1_23_para;
    update_state_1_23_para.lz = 32 - 0;
    update_state_1_23_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    update_state_1_23_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_1_23_para.oz = 0;
    update_state_1_23_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_1_23_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_1_23_para.hx = 1;
    update_state_1_23_para.hy = 1;
    update_state_1_23_para.hz = 0;
    update_state_1_23_para.bx = 256;
    update_state_1_23_para.by = 8;
    update_state_1_23_para.bz = 1;
    update_state_1_23_para.mx = 1;
    update_state_1_23_para.my = 2;
    update_state_1_23_para.mz = 32;
    update_state_1_23_para.old_statev_lat = &old_state->v_lat[Proc.lev_hw - 0+update_state_1_23_para.oz][Proc.lat_hw -1+update_state_1_23_para.oy][Proc.lon_hw -1+update_state_1_23_para.ox];
    update_state_1_23_para.tend2dv = &tend2->dv[Proc.lev_hw - 0+update_state_1_23_para.oz][Proc.lat_hw -1+update_state_1_23_para.oy][Proc.lon_hw -1+update_state_1_23_para.ox];
    update_state_1_23_para.new_statev_lat = &new_state->v_lat[Proc.lev_hw - 0+update_state_1_23_para.oz][Proc.lat_hw -1+update_state_1_23_para.oy][Proc.lon_hw -1+update_state_1_23_para.ox];
    update_state_1_23_para.dt = dt;
    
    athread_spawn(update_state_1_23, &update_state_1_23_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statev_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
}

void damp_run_1(struct HybridStateField* state, struct HybridTendField* tend, struct HybridMeshField* mesh, double dt)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_div]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->u_lon[k][j][i] = (state->u_lon[k][j][i] + ((mesh->c_lon[k][j][0] * (state->div[k][j][(i + 1)] - state->div[k][j][i])) / mesh->de_lon[0][j][0]));
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  div_damp_runu_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_div]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->v_lat[k][j][i] = (state->v_lat[k][j][i] + ((mesh->c_lat[k][j][0] * (state->div[k][(j + 1)][i] - state->div[k][j][i])) / mesh->de_lat[0][j][0]));
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  div_damp_runv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  dt = dt;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_1_0_info smag_damp_run_1_0_para;
  smag_damp_run_1_0_para.lz = 32 - 0;
  smag_damp_run_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_1_0_para.oz = 0;
  smag_damp_run_1_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_1_0_para.hx = 1;
  smag_damp_run_1_0_para.hy = 1;
  smag_damp_run_1_0_para.hz = 0;
  smag_damp_run_1_0_para.bx = 256;
  smag_damp_run_1_0_para.by = 8;
  smag_damp_run_1_0_para.bz = 1;
  smag_damp_run_1_0_para.mx = 1;
  smag_damp_run_1_0_para.my = 2;
  smag_damp_run_1_0_para.mz = 32;
  smag_damp_run_1_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_1_0_para.oz][Proc.lat_hw -1+smag_damp_run_1_0_para.oy][Proc.lon_hw -1+smag_damp_run_1_0_para.ox];
  smag_damp_run_1_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_1_0_para.oz][Proc.lat_hw -1+smag_damp_run_1_0_para.oy][Proc.lon_hw -1+smag_damp_run_1_0_para.ox];
  smag_damp_run_1_0_para.statesmag_t = &state->smag_t[Proc.lev_hw - 0+smag_damp_run_1_0_para.oz][Proc.lat_hw -1+smag_damp_run_1_0_para.oy][Proc.lon_hw -1+smag_damp_run_1_0_para.ox];
  smag_damp_run_1_0_para.de_lon = &mesh->de_lon[0][0][0];
  smag_damp_run_1_0_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  smag_damp_run_1_0_para.le_lon = &mesh->le_lon[0][0][0];
  smag_damp_run_1_0_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_1_0, &smag_damp_run_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_tTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->smag_t[0][0][0], &Proc.FieldReq[async_smag_t], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_1_1_info smag_damp_run_1_1_para;
  smag_damp_run_1_1_para.lz = 32 - 0;
  smag_damp_run_1_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  smag_damp_run_1_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_1_1_para.oz = 0;
  smag_damp_run_1_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  smag_damp_run_1_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_1_1_para.hx = 1;
  smag_damp_run_1_1_para.hy = 1;
  smag_damp_run_1_1_para.hz = 0;
  smag_damp_run_1_1_para.bx = 256;
  smag_damp_run_1_1_para.by = 8;
  smag_damp_run_1_1_para.bz = 1;
  smag_damp_run_1_1_para.mx = 1;
  smag_damp_run_1_1_para.my = 2;
  smag_damp_run_1_1_para.mz = 32;
  smag_damp_run_1_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_1_1_para.oz][Proc.lat_hw -1+smag_damp_run_1_1_para.oy][Proc.lon_hw -1+smag_damp_run_1_1_para.ox];
  smag_damp_run_1_1_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_1_1_para.oz][Proc.lat_hw -1+smag_damp_run_1_1_para.oy][Proc.lon_hw -1+smag_damp_run_1_1_para.ox];
  smag_damp_run_1_1_para.statesmag_s = &state->smag_s[Proc.lev_hw - 0+smag_damp_run_1_1_para.oz][Proc.lat_hw -1+smag_damp_run_1_1_para.oy][Proc.lon_hw -1+smag_damp_run_1_1_para.ox];
  smag_damp_run_1_1_para.le_lat = &mesh->le_lat[0][0][0];
  smag_damp_run_1_1_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  smag_damp_run_1_1_para.de_lat = &mesh->de_lat[0][0][0];
  smag_damp_run_1_1_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_1_1, &smag_damp_run_1_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_sTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->smag_s[0][0][0], &Proc.FieldReq[async_smag_s], false, false, true, true, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_smag_t]);
  HaloWait(Proc,&Proc.FieldReq[async_smag_s]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_1_2_info smag_damp_run_1_2_para;
  smag_damp_run_1_2_para.lz = 32 - 0;
  smag_damp_run_1_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_1_2_para.oz = 0;
  smag_damp_run_1_2_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_1_2_para.hx = 1;
  smag_damp_run_1_2_para.hy = 1;
  smag_damp_run_1_2_para.hz = 0;
  smag_damp_run_1_2_para.bx = 256;
  smag_damp_run_1_2_para.by = 8;
  smag_damp_run_1_2_para.bz = 1;
  smag_damp_run_1_2_para.mx = 1;
  smag_damp_run_1_2_para.my = 2;
  smag_damp_run_1_2_para.mz = 32;
  smag_damp_run_1_2_para.statesmag_t = &state->smag_t[Proc.lev_hw - 0+smag_damp_run_1_2_para.oz][Proc.lat_hw -1+smag_damp_run_1_2_para.oy][Proc.lon_hw -1+smag_damp_run_1_2_para.ox];
  smag_damp_run_1_2_para.statesmag_s = &state->smag_s[Proc.lev_hw - 0+smag_damp_run_1_2_para.oz][Proc.lat_hw -1+smag_damp_run_1_2_para.oy][Proc.lon_hw -1+smag_damp_run_1_2_para.ox];
  smag_damp_run_1_2_para.statekmh_lon = &state->kmh_lon[Proc.lev_hw - 0+smag_damp_run_1_2_para.oz][Proc.lat_hw -1+smag_damp_run_1_2_para.oy][Proc.lon_hw -1+smag_damp_run_1_2_para.ox];
  smag_damp_run_1_2_para.de_lon = &mesh->de_lon[0][0][0];
  smag_damp_run_1_2_para.le_lon = &mesh->le_lon[0][0][0];
  
  athread_spawn(smag_damp_run_1_2, &smag_damp_run_1_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runkmh_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_smag_t]);
  HaloWait(Proc,&Proc.FieldReq[async_smag_s]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_1_3_info smag_damp_run_1_3_para;
  smag_damp_run_1_3_para.lz = 32 - 0;
  smag_damp_run_1_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  smag_damp_run_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_1_3_para.oz = 0;
  smag_damp_run_1_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  smag_damp_run_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_1_3_para.hx = 1;
  smag_damp_run_1_3_para.hy = 1;
  smag_damp_run_1_3_para.hz = 0;
  smag_damp_run_1_3_para.bx = 256;
  smag_damp_run_1_3_para.by = 8;
  smag_damp_run_1_3_para.bz = 1;
  smag_damp_run_1_3_para.mx = 1;
  smag_damp_run_1_3_para.my = 2;
  smag_damp_run_1_3_para.mz = 32;
  smag_damp_run_1_3_para.statesmag_t = &state->smag_t[Proc.lev_hw - 0+smag_damp_run_1_3_para.oz][Proc.lat_hw -1+smag_damp_run_1_3_para.oy][Proc.lon_hw -1+smag_damp_run_1_3_para.ox];
  smag_damp_run_1_3_para.statesmag_s = &state->smag_s[Proc.lev_hw - 0+smag_damp_run_1_3_para.oz][Proc.lat_hw -1+smag_damp_run_1_3_para.oy][Proc.lon_hw -1+smag_damp_run_1_3_para.ox];
  smag_damp_run_1_3_para.statekmh_lat = &state->kmh_lat[Proc.lev_hw - 0+smag_damp_run_1_3_para.oz][Proc.lat_hw -1+smag_damp_run_1_3_para.oy][Proc.lon_hw -1+smag_damp_run_1_3_para.ox];
  smag_damp_run_1_3_para.le_lat = &mesh->le_lat[0][0][0];
  smag_damp_run_1_3_para.de_lat = &mesh->de_lat[0][0][0];
  
  athread_spawn(smag_damp_run_1_3, &smag_damp_run_1_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runkmh_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_1_4_info smag_damp_run_1_4_para;
  smag_damp_run_1_4_para.lz = 32 - 0;
  smag_damp_run_1_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_1_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_1_4_para.oz = 0;
  smag_damp_run_1_4_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_1_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_1_4_para.hx = 1;
  smag_damp_run_1_4_para.hy = 1;
  smag_damp_run_1_4_para.hz = 0;
  smag_damp_run_1_4_para.bx = 256;
  smag_damp_run_1_4_para.by = 8;
  smag_damp_run_1_4_para.bz = 1;
  smag_damp_run_1_4_para.mx = 1;
  smag_damp_run_1_4_para.my = 2;
  smag_damp_run_1_4_para.mz = 32;
  smag_damp_run_1_4_para.statekmh_lon = &state->kmh_lon[Proc.lev_hw - 0+smag_damp_run_1_4_para.oz][Proc.lat_hw -1+smag_damp_run_1_4_para.oy][Proc.lon_hw -1+smag_damp_run_1_4_para.ox];
  smag_damp_run_1_4_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_1_4_para.oz][Proc.lat_hw -1+smag_damp_run_1_4_para.oy][Proc.lon_hw -1+smag_damp_run_1_4_para.ox];
  smag_damp_run_1_4_para.tendsmag_dudt = &tend->smag_dudt[Proc.lev_hw - 0+smag_damp_run_1_4_para.oz][Proc.lat_hw -1+smag_damp_run_1_4_para.oy][Proc.lon_hw -1+smag_damp_run_1_4_para.ox];
  smag_damp_run_1_4_para.de_lon = &mesh->de_lon[0][0][0];
  smag_damp_run_1_4_para.de_lat = &mesh->de_lat[0][0][0];
  smag_damp_run_1_4_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  smag_damp_run_1_4_para.le_lon = &mesh->le_lon[0][0][0];
  smag_damp_run_1_4_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_1_4, &smag_damp_run_1_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_dudtTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_1_5_info smag_damp_run_1_5_para;
  smag_damp_run_1_5_para.lz = 32 - 0;
  smag_damp_run_1_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_1_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_1_5_para.oz = 0;
  smag_damp_run_1_5_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_1_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_1_5_para.hx = 1;
  smag_damp_run_1_5_para.hy = 1;
  smag_damp_run_1_5_para.hz = 0;
  smag_damp_run_1_5_para.bx = 256;
  smag_damp_run_1_5_para.by = 8;
  smag_damp_run_1_5_para.bz = 1;
  smag_damp_run_1_5_para.mx = 1;
  smag_damp_run_1_5_para.my = 2;
  smag_damp_run_1_5_para.mz = 32;
  smag_damp_run_1_5_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_1_5_para.oz][Proc.lat_hw -1+smag_damp_run_1_5_para.oy][Proc.lon_hw -1+smag_damp_run_1_5_para.ox];
  smag_damp_run_1_5_para.tendsmag_dudt = &tend->smag_dudt[Proc.lev_hw - 0+smag_damp_run_1_5_para.oz][Proc.lat_hw -1+smag_damp_run_1_5_para.oy][Proc.lon_hw -1+smag_damp_run_1_5_para.ox];
  smag_damp_run_1_5_para.dt = dt;
  
  athread_spawn(smag_damp_run_1_5, &smag_damp_run_1_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runu_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_1_6_info smag_damp_run_1_6_para;
  smag_damp_run_1_6_para.lz = 32 - 0;
  smag_damp_run_1_6_para.ly = MIN(Proc.lat_end+1, 1198) - MAX(Proc.lat_beg, 1);
  smag_damp_run_1_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_1_6_para.oz = 0;
  smag_damp_run_1_6_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_1_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_1_6_para.hx = 1;
  smag_damp_run_1_6_para.hy = 1;
  smag_damp_run_1_6_para.hz = 0;
  smag_damp_run_1_6_para.bx = 256;
  smag_damp_run_1_6_para.by = 8;
  smag_damp_run_1_6_para.bz = 1;
  smag_damp_run_1_6_para.mx = 1;
  smag_damp_run_1_6_para.my = 2;
  smag_damp_run_1_6_para.mz = 32;
  smag_damp_run_1_6_para.statekmh_lat = &state->kmh_lat[Proc.lev_hw - 0+smag_damp_run_1_6_para.oz][Proc.lat_hw -1+smag_damp_run_1_6_para.oy][Proc.lon_hw -1+smag_damp_run_1_6_para.ox];
  smag_damp_run_1_6_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_1_6_para.oz][Proc.lat_hw -1+smag_damp_run_1_6_para.oy][Proc.lon_hw -1+smag_damp_run_1_6_para.ox];
  smag_damp_run_1_6_para.tendsmag_dvdt = &tend->smag_dvdt[Proc.lev_hw - 0+smag_damp_run_1_6_para.oz][Proc.lat_hw -1+smag_damp_run_1_6_para.oy][Proc.lon_hw -1+smag_damp_run_1_6_para.ox];
  smag_damp_run_1_6_para.le_lat = &mesh->le_lat[0][0][0];
  smag_damp_run_1_6_para.le_lon = &mesh->le_lon[0][0][0];
  smag_damp_run_1_6_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  smag_damp_run_1_6_para.de_lat = &mesh->de_lat[0][0][0];
  smag_damp_run_1_6_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_1_6, &smag_damp_run_1_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_dvdtTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_1_7_info smag_damp_run_1_7_para;
  smag_damp_run_1_7_para.lz = 32 - 0;
  smag_damp_run_1_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  smag_damp_run_1_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_1_7_para.oz = 0;
  smag_damp_run_1_7_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  smag_damp_run_1_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_1_7_para.hx = 1;
  smag_damp_run_1_7_para.hy = 1;
  smag_damp_run_1_7_para.hz = 0;
  smag_damp_run_1_7_para.bx = 256;
  smag_damp_run_1_7_para.by = 8;
  smag_damp_run_1_7_para.bz = 1;
  smag_damp_run_1_7_para.mx = 1;
  smag_damp_run_1_7_para.my = 2;
  smag_damp_run_1_7_para.mz = 32;
  smag_damp_run_1_7_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_1_7_para.oz][Proc.lat_hw -1+smag_damp_run_1_7_para.oy][Proc.lon_hw -1+smag_damp_run_1_7_para.ox];
  smag_damp_run_1_7_para.tendsmag_dvdt = &tend->smag_dvdt[Proc.lev_hw - 0+smag_damp_run_1_7_para.oz][Proc.lat_hw -1+smag_damp_run_1_7_para.oy][Proc.lon_hw -1+smag_damp_run_1_7_para.ox];
  smag_damp_run_1_7_para.dt = dt;
  
  athread_spawn(smag_damp_run_1_7, &smag_damp_run_1_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  trickypt_1_0_info trickypt_1_0_para;
  trickypt_1_0_para.lz = 32 - 0;
  trickypt_1_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  trickypt_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  trickypt_1_0_para.oz = 0;
  trickypt_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  trickypt_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  trickypt_1_0_para.hx = 2;
  trickypt_1_0_para.hy = 2;
  trickypt_1_0_para.hz = 0;
  trickypt_1_0_para.bx = 256;
  trickypt_1_0_para.by = 8;
  trickypt_1_0_para.bz = 1;
  trickypt_1_0_para.mx = 1;
  trickypt_1_0_para.my = 2;
  trickypt_1_0_para.mz = 32;
  trickypt_1_0_para.statept = &state->pt[Proc.lev_hw - 0+trickypt_1_0_para.oz][Proc.lat_hw -2+trickypt_1_0_para.oy][Proc.lon_hw -2+trickypt_1_0_para.ox];
  trickypt_1_0_para.statem = &state->m[Proc.lev_hw - 0+trickypt_1_0_para.oz][Proc.lat_hw -2+trickypt_1_0_para.oy][Proc.lon_hw -2+trickypt_1_0_para.ox];
  
  athread_spawn(trickypt_1_0, &trickypt_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  trickyptptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_phs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_On_Cell(1,0,&state->phs[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_On_CellTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_2d_D(Proc, &state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_phs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_1_21_info calc_ph_1_21_para;
  calc_ph_1_21_para.lz = 33 - 0;
  calc_ph_1_21_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_1_21_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_1_21_para.oz = 0;
  calc_ph_1_21_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_1_21_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_1_21_para.hx = 1;
  calc_ph_1_21_para.hy = 1;
  calc_ph_1_21_para.hz = 0;
  calc_ph_1_21_para.bx = 256;
  calc_ph_1_21_para.by = 8;
  calc_ph_1_21_para.bz = 1;
  calc_ph_1_21_para.mx = 1;
  calc_ph_1_21_para.my = 2;
  calc_ph_1_21_para.mz = 32;
  calc_ph_1_21_para.statephs = &state->phs[0][Proc.lat_hw -1+calc_ph_1_21_para.oy][Proc.lon_hw -1+calc_ph_1_21_para.ox];
  calc_ph_1_21_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_1_21_para.oz][Proc.lat_hw -1+calc_ph_1_21_para.oy][Proc.lon_hw -1+calc_ph_1_21_para.ox];
  calc_ph_1_21_para.hyai = &mesh->hyai[0][0][0];
  calc_ph_1_21_para.hybi = &mesh->hybi[0][0][0];
  
  athread_spawn(calc_ph_1_21, &calc_ph_1_21_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_1_22_info calc_ph_1_22_para;
  calc_ph_1_22_para.lz = 33 - 0;
  calc_ph_1_22_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_1_22_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_1_22_para.oz = 0;
  calc_ph_1_22_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_1_22_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_1_22_para.hx = 1;
  calc_ph_1_22_para.hy = 1;
  calc_ph_1_22_para.hz = 0;
  calc_ph_1_22_para.bx = 256;
  calc_ph_1_22_para.by = 8;
  calc_ph_1_22_para.bz = 1;
  calc_ph_1_22_para.mx = 1;
  calc_ph_1_22_para.my = 2;
  calc_ph_1_22_para.mz = 32;
  calc_ph_1_22_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_1_22_para.oz][Proc.lat_hw -1+calc_ph_1_22_para.oy][Proc.lon_hw -1+calc_ph_1_22_para.ox];
  calc_ph_1_22_para.stateph_exn_lev = &state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_1_22_para.oz][Proc.lat_hw -1+calc_ph_1_22_para.oy][Proc.lon_hw -1+calc_ph_1_22_para.ox];
  
  athread_spawn(calc_ph_1_22, &calc_ph_1_22_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_exn_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_1_23_info calc_ph_1_23_para;
  calc_ph_1_23_para.lz = 32 - 0;
  calc_ph_1_23_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_1_23_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_1_23_para.oz = 0;
  calc_ph_1_23_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_1_23_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_1_23_para.hx = 0;
  calc_ph_1_23_para.hy = 0;
  calc_ph_1_23_para.hz = 1;
  calc_ph_1_23_para.bx = 256;
  calc_ph_1_23_para.by = 1;
  calc_ph_1_23_para.bz = 4;
  calc_ph_1_23_para.mx = 1;
  calc_ph_1_23_para.my = 8;
  calc_ph_1_23_para.mz = 8;
  calc_ph_1_23_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_ph_1_23_para.oz][Proc.lat_hw -0+calc_ph_1_23_para.oy][Proc.lon_hw -0+calc_ph_1_23_para.ox];
  calc_ph_1_23_para.stateph = &state->ph[Proc.lev_hw - 1+calc_ph_1_23_para.oz][Proc.lat_hw -0+calc_ph_1_23_para.oy][Proc.lon_hw -0+calc_ph_1_23_para.ox];
  
  athread_spawn(calc_ph_1_23, &calc_ph_1_23_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phphTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_1_52_info calc_m_1_52_para;
  calc_m_1_52_para.lz = 32 - 0;
  calc_m_1_52_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_1_52_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_1_52_para.oz = 0;
  calc_m_1_52_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_1_52_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_1_52_para.hx = 1;
  calc_m_1_52_para.hy = 0;
  calc_m_1_52_para.hz = 1;
  calc_m_1_52_para.bx = 256;
  calc_m_1_52_para.by = 1;
  calc_m_1_52_para.bz = 4;
  calc_m_1_52_para.mx = 1;
  calc_m_1_52_para.my = 8;
  calc_m_1_52_para.mz = 8;
  calc_m_1_52_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_1_52_para.oz][Proc.lat_hw -0+calc_m_1_52_para.oy][Proc.lon_hw -1+calc_m_1_52_para.ox];
  calc_m_1_52_para.statem = &state->m[Proc.lev_hw - 1+calc_m_1_52_para.oz][Proc.lat_hw -0+calc_m_1_52_para.oy][Proc.lon_hw -1+calc_m_1_52_para.ox];
  
  athread_spawn(calc_m_1_52, &calc_m_1_52_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mmTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_1_53_info calc_m_1_53_para;
  calc_m_1_53_para.lz = 32 - 1;
  calc_m_1_53_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_1_53_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_1_53_para.oz = 1;
  calc_m_1_53_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_1_53_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_1_53_para.hx = 0;
  calc_m_1_53_para.hy = 0;
  calc_m_1_53_para.hz = 1;
  calc_m_1_53_para.bx = 256;
  calc_m_1_53_para.by = 1;
  calc_m_1_53_para.bz = 4;
  calc_m_1_53_para.mx = 1;
  calc_m_1_53_para.my = 8;
  calc_m_1_53_para.mz = 8;
  calc_m_1_53_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_1_53_para.oz][Proc.lat_hw -0+calc_m_1_53_para.oy][Proc.lon_hw -0+calc_m_1_53_para.ox];
  calc_m_1_53_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_1_53_para.oz][Proc.lat_hw -0+calc_m_1_53_para.oy][Proc.lon_hw -0+calc_m_1_53_para.ox];
  
  athread_spawn(calc_m_1_53, &calc_m_1_53_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_1_54_info calc_m_1_54_para;
  calc_m_1_54_para.lz = 1 - 0;
  calc_m_1_54_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_1_54_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_1_54_para.oz = 0;
  calc_m_1_54_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_1_54_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_1_54_para.hx = 0;
  calc_m_1_54_para.hy = 0;
  calc_m_1_54_para.hz = 0;
  calc_m_1_54_para.bx = 256;
  calc_m_1_54_para.by = 8;
  calc_m_1_54_para.bz = 1;
  calc_m_1_54_para.mx = 1;
  calc_m_1_54_para.my = 2;
  calc_m_1_54_para.mz = 32;
  calc_m_1_54_para.stateph = &state->ph[Proc.lev_hw - 0+calc_m_1_54_para.oz][Proc.lat_hw -0+calc_m_1_54_para.oy][Proc.lon_hw -0+calc_m_1_54_para.ox];
  calc_m_1_54_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_m_1_54_para.oz][Proc.lat_hw -0+calc_m_1_54_para.oy][Proc.lon_hw -0+calc_m_1_54_para.ox];
  calc_m_1_54_para.statem_lev = &state->m_lev[Proc.lev_hw - 0+calc_m_1_54_para.oz][Proc.lat_hw -0+calc_m_1_54_para.oy][Proc.lon_hw -0+calc_m_1_54_para.ox];
  
  athread_spawn(calc_m_1_54, &calc_m_1_54_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_1_55_info calc_m_1_55_para;
  calc_m_1_55_para.lz = 33 - 32;
  calc_m_1_55_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_1_55_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_1_55_para.oz = 32;
  calc_m_1_55_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_1_55_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_1_55_para.hx = 0;
  calc_m_1_55_para.hy = 0;
  calc_m_1_55_para.hz = 1;
  calc_m_1_55_para.bx = 256;
  calc_m_1_55_para.by = 1;
  calc_m_1_55_para.bz = 4;
  calc_m_1_55_para.mx = 1;
  calc_m_1_55_para.my = 8;
  calc_m_1_55_para.mz = 8;
  calc_m_1_55_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_1_55_para.oz][Proc.lat_hw -0+calc_m_1_55_para.oy][Proc.lon_hw -0+calc_m_1_55_para.ox];
  calc_m_1_55_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_1_55_para.oz][Proc.lat_hw -0+calc_m_1_55_para.oy][Proc.lon_hw -0+calc_m_1_55_para.ox];
  calc_m_1_55_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_1_55_para.oz][Proc.lat_hw -0+calc_m_1_55_para.oy][Proc.lon_hw -0+calc_m_1_55_para.ox];
  
  athread_spawn(calc_m_1_55, &calc_m_1_55_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLonEdge_1_13_info averageCellToLonEdge_1_13_para;
  averageCellToLonEdge_1_13_para.lz = 32 - 0;
  averageCellToLonEdge_1_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  averageCellToLonEdge_1_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLonEdge_1_13_para.oz = 0;
  averageCellToLonEdge_1_13_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  averageCellToLonEdge_1_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLonEdge_1_13_para.hx = 1;
  averageCellToLonEdge_1_13_para.hy = 1;
  averageCellToLonEdge_1_13_para.hz = 0;
  averageCellToLonEdge_1_13_para.bx = 256;
  averageCellToLonEdge_1_13_para.by = 8;
  averageCellToLonEdge_1_13_para.bz = 1;
  averageCellToLonEdge_1_13_para.mx = 1;
  averageCellToLonEdge_1_13_para.my = 2;
  averageCellToLonEdge_1_13_para.mz = 32;
  averageCellToLonEdge_1_13_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLonEdge_1_13_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_13_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_13_para.ox];
  averageCellToLonEdge_1_13_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_1_13_para.oz][Proc.lat_hw -1+averageCellToLonEdge_1_13_para.oy][Proc.lon_hw -1+averageCellToLonEdge_1_13_para.ox];
  
  athread_spawn(averageCellToLonEdge_1_13, &averageCellToLonEdge_1_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLatEdge_1_13_info averageCellToLatEdge_1_13_para;
  averageCellToLatEdge_1_13_para.lz = 32 - 0;
  averageCellToLatEdge_1_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  averageCellToLatEdge_1_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLatEdge_1_13_para.oz = 0;
  averageCellToLatEdge_1_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  averageCellToLatEdge_1_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLatEdge_1_13_para.hx = 1;
  averageCellToLatEdge_1_13_para.hy = 1;
  averageCellToLatEdge_1_13_para.hz = 0;
  averageCellToLatEdge_1_13_para.bx = 256;
  averageCellToLatEdge_1_13_para.by = 8;
  averageCellToLatEdge_1_13_para.bz = 1;
  averageCellToLatEdge_1_13_para.mx = 1;
  averageCellToLatEdge_1_13_para.my = 2;
  averageCellToLatEdge_1_13_para.mz = 32;
  averageCellToLatEdge_1_13_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLatEdge_1_13_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_13_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_13_para.ox];
  averageCellToLatEdge_1_13_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_1_13_para.oz][Proc.lat_hw -1+averageCellToLatEdge_1_13_para.oy][Proc.lon_hw -1+averageCellToLatEdge_1_13_para.ox];
  
  athread_spawn(averageCellToLatEdge_1_13, &averageCellToLatEdge_1_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interpCellToVtx_1_13_info interpCellToVtx_1_13_para;
  interpCellToVtx_1_13_para.lz = 32 - 0;
  interpCellToVtx_1_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interpCellToVtx_1_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interpCellToVtx_1_13_para.oz = 0;
  interpCellToVtx_1_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interpCellToVtx_1_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interpCellToVtx_1_13_para.hx = 1;
  interpCellToVtx_1_13_para.hy = 1;
  interpCellToVtx_1_13_para.hz = 0;
  interpCellToVtx_1_13_para.bx = 256;
  interpCellToVtx_1_13_para.by = 8;
  interpCellToVtx_1_13_para.bz = 1;
  interpCellToVtx_1_13_para.mx = 1;
  interpCellToVtx_1_13_para.my = 2;
  interpCellToVtx_1_13_para.mz = 32;
  interpCellToVtx_1_13_para.statem = &state->m[Proc.lev_hw - 0+interpCellToVtx_1_13_para.oz][Proc.lat_hw -1+interpCellToVtx_1_13_para.oy][Proc.lon_hw -1+interpCellToVtx_1_13_para.ox];
  interpCellToVtx_1_13_para.statem_vtx = &state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_1_13_para.oz][Proc.lat_hw -1+interpCellToVtx_1_13_para.oy][Proc.lon_hw -1+interpCellToVtx_1_13_para.ox];
  interpCellToVtx_1_13_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  interpCellToVtx_1_13_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  interpCellToVtx_1_13_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(interpCellToVtx_1_13, &interpCellToVtx_1_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_On_Cell(2,1,&state->pt[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_On_CellTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  pole_damp_run_1_0_info pole_damp_run_1_0_para;
  pole_damp_run_1_0_para.lz = 32 - 0;
  pole_damp_run_1_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  pole_damp_run_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  pole_damp_run_1_0_para.oz = 0;
  pole_damp_run_1_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  pole_damp_run_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  pole_damp_run_1_0_para.hx = 2;
  pole_damp_run_1_0_para.hy = 2;
  pole_damp_run_1_0_para.hz = 0;
  pole_damp_run_1_0_para.bx = 256;
  pole_damp_run_1_0_para.by = 8;
  pole_damp_run_1_0_para.bz = 1;
  pole_damp_run_1_0_para.mx = 1;
  pole_damp_run_1_0_para.my = 2;
  pole_damp_run_1_0_para.mz = 32;
  pole_damp_run_1_0_para.statept = &state->pt[Proc.lev_hw - 0+pole_damp_run_1_0_para.oz][Proc.lat_hw -2+pole_damp_run_1_0_para.oy][Proc.lon_hw -2+pole_damp_run_1_0_para.ox];
  pole_damp_run_1_0_para.statem = &state->m[Proc.lev_hw - 0+pole_damp_run_1_0_para.oz][Proc.lat_hw -2+pole_damp_run_1_0_para.oy][Proc.lon_hw -2+pole_damp_run_1_0_para.ox];
  
  athread_spawn(pole_damp_run_1_0, &pole_damp_run_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  pole_damp_runptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_on_lon_edge(3,&state->u_lon[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_on_lon_edgeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_on_lat_edge(3,&state->v_lat[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_on_lat_edgeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void c2a_1(struct HybridStateField* state)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  c2a_1_1_info c2a_1_1_para;
  c2a_1_1_para.lz = 32 - 0;
  c2a_1_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  c2a_1_1_para.lx = MIN(Proc.lon_end+1, 2399) - MAX(Proc.lon_beg, 0);
  c2a_1_1_para.oz = 0;
  c2a_1_1_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  c2a_1_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  c2a_1_1_para.hx = 1;
  c2a_1_1_para.hy = 1;
  c2a_1_1_para.hz = 0;
  c2a_1_1_para.bx = 256;
  c2a_1_1_para.by = 8;
  c2a_1_1_para.bz = 1;
  c2a_1_1_para.mx = 1;
  c2a_1_1_para.my = 2;
  c2a_1_1_para.mz = 32;
  c2a_1_1_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+c2a_1_1_para.oz][Proc.lat_hw -1+c2a_1_1_para.oy][Proc.lon_hw -1+c2a_1_1_para.ox];
  c2a_1_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+c2a_1_1_para.oz][Proc.lat_hw -1+c2a_1_1_para.oy][Proc.lon_hw -1+c2a_1_1_para.ox];
  c2a_1_1_para.stateu = &state->u[Proc.lev_hw - 0+c2a_1_1_para.oz][Proc.lat_hw -1+c2a_1_1_para.oy][Proc.lon_hw -1+c2a_1_1_para.ox];
  c2a_1_1_para.statev = &state->v[Proc.lev_hw - 0+c2a_1_1_para.oz][Proc.lat_hw -1+c2a_1_1_para.oy][Proc.lon_hw -1+c2a_1_1_para.ox];
  
  athread_spawn(c2a_1_1, &c2a_1_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  c2auTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void timeadvance_1()
{
  Time_Advance();
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Time_AdvanceTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void adv_run_1(struct HybridStateField* state_old, struct HybridStateField* state_new, struct HybridAdvField* adv, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  double cursum, cf, s1, s2, ds1, ds2, ds3;
  int k, j, i, ci, l;
  struct Vector3 buf;
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  if (((advPara->uv_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_52_info accum_uv_cell_1_52_para;
    accum_uv_cell_1_52_para.lz = 32 - 0;
    accum_uv_cell_1_52_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_52_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_52_para.oz = 0;
    accum_uv_cell_1_52_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_52_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_52_para.hx = 1;
    accum_uv_cell_1_52_para.hy = 0;
    accum_uv_cell_1_52_para.hz = 0;
    accum_uv_cell_1_52_para.bx = 256;
    accum_uv_cell_1_52_para.by = 8;
    accum_uv_cell_1_52_para.bz = 1;
    accum_uv_cell_1_52_para.mx = 1;
    accum_uv_cell_1_52_para.my = 2;
    accum_uv_cell_1_52_para.mz = 32;
    accum_uv_cell_1_52_para.advu0 = &adv->u0[Proc.lev_hw - 0+accum_uv_cell_1_52_para.oz][Proc.lat_hw -0+accum_uv_cell_1_52_para.oy][Proc.lon_hw -1+accum_uv_cell_1_52_para.ox];
    accum_uv_cell_1_52_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_1_52_para.oz][Proc.lat_hw -0+accum_uv_cell_1_52_para.oy][Proc.lon_hw -1+accum_uv_cell_1_52_para.ox];
    
    athread_spawn(accum_uv_cell_1_52, &accum_uv_cell_1_52_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_53_info accum_uv_cell_1_53_para;
    accum_uv_cell_1_53_para.lz = 32 - 0;
    accum_uv_cell_1_53_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_53_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_53_para.oz = 0;
    accum_uv_cell_1_53_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_53_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_53_para.hx = 0;
    accum_uv_cell_1_53_para.hy = 1;
    accum_uv_cell_1_53_para.hz = 0;
    accum_uv_cell_1_53_para.bx = 256;
    accum_uv_cell_1_53_para.by = 8;
    accum_uv_cell_1_53_para.bz = 1;
    accum_uv_cell_1_53_para.mx = 1;
    accum_uv_cell_1_53_para.my = 2;
    accum_uv_cell_1_53_para.mz = 32;
    accum_uv_cell_1_53_para.advv0 = &adv->v0[Proc.lev_hw - 0+accum_uv_cell_1_53_para.oz][Proc.lat_hw -1+accum_uv_cell_1_53_para.oy][Proc.lon_hw -0+accum_uv_cell_1_53_para.ox];
    accum_uv_cell_1_53_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_1_53_para.oz][Proc.lat_hw -1+accum_uv_cell_1_53_para.oy][Proc.lon_hw -0+accum_uv_cell_1_53_para.ox];
    
    athread_spawn(accum_uv_cell_1_53, &accum_uv_cell_1_53_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->uv_step) = 1;
  }
  if (((advPara->uv_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_54_info accum_uv_cell_1_54_para;
    accum_uv_cell_1_54_para.lz = 32 - 0;
    accum_uv_cell_1_54_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_54_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_54_para.oz = 0;
    accum_uv_cell_1_54_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_54_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_54_para.hx = 1;
    accum_uv_cell_1_54_para.hy = 1;
    accum_uv_cell_1_54_para.hz = 0;
    accum_uv_cell_1_54_para.bx = 256;
    accum_uv_cell_1_54_para.by = 8;
    accum_uv_cell_1_54_para.bz = 1;
    accum_uv_cell_1_54_para.mx = 1;
    accum_uv_cell_1_54_para.my = 2;
    accum_uv_cell_1_54_para.mz = 32;
    accum_uv_cell_1_54_para.state_oldu_lon = &state_old->u_lon[Proc.lev_hw - 0+accum_uv_cell_1_54_para.oz][Proc.lat_hw -1+accum_uv_cell_1_54_para.oy][Proc.lon_hw -1+accum_uv_cell_1_54_para.ox];
    accum_uv_cell_1_54_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_1_54_para.oz][Proc.lat_hw -1+accum_uv_cell_1_54_para.oy][Proc.lon_hw -1+accum_uv_cell_1_54_para.ox];
    
    athread_spawn(accum_uv_cell_1_54, &accum_uv_cell_1_54_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_55_info accum_uv_cell_1_55_para;
    accum_uv_cell_1_55_para.lz = 32 - 0;
    accum_uv_cell_1_55_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_55_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_55_para.oz = 0;
    accum_uv_cell_1_55_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_55_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_55_para.hx = 1;
    accum_uv_cell_1_55_para.hy = 1;
    accum_uv_cell_1_55_para.hz = 0;
    accum_uv_cell_1_55_para.bx = 256;
    accum_uv_cell_1_55_para.by = 8;
    accum_uv_cell_1_55_para.bz = 1;
    accum_uv_cell_1_55_para.mx = 1;
    accum_uv_cell_1_55_para.my = 2;
    accum_uv_cell_1_55_para.mz = 32;
    accum_uv_cell_1_55_para.state_oldv_lat = &state_old->v_lat[Proc.lev_hw - 0+accum_uv_cell_1_55_para.oz][Proc.lat_hw -1+accum_uv_cell_1_55_para.oy][Proc.lon_hw -1+accum_uv_cell_1_55_para.ox];
    accum_uv_cell_1_55_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_1_55_para.oz][Proc.lat_hw -1+accum_uv_cell_1_55_para.oy][Proc.lon_hw -1+accum_uv_cell_1_55_para.ox];
    
    athread_spawn(accum_uv_cell_1_55, &accum_uv_cell_1_55_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->uv_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_56_info accum_uv_cell_1_56_para;
      accum_uv_cell_1_56_para.lz = 32 - 0;
      accum_uv_cell_1_56_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_56_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_56_para.oz = 0;
      accum_uv_cell_1_56_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_56_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_56_para.hx = 1;
      accum_uv_cell_1_56_para.hy = 1;
      accum_uv_cell_1_56_para.hz = 0;
      accum_uv_cell_1_56_para.bx = 256;
      accum_uv_cell_1_56_para.by = 8;
      accum_uv_cell_1_56_para.bz = 1;
      accum_uv_cell_1_56_para.mx = 1;
      accum_uv_cell_1_56_para.my = 2;
      accum_uv_cell_1_56_para.mz = 32;
      accum_uv_cell_1_56_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_1_56_para.oz][Proc.lat_hw -1+accum_uv_cell_1_56_para.oy][Proc.lon_hw -1+accum_uv_cell_1_56_para.ox];
      accum_uv_cell_1_56_para.state_oldu_lon = &state_old->u_lon[Proc.lev_hw - 0+accum_uv_cell_1_56_para.oz][Proc.lat_hw -1+accum_uv_cell_1_56_para.oy][Proc.lon_hw -1+accum_uv_cell_1_56_para.ox];
      accum_uv_cell_1_56_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_1_56, &accum_uv_cell_1_56_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_57_info accum_uv_cell_1_57_para;
      accum_uv_cell_1_57_para.lz = 32 - 0;
      accum_uv_cell_1_57_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_57_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_57_para.oz = 0;
      accum_uv_cell_1_57_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_57_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_57_para.hx = 1;
      accum_uv_cell_1_57_para.hy = 1;
      accum_uv_cell_1_57_para.hz = 0;
      accum_uv_cell_1_57_para.bx = 256;
      accum_uv_cell_1_57_para.by = 8;
      accum_uv_cell_1_57_para.bz = 1;
      accum_uv_cell_1_57_para.mx = 1;
      accum_uv_cell_1_57_para.my = 2;
      accum_uv_cell_1_57_para.mz = 32;
      accum_uv_cell_1_57_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_1_57_para.oz][Proc.lat_hw -1+accum_uv_cell_1_57_para.oy][Proc.lon_hw -1+accum_uv_cell_1_57_para.ox];
      accum_uv_cell_1_57_para.state_oldv_lat = &state_old->v_lat[Proc.lev_hw - 0+accum_uv_cell_1_57_para.oz][Proc.lat_hw -1+accum_uv_cell_1_57_para.oy][Proc.lon_hw -1+accum_uv_cell_1_57_para.ox];
      accum_uv_cell_1_57_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_1_57, &accum_uv_cell_1_57_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_58_info accum_uv_cell_1_58_para;
      accum_uv_cell_1_58_para.lz = 32 - 0;
      accum_uv_cell_1_58_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_58_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_58_para.oz = 0;
      accum_uv_cell_1_58_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_58_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_58_para.hx = 1;
      accum_uv_cell_1_58_para.hy = 0;
      accum_uv_cell_1_58_para.hz = 0;
      accum_uv_cell_1_58_para.bx = 256;
      accum_uv_cell_1_58_para.by = 8;
      accum_uv_cell_1_58_para.bz = 1;
      accum_uv_cell_1_58_para.mx = 1;
      accum_uv_cell_1_58_para.my = 2;
      accum_uv_cell_1_58_para.mz = 32;
      accum_uv_cell_1_58_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_1_58_para.oz][Proc.lat_hw -0+accum_uv_cell_1_58_para.oy][Proc.lon_hw -1+accum_uv_cell_1_58_para.ox];
      accum_uv_cell_1_58_para.advu0 = &adv->u0[Proc.lev_hw - 0+accum_uv_cell_1_58_para.oz][Proc.lat_hw -0+accum_uv_cell_1_58_para.oy][Proc.lon_hw -1+accum_uv_cell_1_58_para.ox];
      
      athread_spawn(accum_uv_cell_1_58, &accum_uv_cell_1_58_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellu0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_59_info accum_uv_cell_1_59_para;
      accum_uv_cell_1_59_para.lz = 32 - 0;
      accum_uv_cell_1_59_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_59_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_59_para.oz = 0;
      accum_uv_cell_1_59_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_59_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_59_para.hx = 0;
      accum_uv_cell_1_59_para.hy = 1;
      accum_uv_cell_1_59_para.hz = 0;
      accum_uv_cell_1_59_para.bx = 256;
      accum_uv_cell_1_59_para.by = 8;
      accum_uv_cell_1_59_para.bz = 1;
      accum_uv_cell_1_59_para.mx = 1;
      accum_uv_cell_1_59_para.my = 2;
      accum_uv_cell_1_59_para.mz = 32;
      accum_uv_cell_1_59_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_1_59_para.oz][Proc.lat_hw -1+accum_uv_cell_1_59_para.oy][Proc.lon_hw -0+accum_uv_cell_1_59_para.ox];
      accum_uv_cell_1_59_para.advv0 = &adv->v0[Proc.lev_hw - 0+accum_uv_cell_1_59_para.oz][Proc.lat_hw -1+accum_uv_cell_1_59_para.oy][Proc.lon_hw -0+accum_uv_cell_1_59_para.ox];
      
      athread_spawn(accum_uv_cell_1_59, &accum_uv_cell_1_59_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellv0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_60_info accum_uv_cell_1_60_para;
      accum_uv_cell_1_60_para.lz = 32 - 0;
      accum_uv_cell_1_60_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_60_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_60_para.oz = 0;
      accum_uv_cell_1_60_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_60_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_60_para.hx = 1;
      accum_uv_cell_1_60_para.hy = 1;
      accum_uv_cell_1_60_para.hz = 0;
      accum_uv_cell_1_60_para.bx = 256;
      accum_uv_cell_1_60_para.by = 8;
      accum_uv_cell_1_60_para.bz = 1;
      accum_uv_cell_1_60_para.mx = 1;
      accum_uv_cell_1_60_para.my = 2;
      accum_uv_cell_1_60_para.mz = 32;
      accum_uv_cell_1_60_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_1_60_para.oz][Proc.lat_hw -1+accum_uv_cell_1_60_para.oy][Proc.lon_hw -1+accum_uv_cell_1_60_para.ox];
      accum_uv_cell_1_60_para.state_oldu_lon = &state_old->u_lon[Proc.lev_hw - 0+accum_uv_cell_1_60_para.oz][Proc.lat_hw -1+accum_uv_cell_1_60_para.oy][Proc.lon_hw -1+accum_uv_cell_1_60_para.ox];
      
      athread_spawn(accum_uv_cell_1_60, &accum_uv_cell_1_60_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_1_61_info accum_uv_cell_1_61_para;
      accum_uv_cell_1_61_para.lz = 32 - 0;
      accum_uv_cell_1_61_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_1_61_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_1_61_para.oz = 0;
      accum_uv_cell_1_61_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_1_61_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_1_61_para.hx = 1;
      accum_uv_cell_1_61_para.hy = 1;
      accum_uv_cell_1_61_para.hz = 0;
      accum_uv_cell_1_61_para.bx = 256;
      accum_uv_cell_1_61_para.by = 8;
      accum_uv_cell_1_61_para.bz = 1;
      accum_uv_cell_1_61_para.mx = 1;
      accum_uv_cell_1_61_para.my = 2;
      accum_uv_cell_1_61_para.mz = 32;
      accum_uv_cell_1_61_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_1_61_para.oz][Proc.lat_hw -1+accum_uv_cell_1_61_para.oy][Proc.lon_hw -1+accum_uv_cell_1_61_para.ox];
      accum_uv_cell_1_61_para.state_oldv_lat = &state_old->v_lat[Proc.lev_hw - 0+accum_uv_cell_1_61_para.oz][Proc.lat_hw -1+accum_uv_cell_1_61_para.oy][Proc.lon_hw -1+accum_uv_cell_1_61_para.ox];
      
      athread_spawn(accum_uv_cell_1_61, &accum_uv_cell_1_61_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->uv_step) = 0;
  }
  else
  {
    (advPara->uv_step) = ((advPara->uv_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->uv_step) > (advPara->nstep))))
  {
    if (!(advPara->dynamic))
    {
      (advPara->uv_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_62_info accum_uv_cell_1_62_para;
    accum_uv_cell_1_62_para.lz = 32 - 0;
    accum_uv_cell_1_62_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_1_62_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_62_para.oz = 0;
    accum_uv_cell_1_62_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_1_62_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_62_para.hx = 1;
    accum_uv_cell_1_62_para.hy = 0;
    accum_uv_cell_1_62_para.hz = 0;
    accum_uv_cell_1_62_para.bx = 256;
    accum_uv_cell_1_62_para.by = 8;
    accum_uv_cell_1_62_para.bz = 1;
    accum_uv_cell_1_62_para.mx = 1;
    accum_uv_cell_1_62_para.my = 2;
    accum_uv_cell_1_62_para.mz = 32;
    accum_uv_cell_1_62_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_1_62_para.oz][Proc.lat_hw -0+accum_uv_cell_1_62_para.oy][Proc.lon_hw -1+accum_uv_cell_1_62_para.ox];
    accum_uv_cell_1_62_para.advcflx = &adv->cflx[Proc.lev_hw - 0+accum_uv_cell_1_62_para.oz][Proc.lat_hw -0+accum_uv_cell_1_62_para.oy][Proc.lon_hw -1+accum_uv_cell_1_62_para.ox];
    accum_uv_cell_1_62_para.de_lon = &mesh->de_lon[0][0][0];
    accum_uv_cell_1_62_para.dt = dt;
    
    athread_spawn(accum_uv_cell_1_62, &accum_uv_cell_1_62_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_63_info accum_uv_cell_1_63_para;
    accum_uv_cell_1_63_para.lz = 32 - 0;
    accum_uv_cell_1_63_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_1_63_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_63_para.oz = 0;
    accum_uv_cell_1_63_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_1_63_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_63_para.hx = 0;
    accum_uv_cell_1_63_para.hy = 1;
    accum_uv_cell_1_63_para.hz = 0;
    accum_uv_cell_1_63_para.bx = 256;
    accum_uv_cell_1_63_para.by = 8;
    accum_uv_cell_1_63_para.bz = 1;
    accum_uv_cell_1_63_para.mx = 1;
    accum_uv_cell_1_63_para.my = 2;
    accum_uv_cell_1_63_para.mz = 32;
    accum_uv_cell_1_63_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_1_63_para.oz][Proc.lat_hw -1+accum_uv_cell_1_63_para.oy][Proc.lon_hw -0+accum_uv_cell_1_63_para.ox];
    accum_uv_cell_1_63_para.advcfly = &adv->cfly[Proc.lev_hw - 0+accum_uv_cell_1_63_para.oz][Proc.lat_hw -1+accum_uv_cell_1_63_para.oy][Proc.lon_hw -0+accum_uv_cell_1_63_para.ox];
    accum_uv_cell_1_63_para.de_lat = &mesh->de_lat[0][0][0];
    accum_uv_cell_1_63_para.dt = dt;
    
    athread_spawn(accum_uv_cell_1_63, &accum_uv_cell_1_63_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_1_64_info accum_uv_cell_1_64_para;
    accum_uv_cell_1_64_para.lz = 32 - 0;
    accum_uv_cell_1_64_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_1_64_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_1_64_para.oz = 0;
    accum_uv_cell_1_64_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_1_64_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_1_64_para.hx = 1;
    accum_uv_cell_1_64_para.hy = 1;
    accum_uv_cell_1_64_para.hz = 0;
    accum_uv_cell_1_64_para.bx = 256;
    accum_uv_cell_1_64_para.by = 8;
    accum_uv_cell_1_64_para.bz = 1;
    accum_uv_cell_1_64_para.mx = 1;
    accum_uv_cell_1_64_para.my = 2;
    accum_uv_cell_1_64_para.mz = 32;
    accum_uv_cell_1_64_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_1_64_para.oz][Proc.lat_hw -1+accum_uv_cell_1_64_para.oy][Proc.lon_hw -1+accum_uv_cell_1_64_para.ox];
    accum_uv_cell_1_64_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_1_64_para.oz][Proc.lat_hw -1+accum_uv_cell_1_64_para.oy][Proc.lon_hw -1+accum_uv_cell_1_64_para.ox];
    accum_uv_cell_1_64_para.advdivx = &adv->divx[Proc.lev_hw - 0+accum_uv_cell_1_64_para.oz][Proc.lat_hw -1+accum_uv_cell_1_64_para.oy][Proc.lon_hw -1+accum_uv_cell_1_64_para.ox];
    accum_uv_cell_1_64_para.advdivy = &adv->divy[Proc.lev_hw - 0+accum_uv_cell_1_64_para.oz][Proc.lat_hw -1+accum_uv_cell_1_64_para.oy][Proc.lon_hw -1+accum_uv_cell_1_64_para.ox];
    accum_uv_cell_1_64_para.le_lon = &mesh->le_lon[0][0][0];
    accum_uv_cell_1_64_para.area_cell = &mesh->area_cell[0][0][0];
    accum_uv_cell_1_64_para.le_lat = &mesh->le_lat[0][0][0];
    
    athread_spawn(accum_uv_cell_1_64, &accum_uv_cell_1_64_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    
    
  }
  advPara = advPara;
  if (((advPara->mf_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          adv->mfx[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          adv->mfy[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->mf_step) = 1;
  }
  if (((advPara->mf_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_1_24_info accum_mf_cell_1_24_para;
    accum_mf_cell_1_24_para.lz = 32 - 0;
    accum_mf_cell_1_24_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_1_24_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_1_24_para.oz = 0;
    accum_mf_cell_1_24_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_1_24_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_1_24_para.hx = 1;
    accum_mf_cell_1_24_para.hy = 1;
    accum_mf_cell_1_24_para.hz = 0;
    accum_mf_cell_1_24_para.bx = 256;
    accum_mf_cell_1_24_para.by = 8;
    accum_mf_cell_1_24_para.bz = 1;
    accum_mf_cell_1_24_para.mx = 1;
    accum_mf_cell_1_24_para.my = 2;
    accum_mf_cell_1_24_para.mz = 32;
    accum_mf_cell_1_24_para.state_oldmfx_lon = &state_old->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_1_24_para.oz][Proc.lat_hw -1+accum_mf_cell_1_24_para.oy][Proc.lon_hw -1+accum_mf_cell_1_24_para.ox];
    accum_mf_cell_1_24_para.advmfx = &adv->mfx[Proc.lev_hw - 0+accum_mf_cell_1_24_para.oz][Proc.lat_hw -1+accum_mf_cell_1_24_para.oy][Proc.lon_hw -1+accum_mf_cell_1_24_para.ox];
    
    athread_spawn(accum_mf_cell_1_24, &accum_mf_cell_1_24_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_1_25_info accum_mf_cell_1_25_para;
    accum_mf_cell_1_25_para.lz = 32 - 0;
    accum_mf_cell_1_25_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_1_25_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_1_25_para.oz = 0;
    accum_mf_cell_1_25_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_1_25_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_1_25_para.hx = 1;
    accum_mf_cell_1_25_para.hy = 1;
    accum_mf_cell_1_25_para.hz = 0;
    accum_mf_cell_1_25_para.bx = 256;
    accum_mf_cell_1_25_para.by = 8;
    accum_mf_cell_1_25_para.bz = 1;
    accum_mf_cell_1_25_para.mx = 1;
    accum_mf_cell_1_25_para.my = 2;
    accum_mf_cell_1_25_para.mz = 32;
    accum_mf_cell_1_25_para.state_oldmfy_lat = &state_old->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_1_25_para.oz][Proc.lat_hw -1+accum_mf_cell_1_25_para.oy][Proc.lon_hw -1+accum_mf_cell_1_25_para.ox];
    accum_mf_cell_1_25_para.advmfy = &adv->mfy[Proc.lev_hw - 0+accum_mf_cell_1_25_para.oz][Proc.lat_hw -1+accum_mf_cell_1_25_para.oy][Proc.lon_hw -1+accum_mf_cell_1_25_para.ox];
    
    athread_spawn(accum_mf_cell_1_25, &accum_mf_cell_1_25_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->mf_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_26_info accum_mf_cell_1_26_para;
      accum_mf_cell_1_26_para.lz = 32 - 0;
      accum_mf_cell_1_26_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_26_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_26_para.oz = 0;
      accum_mf_cell_1_26_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_26_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_26_para.hx = 1;
      accum_mf_cell_1_26_para.hy = 1;
      accum_mf_cell_1_26_para.hz = 0;
      accum_mf_cell_1_26_para.bx = 256;
      accum_mf_cell_1_26_para.by = 8;
      accum_mf_cell_1_26_para.bz = 1;
      accum_mf_cell_1_26_para.mx = 1;
      accum_mf_cell_1_26_para.my = 2;
      accum_mf_cell_1_26_para.mz = 32;
      accum_mf_cell_1_26_para.advmfx = &adv->mfx[Proc.lev_hw - 0+accum_mf_cell_1_26_para.oz][Proc.lat_hw -1+accum_mf_cell_1_26_para.oy][Proc.lon_hw -1+accum_mf_cell_1_26_para.ox];
      accum_mf_cell_1_26_para.state_oldmfx_lon = &state_old->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_1_26_para.oz][Proc.lat_hw -1+accum_mf_cell_1_26_para.oy][Proc.lon_hw -1+accum_mf_cell_1_26_para.ox];
      accum_mf_cell_1_26_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_1_26, &accum_mf_cell_1_26_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_27_info accum_mf_cell_1_27_para;
      accum_mf_cell_1_27_para.lz = 32 - 0;
      accum_mf_cell_1_27_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_27_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_27_para.oz = 0;
      accum_mf_cell_1_27_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_27_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_27_para.hx = 1;
      accum_mf_cell_1_27_para.hy = 1;
      accum_mf_cell_1_27_para.hz = 0;
      accum_mf_cell_1_27_para.bx = 256;
      accum_mf_cell_1_27_para.by = 8;
      accum_mf_cell_1_27_para.bz = 1;
      accum_mf_cell_1_27_para.mx = 1;
      accum_mf_cell_1_27_para.my = 2;
      accum_mf_cell_1_27_para.mz = 32;
      accum_mf_cell_1_27_para.advmfy = &adv->mfy[Proc.lev_hw - 0+accum_mf_cell_1_27_para.oz][Proc.lat_hw -1+accum_mf_cell_1_27_para.oy][Proc.lon_hw -1+accum_mf_cell_1_27_para.ox];
      accum_mf_cell_1_27_para.state_oldmfy_lat = &state_old->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_1_27_para.oz][Proc.lat_hw -1+accum_mf_cell_1_27_para.oy][Proc.lon_hw -1+accum_mf_cell_1_27_para.ox];
      accum_mf_cell_1_27_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_1_27, &accum_mf_cell_1_27_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_28_info accum_mf_cell_1_28_para;
      accum_mf_cell_1_28_para.lz = 32 - 0;
      accum_mf_cell_1_28_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_28_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_28_para.oz = 0;
      accum_mf_cell_1_28_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_28_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_28_para.hx = 1;
      accum_mf_cell_1_28_para.hy = 1;
      accum_mf_cell_1_28_para.hz = 0;
      accum_mf_cell_1_28_para.bx = 256;
      accum_mf_cell_1_28_para.by = 8;
      accum_mf_cell_1_28_para.bz = 1;
      accum_mf_cell_1_28_para.mx = 1;
      accum_mf_cell_1_28_para.my = 2;
      accum_mf_cell_1_28_para.mz = 32;
      accum_mf_cell_1_28_para.advmfx = &adv->mfx[Proc.lev_hw - 0+accum_mf_cell_1_28_para.oz][Proc.lat_hw -1+accum_mf_cell_1_28_para.oy][Proc.lon_hw -1+accum_mf_cell_1_28_para.ox];
      accum_mf_cell_1_28_para.state_oldmfx_lon = &state_old->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_1_28_para.oz][Proc.lat_hw -1+accum_mf_cell_1_28_para.oy][Proc.lon_hw -1+accum_mf_cell_1_28_para.ox];
      
      athread_spawn(accum_mf_cell_1_28, &accum_mf_cell_1_28_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_1_29_info accum_mf_cell_1_29_para;
      accum_mf_cell_1_29_para.lz = 32 - 0;
      accum_mf_cell_1_29_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_1_29_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_1_29_para.oz = 0;
      accum_mf_cell_1_29_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_1_29_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_1_29_para.hx = 1;
      accum_mf_cell_1_29_para.hy = 1;
      accum_mf_cell_1_29_para.hz = 0;
      accum_mf_cell_1_29_para.bx = 256;
      accum_mf_cell_1_29_para.by = 8;
      accum_mf_cell_1_29_para.bz = 1;
      accum_mf_cell_1_29_para.mx = 1;
      accum_mf_cell_1_29_para.my = 2;
      accum_mf_cell_1_29_para.mz = 32;
      accum_mf_cell_1_29_para.advmfy = &adv->mfy[Proc.lev_hw - 0+accum_mf_cell_1_29_para.oz][Proc.lat_hw -1+accum_mf_cell_1_29_para.oy][Proc.lon_hw -1+accum_mf_cell_1_29_para.ox];
      accum_mf_cell_1_29_para.state_oldmfy_lat = &state_old->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_1_29_para.oz][Proc.lat_hw -1+accum_mf_cell_1_29_para.oy][Proc.lon_hw -1+accum_mf_cell_1_29_para.ox];
      
      athread_spawn(accum_mf_cell_1_29, &accum_mf_cell_1_29_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->mf_step) = 0;
  }
  else
  {
    (advPara->mf_step) = ((advPara->mf_step) + 1);
  }
  if ((!(advPara->dynamic) && ((advPara->mf_step) > (advPara->nstep))))
  {
    (advPara->mf_step) = -1;
  }
  advPara = advPara;
  dt = dt;
  if (((advPara->we_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_1_15_info accum_we_lev_1_15_para;
    accum_we_lev_1_15_para.lz = 33 - 0;
    accum_we_lev_1_15_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_1_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_1_15_para.oz = 0;
    accum_we_lev_1_15_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_1_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_1_15_para.hx = 0;
    accum_we_lev_1_15_para.hy = 0;
    accum_we_lev_1_15_para.hz = 0;
    accum_we_lev_1_15_para.bx = 256;
    accum_we_lev_1_15_para.by = 8;
    accum_we_lev_1_15_para.bz = 1;
    accum_we_lev_1_15_para.mx = 1;
    accum_we_lev_1_15_para.my = 2;
    accum_we_lev_1_15_para.mz = 32;
    accum_we_lev_1_15_para.advwe0 = &adv->we0[Proc.lev_hw - 0+accum_we_lev_1_15_para.oz][Proc.lat_hw -0+accum_we_lev_1_15_para.oy][Proc.lon_hw -0+accum_we_lev_1_15_para.ox];
    accum_we_lev_1_15_para.advm0 = &adv->m0[Proc.lev_hw - 0+accum_we_lev_1_15_para.oz][Proc.lat_hw -0+accum_we_lev_1_15_para.oy][Proc.lon_hw -0+accum_we_lev_1_15_para.ox];
    accum_we_lev_1_15_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_1_15_para.oz][Proc.lat_hw -0+accum_we_lev_1_15_para.oy][Proc.lon_hw -0+accum_we_lev_1_15_para.ox];
    accum_we_lev_1_15_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_1_15_para.oz][Proc.lat_hw -0+accum_we_lev_1_15_para.oy][Proc.lon_hw -0+accum_we_lev_1_15_para.ox];
    
    athread_spawn(accum_we_lev_1_15, &accum_we_lev_1_15_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->we_step) = 1;
  }
  if (((advPara->we_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_1_16_info accum_we_lev_1_16_para;
    accum_we_lev_1_16_para.lz = 33 - 0;
    accum_we_lev_1_16_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_1_16_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_1_16_para.oz = 0;
    accum_we_lev_1_16_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_1_16_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_1_16_para.hx = 1;
    accum_we_lev_1_16_para.hy = 1;
    accum_we_lev_1_16_para.hz = 0;
    accum_we_lev_1_16_para.bx = 256;
    accum_we_lev_1_16_para.by = 8;
    accum_we_lev_1_16_para.bz = 1;
    accum_we_lev_1_16_para.mx = 1;
    accum_we_lev_1_16_para.my = 2;
    accum_we_lev_1_16_para.mz = 32;
    accum_we_lev_1_16_para.state_oldwe_lev = &state_old->we_lev[Proc.lev_hw - 0+accum_we_lev_1_16_para.oz][Proc.lat_hw -1+accum_we_lev_1_16_para.oy][Proc.lon_hw -1+accum_we_lev_1_16_para.ox];
    accum_we_lev_1_16_para.state_oldm_lev = &state_old->m_lev[Proc.lev_hw - 0+accum_we_lev_1_16_para.oz][Proc.lat_hw -1+accum_we_lev_1_16_para.oy][Proc.lon_hw -1+accum_we_lev_1_16_para.ox];
    accum_we_lev_1_16_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_1_16_para.oz][Proc.lat_hw -1+accum_we_lev_1_16_para.oy][Proc.lon_hw -1+accum_we_lev_1_16_para.ox];
    accum_we_lev_1_16_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_1_16_para.oz][Proc.lat_hw -1+accum_we_lev_1_16_para.oy][Proc.lon_hw -1+accum_we_lev_1_16_para.ox];
    
    athread_spawn(accum_we_lev_1_16, &accum_we_lev_1_16_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->we_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_1_17_info accum_we_lev_1_17_para;
      accum_we_lev_1_17_para.lz = 33 - 0;
      accum_we_lev_1_17_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_1_17_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_1_17_para.oz = 0;
      accum_we_lev_1_17_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_1_17_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_1_17_para.hx = 1;
      accum_we_lev_1_17_para.hy = 1;
      accum_we_lev_1_17_para.hz = 0;
      accum_we_lev_1_17_para.bx = 256;
      accum_we_lev_1_17_para.by = 8;
      accum_we_lev_1_17_para.bz = 1;
      accum_we_lev_1_17_para.mx = 1;
      accum_we_lev_1_17_para.my = 2;
      accum_we_lev_1_17_para.mz = 32;
      accum_we_lev_1_17_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_1_17_para.oz][Proc.lat_hw -1+accum_we_lev_1_17_para.oy][Proc.lon_hw -1+accum_we_lev_1_17_para.ox];
      accum_we_lev_1_17_para.state_oldwe_lev = &state_old->we_lev[Proc.lev_hw - 0+accum_we_lev_1_17_para.oz][Proc.lat_hw -1+accum_we_lev_1_17_para.oy][Proc.lon_hw -1+accum_we_lev_1_17_para.ox];
      accum_we_lev_1_17_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_1_17_para.oz][Proc.lat_hw -1+accum_we_lev_1_17_para.oy][Proc.lon_hw -1+accum_we_lev_1_17_para.ox];
      accum_we_lev_1_17_para.state_oldm_lev = &state_old->m_lev[Proc.lev_hw - 0+accum_we_lev_1_17_para.oz][Proc.lat_hw -1+accum_we_lev_1_17_para.oy][Proc.lon_hw -1+accum_we_lev_1_17_para.ox];
      accum_we_lev_1_17_para.advwe0 = &adv->we0[Proc.lev_hw - 0+accum_we_lev_1_17_para.oz][Proc.lat_hw -1+accum_we_lev_1_17_para.oy][Proc.lon_hw -1+accum_we_lev_1_17_para.ox];
      accum_we_lev_1_17_para.advm0 = &adv->m0[Proc.lev_hw - 0+accum_we_lev_1_17_para.oz][Proc.lat_hw -1+accum_we_lev_1_17_para.oy][Proc.lon_hw -1+accum_we_lev_1_17_para.ox];
      accum_we_lev_1_17_para.nstep = advPara->nstep;
      
      athread_spawn(accum_we_lev_1_17, &accum_we_lev_1_17_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_1_18_info accum_we_lev_1_18_para;
      accum_we_lev_1_18_para.lz = 33 - 0;
      accum_we_lev_1_18_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_1_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_1_18_para.oz = 0;
      accum_we_lev_1_18_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_1_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_1_18_para.hx = 1;
      accum_we_lev_1_18_para.hy = 1;
      accum_we_lev_1_18_para.hz = 0;
      accum_we_lev_1_18_para.bx = 256;
      accum_we_lev_1_18_para.by = 8;
      accum_we_lev_1_18_para.bz = 1;
      accum_we_lev_1_18_para.mx = 1;
      accum_we_lev_1_18_para.my = 2;
      accum_we_lev_1_18_para.mz = 32;
      accum_we_lev_1_18_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_1_18_para.oz][Proc.lat_hw -1+accum_we_lev_1_18_para.oy][Proc.lon_hw -1+accum_we_lev_1_18_para.ox];
      accum_we_lev_1_18_para.state_oldwe_lev = &state_old->we_lev[Proc.lev_hw - 0+accum_we_lev_1_18_para.oz][Proc.lat_hw -1+accum_we_lev_1_18_para.oy][Proc.lon_hw -1+accum_we_lev_1_18_para.ox];
      accum_we_lev_1_18_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_1_18_para.oz][Proc.lat_hw -1+accum_we_lev_1_18_para.oy][Proc.lon_hw -1+accum_we_lev_1_18_para.ox];
      accum_we_lev_1_18_para.state_oldm_lev = &state_old->m_lev[Proc.lev_hw - 0+accum_we_lev_1_18_para.oz][Proc.lat_hw -1+accum_we_lev_1_18_para.oy][Proc.lon_hw -1+accum_we_lev_1_18_para.ox];
      
      athread_spawn(accum_we_lev_1_18, &accum_we_lev_1_18_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->we_step) = 0;
  }
  else
  {
    (advPara->we_step) = ((advPara->we_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->we_step) > (advPara->nstep))))
  {
    if (((advPara->dynamic) == 0))
    {
      (advPara->we_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_1_19_info accum_we_lev_1_19_para;
    accum_we_lev_1_19_para.lz = 32 - 1;
    accum_we_lev_1_19_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_1_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_1_19_para.oz = 1;
    accum_we_lev_1_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_1_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_1_19_para.hx = 0;
    accum_we_lev_1_19_para.hy = 0;
    accum_we_lev_1_19_para.hz = 0;
    accum_we_lev_1_19_para.bx = 256;
    accum_we_lev_1_19_para.by = 8;
    accum_we_lev_1_19_para.bz = 1;
    accum_we_lev_1_19_para.mx = 1;
    accum_we_lev_1_19_para.my = 2;
    accum_we_lev_1_19_para.mz = 32;
    accum_we_lev_1_19_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_1_19_para.oz][Proc.lat_hw -0+accum_we_lev_1_19_para.oy][Proc.lon_hw -0+accum_we_lev_1_19_para.ox];
    accum_we_lev_1_19_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_1_19_para.oz][Proc.lat_hw -0+accum_we_lev_1_19_para.oy][Proc.lon_hw -0+accum_we_lev_1_19_para.ox];
    accum_we_lev_1_19_para.advcflz = &adv->cflz[Proc.lev_hw - 0+accum_we_lev_1_19_para.oz][Proc.lat_hw -0+accum_we_lev_1_19_para.oy][Proc.lon_hw -0+accum_we_lev_1_19_para.ox];
    accum_we_lev_1_19_para.dt = dt;
    
    athread_spawn(accum_we_lev_1_19, &accum_we_lev_1_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levcflzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  dt = dt;
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_1_9_info hflx_ppm_inner_1_9_para;
  hflx_ppm_inner_1_9_para.lz = 32 - 0;
  hflx_ppm_inner_1_9_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_1_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_1_9_para.oz = 0;
  hflx_ppm_inner_1_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_1_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_1_9_para.hx = 2;
  hflx_ppm_inner_1_9_para.hy = 2;
  hflx_ppm_inner_1_9_para.hz = 0;
  hflx_ppm_inner_1_9_para.bx = 256;
  hflx_ppm_inner_1_9_para.by = 8;
  hflx_ppm_inner_1_9_para.bz = 1;
  hflx_ppm_inner_1_9_para.mx = 1;
  hflx_ppm_inner_1_9_para.my = 2;
  hflx_ppm_inner_1_9_para.mz = 32;
  hflx_ppm_inner_1_9_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+hflx_ppm_inner_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_9_para.ox];
  hflx_ppm_inner_1_9_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_inner_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_9_para.ox];
  hflx_ppm_inner_1_9_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_inner_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_9_para.ox];
  hflx_ppm_inner_1_9_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_inner_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_9_para.ox];
  hflx_ppm_inner_1_9_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_inner_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_9_para.ox];
  hflx_ppm_inner_1_9_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_inner_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_9_para.ox];
  hflx_ppm_inner_1_9_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_inner_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_1_9_para.ox];
  
  athread_spawn(hflx_ppm_inner_1_9, &hflx_ppm_inner_1_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_uu]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_1_10_info hflx_ppm_inner_1_10_para;
  hflx_ppm_inner_1_10_para.lz = 32 - 0;
  hflx_ppm_inner_1_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_inner_1_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_1_10_para.oz = 0;
  hflx_ppm_inner_1_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_inner_1_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_1_10_para.hx = Proc.lon_hw;
  hflx_ppm_inner_1_10_para.hy = Proc.lat_hw;
  hflx_ppm_inner_1_10_para.hz = 0;
  hflx_ppm_inner_1_10_para.bx = 256;
  hflx_ppm_inner_1_10_para.by = 8;
  hflx_ppm_inner_1_10_para.bz = 1;
  hflx_ppm_inner_1_10_para.mx = 1;
  hflx_ppm_inner_1_10_para.my = 2;
  hflx_ppm_inner_1_10_para.mz = 32;
  hflx_ppm_inner_1_10_para.advcflx = &adv->cflx[Proc.lev_hw - 0+hflx_ppm_inner_1_10_para.oz][Proc.lat_hw -hflx_ppm_inner_1_10_para.hy +hflx_ppm_inner_1_10_para.oy][Proc.lon_hw -hflx_ppm_inner_1_10_para.hx +hflx_ppm_inner_1_10_para.ox];
  hflx_ppm_inner_1_10_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+hflx_ppm_inner_1_10_para.oz][Proc.lat_hw -hflx_ppm_inner_1_10_para.hy +hflx_ppm_inner_1_10_para.oy][Proc.lon_hw -hflx_ppm_inner_1_10_para.hx +hflx_ppm_inner_1_10_para.ox];
  hflx_ppm_inner_1_10_para.advuu = &adv->uu[Proc.lev_hw - 0+hflx_ppm_inner_1_10_para.oz][Proc.lat_hw -hflx_ppm_inner_1_10_para.hy +hflx_ppm_inner_1_10_para.oy][Proc.lon_hw -hflx_ppm_inner_1_10_para.hx +hflx_ppm_inner_1_10_para.ox];
  hflx_ppm_inner_1_10_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_inner_1_10_para.oz][Proc.lat_hw -hflx_ppm_inner_1_10_para.hy +hflx_ppm_inner_1_10_para.oy][Proc.lon_hw -hflx_ppm_inner_1_10_para.hx +hflx_ppm_inner_1_10_para.ox];
  hflx_ppm_inner_1_10_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_inner_1_10_para.oz][Proc.lat_hw -hflx_ppm_inner_1_10_para.hy +hflx_ppm_inner_1_10_para.oy][Proc.lon_hw -hflx_ppm_inner_1_10_para.hx +hflx_ppm_inner_1_10_para.ox];
  hflx_ppm_inner_1_10_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_inner_1_10_para.oz][Proc.lat_hw -hflx_ppm_inner_1_10_para.hy +hflx_ppm_inner_1_10_para.oy][Proc.lon_hw -hflx_ppm_inner_1_10_para.hx +hflx_ppm_inner_1_10_para.ox];
  hflx_ppm_inner_1_10_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+hflx_ppm_inner_1_10_para.oz][Proc.lat_hw -hflx_ppm_inner_1_10_para.hy +hflx_ppm_inner_1_10_para.oy][Proc.lon_hw -hflx_ppm_inner_1_10_para.hx +hflx_ppm_inner_1_10_para.ox];
  
  athread_spawn(hflx_ppm_inner_1_10, &hflx_ppm_inner_1_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqmf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lon[0][0][0], &Proc.FieldReq[async_qmf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_vv]);
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_1_11_info hflx_ppm_inner_1_11_para;
  hflx_ppm_inner_1_11_para.lz = 32 - 0;
  hflx_ppm_inner_1_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_1_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_1_11_para.oz = 0;
  hflx_ppm_inner_1_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_1_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_1_11_para.hx = 0;
  hflx_ppm_inner_1_11_para.hy = 1;
  hflx_ppm_inner_1_11_para.hz = 0;
  hflx_ppm_inner_1_11_para.bx = 256;
  hflx_ppm_inner_1_11_para.by = 8;
  hflx_ppm_inner_1_11_para.bz = 1;
  hflx_ppm_inner_1_11_para.mx = 1;
  hflx_ppm_inner_1_11_para.my = 2;
  hflx_ppm_inner_1_11_para.mz = 32;
  hflx_ppm_inner_1_11_para.advcfly = &adv->cfly[Proc.lev_hw - 0+hflx_ppm_inner_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_11_para.ox];
  hflx_ppm_inner_1_11_para.advvv = &adv->vv[Proc.lev_hw - 0+hflx_ppm_inner_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_11_para.ox];
  hflx_ppm_inner_1_11_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_inner_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_11_para.ox];
  hflx_ppm_inner_1_11_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_inner_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_11_para.ox];
  hflx_ppm_inner_1_11_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_inner_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_11_para.ox];
  hflx_ppm_inner_1_11_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+hflx_ppm_inner_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_1_11_para.ox];
  
  athread_spawn(hflx_ppm_inner_1_11, &hflx_ppm_inner_1_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqmf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lat[0][0][0], &Proc.FieldReq[async_qmf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_1_3_info ffsl_calc_tracer_hflx_1_3_para;
  ffsl_calc_tracer_hflx_1_3_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_1_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  ffsl_calc_tracer_hflx_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_1_3_para.oz = 0;
  ffsl_calc_tracer_hflx_1_3_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_1_3_para.hx = 2;
  ffsl_calc_tracer_hflx_1_3_para.hy = 2;
  ffsl_calc_tracer_hflx_1_3_para.hz = 0;
  ffsl_calc_tracer_hflx_1_3_para.bx = 256;
  ffsl_calc_tracer_hflx_1_3_para.by = 8;
  ffsl_calc_tracer_hflx_1_3_para.bz = 1;
  ffsl_calc_tracer_hflx_1_3_para.mx = 1;
  ffsl_calc_tracer_hflx_1_3_para.my = 2;
  ffsl_calc_tracer_hflx_1_3_para.mz = 32;
  ffsl_calc_tracer_hflx_1_3_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_3_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_3_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_3_para.ox];
  ffsl_calc_tracer_hflx_1_3_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_3_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_3_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_3_para.ox];
  ffsl_calc_tracer_hflx_1_3_para.advdivx = &adv->divx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_3_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_3_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_3_para.ox];
  ffsl_calc_tracer_hflx_1_3_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_3_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_3_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_3_para.ox];
  ffsl_calc_tracer_hflx_1_3_para.advdivy = &adv->divy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_3_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_3_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_3_para.ox];
  ffsl_calc_tracer_hflx_1_3_para.advqx = &adv->qx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_3_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_3_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_3_para.ox];
  ffsl_calc_tracer_hflx_1_3_para.advqy = &adv->qy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_1_3_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_1_3_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_1_3_para.ox];
  ffsl_calc_tracer_hflx_1_3_para.le_lon = &mesh->le_lon[0][0][0];
  ffsl_calc_tracer_hflx_1_3_para.area_cell = &mesh->area_cell[0][0][0];
  ffsl_calc_tracer_hflx_1_3_para.le_lat = &mesh->le_lat[0][0][0];
  ffsl_calc_tracer_hflx_1_3_para.dt = dt;
  
  athread_spawn(ffsl_calc_tracer_hflx_1_3, &ffsl_calc_tracer_hflx_1_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxqxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qx[0][0][0], &Proc.FieldReq[async_qx], true, true, true, false, false, true, true, true);
  UpdateHalo_3d_D(Proc, &adv->qy[0][0][0], &Proc.FieldReq[async_qy], true, true, true, true, true, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qx]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_1_9_info hflx_ppm_outer_1_9_para;
  hflx_ppm_outer_1_9_para.lz = 32 - 0;
  hflx_ppm_outer_1_9_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_1_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_1_9_para.oz = 0;
  hflx_ppm_outer_1_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_1_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_1_9_para.hx = 2;
  hflx_ppm_outer_1_9_para.hy = 2;
  hflx_ppm_outer_1_9_para.hz = 0;
  hflx_ppm_outer_1_9_para.bx = 256;
  hflx_ppm_outer_1_9_para.by = 8;
  hflx_ppm_outer_1_9_para.bz = 1;
  hflx_ppm_outer_1_9_para.mx = 1;
  hflx_ppm_outer_1_9_para.my = 2;
  hflx_ppm_outer_1_9_para.mz = 32;
  hflx_ppm_outer_1_9_para.advqy = &adv->qy[Proc.lev_hw - 0+hflx_ppm_outer_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_9_para.ox];
  hflx_ppm_outer_1_9_para.advqx = &adv->qx[Proc.lev_hw - 0+hflx_ppm_outer_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_9_para.ox];
  hflx_ppm_outer_1_9_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_outer_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_9_para.ox];
  hflx_ppm_outer_1_9_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_outer_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_9_para.ox];
  hflx_ppm_outer_1_9_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_outer_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_9_para.ox];
  hflx_ppm_outer_1_9_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_outer_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_9_para.ox];
  hflx_ppm_outer_1_9_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_outer_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_9_para.ox];
  hflx_ppm_outer_1_9_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_outer_1_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_1_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_1_9_para.ox];
  
  athread_spawn(hflx_ppm_outer_1_9, &hflx_ppm_outer_1_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_1_10_info hflx_ppm_outer_1_10_para;
  hflx_ppm_outer_1_10_para.lz = 32 - 0;
  hflx_ppm_outer_1_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_outer_1_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_1_10_para.oz = 0;
  hflx_ppm_outer_1_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_outer_1_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_1_10_para.hx = Proc.lon_hw;
  hflx_ppm_outer_1_10_para.hy = Proc.lat_hw;
  hflx_ppm_outer_1_10_para.hz = 0;
  hflx_ppm_outer_1_10_para.bx = 256;
  hflx_ppm_outer_1_10_para.by = 8;
  hflx_ppm_outer_1_10_para.bz = 1;
  hflx_ppm_outer_1_10_para.mx = 1;
  hflx_ppm_outer_1_10_para.my = 2;
  hflx_ppm_outer_1_10_para.mz = 32;
  hflx_ppm_outer_1_10_para.advcflx = &adv->cflx[Proc.lev_hw - 0+hflx_ppm_outer_1_10_para.oz][Proc.lat_hw -hflx_ppm_outer_1_10_para.hy +hflx_ppm_outer_1_10_para.oy][Proc.lon_hw -hflx_ppm_outer_1_10_para.hx +hflx_ppm_outer_1_10_para.ox];
  hflx_ppm_outer_1_10_para.advqy = &adv->qy[Proc.lev_hw - 0+hflx_ppm_outer_1_10_para.oz][Proc.lat_hw -hflx_ppm_outer_1_10_para.hy +hflx_ppm_outer_1_10_para.oy][Proc.lon_hw -hflx_ppm_outer_1_10_para.hx +hflx_ppm_outer_1_10_para.ox];
  hflx_ppm_outer_1_10_para.advmfx = &adv->mfx[Proc.lev_hw - 0+hflx_ppm_outer_1_10_para.oz][Proc.lat_hw -hflx_ppm_outer_1_10_para.hy +hflx_ppm_outer_1_10_para.oy][Proc.lon_hw -hflx_ppm_outer_1_10_para.hx +hflx_ppm_outer_1_10_para.ox];
  hflx_ppm_outer_1_10_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_outer_1_10_para.oz][Proc.lat_hw -hflx_ppm_outer_1_10_para.hy +hflx_ppm_outer_1_10_para.oy][Proc.lon_hw -hflx_ppm_outer_1_10_para.hx +hflx_ppm_outer_1_10_para.ox];
  hflx_ppm_outer_1_10_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_outer_1_10_para.oz][Proc.lat_hw -hflx_ppm_outer_1_10_para.hy +hflx_ppm_outer_1_10_para.oy][Proc.lon_hw -hflx_ppm_outer_1_10_para.hx +hflx_ppm_outer_1_10_para.ox];
  hflx_ppm_outer_1_10_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_outer_1_10_para.oz][Proc.lat_hw -hflx_ppm_outer_1_10_para.hy +hflx_ppm_outer_1_10_para.oy][Proc.lon_hw -hflx_ppm_outer_1_10_para.hx +hflx_ppm_outer_1_10_para.ox];
  hflx_ppm_outer_1_10_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+hflx_ppm_outer_1_10_para.oz][Proc.lat_hw -hflx_ppm_outer_1_10_para.hy +hflx_ppm_outer_1_10_para.oy][Proc.lon_hw -hflx_ppm_outer_1_10_para.hx +hflx_ppm_outer_1_10_para.ox];
  
  athread_spawn(hflx_ppm_outer_1_10, &hflx_ppm_outer_1_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqmf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lon[0][0][0], &Proc.FieldReq[async_qmf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_1_11_info hflx_ppm_outer_1_11_para;
  hflx_ppm_outer_1_11_para.lz = 32 - 0;
  hflx_ppm_outer_1_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_1_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_1_11_para.oz = 0;
  hflx_ppm_outer_1_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_1_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_1_11_para.hx = 0;
  hflx_ppm_outer_1_11_para.hy = 1;
  hflx_ppm_outer_1_11_para.hz = 0;
  hflx_ppm_outer_1_11_para.bx = 256;
  hflx_ppm_outer_1_11_para.by = 8;
  hflx_ppm_outer_1_11_para.bz = 1;
  hflx_ppm_outer_1_11_para.mx = 1;
  hflx_ppm_outer_1_11_para.my = 2;
  hflx_ppm_outer_1_11_para.mz = 32;
  hflx_ppm_outer_1_11_para.advcfly = &adv->cfly[Proc.lev_hw - 0+hflx_ppm_outer_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_11_para.ox];
  hflx_ppm_outer_1_11_para.advmfy = &adv->mfy[Proc.lev_hw - 0+hflx_ppm_outer_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_11_para.ox];
  hflx_ppm_outer_1_11_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_outer_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_11_para.ox];
  hflx_ppm_outer_1_11_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_outer_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_11_para.ox];
  hflx_ppm_outer_1_11_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_outer_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_11_para.ox];
  hflx_ppm_outer_1_11_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+hflx_ppm_outer_1_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_1_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_1_11_para.ox];
  
  athread_spawn(hflx_ppm_outer_1_11, &hflx_ppm_outer_1_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqmf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lat[0][0][0], &Proc.FieldReq[async_qmf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_1_0_info adv_run_1_0_para;
  adv_run_1_0_para.lz = 32 - 0;
  adv_run_1_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  adv_run_1_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_1_0_para.oz = 0;
  adv_run_1_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  adv_run_1_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_1_0_para.hx = 2;
  adv_run_1_0_para.hy = 2;
  adv_run_1_0_para.hz = 0;
  adv_run_1_0_para.bx = 256;
  adv_run_1_0_para.by = 8;
  adv_run_1_0_para.bz = 1;
  adv_run_1_0_para.mx = 1;
  adv_run_1_0_para.my = 2;
  adv_run_1_0_para.mz = 32;
  adv_run_1_0_para.advold_m = &adv->old_m[Proc.lev_hw - 0+adv_run_1_0_para.oz][Proc.lat_hw -2+adv_run_1_0_para.oy][Proc.lon_hw -2+adv_run_1_0_para.ox];
  adv_run_1_0_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+adv_run_1_0_para.oz][Proc.lat_hw -2+adv_run_1_0_para.oy][Proc.lon_hw -2+adv_run_1_0_para.ox];
  adv_run_1_0_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+adv_run_1_0_para.oz][Proc.lat_hw -2+adv_run_1_0_para.oy][Proc.lon_hw -2+adv_run_1_0_para.ox];
  adv_run_1_0_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+adv_run_1_0_para.oz][Proc.lat_hw -2+adv_run_1_0_para.oy][Proc.lon_hw -2+adv_run_1_0_para.ox];
  adv_run_1_0_para.state_newqv = &state_new->qv[Proc.lev_hw - 0+adv_run_1_0_para.oz][Proc.lat_hw -2+adv_run_1_0_para.oy][Proc.lon_hw -2+adv_run_1_0_para.ox];
  adv_run_1_0_para.le_lon = &mesh->le_lon[0][0][0];
  adv_run_1_0_para.le_lat = &mesh->le_lat[0][0][0];
  adv_run_1_0_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(adv_run_1_0, &adv_run_1_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_1_1_info adv_run_1_1_para;
  adv_run_1_1_para.lz = 32 - 0;
  adv_run_1_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  adv_run_1_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_1_1_para.oz = 0;
  adv_run_1_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  adv_run_1_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_1_1_para.hx = 2;
  adv_run_1_1_para.hy = 2;
  adv_run_1_1_para.hz = 0;
  adv_run_1_1_para.bx = 256;
  adv_run_1_1_para.by = 8;
  adv_run_1_1_para.bz = 1;
  adv_run_1_1_para.mx = 1;
  adv_run_1_1_para.my = 2;
  adv_run_1_1_para.mz = 32;
  adv_run_1_1_para.state_newqv = &state_new->qv[Proc.lev_hw - 0+adv_run_1_1_para.oz][Proc.lat_hw -2+adv_run_1_1_para.oy][Proc.lon_hw -2+adv_run_1_1_para.ox];
  adv_run_1_1_para.state_oldm = &state_old->m[Proc.lev_hw - 0+adv_run_1_1_para.oz][Proc.lat_hw -2+adv_run_1_1_para.oy][Proc.lon_hw -2+adv_run_1_1_para.ox];
  
  athread_spawn(adv_run_1_1, &adv_run_1_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        buf = ppm(state_new->qv[(k - 2)][j][i],state_new->qv[(k - 1)][j][i],state_new->qv[k][j][i],state_new->qv[(k + 1)][j][i],state_new->qv[(k + 2)][j][i]);
        adv->qlx[k][j][i] = buf.x;
        adv->dqx[k][j][i] = buf.y;
        adv->q6x[k][j][i] = buf.z;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=1+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        ci = (int)(adv->cflz[k][j][i]);
        cf = (adv->cflz[k][j][i] - ci);
        if ((adv->cflz[k][j][i] > 0))
        {
          s1 = (1.0 - cf);
          s2 = 1.0;
          ds1 = (s2 - s1);
          ds2 = (pow(s2,2) - pow(s1,2));
          ds3 = (pow(s2,3) - pow(s1,3));
          cursum = 0.0;
          for (l=(k - ci);l<((k - 1) + 1);l+=1){
            cursum = (cursum + state_new->qv[l][j][i]);
          }
          adv->qmf_lev[k][j][i] = ((adv->we[k][j][i] * (((cursum + (adv->qlx[((k - ci) - 1)][j][i] * ds1)) + ((0.5 * adv->dqx[((k - ci) - 1)][j][i]) * ds2)) + (adv->q6x[((k - ci) - 1)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / adv->cflz[k][j][i]);
        }
        else
        {
          if ((adv->cflz[k][j][i] < 0))
          {
            s1 = 0.0;
            s2 = -cf;
            ds1 = (s2 - s1);
            ds2 = (pow(s2,2) - pow(s1,2));
            ds3 = (pow(s2,3) - pow(s1,3));
            for (l=k;l<(((k - ci) - 1) + 1);l+=1){
              cursum = (cursum + state_new->qv[l][j][i]);
            }
            adv->qmf_lev[k][j][i] = ((-adv->we[k][j][i] * (((cursum + (adv->qlx[(k - ci)][j][i] * ds1)) + ((0.5 * adv->dqx[(k - ci)][j][i]) * ds2)) + (adv->q6x[(k - ci)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / adv->cflz[k][j][i]);
          }
          else
          {
            adv->qmf_lev[k][j][i] = 0.0;
          }
        }
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmqmf_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_1_2_info adv_run_1_2_para;
  adv_run_1_2_para.lz = 32 - 0;
  adv_run_1_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  adv_run_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_1_2_para.oz = 0;
  adv_run_1_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  adv_run_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_1_2_para.hx = 2;
  adv_run_1_2_para.hy = 0;
  adv_run_1_2_para.hz = 2;
  adv_run_1_2_para.bx = 256;
  adv_run_1_2_para.by = 1;
  adv_run_1_2_para.bz = 4;
  adv_run_1_2_para.mx = 1;
  adv_run_1_2_para.my = 8;
  adv_run_1_2_para.mz = 8;
  adv_run_1_2_para.state_newqv = &state_new->qv[Proc.lev_hw - 2+adv_run_1_2_para.oz][Proc.lat_hw -0+adv_run_1_2_para.oy][Proc.lon_hw -2+adv_run_1_2_para.ox];
  adv_run_1_2_para.state_oldm = &state_old->m[Proc.lev_hw - 2+adv_run_1_2_para.oz][Proc.lat_hw -0+adv_run_1_2_para.oy][Proc.lon_hw -2+adv_run_1_2_para.ox];
  adv_run_1_2_para.advqmf_lev = &adv->qmf_lev[Proc.lev_hw - 2+adv_run_1_2_para.oz][Proc.lat_hw -0+adv_run_1_2_para.oy][Proc.lon_hw -2+adv_run_1_2_para.ox];
  
  athread_spawn(adv_run_1_2, &adv_run_1_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_On_Cell(1,1,&state_new->qv[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_On_CellTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state_new->qv[0][0][0], &Proc.FieldReq[async_qv], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_1_3_info adv_run_1_3_para;
  adv_run_1_3_para.lz = 32 - 0;
  adv_run_1_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  adv_run_1_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_1_3_para.oz = 0;
  adv_run_1_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  adv_run_1_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_1_3_para.hx = 2;
  adv_run_1_3_para.hy = 2;
  adv_run_1_3_para.hz = 0;
  adv_run_1_3_para.bx = 256;
  adv_run_1_3_para.by = 8;
  adv_run_1_3_para.bz = 1;
  adv_run_1_3_para.mx = 1;
  adv_run_1_3_para.my = 2;
  adv_run_1_3_para.mz = 32;
  adv_run_1_3_para.state_newqv = &state_new->qv[Proc.lev_hw - 0+adv_run_1_3_para.oz][Proc.lat_hw -2+adv_run_1_3_para.oy][Proc.lon_hw -2+adv_run_1_3_para.ox];
  adv_run_1_3_para.state_oldm = &state_old->m[Proc.lev_hw - 0+adv_run_1_3_para.oz][Proc.lat_hw -2+adv_run_1_3_para.oy][Proc.lon_hw -2+adv_run_1_3_para.ox];
  
  athread_spawn(adv_run_1_3, &adv_run_1_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state_new->qv[0][0][0], &Proc.FieldReq[async_qv], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  copy_old_m_1_2_info copy_old_m_1_2_para;
  copy_old_m_1_2_para.lz = 32 - 0;
  copy_old_m_1_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  copy_old_m_1_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  copy_old_m_1_2_para.oz = 0;
  copy_old_m_1_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  copy_old_m_1_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  copy_old_m_1_2_para.hx = 1;
  copy_old_m_1_2_para.hy = 1;
  copy_old_m_1_2_para.hz = 0;
  copy_old_m_1_2_para.bx = 256;
  copy_old_m_1_2_para.by = 8;
  copy_old_m_1_2_para.bz = 1;
  copy_old_m_1_2_para.mx = 1;
  copy_old_m_1_2_para.my = 2;
  copy_old_m_1_2_para.mz = 32;
  copy_old_m_1_2_para.state_oldm = &state_old->m[Proc.lev_hw - 0+copy_old_m_1_2_para.oz][Proc.lat_hw -1+copy_old_m_1_2_para.oy][Proc.lon_hw -1+copy_old_m_1_2_para.ox];
  copy_old_m_1_2_para.advold_m = &adv->old_m[Proc.lev_hw - 0+copy_old_m_1_2_para.oz][Proc.lat_hw -1+copy_old_m_1_2_para.oy][Proc.lon_hw -1+copy_old_m_1_2_para.ox];
  
  athread_spawn(copy_old_m_1_2, &copy_old_m_1_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  copy_old_mold_mTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void Diagnose_State_1(struct HybridStateField* state)
{
  Diagnose(state,10);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  DiagnoseTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void ncIO_Read_2(struct HybridStateField* state, struct HybridStaticField* staticv)
{
  int nid;
  nid = ncOpenFile("gmcore.restart.DSL.15.nc",0);
  ncGetVar(nid, "u_lon", 0, 32, Proc.lev_hw, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.half_nlon, Proc.lon_hw, &(state->u_lon[0][0][0]));
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  
  ncGetVar(nid, "v_lat", 0, 32, Proc.lev_hw, Proc.lat_beg, Proc.half_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(state->v_lat[0][0][0]));
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  
  ncGetVar(nid, "pt", 0, 32, Proc.lev_hw, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(state->pt[0][0][0]));
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  
  ncGetVar(nid, "phs", 0, 1, 0, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(state->phs[0][0][0]));
  UpdateHalo_2d_D(Proc, &state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
  
  ncGetVar(nid, "gzs", 0, 1, 0, Proc.lat_beg, Proc.full_nlat, Proc.lat_hw, Proc.lon_beg, Proc.full_nlon, Proc.lon_hw, &(staticv->gzs[0][0][0]));
  UpdateHalo_2d_D(Proc, &staticv->gzs[0][0][0], &Proc.FieldReq[async_gzs], true, true, true, true, true, true, false);
  
  ncCloseFile(nid);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ncCloseFileTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void spaceOperatorInit_2(struct HybridStaticField* staticv, struct HybridMeshField* mesh)
{
  int j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=MAX(Proc.lat_beg, 1)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
    for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
      staticv->dzsdlon[0][j][i] = (((staticv->gzs[0][j][(i + 1)] - staticv->gzs[0][j][i]) / 9.80616) / mesh->de_lon[0][j][0]);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  prepareStaticdzsdlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
    for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
      staticv->dzsdlat[0][j][i] = (((staticv->gzs[0][(j + 1)][i] - staticv->gzs[0][j][i]) / 9.80616) / mesh->de_lat[0][j][0]);
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  prepareStaticdzsdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void gzlevInit_2(struct HybridStateField* state, struct HybridStaticField* staticv)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=32+Proc.lev_hw; k<33+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->gz_lev[k][j][i] = staticv->gzs[0][j][i];
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  preparegzlevgz_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_2d_D(Proc, &state->gz_lev[32 + Proc.lev_hw][0][0], &Proc.FieldReq[async_gz_lev], true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void uvInit_2(struct HybridStateField* state)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  c2a_2_0_info c2a_2_0_para;
  c2a_2_0_para.lz = 32 - 0;
  c2a_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  c2a_2_0_para.lx = MIN(Proc.lon_end+1, 2399) - MAX(Proc.lon_beg, 0);
  c2a_2_0_para.oz = 0;
  c2a_2_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  c2a_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  c2a_2_0_para.hx = 1;
  c2a_2_0_para.hy = 1;
  c2a_2_0_para.hz = 0;
  c2a_2_0_para.bx = 256;
  c2a_2_0_para.by = 8;
  c2a_2_0_para.bz = 1;
  c2a_2_0_para.mx = 1;
  c2a_2_0_para.my = 2;
  c2a_2_0_para.mz = 32;
  c2a_2_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+c2a_2_0_para.oz][Proc.lat_hw -1+c2a_2_0_para.oy][Proc.lon_hw -1+c2a_2_0_para.ox];
  c2a_2_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+c2a_2_0_para.oz][Proc.lat_hw -1+c2a_2_0_para.oy][Proc.lon_hw -1+c2a_2_0_para.ox];
  c2a_2_0_para.stateu = &state->u[Proc.lev_hw - 0+c2a_2_0_para.oz][Proc.lat_hw -1+c2a_2_0_para.oy][Proc.lon_hw -1+c2a_2_0_para.ox];
  c2a_2_0_para.statev = &state->v[Proc.lev_hw - 0+c2a_2_0_para.oz][Proc.lat_hw -1+c2a_2_0_para.oy][Proc.lon_hw -1+c2a_2_0_para.ox];
  
  athread_spawn(c2a_2_0, &c2a_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  c2auTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void operatorPrepareNull_2(struct HybridStateField* state, struct HybridStaticField* staticv, struct HybridAdvField* advpt, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  int k, j, i, l;
  double b, dgz;
  double *tmp_state_tmpsum;
  struct Vector4 ke_vtx;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_phs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_2_0_info calc_ph_2_0_para;
  calc_ph_2_0_para.lz = 33 - 0;
  calc_ph_2_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_2_0_para.oz = 0;
  calc_ph_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_2_0_para.hx = 1;
  calc_ph_2_0_para.hy = 1;
  calc_ph_2_0_para.hz = 0;
  calc_ph_2_0_para.bx = 256;
  calc_ph_2_0_para.by = 8;
  calc_ph_2_0_para.bz = 1;
  calc_ph_2_0_para.mx = 1;
  calc_ph_2_0_para.my = 2;
  calc_ph_2_0_para.mz = 32;
  calc_ph_2_0_para.statephs = &state->phs[0][Proc.lat_hw -1+calc_ph_2_0_para.oy][Proc.lon_hw -1+calc_ph_2_0_para.ox];
  calc_ph_2_0_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_2_0_para.oz][Proc.lat_hw -1+calc_ph_2_0_para.oy][Proc.lon_hw -1+calc_ph_2_0_para.ox];
  calc_ph_2_0_para.hyai = &mesh->hyai[0][0][0];
  calc_ph_2_0_para.hybi = &mesh->hybi[0][0][0];
  
  athread_spawn(calc_ph_2_0, &calc_ph_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_2_1_info calc_ph_2_1_para;
  calc_ph_2_1_para.lz = 33 - 0;
  calc_ph_2_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_2_1_para.oz = 0;
  calc_ph_2_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_2_1_para.hx = 1;
  calc_ph_2_1_para.hy = 1;
  calc_ph_2_1_para.hz = 0;
  calc_ph_2_1_para.bx = 256;
  calc_ph_2_1_para.by = 8;
  calc_ph_2_1_para.bz = 1;
  calc_ph_2_1_para.mx = 1;
  calc_ph_2_1_para.my = 2;
  calc_ph_2_1_para.mz = 32;
  calc_ph_2_1_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_2_1_para.oz][Proc.lat_hw -1+calc_ph_2_1_para.oy][Proc.lon_hw -1+calc_ph_2_1_para.ox];
  calc_ph_2_1_para.stateph_exn_lev = &state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_2_1_para.oz][Proc.lat_hw -1+calc_ph_2_1_para.oy][Proc.lon_hw -1+calc_ph_2_1_para.ox];
  
  athread_spawn(calc_ph_2_1, &calc_ph_2_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_exn_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_2_2_info calc_ph_2_2_para;
  calc_ph_2_2_para.lz = 32 - 0;
  calc_ph_2_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_2_2_para.oz = 0;
  calc_ph_2_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_2_2_para.hx = 0;
  calc_ph_2_2_para.hy = 0;
  calc_ph_2_2_para.hz = 1;
  calc_ph_2_2_para.bx = 256;
  calc_ph_2_2_para.by = 1;
  calc_ph_2_2_para.bz = 4;
  calc_ph_2_2_para.mx = 1;
  calc_ph_2_2_para.my = 8;
  calc_ph_2_2_para.mz = 8;
  calc_ph_2_2_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_ph_2_2_para.oz][Proc.lat_hw -0+calc_ph_2_2_para.oy][Proc.lon_hw -0+calc_ph_2_2_para.ox];
  calc_ph_2_2_para.stateph = &state->ph[Proc.lev_hw - 1+calc_ph_2_2_para.oz][Proc.lat_hw -0+calc_ph_2_2_para.oy][Proc.lon_hw -0+calc_ph_2_2_para.ox];
  
  athread_spawn(calc_ph_2_2, &calc_ph_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phphTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_2_0_info calc_m_2_0_para;
  calc_m_2_0_para.lz = 32 - 0;
  calc_m_2_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_2_0_para.oz = 0;
  calc_m_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_2_0_para.hx = 1;
  calc_m_2_0_para.hy = 0;
  calc_m_2_0_para.hz = 1;
  calc_m_2_0_para.bx = 256;
  calc_m_2_0_para.by = 1;
  calc_m_2_0_para.bz = 4;
  calc_m_2_0_para.mx = 1;
  calc_m_2_0_para.my = 8;
  calc_m_2_0_para.mz = 8;
  calc_m_2_0_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_2_0_para.oz][Proc.lat_hw -0+calc_m_2_0_para.oy][Proc.lon_hw -1+calc_m_2_0_para.ox];
  calc_m_2_0_para.statem = &state->m[Proc.lev_hw - 1+calc_m_2_0_para.oz][Proc.lat_hw -0+calc_m_2_0_para.oy][Proc.lon_hw -1+calc_m_2_0_para.ox];
  
  athread_spawn(calc_m_2_0, &calc_m_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mmTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_2_1_info calc_m_2_1_para;
  calc_m_2_1_para.lz = 32 - 1;
  calc_m_2_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_2_1_para.oz = 1;
  calc_m_2_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_2_1_para.hx = 0;
  calc_m_2_1_para.hy = 0;
  calc_m_2_1_para.hz = 1;
  calc_m_2_1_para.bx = 256;
  calc_m_2_1_para.by = 1;
  calc_m_2_1_para.bz = 4;
  calc_m_2_1_para.mx = 1;
  calc_m_2_1_para.my = 8;
  calc_m_2_1_para.mz = 8;
  calc_m_2_1_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_2_1_para.oz][Proc.lat_hw -0+calc_m_2_1_para.oy][Proc.lon_hw -0+calc_m_2_1_para.ox];
  calc_m_2_1_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_2_1_para.oz][Proc.lat_hw -0+calc_m_2_1_para.oy][Proc.lon_hw -0+calc_m_2_1_para.ox];
  
  athread_spawn(calc_m_2_1, &calc_m_2_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_2_2_info calc_m_2_2_para;
  calc_m_2_2_para.lz = 1 - 0;
  calc_m_2_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_2_2_para.oz = 0;
  calc_m_2_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_2_2_para.hx = 0;
  calc_m_2_2_para.hy = 0;
  calc_m_2_2_para.hz = 0;
  calc_m_2_2_para.bx = 256;
  calc_m_2_2_para.by = 8;
  calc_m_2_2_para.bz = 1;
  calc_m_2_2_para.mx = 1;
  calc_m_2_2_para.my = 2;
  calc_m_2_2_para.mz = 32;
  calc_m_2_2_para.stateph = &state->ph[Proc.lev_hw - 0+calc_m_2_2_para.oz][Proc.lat_hw -0+calc_m_2_2_para.oy][Proc.lon_hw -0+calc_m_2_2_para.ox];
  calc_m_2_2_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_m_2_2_para.oz][Proc.lat_hw -0+calc_m_2_2_para.oy][Proc.lon_hw -0+calc_m_2_2_para.ox];
  calc_m_2_2_para.statem_lev = &state->m_lev[Proc.lev_hw - 0+calc_m_2_2_para.oz][Proc.lat_hw -0+calc_m_2_2_para.oy][Proc.lon_hw -0+calc_m_2_2_para.ox];
  
  athread_spawn(calc_m_2_2, &calc_m_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_2_3_info calc_m_2_3_para;
  calc_m_2_3_para.lz = 33 - 32;
  calc_m_2_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_2_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_2_3_para.oz = 32;
  calc_m_2_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_2_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_2_3_para.hx = 0;
  calc_m_2_3_para.hy = 0;
  calc_m_2_3_para.hz = 1;
  calc_m_2_3_para.bx = 256;
  calc_m_2_3_para.by = 1;
  calc_m_2_3_para.bz = 4;
  calc_m_2_3_para.mx = 1;
  calc_m_2_3_para.my = 8;
  calc_m_2_3_para.mz = 8;
  calc_m_2_3_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_2_3_para.oz][Proc.lat_hw -0+calc_m_2_3_para.oy][Proc.lon_hw -0+calc_m_2_3_para.ox];
  calc_m_2_3_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_2_3_para.oz][Proc.lat_hw -0+calc_m_2_3_para.oy][Proc.lon_hw -0+calc_m_2_3_para.ox];
  calc_m_2_3_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_2_3_para.oz][Proc.lat_hw -0+calc_m_2_3_para.oy][Proc.lon_hw -0+calc_m_2_3_para.ox];
  
  athread_spawn(calc_m_2_3, &calc_m_2_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLonEdge_2_0_info averageCellToLonEdge_2_0_para;
  averageCellToLonEdge_2_0_para.lz = 32 - 0;
  averageCellToLonEdge_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  averageCellToLonEdge_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLonEdge_2_0_para.oz = 0;
  averageCellToLonEdge_2_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  averageCellToLonEdge_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLonEdge_2_0_para.hx = 1;
  averageCellToLonEdge_2_0_para.hy = 1;
  averageCellToLonEdge_2_0_para.hz = 0;
  averageCellToLonEdge_2_0_para.bx = 256;
  averageCellToLonEdge_2_0_para.by = 8;
  averageCellToLonEdge_2_0_para.bz = 1;
  averageCellToLonEdge_2_0_para.mx = 1;
  averageCellToLonEdge_2_0_para.my = 2;
  averageCellToLonEdge_2_0_para.mz = 32;
  averageCellToLonEdge_2_0_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLonEdge_2_0_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_0_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_0_para.ox];
  averageCellToLonEdge_2_0_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_2_0_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_0_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_0_para.ox];
  
  athread_spawn(averageCellToLonEdge_2_0, &averageCellToLonEdge_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLatEdge_2_0_info averageCellToLatEdge_2_0_para;
  averageCellToLatEdge_2_0_para.lz = 32 - 0;
  averageCellToLatEdge_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  averageCellToLatEdge_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLatEdge_2_0_para.oz = 0;
  averageCellToLatEdge_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  averageCellToLatEdge_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLatEdge_2_0_para.hx = 1;
  averageCellToLatEdge_2_0_para.hy = 1;
  averageCellToLatEdge_2_0_para.hz = 0;
  averageCellToLatEdge_2_0_para.bx = 256;
  averageCellToLatEdge_2_0_para.by = 8;
  averageCellToLatEdge_2_0_para.bz = 1;
  averageCellToLatEdge_2_0_para.mx = 1;
  averageCellToLatEdge_2_0_para.my = 2;
  averageCellToLatEdge_2_0_para.mz = 32;
  averageCellToLatEdge_2_0_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLatEdge_2_0_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_0_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_0_para.ox];
  averageCellToLatEdge_2_0_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_2_0_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_0_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_0_para.ox];
  
  athread_spawn(averageCellToLatEdge_2_0, &averageCellToLatEdge_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interpCellToVtx_2_0_info interpCellToVtx_2_0_para;
  interpCellToVtx_2_0_para.lz = 32 - 0;
  interpCellToVtx_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interpCellToVtx_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interpCellToVtx_2_0_para.oz = 0;
  interpCellToVtx_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interpCellToVtx_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interpCellToVtx_2_0_para.hx = 1;
  interpCellToVtx_2_0_para.hy = 1;
  interpCellToVtx_2_0_para.hz = 0;
  interpCellToVtx_2_0_para.bx = 256;
  interpCellToVtx_2_0_para.by = 8;
  interpCellToVtx_2_0_para.bz = 1;
  interpCellToVtx_2_0_para.mx = 1;
  interpCellToVtx_2_0_para.my = 2;
  interpCellToVtx_2_0_para.mz = 32;
  interpCellToVtx_2_0_para.statem = &state->m[Proc.lev_hw - 0+interpCellToVtx_2_0_para.oz][Proc.lat_hw -1+interpCellToVtx_2_0_para.oy][Proc.lon_hw -1+interpCellToVtx_2_0_para.ox];
  interpCellToVtx_2_0_para.statem_vtx = &state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_2_0_para.oz][Proc.lat_hw -1+interpCellToVtx_2_0_para.oy][Proc.lon_hw -1+interpCellToVtx_2_0_para.ox];
  interpCellToVtx_2_0_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  interpCellToVtx_2_0_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  interpCellToVtx_2_0_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(interpCellToVtx_2_0, &interpCellToVtx_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_t_2_0_info calc_t_2_0_para;
  calc_t_2_0_para.lz = 32 - 0;
  calc_t_2_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_t_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_t_2_0_para.oz = 0;
  calc_t_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_t_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_t_2_0_para.hx = 2;
  calc_t_2_0_para.hy = 2;
  calc_t_2_0_para.hz = 0;
  calc_t_2_0_para.bx = 256;
  calc_t_2_0_para.by = 8;
  calc_t_2_0_para.bz = 1;
  calc_t_2_0_para.mx = 1;
  calc_t_2_0_para.my = 2;
  calc_t_2_0_para.mz = 32;
  calc_t_2_0_para.statept = &state->pt[Proc.lev_hw - 0+calc_t_2_0_para.oz][Proc.lat_hw -2+calc_t_2_0_para.oy][Proc.lon_hw -2+calc_t_2_0_para.ox];
  calc_t_2_0_para.stateph = &state->ph[Proc.lev_hw - 0+calc_t_2_0_para.oz][Proc.lat_hw -2+calc_t_2_0_para.oy][Proc.lon_hw -2+calc_t_2_0_para.ox];
  calc_t_2_0_para.stateqv = &state->qv[Proc.lev_hw - 0+calc_t_2_0_para.oz][Proc.lat_hw -2+calc_t_2_0_para.oy][Proc.lon_hw -2+calc_t_2_0_para.ox];
  calc_t_2_0_para.statet = &state->t[Proc.lev_hw - 0+calc_t_2_0_para.oz][Proc.lat_hw -2+calc_t_2_0_para.oy][Proc.lon_hw -2+calc_t_2_0_para.ox];
  
  athread_spawn(calc_t_2_0, &calc_t_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_ttTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  if (((advPara->uv_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_0_info accum_uv_cell_2_0_para;
    accum_uv_cell_2_0_para.lz = 32 - 0;
    accum_uv_cell_2_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_0_para.oz = 0;
    accum_uv_cell_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_0_para.hx = 1;
    accum_uv_cell_2_0_para.hy = 0;
    accum_uv_cell_2_0_para.hz = 0;
    accum_uv_cell_2_0_para.bx = 256;
    accum_uv_cell_2_0_para.by = 8;
    accum_uv_cell_2_0_para.bz = 1;
    accum_uv_cell_2_0_para.mx = 1;
    accum_uv_cell_2_0_para.my = 2;
    accum_uv_cell_2_0_para.mz = 32;
    accum_uv_cell_2_0_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_2_0_para.oz][Proc.lat_hw -0+accum_uv_cell_2_0_para.oy][Proc.lon_hw -1+accum_uv_cell_2_0_para.ox];
    accum_uv_cell_2_0_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_0_para.oz][Proc.lat_hw -0+accum_uv_cell_2_0_para.oy][Proc.lon_hw -1+accum_uv_cell_2_0_para.ox];
    
    athread_spawn(accum_uv_cell_2_0, &accum_uv_cell_2_0_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_1_info accum_uv_cell_2_1_para;
    accum_uv_cell_2_1_para.lz = 32 - 0;
    accum_uv_cell_2_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_1_para.oz = 0;
    accum_uv_cell_2_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_1_para.hx = 0;
    accum_uv_cell_2_1_para.hy = 1;
    accum_uv_cell_2_1_para.hz = 0;
    accum_uv_cell_2_1_para.bx = 256;
    accum_uv_cell_2_1_para.by = 8;
    accum_uv_cell_2_1_para.bz = 1;
    accum_uv_cell_2_1_para.mx = 1;
    accum_uv_cell_2_1_para.my = 2;
    accum_uv_cell_2_1_para.mz = 32;
    accum_uv_cell_2_1_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_2_1_para.oz][Proc.lat_hw -1+accum_uv_cell_2_1_para.oy][Proc.lon_hw -0+accum_uv_cell_2_1_para.ox];
    accum_uv_cell_2_1_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_1_para.oz][Proc.lat_hw -1+accum_uv_cell_2_1_para.oy][Proc.lon_hw -0+accum_uv_cell_2_1_para.ox];
    
    athread_spawn(accum_uv_cell_2_1, &accum_uv_cell_2_1_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->uv_step) = 1;
  }
  if (((advPara->uv_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_2_info accum_uv_cell_2_2_para;
    accum_uv_cell_2_2_para.lz = 32 - 0;
    accum_uv_cell_2_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_2_para.oz = 0;
    accum_uv_cell_2_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_2_para.hx = 1;
    accum_uv_cell_2_2_para.hy = 1;
    accum_uv_cell_2_2_para.hz = 0;
    accum_uv_cell_2_2_para.bx = 256;
    accum_uv_cell_2_2_para.by = 8;
    accum_uv_cell_2_2_para.bz = 1;
    accum_uv_cell_2_2_para.mx = 1;
    accum_uv_cell_2_2_para.my = 2;
    accum_uv_cell_2_2_para.mz = 32;
    accum_uv_cell_2_2_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+accum_uv_cell_2_2_para.oz][Proc.lat_hw -1+accum_uv_cell_2_2_para.oy][Proc.lon_hw -1+accum_uv_cell_2_2_para.ox];
    accum_uv_cell_2_2_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_2_para.oz][Proc.lat_hw -1+accum_uv_cell_2_2_para.oy][Proc.lon_hw -1+accum_uv_cell_2_2_para.ox];
    
    athread_spawn(accum_uv_cell_2_2, &accum_uv_cell_2_2_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_3_info accum_uv_cell_2_3_para;
    accum_uv_cell_2_3_para.lz = 32 - 0;
    accum_uv_cell_2_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_3_para.oz = 0;
    accum_uv_cell_2_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_3_para.hx = 1;
    accum_uv_cell_2_3_para.hy = 1;
    accum_uv_cell_2_3_para.hz = 0;
    accum_uv_cell_2_3_para.bx = 256;
    accum_uv_cell_2_3_para.by = 8;
    accum_uv_cell_2_3_para.bz = 1;
    accum_uv_cell_2_3_para.mx = 1;
    accum_uv_cell_2_3_para.my = 2;
    accum_uv_cell_2_3_para.mz = 32;
    accum_uv_cell_2_3_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+accum_uv_cell_2_3_para.oz][Proc.lat_hw -1+accum_uv_cell_2_3_para.oy][Proc.lon_hw -1+accum_uv_cell_2_3_para.ox];
    accum_uv_cell_2_3_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_3_para.oz][Proc.lat_hw -1+accum_uv_cell_2_3_para.oy][Proc.lon_hw -1+accum_uv_cell_2_3_para.ox];
    
    athread_spawn(accum_uv_cell_2_3, &accum_uv_cell_2_3_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->uv_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_4_info accum_uv_cell_2_4_para;
      accum_uv_cell_2_4_para.lz = 32 - 0;
      accum_uv_cell_2_4_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_4_para.oz = 0;
      accum_uv_cell_2_4_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_4_para.hx = 1;
      accum_uv_cell_2_4_para.hy = 1;
      accum_uv_cell_2_4_para.hz = 0;
      accum_uv_cell_2_4_para.bx = 256;
      accum_uv_cell_2_4_para.by = 8;
      accum_uv_cell_2_4_para.bz = 1;
      accum_uv_cell_2_4_para.mx = 1;
      accum_uv_cell_2_4_para.my = 2;
      accum_uv_cell_2_4_para.mz = 32;
      accum_uv_cell_2_4_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_4_para.oz][Proc.lat_hw -1+accum_uv_cell_2_4_para.oy][Proc.lon_hw -1+accum_uv_cell_2_4_para.ox];
      accum_uv_cell_2_4_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+accum_uv_cell_2_4_para.oz][Proc.lat_hw -1+accum_uv_cell_2_4_para.oy][Proc.lon_hw -1+accum_uv_cell_2_4_para.ox];
      accum_uv_cell_2_4_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_2_4, &accum_uv_cell_2_4_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_5_info accum_uv_cell_2_5_para;
      accum_uv_cell_2_5_para.lz = 32 - 0;
      accum_uv_cell_2_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_5_para.oz = 0;
      accum_uv_cell_2_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_5_para.hx = 1;
      accum_uv_cell_2_5_para.hy = 1;
      accum_uv_cell_2_5_para.hz = 0;
      accum_uv_cell_2_5_para.bx = 256;
      accum_uv_cell_2_5_para.by = 8;
      accum_uv_cell_2_5_para.bz = 1;
      accum_uv_cell_2_5_para.mx = 1;
      accum_uv_cell_2_5_para.my = 2;
      accum_uv_cell_2_5_para.mz = 32;
      accum_uv_cell_2_5_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_5_para.oz][Proc.lat_hw -1+accum_uv_cell_2_5_para.oy][Proc.lon_hw -1+accum_uv_cell_2_5_para.ox];
      accum_uv_cell_2_5_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+accum_uv_cell_2_5_para.oz][Proc.lat_hw -1+accum_uv_cell_2_5_para.oy][Proc.lon_hw -1+accum_uv_cell_2_5_para.ox];
      accum_uv_cell_2_5_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_2_5, &accum_uv_cell_2_5_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_6_info accum_uv_cell_2_6_para;
      accum_uv_cell_2_6_para.lz = 32 - 0;
      accum_uv_cell_2_6_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_6_para.oz = 0;
      accum_uv_cell_2_6_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_6_para.hx = 1;
      accum_uv_cell_2_6_para.hy = 0;
      accum_uv_cell_2_6_para.hz = 0;
      accum_uv_cell_2_6_para.bx = 256;
      accum_uv_cell_2_6_para.by = 8;
      accum_uv_cell_2_6_para.bz = 1;
      accum_uv_cell_2_6_para.mx = 1;
      accum_uv_cell_2_6_para.my = 2;
      accum_uv_cell_2_6_para.mz = 32;
      accum_uv_cell_2_6_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_6_para.oz][Proc.lat_hw -0+accum_uv_cell_2_6_para.oy][Proc.lon_hw -1+accum_uv_cell_2_6_para.ox];
      accum_uv_cell_2_6_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_2_6_para.oz][Proc.lat_hw -0+accum_uv_cell_2_6_para.oy][Proc.lon_hw -1+accum_uv_cell_2_6_para.ox];
      
      athread_spawn(accum_uv_cell_2_6, &accum_uv_cell_2_6_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellu0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_7_info accum_uv_cell_2_7_para;
      accum_uv_cell_2_7_para.lz = 32 - 0;
      accum_uv_cell_2_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_7_para.oz = 0;
      accum_uv_cell_2_7_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_7_para.hx = 0;
      accum_uv_cell_2_7_para.hy = 1;
      accum_uv_cell_2_7_para.hz = 0;
      accum_uv_cell_2_7_para.bx = 256;
      accum_uv_cell_2_7_para.by = 8;
      accum_uv_cell_2_7_para.bz = 1;
      accum_uv_cell_2_7_para.mx = 1;
      accum_uv_cell_2_7_para.my = 2;
      accum_uv_cell_2_7_para.mz = 32;
      accum_uv_cell_2_7_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_7_para.oz][Proc.lat_hw -1+accum_uv_cell_2_7_para.oy][Proc.lon_hw -0+accum_uv_cell_2_7_para.ox];
      accum_uv_cell_2_7_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_2_7_para.oz][Proc.lat_hw -1+accum_uv_cell_2_7_para.oy][Proc.lon_hw -0+accum_uv_cell_2_7_para.ox];
      
      athread_spawn(accum_uv_cell_2_7, &accum_uv_cell_2_7_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellv0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_8_info accum_uv_cell_2_8_para;
      accum_uv_cell_2_8_para.lz = 32 - 0;
      accum_uv_cell_2_8_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_8_para.oz = 0;
      accum_uv_cell_2_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_8_para.hx = 1;
      accum_uv_cell_2_8_para.hy = 1;
      accum_uv_cell_2_8_para.hz = 0;
      accum_uv_cell_2_8_para.bx = 256;
      accum_uv_cell_2_8_para.by = 8;
      accum_uv_cell_2_8_para.bz = 1;
      accum_uv_cell_2_8_para.mx = 1;
      accum_uv_cell_2_8_para.my = 2;
      accum_uv_cell_2_8_para.mz = 32;
      accum_uv_cell_2_8_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_8_para.oz][Proc.lat_hw -1+accum_uv_cell_2_8_para.oy][Proc.lon_hw -1+accum_uv_cell_2_8_para.ox];
      accum_uv_cell_2_8_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+accum_uv_cell_2_8_para.oz][Proc.lat_hw -1+accum_uv_cell_2_8_para.oy][Proc.lon_hw -1+accum_uv_cell_2_8_para.ox];
      
      athread_spawn(accum_uv_cell_2_8, &accum_uv_cell_2_8_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_9_info accum_uv_cell_2_9_para;
      accum_uv_cell_2_9_para.lz = 32 - 0;
      accum_uv_cell_2_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_9_para.oz = 0;
      accum_uv_cell_2_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_9_para.hx = 1;
      accum_uv_cell_2_9_para.hy = 1;
      accum_uv_cell_2_9_para.hz = 0;
      accum_uv_cell_2_9_para.bx = 256;
      accum_uv_cell_2_9_para.by = 8;
      accum_uv_cell_2_9_para.bz = 1;
      accum_uv_cell_2_9_para.mx = 1;
      accum_uv_cell_2_9_para.my = 2;
      accum_uv_cell_2_9_para.mz = 32;
      accum_uv_cell_2_9_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_9_para.oz][Proc.lat_hw -1+accum_uv_cell_2_9_para.oy][Proc.lon_hw -1+accum_uv_cell_2_9_para.ox];
      accum_uv_cell_2_9_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+accum_uv_cell_2_9_para.oz][Proc.lat_hw -1+accum_uv_cell_2_9_para.oy][Proc.lon_hw -1+accum_uv_cell_2_9_para.ox];
      
      athread_spawn(accum_uv_cell_2_9, &accum_uv_cell_2_9_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->uv_step) = 0;
  }
  else
  {
    (advPara->uv_step) = ((advPara->uv_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->uv_step) > (advPara->nstep))))
  {
    if (!(advPara->dynamic))
    {
      (advPara->uv_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_10_info accum_uv_cell_2_10_para;
    accum_uv_cell_2_10_para.lz = 32 - 0;
    accum_uv_cell_2_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_10_para.oz = 0;
    accum_uv_cell_2_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_10_para.hx = 1;
    accum_uv_cell_2_10_para.hy = 0;
    accum_uv_cell_2_10_para.hz = 0;
    accum_uv_cell_2_10_para.bx = 256;
    accum_uv_cell_2_10_para.by = 8;
    accum_uv_cell_2_10_para.bz = 1;
    accum_uv_cell_2_10_para.mx = 1;
    accum_uv_cell_2_10_para.my = 2;
    accum_uv_cell_2_10_para.mz = 32;
    accum_uv_cell_2_10_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_10_para.oz][Proc.lat_hw -0+accum_uv_cell_2_10_para.oy][Proc.lon_hw -1+accum_uv_cell_2_10_para.ox];
    accum_uv_cell_2_10_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+accum_uv_cell_2_10_para.oz][Proc.lat_hw -0+accum_uv_cell_2_10_para.oy][Proc.lon_hw -1+accum_uv_cell_2_10_para.ox];
    accum_uv_cell_2_10_para.de_lon = &mesh->de_lon[0][0][0];
    accum_uv_cell_2_10_para.dt = dt;
    
    athread_spawn(accum_uv_cell_2_10, &accum_uv_cell_2_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_11_info accum_uv_cell_2_11_para;
    accum_uv_cell_2_11_para.lz = 32 - 0;
    accum_uv_cell_2_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_11_para.oz = 0;
    accum_uv_cell_2_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_11_para.hx = 0;
    accum_uv_cell_2_11_para.hy = 1;
    accum_uv_cell_2_11_para.hz = 0;
    accum_uv_cell_2_11_para.bx = 256;
    accum_uv_cell_2_11_para.by = 8;
    accum_uv_cell_2_11_para.bz = 1;
    accum_uv_cell_2_11_para.mx = 1;
    accum_uv_cell_2_11_para.my = 2;
    accum_uv_cell_2_11_para.mz = 32;
    accum_uv_cell_2_11_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_11_para.oz][Proc.lat_hw -1+accum_uv_cell_2_11_para.oy][Proc.lon_hw -0+accum_uv_cell_2_11_para.ox];
    accum_uv_cell_2_11_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+accum_uv_cell_2_11_para.oz][Proc.lat_hw -1+accum_uv_cell_2_11_para.oy][Proc.lon_hw -0+accum_uv_cell_2_11_para.ox];
    accum_uv_cell_2_11_para.de_lat = &mesh->de_lat[0][0][0];
    accum_uv_cell_2_11_para.dt = dt;
    
    athread_spawn(accum_uv_cell_2_11, &accum_uv_cell_2_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_12_info accum_uv_cell_2_12_para;
    accum_uv_cell_2_12_para.lz = 32 - 0;
    accum_uv_cell_2_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_2_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_12_para.oz = 0;
    accum_uv_cell_2_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_2_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_12_para.hx = 1;
    accum_uv_cell_2_12_para.hy = 1;
    accum_uv_cell_2_12_para.hz = 0;
    accum_uv_cell_2_12_para.bx = 256;
    accum_uv_cell_2_12_para.by = 8;
    accum_uv_cell_2_12_para.bz = 1;
    accum_uv_cell_2_12_para.mx = 1;
    accum_uv_cell_2_12_para.my = 2;
    accum_uv_cell_2_12_para.mz = 32;
    accum_uv_cell_2_12_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_12_para.oz][Proc.lat_hw -1+accum_uv_cell_2_12_para.oy][Proc.lon_hw -1+accum_uv_cell_2_12_para.ox];
    accum_uv_cell_2_12_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_12_para.oz][Proc.lat_hw -1+accum_uv_cell_2_12_para.oy][Proc.lon_hw -1+accum_uv_cell_2_12_para.ox];
    accum_uv_cell_2_12_para.advptdivx = &advpt->divx[Proc.lev_hw - 0+accum_uv_cell_2_12_para.oz][Proc.lat_hw -1+accum_uv_cell_2_12_para.oy][Proc.lon_hw -1+accum_uv_cell_2_12_para.ox];
    accum_uv_cell_2_12_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+accum_uv_cell_2_12_para.oz][Proc.lat_hw -1+accum_uv_cell_2_12_para.oy][Proc.lon_hw -1+accum_uv_cell_2_12_para.ox];
    accum_uv_cell_2_12_para.le_lon = &mesh->le_lon[0][0][0];
    accum_uv_cell_2_12_para.area_cell = &mesh->area_cell[0][0][0];
    accum_uv_cell_2_12_para.le_lat = &mesh->le_lat[0][0][0];
    
    athread_spawn(accum_uv_cell_2_12, &accum_uv_cell_2_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_13_info accum_uv_cell_2_13_para;
    accum_uv_cell_2_13_para.lz = 32 - 0;
    accum_uv_cell_2_13_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
    accum_uv_cell_2_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_13_para.oz = 0;
    accum_uv_cell_2_13_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
    accum_uv_cell_2_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_13_para.hx = 0;
    accum_uv_cell_2_13_para.hy = 1;
    accum_uv_cell_2_13_para.hz = 0;
    accum_uv_cell_2_13_para.bx = 256;
    accum_uv_cell_2_13_para.by = 8;
    accum_uv_cell_2_13_para.bz = 1;
    accum_uv_cell_2_13_para.mx = 1;
    accum_uv_cell_2_13_para.my = 2;
    accum_uv_cell_2_13_para.mz = 32;
    accum_uv_cell_2_13_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_13_para.oz][Proc.lat_hw -1+accum_uv_cell_2_13_para.oy][Proc.lon_hw -0+accum_uv_cell_2_13_para.ox];
    accum_uv_cell_2_13_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+accum_uv_cell_2_13_para.oz][Proc.lat_hw -1+accum_uv_cell_2_13_para.oy][Proc.lon_hw -0+accum_uv_cell_2_13_para.ox];
    
    athread_spawn(accum_uv_cell_2_13, &accum_uv_cell_2_13_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celltmpsumTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    // SumCall:state->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
    tmp_state_tmpsum = allocate_1d_array_D(32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          tmp_state_tmpsum[k-Proc.lev_hw]=tmp_state_tmpsum[k-Proc.lev_hw]+state->tmpsum[k][j][i];
        }
      }
    }
    Zonal_Sum_1d_D(Proc, &tmp_state_tmpsum,32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          state->tmpsum[k][j][i]=tmp_state_tmpsum[k-Proc.lev_hw];
        }
      }
    }
    free_1d_array_D(tmp_state_tmpsum,32);
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_14_info accum_uv_cell_2_14_para;
    accum_uv_cell_2_14_para.lz = 32 - 0;
    accum_uv_cell_2_14_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
    accum_uv_cell_2_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_14_para.oz = 0;
    accum_uv_cell_2_14_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
    accum_uv_cell_2_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_14_para.hx = 0;
    accum_uv_cell_2_14_para.hy = 0;
    accum_uv_cell_2_14_para.hz = 0;
    accum_uv_cell_2_14_para.bx = 256;
    accum_uv_cell_2_14_para.by = 8;
    accum_uv_cell_2_14_para.bz = 1;
    accum_uv_cell_2_14_para.mx = 1;
    accum_uv_cell_2_14_para.my = 2;
    accum_uv_cell_2_14_para.mz = 32;
    accum_uv_cell_2_14_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+accum_uv_cell_2_14_para.oz][Proc.lat_hw -0+accum_uv_cell_2_14_para.oy][Proc.lon_hw -0+accum_uv_cell_2_14_para.ox];
    accum_uv_cell_2_14_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+accum_uv_cell_2_14_para.oz][Proc.lat_hw -0+accum_uv_cell_2_14_para.oy][Proc.lon_hw -0+accum_uv_cell_2_14_para.ox];
    accum_uv_cell_2_14_para.le_lat = &mesh->le_lat[0][0][0];
    accum_uv_cell_2_14_para.area_cell = &mesh->area_cell[0][0][0];
    
    athread_spawn(accum_uv_cell_2_14, &accum_uv_cell_2_14_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_2_0_info calc_mf_2_0_para;
  calc_mf_2_0_para.lz = 32 - 0;
  calc_mf_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_2_0_para.oz = 0;
  calc_mf_2_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_2_0_para.hx = 1;
  calc_mf_2_0_para.hy = 1;
  calc_mf_2_0_para.hz = 0;
  calc_mf_2_0_para.bx = 256;
  calc_mf_2_0_para.by = 8;
  calc_mf_2_0_para.bz = 1;
  calc_mf_2_0_para.mx = 1;
  calc_mf_2_0_para.my = 2;
  calc_mf_2_0_para.mz = 32;
  calc_mf_2_0_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+calc_mf_2_0_para.oz][Proc.lat_hw -1+calc_mf_2_0_para.oy][Proc.lon_hw -1+calc_mf_2_0_para.ox];
  calc_mf_2_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_mf_2_0_para.oz][Proc.lat_hw -1+calc_mf_2_0_para.oy][Proc.lon_hw -1+calc_mf_2_0_para.ox];
  calc_mf_2_0_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+calc_mf_2_0_para.oz][Proc.lat_hw -1+calc_mf_2_0_para.oy][Proc.lon_hw -1+calc_mf_2_0_para.ox];
  
  athread_spawn(calc_mf_2_0, &calc_mf_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->mfx_lon[0][0][0], &Proc.FieldReq[async_mfx_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_2_1_info calc_mf_2_1_para;
  calc_mf_2_1_para.lz = 32 - 0;
  calc_mf_2_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_2_1_para.oz = 0;
  calc_mf_2_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_2_1_para.hx = 1;
  calc_mf_2_1_para.hy = 1;
  calc_mf_2_1_para.hz = 0;
  calc_mf_2_1_para.bx = 256;
  calc_mf_2_1_para.by = 8;
  calc_mf_2_1_para.bz = 1;
  calc_mf_2_1_para.mx = 1;
  calc_mf_2_1_para.my = 2;
  calc_mf_2_1_para.mz = 32;
  calc_mf_2_1_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+calc_mf_2_1_para.oz][Proc.lat_hw -1+calc_mf_2_1_para.oy][Proc.lon_hw -1+calc_mf_2_1_para.ox];
  calc_mf_2_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_mf_2_1_para.oz][Proc.lat_hw -1+calc_mf_2_1_para.oy][Proc.lon_hw -1+calc_mf_2_1_para.ox];
  calc_mf_2_1_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+calc_mf_2_1_para.oz][Proc.lat_hw -1+calc_mf_2_1_para.oy][Proc.lon_hw -1+calc_mf_2_1_para.ox];
  
  athread_spawn(calc_mf_2_1, &calc_mf_2_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->mfy_lat[0][0][0], &Proc.FieldReq[async_mfy_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  if (((advPara->mf_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfx[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfy[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->mf_step) = 1;
  }
  if (((advPara->mf_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_2_0_info accum_mf_cell_2_0_para;
    accum_mf_cell_2_0_para.lz = 32 - 0;
    accum_mf_cell_2_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_2_0_para.oz = 0;
    accum_mf_cell_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_2_0_para.hx = 1;
    accum_mf_cell_2_0_para.hy = 1;
    accum_mf_cell_2_0_para.hz = 0;
    accum_mf_cell_2_0_para.bx = 256;
    accum_mf_cell_2_0_para.by = 8;
    accum_mf_cell_2_0_para.bz = 1;
    accum_mf_cell_2_0_para.mx = 1;
    accum_mf_cell_2_0_para.my = 2;
    accum_mf_cell_2_0_para.mz = 32;
    accum_mf_cell_2_0_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_2_0_para.oz][Proc.lat_hw -1+accum_mf_cell_2_0_para.oy][Proc.lon_hw -1+accum_mf_cell_2_0_para.ox];
    accum_mf_cell_2_0_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_2_0_para.oz][Proc.lat_hw -1+accum_mf_cell_2_0_para.oy][Proc.lon_hw -1+accum_mf_cell_2_0_para.ox];
    
    athread_spawn(accum_mf_cell_2_0, &accum_mf_cell_2_0_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_2_1_info accum_mf_cell_2_1_para;
    accum_mf_cell_2_1_para.lz = 32 - 0;
    accum_mf_cell_2_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_2_1_para.oz = 0;
    accum_mf_cell_2_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_2_1_para.hx = 1;
    accum_mf_cell_2_1_para.hy = 1;
    accum_mf_cell_2_1_para.hz = 0;
    accum_mf_cell_2_1_para.bx = 256;
    accum_mf_cell_2_1_para.by = 8;
    accum_mf_cell_2_1_para.bz = 1;
    accum_mf_cell_2_1_para.mx = 1;
    accum_mf_cell_2_1_para.my = 2;
    accum_mf_cell_2_1_para.mz = 32;
    accum_mf_cell_2_1_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_2_1_para.oz][Proc.lat_hw -1+accum_mf_cell_2_1_para.oy][Proc.lon_hw -1+accum_mf_cell_2_1_para.ox];
    accum_mf_cell_2_1_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_2_1_para.oz][Proc.lat_hw -1+accum_mf_cell_2_1_para.oy][Proc.lon_hw -1+accum_mf_cell_2_1_para.ox];
    
    athread_spawn(accum_mf_cell_2_1, &accum_mf_cell_2_1_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->mf_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_2_info accum_mf_cell_2_2_para;
      accum_mf_cell_2_2_para.lz = 32 - 0;
      accum_mf_cell_2_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_2_para.oz = 0;
      accum_mf_cell_2_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_2_para.hx = 1;
      accum_mf_cell_2_2_para.hy = 1;
      accum_mf_cell_2_2_para.hz = 0;
      accum_mf_cell_2_2_para.bx = 256;
      accum_mf_cell_2_2_para.by = 8;
      accum_mf_cell_2_2_para.bz = 1;
      accum_mf_cell_2_2_para.mx = 1;
      accum_mf_cell_2_2_para.my = 2;
      accum_mf_cell_2_2_para.mz = 32;
      accum_mf_cell_2_2_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_2_2_para.oz][Proc.lat_hw -1+accum_mf_cell_2_2_para.oy][Proc.lon_hw -1+accum_mf_cell_2_2_para.ox];
      accum_mf_cell_2_2_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_2_2_para.oz][Proc.lat_hw -1+accum_mf_cell_2_2_para.oy][Proc.lon_hw -1+accum_mf_cell_2_2_para.ox];
      accum_mf_cell_2_2_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_2_2, &accum_mf_cell_2_2_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_3_info accum_mf_cell_2_3_para;
      accum_mf_cell_2_3_para.lz = 32 - 0;
      accum_mf_cell_2_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_3_para.oz = 0;
      accum_mf_cell_2_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_3_para.hx = 1;
      accum_mf_cell_2_3_para.hy = 1;
      accum_mf_cell_2_3_para.hz = 0;
      accum_mf_cell_2_3_para.bx = 256;
      accum_mf_cell_2_3_para.by = 8;
      accum_mf_cell_2_3_para.bz = 1;
      accum_mf_cell_2_3_para.mx = 1;
      accum_mf_cell_2_3_para.my = 2;
      accum_mf_cell_2_3_para.mz = 32;
      accum_mf_cell_2_3_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_2_3_para.oz][Proc.lat_hw -1+accum_mf_cell_2_3_para.oy][Proc.lon_hw -1+accum_mf_cell_2_3_para.ox];
      accum_mf_cell_2_3_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_2_3_para.oz][Proc.lat_hw -1+accum_mf_cell_2_3_para.oy][Proc.lon_hw -1+accum_mf_cell_2_3_para.ox];
      accum_mf_cell_2_3_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_2_3, &accum_mf_cell_2_3_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_4_info accum_mf_cell_2_4_para;
      accum_mf_cell_2_4_para.lz = 32 - 0;
      accum_mf_cell_2_4_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_4_para.oz = 0;
      accum_mf_cell_2_4_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_4_para.hx = 1;
      accum_mf_cell_2_4_para.hy = 1;
      accum_mf_cell_2_4_para.hz = 0;
      accum_mf_cell_2_4_para.bx = 256;
      accum_mf_cell_2_4_para.by = 8;
      accum_mf_cell_2_4_para.bz = 1;
      accum_mf_cell_2_4_para.mx = 1;
      accum_mf_cell_2_4_para.my = 2;
      accum_mf_cell_2_4_para.mz = 32;
      accum_mf_cell_2_4_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_2_4_para.oz][Proc.lat_hw -1+accum_mf_cell_2_4_para.oy][Proc.lon_hw -1+accum_mf_cell_2_4_para.ox];
      accum_mf_cell_2_4_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_2_4_para.oz][Proc.lat_hw -1+accum_mf_cell_2_4_para.oy][Proc.lon_hw -1+accum_mf_cell_2_4_para.ox];
      
      athread_spawn(accum_mf_cell_2_4, &accum_mf_cell_2_4_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_5_info accum_mf_cell_2_5_para;
      accum_mf_cell_2_5_para.lz = 32 - 0;
      accum_mf_cell_2_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_5_para.oz = 0;
      accum_mf_cell_2_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_5_para.hx = 1;
      accum_mf_cell_2_5_para.hy = 1;
      accum_mf_cell_2_5_para.hz = 0;
      accum_mf_cell_2_5_para.bx = 256;
      accum_mf_cell_2_5_para.by = 8;
      accum_mf_cell_2_5_para.bz = 1;
      accum_mf_cell_2_5_para.mx = 1;
      accum_mf_cell_2_5_para.my = 2;
      accum_mf_cell_2_5_para.mz = 32;
      accum_mf_cell_2_5_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_2_5_para.oz][Proc.lat_hw -1+accum_mf_cell_2_5_para.oy][Proc.lon_hw -1+accum_mf_cell_2_5_para.ox];
      accum_mf_cell_2_5_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_2_5_para.oz][Proc.lat_hw -1+accum_mf_cell_2_5_para.oy][Proc.lon_hw -1+accum_mf_cell_2_5_para.ox];
      
      athread_spawn(accum_mf_cell_2_5, &accum_mf_cell_2_5_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->mf_step) = 0;
  }
  else
  {
    (advPara->mf_step) = ((advPara->mf_step) + 1);
  }
  if ((!(advPara->dynamic) && ((advPara->mf_step) > (advPara->nstep))))
  {
    (advPara->mf_step) = -1;
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_2_2_info calc_mf_2_2_para;
  calc_mf_2_2_para.lz = 32 - 0;
  calc_mf_2_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_2_2_para.oz = 0;
  calc_mf_2_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_2_2_para.hx = 1;
  calc_mf_2_2_para.hy = 1;
  calc_mf_2_2_para.hz = 0;
  calc_mf_2_2_para.bx = 256;
  calc_mf_2_2_para.by = 8;
  calc_mf_2_2_para.bz = 1;
  calc_mf_2_2_para.mx = 1;
  calc_mf_2_2_para.my = 2;
  calc_mf_2_2_para.mz = 32;
  calc_mf_2_2_para.statemfx_lon = &state->mfx_lon[Proc.lev_hw - 0+calc_mf_2_2_para.oz][Proc.lat_hw -1+calc_mf_2_2_para.oy][Proc.lon_hw -1+calc_mf_2_2_para.ox];
  calc_mf_2_2_para.statemfx_lat = &state->mfx_lat[Proc.lev_hw - 0+calc_mf_2_2_para.oz][Proc.lat_hw -1+calc_mf_2_2_para.oy][Proc.lon_hw -1+calc_mf_2_2_para.ox];
  calc_mf_2_2_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+calc_mf_2_2_para.oz][Proc.lat_hw -1+calc_mf_2_2_para.oy][Proc.lon_hw -1+calc_mf_2_2_para.ox];
  calc_mf_2_2_para.stateu_lat = &state->u_lat[Proc.lev_hw - 0+calc_mf_2_2_para.oz][Proc.lat_hw -1+calc_mf_2_2_para.oy][Proc.lon_hw -1+calc_mf_2_2_para.ox];
  calc_mf_2_2_para.half_tangent_wgt_0 = &mesh->half_tangent_wgt_0[0][0][0];
  calc_mf_2_2_para.half_tangent_wgt_1 = &mesh->half_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_2_2, &calc_mf_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_2_3_info calc_mf_2_3_para;
  calc_mf_2_3_para.lz = 32 - 0;
  calc_mf_2_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_2_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_2_3_para.oz = 0;
  calc_mf_2_3_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_2_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_2_3_para.hx = 1;
  calc_mf_2_3_para.hy = 1;
  calc_mf_2_3_para.hz = 0;
  calc_mf_2_3_para.bx = 256;
  calc_mf_2_3_para.by = 8;
  calc_mf_2_3_para.bz = 1;
  calc_mf_2_3_para.mx = 1;
  calc_mf_2_3_para.my = 2;
  calc_mf_2_3_para.mz = 32;
  calc_mf_2_3_para.statemfy_lat = &state->mfy_lat[Proc.lev_hw - 0+calc_mf_2_3_para.oz][Proc.lat_hw -1+calc_mf_2_3_para.oy][Proc.lon_hw -1+calc_mf_2_3_para.ox];
  calc_mf_2_3_para.statemfy_lon = &state->mfy_lon[Proc.lev_hw - 0+calc_mf_2_3_para.oz][Proc.lat_hw -1+calc_mf_2_3_para.oy][Proc.lon_hw -1+calc_mf_2_3_para.ox];
  calc_mf_2_3_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+calc_mf_2_3_para.oz][Proc.lat_hw -1+calc_mf_2_3_para.oy][Proc.lon_hw -1+calc_mf_2_3_para.ox];
  calc_mf_2_3_para.statev_lon = &state->v_lon[Proc.lev_hw - 0+calc_mf_2_3_para.oz][Proc.lat_hw -1+calc_mf_2_3_para.oy][Proc.lon_hw -1+calc_mf_2_3_para.ox];
  calc_mf_2_3_para.full_tangent_wgt_0 = &mesh->full_tangent_wgt_0[0][0][0];
  calc_mf_2_3_para.full_tangent_wgt_1 = &mesh->full_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_2_3, &calc_mf_2_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  ke_vtx = (struct Vector4){0.0,0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_2_0_info calc_ke_2_0_para;
  calc_ke_2_0_para.lz = 32 - 0;
  calc_ke_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_2_0_para.oz = 0;
  calc_ke_2_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_2_0_para.hx = 1;
  calc_ke_2_0_para.hy = 1;
  calc_ke_2_0_para.hz = 0;
  calc_ke_2_0_para.bx = 256;
  calc_ke_2_0_para.by = 8;
  calc_ke_2_0_para.bz = 1;
  calc_ke_2_0_para.mx = 1;
  calc_ke_2_0_para.my = 2;
  calc_ke_2_0_para.mz = 32;
  calc_ke_2_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_ke_2_0_para.oz][Proc.lat_hw -1+calc_ke_2_0_para.oy][Proc.lon_hw -1+calc_ke_2_0_para.ox];
  calc_ke_2_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_ke_2_0_para.oz][Proc.lat_hw -1+calc_ke_2_0_para.oy][Proc.lon_hw -1+calc_ke_2_0_para.ox];
  calc_ke_2_0_para.stateke = &state->ke[Proc.lev_hw - 0+calc_ke_2_0_para.oz][Proc.lat_hw -1+calc_ke_2_0_para.oy][Proc.lon_hw -1+calc_ke_2_0_para.ox];
  calc_ke_2_0_para.area_lon_west = &mesh->area_lon_west[0][0][0];
  calc_ke_2_0_para.area_lon_east = &mesh->area_lon_east[0][0][0];
  calc_ke_2_0_para.area_lat_north = &mesh->area_lat_north[0][0][0];
  calc_ke_2_0_para.area_lat_south = &mesh->area_lat_south[0][0][0];
  calc_ke_2_0_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_2_0, &calc_ke_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_2_1_info calc_ke_2_1_para;
  calc_ke_2_1_para.lz = 32 - 0;
  calc_ke_2_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_2_1_para.oz = 0;
  calc_ke_2_1_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_2_1_para.hx = 1;
  calc_ke_2_1_para.hy = 1;
  calc_ke_2_1_para.hz = 0;
  calc_ke_2_1_para.bx = 256;
  calc_ke_2_1_para.by = 8;
  calc_ke_2_1_para.bz = 1;
  calc_ke_2_1_para.mx = 1;
  calc_ke_2_1_para.my = 2;
  calc_ke_2_1_para.mz = 32;
  calc_ke_2_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_ke_2_1_para.oz][Proc.lat_hw -1+calc_ke_2_1_para.oy][Proc.lon_hw -1+calc_ke_2_1_para.ox];
  calc_ke_2_1_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_ke_2_1_para.oz][Proc.lat_hw -1+calc_ke_2_1_para.oy][Proc.lon_hw -1+calc_ke_2_1_para.ox];
  calc_ke_2_1_para.stateke = &state->ke[Proc.lev_hw - 0+calc_ke_2_1_para.oz][Proc.lat_hw -1+calc_ke_2_1_para.oy][Proc.lon_hw -1+calc_ke_2_1_para.ox];
  calc_ke_2_1_para.area_lat_east = &mesh->area_lat_east[0][0][0];
  calc_ke_2_1_para.area_lat_west = &mesh->area_lat_west[0][0][0];
  calc_ke_2_1_para.area_lon_north = &mesh->area_lon_north[0][0][0];
  calc_ke_2_1_para.area_lon_south = &mesh->area_lon_south[0][0][0];
  calc_ke_2_1_para.area_vtx = &mesh->area_vtx[0][0][0];
  calc_ke_2_1_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  calc_ke_2_1_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  calc_ke_2_1_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_2_1, &calc_ke_2_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_2_2_info calc_ke_2_2_para;
  calc_ke_2_2_para.lz = 32 - 0;
  calc_ke_2_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_ke_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_2_2_para.oz = 0;
  calc_ke_2_2_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_ke_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_2_2_para.hx = 1;
  calc_ke_2_2_para.hy = 1;
  calc_ke_2_2_para.hz = 0;
  calc_ke_2_2_para.bx = 256;
  calc_ke_2_2_para.by = 8;
  calc_ke_2_2_para.bz = 1;
  calc_ke_2_2_para.mx = 1;
  calc_ke_2_2_para.my = 2;
  calc_ke_2_2_para.mz = 32;
  calc_ke_2_2_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_ke_2_2_para.oz][Proc.lat_hw -1+calc_ke_2_2_para.oy][Proc.lon_hw -1+calc_ke_2_2_para.ox];
  calc_ke_2_2_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_ke_2_2_para.oz][Proc.lat_hw -1+calc_ke_2_2_para.oy][Proc.lon_hw -1+calc_ke_2_2_para.ox];
  
  athread_spawn(calc_ke_2_2, &calc_ke_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_ketmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:state->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
  tmp_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_state_tmpsum[k-Proc.lev_hw]=tmp_state_tmpsum[k-Proc.lev_hw]+state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->tmpsum[k][j][i]=tmp_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_2_3_info calc_ke_2_3_para;
  calc_ke_2_3_para.lz = 32 - 0;
  calc_ke_2_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_ke_2_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_2_3_para.oz = 0;
  calc_ke_2_3_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_ke_2_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_2_3_para.hx = 1;
  calc_ke_2_3_para.hy = 1;
  calc_ke_2_3_para.hz = 0;
  calc_ke_2_3_para.bx = 256;
  calc_ke_2_3_para.by = 8;
  calc_ke_2_3_para.bz = 1;
  calc_ke_2_3_para.mx = 1;
  calc_ke_2_3_para.my = 2;
  calc_ke_2_3_para.mz = 32;
  calc_ke_2_3_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_ke_2_3_para.oz][Proc.lat_hw -1+calc_ke_2_3_para.oy][Proc.lon_hw -1+calc_ke_2_3_para.ox];
  calc_ke_2_3_para.stateke = &state->ke[Proc.lev_hw - 0+calc_ke_2_3_para.oz][Proc.lat_hw -1+calc_ke_2_3_para.oy][Proc.lon_hw -1+calc_ke_2_3_para.ox];
  
  athread_spawn(calc_ke_2_3, &calc_ke_2_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->ke[0][0][0], &Proc.FieldReq[async_ke], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_2_0_info calc_vor_2_0_para;
  calc_vor_2_0_para.lz = 32 - 0;
  calc_vor_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_vor_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_2_0_para.oz = 0;
  calc_vor_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_vor_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_2_0_para.hx = 1;
  calc_vor_2_0_para.hy = 1;
  calc_vor_2_0_para.hz = 0;
  calc_vor_2_0_para.bx = 256;
  calc_vor_2_0_para.by = 8;
  calc_vor_2_0_para.bz = 1;
  calc_vor_2_0_para.mx = 1;
  calc_vor_2_0_para.my = 2;
  calc_vor_2_0_para.mz = 32;
  calc_vor_2_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_vor_2_0_para.oz][Proc.lat_hw -1+calc_vor_2_0_para.oy][Proc.lon_hw -1+calc_vor_2_0_para.ox];
  calc_vor_2_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_vor_2_0_para.oz][Proc.lat_hw -1+calc_vor_2_0_para.oy][Proc.lon_hw -1+calc_vor_2_0_para.ox];
  calc_vor_2_0_para.statevor = &state->vor[Proc.lev_hw - 0+calc_vor_2_0_para.oz][Proc.lat_hw -1+calc_vor_2_0_para.oy][Proc.lon_hw -1+calc_vor_2_0_para.ox];
  calc_vor_2_0_para.de_lon = &mesh->de_lon[0][0][0];
  calc_vor_2_0_para.de_lat = &mesh->de_lat[0][0][0];
  calc_vor_2_0_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(calc_vor_2_0, &calc_vor_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vorvorTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_2_1_info calc_vor_2_1_para;
  calc_vor_2_1_para.lz = 32 - 0;
  calc_vor_2_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1198);
  calc_vor_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_2_1_para.oz = 0;
  calc_vor_2_1_para.oy = MAX(Proc.lat_beg, 1198) - Proc.lat_beg;
  calc_vor_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_2_1_para.hx = 0;
  calc_vor_2_1_para.hy = 0;
  calc_vor_2_1_para.hz = 0;
  calc_vor_2_1_para.bx = 256;
  calc_vor_2_1_para.by = 8;
  calc_vor_2_1_para.bz = 1;
  calc_vor_2_1_para.mx = 1;
  calc_vor_2_1_para.my = 2;
  calc_vor_2_1_para.mz = 32;
  calc_vor_2_1_para.stateu_lat = &state->u_lat[Proc.lev_hw - 0+calc_vor_2_1_para.oz][Proc.lat_hw -0+calc_vor_2_1_para.oy][Proc.lon_hw -0+calc_vor_2_1_para.ox];
  calc_vor_2_1_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_vor_2_1_para.oz][Proc.lat_hw -0+calc_vor_2_1_para.oy][Proc.lon_hw -0+calc_vor_2_1_para.ox];
  calc_vor_2_1_para.le_lat = &mesh->le_lat[0][0][0];
  
  athread_spawn(calc_vor_2_1, &calc_vor_2_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vortmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:state->tmpsum.[0, 0, 32, 0, 1198, 1199, 1, 0, 2400]
  tmp_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1198)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_state_tmpsum[k-Proc.lev_hw]=tmp_state_tmpsum[k-Proc.lev_hw]+state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1198)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->tmpsum[k][j][i]=tmp_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_2_2_info calc_vor_2_2_para;
  calc_vor_2_2_para.lz = 32 - 0;
  calc_vor_2_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1198);
  calc_vor_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_2_2_para.oz = 0;
  calc_vor_2_2_para.oy = MAX(Proc.lat_beg, 1198) - Proc.lat_beg;
  calc_vor_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_2_2_para.hx = 0;
  calc_vor_2_2_para.hy = 0;
  calc_vor_2_2_para.hz = 0;
  calc_vor_2_2_para.bx = 256;
  calc_vor_2_2_para.by = 8;
  calc_vor_2_2_para.bz = 1;
  calc_vor_2_2_para.mx = 1;
  calc_vor_2_2_para.my = 2;
  calc_vor_2_2_para.mz = 32;
  calc_vor_2_2_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_vor_2_2_para.oz][Proc.lat_hw -0+calc_vor_2_2_para.oy][Proc.lon_hw -0+calc_vor_2_2_para.ox];
  calc_vor_2_2_para.statevor = &state->vor[Proc.lev_hw - 0+calc_vor_2_2_para.oz][Proc.lat_hw -0+calc_vor_2_2_para.oy][Proc.lon_hw -0+calc_vor_2_2_para.ox];
  calc_vor_2_2_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_vor_2_2, &calc_vor_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vorvorTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_pv_2_0_info calc_pv_2_0_para;
  calc_pv_2_0_para.lz = 32 - 0;
  calc_pv_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_pv_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_pv_2_0_para.oz = 0;
  calc_pv_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_pv_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_pv_2_0_para.hx = 2;
  calc_pv_2_0_para.hy = 2;
  calc_pv_2_0_para.hz = 0;
  calc_pv_2_0_para.bx = 256;
  calc_pv_2_0_para.by = 8;
  calc_pv_2_0_para.bz = 1;
  calc_pv_2_0_para.mx = 1;
  calc_pv_2_0_para.my = 2;
  calc_pv_2_0_para.mz = 32;
  calc_pv_2_0_para.statevor = &state->vor[Proc.lev_hw - 0+calc_pv_2_0_para.oz][Proc.lat_hw -2+calc_pv_2_0_para.oy][Proc.lon_hw -2+calc_pv_2_0_para.ox];
  calc_pv_2_0_para.statem_vtx = &state->m_vtx[Proc.lev_hw - 0+calc_pv_2_0_para.oz][Proc.lat_hw -2+calc_pv_2_0_para.oy][Proc.lon_hw -2+calc_pv_2_0_para.ox];
  calc_pv_2_0_para.statepv = &state->pv[Proc.lev_hw - 0+calc_pv_2_0_para.oz][Proc.lat_hw -2+calc_pv_2_0_para.oy][Proc.lon_hw -2+calc_pv_2_0_para.ox];
  calc_pv_2_0_para.half_f = &mesh->half_f[0][0][0];
  
  athread_spawn(calc_pv_2_0, &calc_pv_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_pvpvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pv[0][0][0], &Proc.FieldReq[async_pv], false, false, true, true, true, true, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_2_0_info interp_pv_upwind_2_0_para;
  interp_pv_upwind_2_0_para.lz = 32 - 0;
  interp_pv_upwind_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  interp_pv_upwind_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_2_0_para.oz = 0;
  interp_pv_upwind_2_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  interp_pv_upwind_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_2_0_para.hx = 2;
  interp_pv_upwind_2_0_para.hy = 2;
  interp_pv_upwind_2_0_para.hz = 0;
  interp_pv_upwind_2_0_para.bx = 256;
  interp_pv_upwind_2_0_para.by = 8;
  interp_pv_upwind_2_0_para.bz = 1;
  interp_pv_upwind_2_0_para.mx = 1;
  interp_pv_upwind_2_0_para.my = 2;
  interp_pv_upwind_2_0_para.mz = 32;
  interp_pv_upwind_2_0_para.statev_lon = &state->v_lon[Proc.lev_hw - 0+interp_pv_upwind_2_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_0_para.ox];
  interp_pv_upwind_2_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+interp_pv_upwind_2_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_0_para.ox];
  interp_pv_upwind_2_0_para.statepv = &state->pv[Proc.lev_hw - 0+interp_pv_upwind_2_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_0_para.ox];
  interp_pv_upwind_2_0_para.statepv_lon = &state->pv_lon[Proc.lev_hw - 0+interp_pv_upwind_2_0_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_0_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_0_para.ox];
  
  athread_spawn(interp_pv_upwind_2_0, &interp_pv_upwind_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pv_lon[0][0][0], &Proc.FieldReq[async_pv_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_2_1_info interp_pv_upwind_2_1_para;
  interp_pv_upwind_2_1_para.lz = 32 - 0;
  interp_pv_upwind_2_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interp_pv_upwind_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_2_1_para.oz = 0;
  interp_pv_upwind_2_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interp_pv_upwind_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_2_1_para.hx = 2;
  interp_pv_upwind_2_1_para.hy = 2;
  interp_pv_upwind_2_1_para.hz = 0;
  interp_pv_upwind_2_1_para.bx = 256;
  interp_pv_upwind_2_1_para.by = 8;
  interp_pv_upwind_2_1_para.bz = 1;
  interp_pv_upwind_2_1_para.mx = 1;
  interp_pv_upwind_2_1_para.my = 2;
  interp_pv_upwind_2_1_para.mz = 32;
  interp_pv_upwind_2_1_para.stateu_lat = &state->u_lat[Proc.lev_hw - 0+interp_pv_upwind_2_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_1_para.ox];
  interp_pv_upwind_2_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+interp_pv_upwind_2_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_1_para.ox];
  interp_pv_upwind_2_1_para.statepv = &state->pv[Proc.lev_hw - 0+interp_pv_upwind_2_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_1_para.ox];
  interp_pv_upwind_2_1_para.statepv_lat = &state->pv_lat[Proc.lev_hw - 0+interp_pv_upwind_2_1_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_1_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_1_para.ox];
  
  athread_spawn(interp_pv_upwind_2_1, &interp_pv_upwind_2_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pv_lat[0][0][0], &Proc.FieldReq[async_pv_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_2_0_info calc_div_2_0_para;
  calc_div_2_0_para.lz = 32 - 0;
  calc_div_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_div_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_2_0_para.oz = 0;
  calc_div_2_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_div_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_2_0_para.hx = 1;
  calc_div_2_0_para.hy = 1;
  calc_div_2_0_para.hz = 0;
  calc_div_2_0_para.bx = 256;
  calc_div_2_0_para.by = 8;
  calc_div_2_0_para.bz = 1;
  calc_div_2_0_para.mx = 1;
  calc_div_2_0_para.my = 2;
  calc_div_2_0_para.mz = 32;
  calc_div_2_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+calc_div_2_0_para.oz][Proc.lat_hw -1+calc_div_2_0_para.oy][Proc.lon_hw -1+calc_div_2_0_para.ox];
  calc_div_2_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_div_2_0_para.oz][Proc.lat_hw -1+calc_div_2_0_para.oy][Proc.lon_hw -1+calc_div_2_0_para.ox];
  calc_div_2_0_para.statediv = &state->div[Proc.lev_hw - 0+calc_div_2_0_para.oz][Proc.lat_hw -1+calc_div_2_0_para.oy][Proc.lon_hw -1+calc_div_2_0_para.ox];
  calc_div_2_0_para.le_lon = &mesh->le_lon[0][0][0];
  calc_div_2_0_para.le_lat = &mesh->le_lat[0][0][0];
  calc_div_2_0_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_div_2_0, &calc_div_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divdivTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_2_1_info calc_div_2_1_para;
  calc_div_2_1_para.lz = 32 - 0;
  calc_div_2_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_div_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_2_1_para.oz = 0;
  calc_div_2_1_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_div_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_2_1_para.hx = 1;
  calc_div_2_1_para.hy = 1;
  calc_div_2_1_para.hz = 0;
  calc_div_2_1_para.bx = 256;
  calc_div_2_1_para.by = 8;
  calc_div_2_1_para.bz = 1;
  calc_div_2_1_para.mx = 1;
  calc_div_2_1_para.my = 2;
  calc_div_2_1_para.mz = 32;
  calc_div_2_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+calc_div_2_1_para.oz][Proc.lat_hw -1+calc_div_2_1_para.oy][Proc.lon_hw -1+calc_div_2_1_para.ox];
  calc_div_2_1_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_div_2_1_para.oz][Proc.lat_hw -1+calc_div_2_1_para.oy][Proc.lon_hw -1+calc_div_2_1_para.ox];
  
  athread_spawn(calc_div_2_1, &calc_div_2_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divtmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:state->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
  tmp_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_state_tmpsum[k-Proc.lev_hw]=tmp_state_tmpsum[k-Proc.lev_hw]+state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->tmpsum[k][j][i]=tmp_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_2_2_info calc_div_2_2_para;
  calc_div_2_2_para.lz = 32 - 0;
  calc_div_2_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_div_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_2_2_para.oz = 0;
  calc_div_2_2_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_div_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_2_2_para.hx = 1;
  calc_div_2_2_para.hy = 1;
  calc_div_2_2_para.hz = 0;
  calc_div_2_2_para.bx = 256;
  calc_div_2_2_para.by = 8;
  calc_div_2_2_para.bz = 1;
  calc_div_2_2_para.mx = 1;
  calc_div_2_2_para.my = 2;
  calc_div_2_2_para.mz = 32;
  calc_div_2_2_para.statetmpsum = &state->tmpsum[Proc.lev_hw - 0+calc_div_2_2_para.oz][Proc.lat_hw -1+calc_div_2_2_para.oy][Proc.lon_hw -1+calc_div_2_2_para.ox];
  calc_div_2_2_para.statediv = &state->div[Proc.lev_hw - 0+calc_div_2_2_para.oz][Proc.lat_hw -1+calc_div_2_2_para.oy][Proc.lon_hw -1+calc_div_2_2_para.ox];
  calc_div_2_2_para.le_lat = &mesh->le_lat[0][0][0];
  calc_div_2_2_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_div_2_2, &calc_div_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divdivTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->div[0][0][0], &Proc.FieldReq[async_div], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_gz_lev_2_0_info calc_gz_lev_2_0_para;
  calc_gz_lev_2_0_para.lz = 32 - 0;
  calc_gz_lev_2_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_gz_lev_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_gz_lev_2_0_para.oz = 0;
  calc_gz_lev_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_gz_lev_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_gz_lev_2_0_para.hx = 1;
  calc_gz_lev_2_0_para.hy = 0;
  calc_gz_lev_2_0_para.hz = Proc.lev_hw;
  calc_gz_lev_2_0_para.bx = 64;
  calc_gz_lev_2_0_para.by = 1;
  calc_gz_lev_2_0_para.bz = 32;
  calc_gz_lev_2_0_para.mx = 8;
  calc_gz_lev_2_0_para.my = 8;
  calc_gz_lev_2_0_para.mz = 1;
  calc_gz_lev_2_0_para.statet = &state->t[Proc.lev_hw - calc_gz_lev_2_0_para.hz+calc_gz_lev_2_0_para.oz][Proc.lat_hw -0+calc_gz_lev_2_0_para.oy][Proc.lon_hw -1+calc_gz_lev_2_0_para.ox];
  calc_gz_lev_2_0_para.stateph_lev = &state->ph_lev[Proc.lev_hw - calc_gz_lev_2_0_para.hz+calc_gz_lev_2_0_para.oz][Proc.lat_hw -0+calc_gz_lev_2_0_para.oy][Proc.lon_hw -1+calc_gz_lev_2_0_para.ox];
  calc_gz_lev_2_0_para.staticvgzs = &staticv->gzs[0][Proc.lat_hw -0+calc_gz_lev_2_0_para.oy][Proc.lon_hw -1+calc_gz_lev_2_0_para.ox];
  calc_gz_lev_2_0_para.stategz_lev = &state->gz_lev[Proc.lev_hw - calc_gz_lev_2_0_para.hz+calc_gz_lev_2_0_para.oz][Proc.lat_hw -0+calc_gz_lev_2_0_para.oy][Proc.lon_hw -1+calc_gz_lev_2_0_para.ox];
  
  athread_spawn(calc_gz_lev_2_0, &calc_gz_lev_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_gz_levgz_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->gz_lev[0][0][0], &Proc.FieldReq[async_gz_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void advPrepare_2(struct HybridStateField* state, struct HybridAdvField* advm, struct HybridAdvField* advpt)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  copy_old_m_2_0_info copy_old_m_2_0_para;
  copy_old_m_2_0_para.lz = 32 - 0;
  copy_old_m_2_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  copy_old_m_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  copy_old_m_2_0_para.oz = 0;
  copy_old_m_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  copy_old_m_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  copy_old_m_2_0_para.hx = 1;
  copy_old_m_2_0_para.hy = 1;
  copy_old_m_2_0_para.hz = 0;
  copy_old_m_2_0_para.bx = 256;
  copy_old_m_2_0_para.by = 8;
  copy_old_m_2_0_para.bz = 1;
  copy_old_m_2_0_para.mx = 1;
  copy_old_m_2_0_para.my = 2;
  copy_old_m_2_0_para.mz = 32;
  copy_old_m_2_0_para.statem = &state->m[Proc.lev_hw - 0+copy_old_m_2_0_para.oz][Proc.lat_hw -1+copy_old_m_2_0_para.oy][Proc.lon_hw -1+copy_old_m_2_0_para.ox];
  copy_old_m_2_0_para.advmold_m = &advm->old_m[Proc.lev_hw - 0+copy_old_m_2_0_para.oz][Proc.lat_hw -1+copy_old_m_2_0_para.oy][Proc.lon_hw -1+copy_old_m_2_0_para.ox];
  
  athread_spawn(copy_old_m_2_0, &copy_old_m_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  copy_old_mold_mTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  copy_old_m_2_1_info copy_old_m_2_1_para;
  copy_old_m_2_1_para.lz = 32 - 0;
  copy_old_m_2_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  copy_old_m_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  copy_old_m_2_1_para.oz = 0;
  copy_old_m_2_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  copy_old_m_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  copy_old_m_2_1_para.hx = 1;
  copy_old_m_2_1_para.hy = 1;
  copy_old_m_2_1_para.hz = 0;
  copy_old_m_2_1_para.bx = 256;
  copy_old_m_2_1_para.by = 8;
  copy_old_m_2_1_para.bz = 1;
  copy_old_m_2_1_para.mx = 1;
  copy_old_m_2_1_para.my = 2;
  copy_old_m_2_1_para.mz = 32;
  copy_old_m_2_1_para.statem = &state->m[Proc.lev_hw - 0+copy_old_m_2_1_para.oz][Proc.lat_hw -1+copy_old_m_2_1_para.oy][Proc.lon_hw -1+copy_old_m_2_1_para.ox];
  copy_old_m_2_1_para.advptold_m = &advpt->old_m[Proc.lev_hw - 0+copy_old_m_2_1_para.oz][Proc.lat_hw -1+copy_old_m_2_1_para.oy][Proc.lon_hw -1+copy_old_m_2_1_para.ox];
  
  athread_spawn(copy_old_m_2_1, &copy_old_m_2_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  copy_old_mold_mTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void filterinit_2(struct HybridMeshField* mesh, double dt)
{
  Filter_Init(mesh,dt);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_InitTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void stepForwardBackward_2(struct HybridStateField* old_state, struct HybridStateField* star_state, struct HybridStateField* new_state, struct HybridStaticField* staticv, struct HybridTendField* tend1, struct HybridTendField* tend2, struct HybridTendPara* tendPara, struct HybridAdvField* advpt, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  double b, mfs, cursum, cf, s1, s2, ds1, ds2, ds3, dgz, tl, dph1, dph2, dgz1, dgz2;
  int k, j, i, l, ci;
  double *tmp_star_state_tmpsum;
  struct Vector4 ke_vtx;
  struct Vector3 buf;
  tendPara = tendPara;
  advPara = advPara;
  dt = dt;
  tendPara = tendPara;
  (tendPara->u) = 0;
  (tendPara->v) = 0;
  (tendPara->pt) = 0;
  (tendPara->gz) = 0;
  (tendPara->phs) = 0;
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  if (((advPara->uv_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_45_info accum_uv_cell_2_45_para;
    accum_uv_cell_2_45_para.lz = 32 - 0;
    accum_uv_cell_2_45_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_45_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_45_para.oz = 0;
    accum_uv_cell_2_45_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_45_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_45_para.hx = 1;
    accum_uv_cell_2_45_para.hy = 0;
    accum_uv_cell_2_45_para.hz = 0;
    accum_uv_cell_2_45_para.bx = 256;
    accum_uv_cell_2_45_para.by = 8;
    accum_uv_cell_2_45_para.bz = 1;
    accum_uv_cell_2_45_para.mx = 1;
    accum_uv_cell_2_45_para.my = 2;
    accum_uv_cell_2_45_para.mz = 32;
    accum_uv_cell_2_45_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_2_45_para.oz][Proc.lat_hw -0+accum_uv_cell_2_45_para.oy][Proc.lon_hw -1+accum_uv_cell_2_45_para.ox];
    accum_uv_cell_2_45_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_45_para.oz][Proc.lat_hw -0+accum_uv_cell_2_45_para.oy][Proc.lon_hw -1+accum_uv_cell_2_45_para.ox];
    
    athread_spawn(accum_uv_cell_2_45, &accum_uv_cell_2_45_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_46_info accum_uv_cell_2_46_para;
    accum_uv_cell_2_46_para.lz = 32 - 0;
    accum_uv_cell_2_46_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_46_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_46_para.oz = 0;
    accum_uv_cell_2_46_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_46_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_46_para.hx = 0;
    accum_uv_cell_2_46_para.hy = 1;
    accum_uv_cell_2_46_para.hz = 0;
    accum_uv_cell_2_46_para.bx = 256;
    accum_uv_cell_2_46_para.by = 8;
    accum_uv_cell_2_46_para.bz = 1;
    accum_uv_cell_2_46_para.mx = 1;
    accum_uv_cell_2_46_para.my = 2;
    accum_uv_cell_2_46_para.mz = 32;
    accum_uv_cell_2_46_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_2_46_para.oz][Proc.lat_hw -1+accum_uv_cell_2_46_para.oy][Proc.lon_hw -0+accum_uv_cell_2_46_para.ox];
    accum_uv_cell_2_46_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_46_para.oz][Proc.lat_hw -1+accum_uv_cell_2_46_para.oy][Proc.lon_hw -0+accum_uv_cell_2_46_para.ox];
    
    athread_spawn(accum_uv_cell_2_46, &accum_uv_cell_2_46_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->uv_step) = 1;
  }
  if (((advPara->uv_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_47_info accum_uv_cell_2_47_para;
    accum_uv_cell_2_47_para.lz = 32 - 0;
    accum_uv_cell_2_47_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_47_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_47_para.oz = 0;
    accum_uv_cell_2_47_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_47_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_47_para.hx = 1;
    accum_uv_cell_2_47_para.hy = 1;
    accum_uv_cell_2_47_para.hz = 0;
    accum_uv_cell_2_47_para.bx = 256;
    accum_uv_cell_2_47_para.by = 8;
    accum_uv_cell_2_47_para.bz = 1;
    accum_uv_cell_2_47_para.mx = 1;
    accum_uv_cell_2_47_para.my = 2;
    accum_uv_cell_2_47_para.mz = 32;
    accum_uv_cell_2_47_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+accum_uv_cell_2_47_para.oz][Proc.lat_hw -1+accum_uv_cell_2_47_para.oy][Proc.lon_hw -1+accum_uv_cell_2_47_para.ox];
    accum_uv_cell_2_47_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_47_para.oz][Proc.lat_hw -1+accum_uv_cell_2_47_para.oy][Proc.lon_hw -1+accum_uv_cell_2_47_para.ox];
    
    athread_spawn(accum_uv_cell_2_47, &accum_uv_cell_2_47_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_48_info accum_uv_cell_2_48_para;
    accum_uv_cell_2_48_para.lz = 32 - 0;
    accum_uv_cell_2_48_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_48_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_48_para.oz = 0;
    accum_uv_cell_2_48_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_48_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_48_para.hx = 1;
    accum_uv_cell_2_48_para.hy = 1;
    accum_uv_cell_2_48_para.hz = 0;
    accum_uv_cell_2_48_para.bx = 256;
    accum_uv_cell_2_48_para.by = 8;
    accum_uv_cell_2_48_para.bz = 1;
    accum_uv_cell_2_48_para.mx = 1;
    accum_uv_cell_2_48_para.my = 2;
    accum_uv_cell_2_48_para.mz = 32;
    accum_uv_cell_2_48_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+accum_uv_cell_2_48_para.oz][Proc.lat_hw -1+accum_uv_cell_2_48_para.oy][Proc.lon_hw -1+accum_uv_cell_2_48_para.ox];
    accum_uv_cell_2_48_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_48_para.oz][Proc.lat_hw -1+accum_uv_cell_2_48_para.oy][Proc.lon_hw -1+accum_uv_cell_2_48_para.ox];
    
    athread_spawn(accum_uv_cell_2_48, &accum_uv_cell_2_48_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->uv_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_49_info accum_uv_cell_2_49_para;
      accum_uv_cell_2_49_para.lz = 32 - 0;
      accum_uv_cell_2_49_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_49_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_49_para.oz = 0;
      accum_uv_cell_2_49_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_49_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_49_para.hx = 1;
      accum_uv_cell_2_49_para.hy = 1;
      accum_uv_cell_2_49_para.hz = 0;
      accum_uv_cell_2_49_para.bx = 256;
      accum_uv_cell_2_49_para.by = 8;
      accum_uv_cell_2_49_para.bz = 1;
      accum_uv_cell_2_49_para.mx = 1;
      accum_uv_cell_2_49_para.my = 2;
      accum_uv_cell_2_49_para.mz = 32;
      accum_uv_cell_2_49_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_49_para.oz][Proc.lat_hw -1+accum_uv_cell_2_49_para.oy][Proc.lon_hw -1+accum_uv_cell_2_49_para.ox];
      accum_uv_cell_2_49_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+accum_uv_cell_2_49_para.oz][Proc.lat_hw -1+accum_uv_cell_2_49_para.oy][Proc.lon_hw -1+accum_uv_cell_2_49_para.ox];
      accum_uv_cell_2_49_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_2_49, &accum_uv_cell_2_49_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_50_info accum_uv_cell_2_50_para;
      accum_uv_cell_2_50_para.lz = 32 - 0;
      accum_uv_cell_2_50_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_50_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_50_para.oz = 0;
      accum_uv_cell_2_50_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_50_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_50_para.hx = 1;
      accum_uv_cell_2_50_para.hy = 1;
      accum_uv_cell_2_50_para.hz = 0;
      accum_uv_cell_2_50_para.bx = 256;
      accum_uv_cell_2_50_para.by = 8;
      accum_uv_cell_2_50_para.bz = 1;
      accum_uv_cell_2_50_para.mx = 1;
      accum_uv_cell_2_50_para.my = 2;
      accum_uv_cell_2_50_para.mz = 32;
      accum_uv_cell_2_50_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_50_para.oz][Proc.lat_hw -1+accum_uv_cell_2_50_para.oy][Proc.lon_hw -1+accum_uv_cell_2_50_para.ox];
      accum_uv_cell_2_50_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+accum_uv_cell_2_50_para.oz][Proc.lat_hw -1+accum_uv_cell_2_50_para.oy][Proc.lon_hw -1+accum_uv_cell_2_50_para.ox];
      accum_uv_cell_2_50_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_2_50, &accum_uv_cell_2_50_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_51_info accum_uv_cell_2_51_para;
      accum_uv_cell_2_51_para.lz = 32 - 0;
      accum_uv_cell_2_51_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_51_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_51_para.oz = 0;
      accum_uv_cell_2_51_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_51_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_51_para.hx = 1;
      accum_uv_cell_2_51_para.hy = 0;
      accum_uv_cell_2_51_para.hz = 0;
      accum_uv_cell_2_51_para.bx = 256;
      accum_uv_cell_2_51_para.by = 8;
      accum_uv_cell_2_51_para.bz = 1;
      accum_uv_cell_2_51_para.mx = 1;
      accum_uv_cell_2_51_para.my = 2;
      accum_uv_cell_2_51_para.mz = 32;
      accum_uv_cell_2_51_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_51_para.oz][Proc.lat_hw -0+accum_uv_cell_2_51_para.oy][Proc.lon_hw -1+accum_uv_cell_2_51_para.ox];
      accum_uv_cell_2_51_para.advptu0 = &advpt->u0[Proc.lev_hw - 0+accum_uv_cell_2_51_para.oz][Proc.lat_hw -0+accum_uv_cell_2_51_para.oy][Proc.lon_hw -1+accum_uv_cell_2_51_para.ox];
      
      athread_spawn(accum_uv_cell_2_51, &accum_uv_cell_2_51_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellu0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_52_info accum_uv_cell_2_52_para;
      accum_uv_cell_2_52_para.lz = 32 - 0;
      accum_uv_cell_2_52_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_52_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_52_para.oz = 0;
      accum_uv_cell_2_52_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_52_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_52_para.hx = 0;
      accum_uv_cell_2_52_para.hy = 1;
      accum_uv_cell_2_52_para.hz = 0;
      accum_uv_cell_2_52_para.bx = 256;
      accum_uv_cell_2_52_para.by = 8;
      accum_uv_cell_2_52_para.bz = 1;
      accum_uv_cell_2_52_para.mx = 1;
      accum_uv_cell_2_52_para.my = 2;
      accum_uv_cell_2_52_para.mz = 32;
      accum_uv_cell_2_52_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_52_para.oz][Proc.lat_hw -1+accum_uv_cell_2_52_para.oy][Proc.lon_hw -0+accum_uv_cell_2_52_para.ox];
      accum_uv_cell_2_52_para.advptv0 = &advpt->v0[Proc.lev_hw - 0+accum_uv_cell_2_52_para.oz][Proc.lat_hw -1+accum_uv_cell_2_52_para.oy][Proc.lon_hw -0+accum_uv_cell_2_52_para.ox];
      
      athread_spawn(accum_uv_cell_2_52, &accum_uv_cell_2_52_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellv0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_53_info accum_uv_cell_2_53_para;
      accum_uv_cell_2_53_para.lz = 32 - 0;
      accum_uv_cell_2_53_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_53_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_53_para.oz = 0;
      accum_uv_cell_2_53_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_53_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_53_para.hx = 1;
      accum_uv_cell_2_53_para.hy = 1;
      accum_uv_cell_2_53_para.hz = 0;
      accum_uv_cell_2_53_para.bx = 256;
      accum_uv_cell_2_53_para.by = 8;
      accum_uv_cell_2_53_para.bz = 1;
      accum_uv_cell_2_53_para.mx = 1;
      accum_uv_cell_2_53_para.my = 2;
      accum_uv_cell_2_53_para.mz = 32;
      accum_uv_cell_2_53_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_53_para.oz][Proc.lat_hw -1+accum_uv_cell_2_53_para.oy][Proc.lon_hw -1+accum_uv_cell_2_53_para.ox];
      accum_uv_cell_2_53_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+accum_uv_cell_2_53_para.oz][Proc.lat_hw -1+accum_uv_cell_2_53_para.oy][Proc.lon_hw -1+accum_uv_cell_2_53_para.ox];
      
      athread_spawn(accum_uv_cell_2_53, &accum_uv_cell_2_53_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_54_info accum_uv_cell_2_54_para;
      accum_uv_cell_2_54_para.lz = 32 - 0;
      accum_uv_cell_2_54_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_54_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_54_para.oz = 0;
      accum_uv_cell_2_54_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_54_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_54_para.hx = 1;
      accum_uv_cell_2_54_para.hy = 1;
      accum_uv_cell_2_54_para.hz = 0;
      accum_uv_cell_2_54_para.bx = 256;
      accum_uv_cell_2_54_para.by = 8;
      accum_uv_cell_2_54_para.bz = 1;
      accum_uv_cell_2_54_para.mx = 1;
      accum_uv_cell_2_54_para.my = 2;
      accum_uv_cell_2_54_para.mz = 32;
      accum_uv_cell_2_54_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_54_para.oz][Proc.lat_hw -1+accum_uv_cell_2_54_para.oy][Proc.lon_hw -1+accum_uv_cell_2_54_para.ox];
      accum_uv_cell_2_54_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+accum_uv_cell_2_54_para.oz][Proc.lat_hw -1+accum_uv_cell_2_54_para.oy][Proc.lon_hw -1+accum_uv_cell_2_54_para.ox];
      
      athread_spawn(accum_uv_cell_2_54, &accum_uv_cell_2_54_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &advpt->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->uv_step) = 0;
  }
  else
  {
    (advPara->uv_step) = ((advPara->uv_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->uv_step) > (advPara->nstep))))
  {
    if (!(advPara->dynamic))
    {
      (advPara->uv_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_55_info accum_uv_cell_2_55_para;
    accum_uv_cell_2_55_para.lz = 32 - 0;
    accum_uv_cell_2_55_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_2_55_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_55_para.oz = 0;
    accum_uv_cell_2_55_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_2_55_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_55_para.hx = 1;
    accum_uv_cell_2_55_para.hy = 0;
    accum_uv_cell_2_55_para.hz = 0;
    accum_uv_cell_2_55_para.bx = 256;
    accum_uv_cell_2_55_para.by = 8;
    accum_uv_cell_2_55_para.bz = 1;
    accum_uv_cell_2_55_para.mx = 1;
    accum_uv_cell_2_55_para.my = 2;
    accum_uv_cell_2_55_para.mz = 32;
    accum_uv_cell_2_55_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_55_para.oz][Proc.lat_hw -0+accum_uv_cell_2_55_para.oy][Proc.lon_hw -1+accum_uv_cell_2_55_para.ox];
    accum_uv_cell_2_55_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+accum_uv_cell_2_55_para.oz][Proc.lat_hw -0+accum_uv_cell_2_55_para.oy][Proc.lon_hw -1+accum_uv_cell_2_55_para.ox];
    accum_uv_cell_2_55_para.de_lon = &mesh->de_lon[0][0][0];
    accum_uv_cell_2_55_para.dt = dt;
    
    athread_spawn(accum_uv_cell_2_55, &accum_uv_cell_2_55_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_56_info accum_uv_cell_2_56_para;
    accum_uv_cell_2_56_para.lz = 32 - 0;
    accum_uv_cell_2_56_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_56_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_56_para.oz = 0;
    accum_uv_cell_2_56_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_56_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_56_para.hx = 0;
    accum_uv_cell_2_56_para.hy = 1;
    accum_uv_cell_2_56_para.hz = 0;
    accum_uv_cell_2_56_para.bx = 256;
    accum_uv_cell_2_56_para.by = 8;
    accum_uv_cell_2_56_para.bz = 1;
    accum_uv_cell_2_56_para.mx = 1;
    accum_uv_cell_2_56_para.my = 2;
    accum_uv_cell_2_56_para.mz = 32;
    accum_uv_cell_2_56_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_56_para.oz][Proc.lat_hw -1+accum_uv_cell_2_56_para.oy][Proc.lon_hw -0+accum_uv_cell_2_56_para.ox];
    accum_uv_cell_2_56_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+accum_uv_cell_2_56_para.oz][Proc.lat_hw -1+accum_uv_cell_2_56_para.oy][Proc.lon_hw -0+accum_uv_cell_2_56_para.ox];
    accum_uv_cell_2_56_para.de_lat = &mesh->de_lat[0][0][0];
    accum_uv_cell_2_56_para.dt = dt;
    
    athread_spawn(accum_uv_cell_2_56, &accum_uv_cell_2_56_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_57_info accum_uv_cell_2_57_para;
    accum_uv_cell_2_57_para.lz = 32 - 0;
    accum_uv_cell_2_57_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_2_57_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_57_para.oz = 0;
    accum_uv_cell_2_57_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_2_57_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_57_para.hx = 1;
    accum_uv_cell_2_57_para.hy = 1;
    accum_uv_cell_2_57_para.hz = 0;
    accum_uv_cell_2_57_para.bx = 256;
    accum_uv_cell_2_57_para.by = 8;
    accum_uv_cell_2_57_para.bz = 1;
    accum_uv_cell_2_57_para.mx = 1;
    accum_uv_cell_2_57_para.my = 2;
    accum_uv_cell_2_57_para.mz = 32;
    accum_uv_cell_2_57_para.advptuu = &advpt->uu[Proc.lev_hw - 0+accum_uv_cell_2_57_para.oz][Proc.lat_hw -1+accum_uv_cell_2_57_para.oy][Proc.lon_hw -1+accum_uv_cell_2_57_para.ox];
    accum_uv_cell_2_57_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_57_para.oz][Proc.lat_hw -1+accum_uv_cell_2_57_para.oy][Proc.lon_hw -1+accum_uv_cell_2_57_para.ox];
    accum_uv_cell_2_57_para.advptdivx = &advpt->divx[Proc.lev_hw - 0+accum_uv_cell_2_57_para.oz][Proc.lat_hw -1+accum_uv_cell_2_57_para.oy][Proc.lon_hw -1+accum_uv_cell_2_57_para.ox];
    accum_uv_cell_2_57_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+accum_uv_cell_2_57_para.oz][Proc.lat_hw -1+accum_uv_cell_2_57_para.oy][Proc.lon_hw -1+accum_uv_cell_2_57_para.ox];
    accum_uv_cell_2_57_para.le_lon = &mesh->le_lon[0][0][0];
    accum_uv_cell_2_57_para.area_cell = &mesh->area_cell[0][0][0];
    accum_uv_cell_2_57_para.le_lat = &mesh->le_lat[0][0][0];
    
    athread_spawn(accum_uv_cell_2_57, &accum_uv_cell_2_57_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_58_info accum_uv_cell_2_58_para;
    accum_uv_cell_2_58_para.lz = 32 - 0;
    accum_uv_cell_2_58_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
    accum_uv_cell_2_58_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_58_para.oz = 0;
    accum_uv_cell_2_58_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
    accum_uv_cell_2_58_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_58_para.hx = 0;
    accum_uv_cell_2_58_para.hy = 1;
    accum_uv_cell_2_58_para.hz = 0;
    accum_uv_cell_2_58_para.bx = 256;
    accum_uv_cell_2_58_para.by = 8;
    accum_uv_cell_2_58_para.bz = 1;
    accum_uv_cell_2_58_para.mx = 1;
    accum_uv_cell_2_58_para.my = 2;
    accum_uv_cell_2_58_para.mz = 32;
    accum_uv_cell_2_58_para.advptvv = &advpt->vv[Proc.lev_hw - 0+accum_uv_cell_2_58_para.oz][Proc.lat_hw -1+accum_uv_cell_2_58_para.oy][Proc.lon_hw -0+accum_uv_cell_2_58_para.ox];
    accum_uv_cell_2_58_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+accum_uv_cell_2_58_para.oz][Proc.lat_hw -1+accum_uv_cell_2_58_para.oy][Proc.lon_hw -0+accum_uv_cell_2_58_para.ox];
    
    athread_spawn(accum_uv_cell_2_58, &accum_uv_cell_2_58_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celltmpsumTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    // SumCall:star_state->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
    tmp_star_state_tmpsum = allocate_1d_array_D(32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
        }
      }
    }
    Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
        }
      }
    }
    free_1d_array_D(tmp_star_state_tmpsum,32);
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_59_info accum_uv_cell_2_59_para;
    accum_uv_cell_2_59_para.lz = 32 - 0;
    accum_uv_cell_2_59_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
    accum_uv_cell_2_59_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_59_para.oz = 0;
    accum_uv_cell_2_59_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
    accum_uv_cell_2_59_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_59_para.hx = 0;
    accum_uv_cell_2_59_para.hy = 0;
    accum_uv_cell_2_59_para.hz = 0;
    accum_uv_cell_2_59_para.bx = 256;
    accum_uv_cell_2_59_para.by = 8;
    accum_uv_cell_2_59_para.bz = 1;
    accum_uv_cell_2_59_para.mx = 1;
    accum_uv_cell_2_59_para.my = 2;
    accum_uv_cell_2_59_para.mz = 32;
    accum_uv_cell_2_59_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+accum_uv_cell_2_59_para.oz][Proc.lat_hw -0+accum_uv_cell_2_59_para.oy][Proc.lon_hw -0+accum_uv_cell_2_59_para.ox];
    accum_uv_cell_2_59_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+accum_uv_cell_2_59_para.oz][Proc.lat_hw -0+accum_uv_cell_2_59_para.oy][Proc.lon_hw -0+accum_uv_cell_2_59_para.ox];
    accum_uv_cell_2_59_para.le_lat = &mesh->le_lat[0][0][0];
    accum_uv_cell_2_59_para.area_cell = &mesh->area_cell[0][0][0];
    
    athread_spawn(accum_uv_cell_2_59, &accum_uv_cell_2_59_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_2_12_info calc_mf_2_12_para;
  calc_mf_2_12_para.lz = 32 - 0;
  calc_mf_2_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_2_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_2_12_para.oz = 0;
  calc_mf_2_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_2_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_2_12_para.hx = 1;
  calc_mf_2_12_para.hy = 1;
  calc_mf_2_12_para.hz = 0;
  calc_mf_2_12_para.bx = 256;
  calc_mf_2_12_para.by = 8;
  calc_mf_2_12_para.bz = 1;
  calc_mf_2_12_para.mx = 1;
  calc_mf_2_12_para.my = 2;
  calc_mf_2_12_para.mz = 32;
  calc_mf_2_12_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 0+calc_mf_2_12_para.oz][Proc.lat_hw -1+calc_mf_2_12_para.oy][Proc.lon_hw -1+calc_mf_2_12_para.ox];
  calc_mf_2_12_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_mf_2_12_para.oz][Proc.lat_hw -1+calc_mf_2_12_para.oy][Proc.lon_hw -1+calc_mf_2_12_para.ox];
  calc_mf_2_12_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_mf_2_12_para.oz][Proc.lat_hw -1+calc_mf_2_12_para.oy][Proc.lon_hw -1+calc_mf_2_12_para.ox];
  
  athread_spawn(calc_mf_2_12, &calc_mf_2_12_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->mfx_lon[0][0][0], &Proc.FieldReq[async_mfx_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_2_13_info calc_mf_2_13_para;
  calc_mf_2_13_para.lz = 32 - 0;
  calc_mf_2_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_2_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_2_13_para.oz = 0;
  calc_mf_2_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_2_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_2_13_para.hx = 1;
  calc_mf_2_13_para.hy = 1;
  calc_mf_2_13_para.hz = 0;
  calc_mf_2_13_para.bx = 256;
  calc_mf_2_13_para.by = 8;
  calc_mf_2_13_para.bz = 1;
  calc_mf_2_13_para.mx = 1;
  calc_mf_2_13_para.my = 2;
  calc_mf_2_13_para.mz = 32;
  calc_mf_2_13_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 0+calc_mf_2_13_para.oz][Proc.lat_hw -1+calc_mf_2_13_para.oy][Proc.lon_hw -1+calc_mf_2_13_para.ox];
  calc_mf_2_13_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_mf_2_13_para.oz][Proc.lat_hw -1+calc_mf_2_13_para.oy][Proc.lon_hw -1+calc_mf_2_13_para.ox];
  calc_mf_2_13_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_mf_2_13_para.oz][Proc.lat_hw -1+calc_mf_2_13_para.oy][Proc.lon_hw -1+calc_mf_2_13_para.ox];
  
  athread_spawn(calc_mf_2_13, &calc_mf_2_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->mfy_lat[0][0][0], &Proc.FieldReq[async_mfy_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  if (((advPara->mf_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfx[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          advpt->mfy[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->mf_step) = 1;
  }
  if (((advPara->mf_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_2_18_info accum_mf_cell_2_18_para;
    accum_mf_cell_2_18_para.lz = 32 - 0;
    accum_mf_cell_2_18_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_2_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_2_18_para.oz = 0;
    accum_mf_cell_2_18_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_2_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_2_18_para.hx = 1;
    accum_mf_cell_2_18_para.hy = 1;
    accum_mf_cell_2_18_para.hz = 0;
    accum_mf_cell_2_18_para.bx = 256;
    accum_mf_cell_2_18_para.by = 8;
    accum_mf_cell_2_18_para.bz = 1;
    accum_mf_cell_2_18_para.mx = 1;
    accum_mf_cell_2_18_para.my = 2;
    accum_mf_cell_2_18_para.mz = 32;
    accum_mf_cell_2_18_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_2_18_para.oz][Proc.lat_hw -1+accum_mf_cell_2_18_para.oy][Proc.lon_hw -1+accum_mf_cell_2_18_para.ox];
    accum_mf_cell_2_18_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_2_18_para.oz][Proc.lat_hw -1+accum_mf_cell_2_18_para.oy][Proc.lon_hw -1+accum_mf_cell_2_18_para.ox];
    
    athread_spawn(accum_mf_cell_2_18, &accum_mf_cell_2_18_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_2_19_info accum_mf_cell_2_19_para;
    accum_mf_cell_2_19_para.lz = 32 - 0;
    accum_mf_cell_2_19_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_2_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_2_19_para.oz = 0;
    accum_mf_cell_2_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_2_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_2_19_para.hx = 1;
    accum_mf_cell_2_19_para.hy = 1;
    accum_mf_cell_2_19_para.hz = 0;
    accum_mf_cell_2_19_para.bx = 256;
    accum_mf_cell_2_19_para.by = 8;
    accum_mf_cell_2_19_para.bz = 1;
    accum_mf_cell_2_19_para.mx = 1;
    accum_mf_cell_2_19_para.my = 2;
    accum_mf_cell_2_19_para.mz = 32;
    accum_mf_cell_2_19_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_2_19_para.oz][Proc.lat_hw -1+accum_mf_cell_2_19_para.oy][Proc.lon_hw -1+accum_mf_cell_2_19_para.ox];
    accum_mf_cell_2_19_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_2_19_para.oz][Proc.lat_hw -1+accum_mf_cell_2_19_para.oy][Proc.lon_hw -1+accum_mf_cell_2_19_para.ox];
    
    athread_spawn(accum_mf_cell_2_19, &accum_mf_cell_2_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->mf_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_20_info accum_mf_cell_2_20_para;
      accum_mf_cell_2_20_para.lz = 32 - 0;
      accum_mf_cell_2_20_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_20_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_20_para.oz = 0;
      accum_mf_cell_2_20_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_20_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_20_para.hx = 1;
      accum_mf_cell_2_20_para.hy = 1;
      accum_mf_cell_2_20_para.hz = 0;
      accum_mf_cell_2_20_para.bx = 256;
      accum_mf_cell_2_20_para.by = 8;
      accum_mf_cell_2_20_para.bz = 1;
      accum_mf_cell_2_20_para.mx = 1;
      accum_mf_cell_2_20_para.my = 2;
      accum_mf_cell_2_20_para.mz = 32;
      accum_mf_cell_2_20_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_2_20_para.oz][Proc.lat_hw -1+accum_mf_cell_2_20_para.oy][Proc.lon_hw -1+accum_mf_cell_2_20_para.ox];
      accum_mf_cell_2_20_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_2_20_para.oz][Proc.lat_hw -1+accum_mf_cell_2_20_para.oy][Proc.lon_hw -1+accum_mf_cell_2_20_para.ox];
      accum_mf_cell_2_20_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_2_20, &accum_mf_cell_2_20_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_21_info accum_mf_cell_2_21_para;
      accum_mf_cell_2_21_para.lz = 32 - 0;
      accum_mf_cell_2_21_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_21_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_21_para.oz = 0;
      accum_mf_cell_2_21_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_21_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_21_para.hx = 1;
      accum_mf_cell_2_21_para.hy = 1;
      accum_mf_cell_2_21_para.hz = 0;
      accum_mf_cell_2_21_para.bx = 256;
      accum_mf_cell_2_21_para.by = 8;
      accum_mf_cell_2_21_para.bz = 1;
      accum_mf_cell_2_21_para.mx = 1;
      accum_mf_cell_2_21_para.my = 2;
      accum_mf_cell_2_21_para.mz = 32;
      accum_mf_cell_2_21_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_2_21_para.oz][Proc.lat_hw -1+accum_mf_cell_2_21_para.oy][Proc.lon_hw -1+accum_mf_cell_2_21_para.ox];
      accum_mf_cell_2_21_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_2_21_para.oz][Proc.lat_hw -1+accum_mf_cell_2_21_para.oy][Proc.lon_hw -1+accum_mf_cell_2_21_para.ox];
      accum_mf_cell_2_21_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_2_21, &accum_mf_cell_2_21_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_22_info accum_mf_cell_2_22_para;
      accum_mf_cell_2_22_para.lz = 32 - 0;
      accum_mf_cell_2_22_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_22_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_22_para.oz = 0;
      accum_mf_cell_2_22_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_22_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_22_para.hx = 1;
      accum_mf_cell_2_22_para.hy = 1;
      accum_mf_cell_2_22_para.hz = 0;
      accum_mf_cell_2_22_para.bx = 256;
      accum_mf_cell_2_22_para.by = 8;
      accum_mf_cell_2_22_para.bz = 1;
      accum_mf_cell_2_22_para.mx = 1;
      accum_mf_cell_2_22_para.my = 2;
      accum_mf_cell_2_22_para.mz = 32;
      accum_mf_cell_2_22_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+accum_mf_cell_2_22_para.oz][Proc.lat_hw -1+accum_mf_cell_2_22_para.oy][Proc.lon_hw -1+accum_mf_cell_2_22_para.ox];
      accum_mf_cell_2_22_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_2_22_para.oz][Proc.lat_hw -1+accum_mf_cell_2_22_para.oy][Proc.lon_hw -1+accum_mf_cell_2_22_para.ox];
      
      athread_spawn(accum_mf_cell_2_22, &accum_mf_cell_2_22_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_23_info accum_mf_cell_2_23_para;
      accum_mf_cell_2_23_para.lz = 32 - 0;
      accum_mf_cell_2_23_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_23_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_23_para.oz = 0;
      accum_mf_cell_2_23_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_23_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_23_para.hx = 1;
      accum_mf_cell_2_23_para.hy = 1;
      accum_mf_cell_2_23_para.hz = 0;
      accum_mf_cell_2_23_para.bx = 256;
      accum_mf_cell_2_23_para.by = 8;
      accum_mf_cell_2_23_para.bz = 1;
      accum_mf_cell_2_23_para.mx = 1;
      accum_mf_cell_2_23_para.my = 2;
      accum_mf_cell_2_23_para.mz = 32;
      accum_mf_cell_2_23_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+accum_mf_cell_2_23_para.oz][Proc.lat_hw -1+accum_mf_cell_2_23_para.oy][Proc.lon_hw -1+accum_mf_cell_2_23_para.ox];
      accum_mf_cell_2_23_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_2_23_para.oz][Proc.lat_hw -1+accum_mf_cell_2_23_para.oy][Proc.lon_hw -1+accum_mf_cell_2_23_para.ox];
      
      athread_spawn(accum_mf_cell_2_23, &accum_mf_cell_2_23_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->mf_step) = 0;
  }
  else
  {
    (advPara->mf_step) = ((advPara->mf_step) + 1);
  }
  if ((!(advPara->dynamic) && ((advPara->mf_step) > (advPara->nstep))))
  {
    (advPara->mf_step) = -1;
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_2_14_info calc_mf_2_14_para;
  calc_mf_2_14_para.lz = 32 - 0;
  calc_mf_2_14_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_mf_2_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_2_14_para.oz = 0;
  calc_mf_2_14_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_mf_2_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_2_14_para.hx = 1;
  calc_mf_2_14_para.hy = 1;
  calc_mf_2_14_para.hz = 0;
  calc_mf_2_14_para.bx = 256;
  calc_mf_2_14_para.by = 8;
  calc_mf_2_14_para.bz = 1;
  calc_mf_2_14_para.mx = 1;
  calc_mf_2_14_para.my = 2;
  calc_mf_2_14_para.mz = 32;
  calc_mf_2_14_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_mf_2_14_para.oz][Proc.lat_hw -1+calc_mf_2_14_para.oy][Proc.lon_hw -1+calc_mf_2_14_para.ox];
  calc_mf_2_14_para.star_statemfx_lat = &star_state->mfx_lat[Proc.lev_hw - 0+calc_mf_2_14_para.oz][Proc.lat_hw -1+calc_mf_2_14_para.oy][Proc.lon_hw -1+calc_mf_2_14_para.ox];
  calc_mf_2_14_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 0+calc_mf_2_14_para.oz][Proc.lat_hw -1+calc_mf_2_14_para.oy][Proc.lon_hw -1+calc_mf_2_14_para.ox];
  calc_mf_2_14_para.star_stateu_lat = &star_state->u_lat[Proc.lev_hw - 0+calc_mf_2_14_para.oz][Proc.lat_hw -1+calc_mf_2_14_para.oy][Proc.lon_hw -1+calc_mf_2_14_para.ox];
  calc_mf_2_14_para.half_tangent_wgt_0 = &mesh->half_tangent_wgt_0[0][0][0];
  calc_mf_2_14_para.half_tangent_wgt_1 = &mesh->half_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_2_14, &calc_mf_2_14_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfx_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_mf_2_15_info calc_mf_2_15_para;
  calc_mf_2_15_para.lz = 32 - 0;
  calc_mf_2_15_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_mf_2_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_mf_2_15_para.oz = 0;
  calc_mf_2_15_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_mf_2_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_mf_2_15_para.hx = 1;
  calc_mf_2_15_para.hy = 1;
  calc_mf_2_15_para.hz = 0;
  calc_mf_2_15_para.bx = 256;
  calc_mf_2_15_para.by = 8;
  calc_mf_2_15_para.bz = 1;
  calc_mf_2_15_para.mx = 1;
  calc_mf_2_15_para.my = 2;
  calc_mf_2_15_para.mz = 32;
  calc_mf_2_15_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_mf_2_15_para.oz][Proc.lat_hw -1+calc_mf_2_15_para.oy][Proc.lon_hw -1+calc_mf_2_15_para.ox];
  calc_mf_2_15_para.star_statemfy_lon = &star_state->mfy_lon[Proc.lev_hw - 0+calc_mf_2_15_para.oz][Proc.lat_hw -1+calc_mf_2_15_para.oy][Proc.lon_hw -1+calc_mf_2_15_para.ox];
  calc_mf_2_15_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 0+calc_mf_2_15_para.oz][Proc.lat_hw -1+calc_mf_2_15_para.oy][Proc.lon_hw -1+calc_mf_2_15_para.ox];
  calc_mf_2_15_para.star_statev_lon = &star_state->v_lon[Proc.lev_hw - 0+calc_mf_2_15_para.oz][Proc.lat_hw -1+calc_mf_2_15_para.oy][Proc.lon_hw -1+calc_mf_2_15_para.ox];
  calc_mf_2_15_para.full_tangent_wgt_0 = &mesh->full_tangent_wgt_0[0][0][0];
  calc_mf_2_15_para.full_tangent_wgt_1 = &mesh->full_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_mf_2_15, &calc_mf_2_15_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mfmfy_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  ke_vtx = (struct Vector4){0.0,0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_2_12_info calc_ke_2_12_para;
  calc_ke_2_12_para.lz = 32 - 0;
  calc_ke_2_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_2_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_2_12_para.oz = 0;
  calc_ke_2_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_2_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_2_12_para.hx = 1;
  calc_ke_2_12_para.hy = 1;
  calc_ke_2_12_para.hz = 0;
  calc_ke_2_12_para.bx = 256;
  calc_ke_2_12_para.by = 8;
  calc_ke_2_12_para.bz = 1;
  calc_ke_2_12_para.mx = 1;
  calc_ke_2_12_para.my = 2;
  calc_ke_2_12_para.mz = 32;
  calc_ke_2_12_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_ke_2_12_para.oz][Proc.lat_hw -1+calc_ke_2_12_para.oy][Proc.lon_hw -1+calc_ke_2_12_para.ox];
  calc_ke_2_12_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_ke_2_12_para.oz][Proc.lat_hw -1+calc_ke_2_12_para.oy][Proc.lon_hw -1+calc_ke_2_12_para.ox];
  calc_ke_2_12_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_ke_2_12_para.oz][Proc.lat_hw -1+calc_ke_2_12_para.oy][Proc.lon_hw -1+calc_ke_2_12_para.ox];
  calc_ke_2_12_para.area_lon_west = &mesh->area_lon_west[0][0][0];
  calc_ke_2_12_para.area_lon_east = &mesh->area_lon_east[0][0][0];
  calc_ke_2_12_para.area_lat_north = &mesh->area_lat_north[0][0][0];
  calc_ke_2_12_para.area_lat_south = &mesh->area_lat_south[0][0][0];
  calc_ke_2_12_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_2_12, &calc_ke_2_12_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_2_13_info calc_ke_2_13_para;
  calc_ke_2_13_para.lz = 32 - 0;
  calc_ke_2_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_ke_2_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_2_13_para.oz = 0;
  calc_ke_2_13_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_ke_2_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_2_13_para.hx = 1;
  calc_ke_2_13_para.hy = 1;
  calc_ke_2_13_para.hz = 0;
  calc_ke_2_13_para.bx = 256;
  calc_ke_2_13_para.by = 8;
  calc_ke_2_13_para.bz = 1;
  calc_ke_2_13_para.mx = 1;
  calc_ke_2_13_para.my = 2;
  calc_ke_2_13_para.mz = 32;
  calc_ke_2_13_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_ke_2_13_para.oz][Proc.lat_hw -1+calc_ke_2_13_para.oy][Proc.lon_hw -1+calc_ke_2_13_para.ox];
  calc_ke_2_13_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_ke_2_13_para.oz][Proc.lat_hw -1+calc_ke_2_13_para.oy][Proc.lon_hw -1+calc_ke_2_13_para.ox];
  calc_ke_2_13_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_ke_2_13_para.oz][Proc.lat_hw -1+calc_ke_2_13_para.oy][Proc.lon_hw -1+calc_ke_2_13_para.ox];
  calc_ke_2_13_para.area_lat_east = &mesh->area_lat_east[0][0][0];
  calc_ke_2_13_para.area_lat_west = &mesh->area_lat_west[0][0][0];
  calc_ke_2_13_para.area_lon_north = &mesh->area_lon_north[0][0][0];
  calc_ke_2_13_para.area_lon_south = &mesh->area_lon_south[0][0][0];
  calc_ke_2_13_para.area_vtx = &mesh->area_vtx[0][0][0];
  calc_ke_2_13_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  calc_ke_2_13_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  calc_ke_2_13_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_ke_2_13, &calc_ke_2_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_2_14_info calc_ke_2_14_para;
  calc_ke_2_14_para.lz = 32 - 0;
  calc_ke_2_14_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_ke_2_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_2_14_para.oz = 0;
  calc_ke_2_14_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_ke_2_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_2_14_para.hx = 1;
  calc_ke_2_14_para.hy = 1;
  calc_ke_2_14_para.hz = 0;
  calc_ke_2_14_para.bx = 256;
  calc_ke_2_14_para.by = 8;
  calc_ke_2_14_para.bz = 1;
  calc_ke_2_14_para.mx = 1;
  calc_ke_2_14_para.my = 2;
  calc_ke_2_14_para.mz = 32;
  calc_ke_2_14_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_ke_2_14_para.oz][Proc.lat_hw -1+calc_ke_2_14_para.oy][Proc.lon_hw -1+calc_ke_2_14_para.ox];
  calc_ke_2_14_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_ke_2_14_para.oz][Proc.lat_hw -1+calc_ke_2_14_para.oy][Proc.lon_hw -1+calc_ke_2_14_para.ox];
  
  athread_spawn(calc_ke_2_14, &calc_ke_2_14_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_ketmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ke_2_15_info calc_ke_2_15_para;
  calc_ke_2_15_para.lz = 32 - 0;
  calc_ke_2_15_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_ke_2_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ke_2_15_para.oz = 0;
  calc_ke_2_15_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_ke_2_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ke_2_15_para.hx = 1;
  calc_ke_2_15_para.hy = 1;
  calc_ke_2_15_para.hz = 0;
  calc_ke_2_15_para.bx = 256;
  calc_ke_2_15_para.by = 8;
  calc_ke_2_15_para.bz = 1;
  calc_ke_2_15_para.mx = 1;
  calc_ke_2_15_para.my = 2;
  calc_ke_2_15_para.mz = 32;
  calc_ke_2_15_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_ke_2_15_para.oz][Proc.lat_hw -1+calc_ke_2_15_para.oy][Proc.lon_hw -1+calc_ke_2_15_para.ox];
  calc_ke_2_15_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_ke_2_15_para.oz][Proc.lat_hw -1+calc_ke_2_15_para.oy][Proc.lon_hw -1+calc_ke_2_15_para.ox];
  
  athread_spawn(calc_ke_2_15, &calc_ke_2_15_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_kekeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ke[0][0][0], &Proc.FieldReq[async_ke], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_2_9_info calc_div_2_9_para;
  calc_div_2_9_para.lz = 32 - 0;
  calc_div_2_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_div_2_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_2_9_para.oz = 0;
  calc_div_2_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_div_2_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_2_9_para.hx = 1;
  calc_div_2_9_para.hy = 1;
  calc_div_2_9_para.hz = 0;
  calc_div_2_9_para.bx = 256;
  calc_div_2_9_para.by = 8;
  calc_div_2_9_para.bz = 1;
  calc_div_2_9_para.mx = 1;
  calc_div_2_9_para.my = 2;
  calc_div_2_9_para.mz = 32;
  calc_div_2_9_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_div_2_9_para.oz][Proc.lat_hw -1+calc_div_2_9_para.oy][Proc.lon_hw -1+calc_div_2_9_para.ox];
  calc_div_2_9_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_div_2_9_para.oz][Proc.lat_hw -1+calc_div_2_9_para.oy][Proc.lon_hw -1+calc_div_2_9_para.ox];
  calc_div_2_9_para.star_statediv = &star_state->div[Proc.lev_hw - 0+calc_div_2_9_para.oz][Proc.lat_hw -1+calc_div_2_9_para.oy][Proc.lon_hw -1+calc_div_2_9_para.ox];
  calc_div_2_9_para.le_lon = &mesh->le_lon[0][0][0];
  calc_div_2_9_para.le_lat = &mesh->le_lat[0][0][0];
  calc_div_2_9_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_div_2_9, &calc_div_2_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divdivTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_2_10_info calc_div_2_10_para;
  calc_div_2_10_para.lz = 32 - 0;
  calc_div_2_10_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_div_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_2_10_para.oz = 0;
  calc_div_2_10_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_div_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_2_10_para.hx = 1;
  calc_div_2_10_para.hy = 1;
  calc_div_2_10_para.hz = 0;
  calc_div_2_10_para.bx = 256;
  calc_div_2_10_para.by = 8;
  calc_div_2_10_para.bz = 1;
  calc_div_2_10_para.mx = 1;
  calc_div_2_10_para.my = 2;
  calc_div_2_10_para.mz = 32;
  calc_div_2_10_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_div_2_10_para.oz][Proc.lat_hw -1+calc_div_2_10_para.oy][Proc.lon_hw -1+calc_div_2_10_para.ox];
  calc_div_2_10_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_div_2_10_para.oz][Proc.lat_hw -1+calc_div_2_10_para.oy][Proc.lon_hw -1+calc_div_2_10_para.ox];
  
  athread_spawn(calc_div_2_10, &calc_div_2_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divtmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_div_2_11_info calc_div_2_11_para;
  calc_div_2_11_para.lz = 32 - 0;
  calc_div_2_11_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_div_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_div_2_11_para.oz = 0;
  calc_div_2_11_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_div_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_div_2_11_para.hx = 1;
  calc_div_2_11_para.hy = 1;
  calc_div_2_11_para.hz = 0;
  calc_div_2_11_para.bx = 256;
  calc_div_2_11_para.by = 8;
  calc_div_2_11_para.bz = 1;
  calc_div_2_11_para.mx = 1;
  calc_div_2_11_para.my = 2;
  calc_div_2_11_para.mz = 32;
  calc_div_2_11_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_div_2_11_para.oz][Proc.lat_hw -1+calc_div_2_11_para.oy][Proc.lon_hw -1+calc_div_2_11_para.ox];
  calc_div_2_11_para.star_statediv = &star_state->div[Proc.lev_hw - 0+calc_div_2_11_para.oz][Proc.lat_hw -1+calc_div_2_11_para.oy][Proc.lon_hw -1+calc_div_2_11_para.ox];
  calc_div_2_11_para.le_lat = &mesh->le_lat[0][0][0];
  calc_div_2_11_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_div_2_11, &calc_div_2_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_divdivTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->div[0][0][0], &Proc.FieldReq[async_div], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_2_9_info calc_vor_2_9_para;
  calc_vor_2_9_para.lz = 32 - 0;
  calc_vor_2_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_vor_2_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_2_9_para.oz = 0;
  calc_vor_2_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_vor_2_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_2_9_para.hx = 1;
  calc_vor_2_9_para.hy = 1;
  calc_vor_2_9_para.hz = 0;
  calc_vor_2_9_para.bx = 256;
  calc_vor_2_9_para.by = 8;
  calc_vor_2_9_para.bz = 1;
  calc_vor_2_9_para.mx = 1;
  calc_vor_2_9_para.my = 2;
  calc_vor_2_9_para.mz = 32;
  calc_vor_2_9_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+calc_vor_2_9_para.oz][Proc.lat_hw -1+calc_vor_2_9_para.oy][Proc.lon_hw -1+calc_vor_2_9_para.ox];
  calc_vor_2_9_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+calc_vor_2_9_para.oz][Proc.lat_hw -1+calc_vor_2_9_para.oy][Proc.lon_hw -1+calc_vor_2_9_para.ox];
  calc_vor_2_9_para.star_statevor = &star_state->vor[Proc.lev_hw - 0+calc_vor_2_9_para.oz][Proc.lat_hw -1+calc_vor_2_9_para.oy][Proc.lon_hw -1+calc_vor_2_9_para.ox];
  calc_vor_2_9_para.de_lon = &mesh->de_lon[0][0][0];
  calc_vor_2_9_para.de_lat = &mesh->de_lat[0][0][0];
  calc_vor_2_9_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(calc_vor_2_9, &calc_vor_2_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vorvorTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_2_10_info calc_vor_2_10_para;
  calc_vor_2_10_para.lz = 32 - 0;
  calc_vor_2_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1198);
  calc_vor_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_2_10_para.oz = 0;
  calc_vor_2_10_para.oy = MAX(Proc.lat_beg, 1198) - Proc.lat_beg;
  calc_vor_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_2_10_para.hx = 0;
  calc_vor_2_10_para.hy = 0;
  calc_vor_2_10_para.hz = 0;
  calc_vor_2_10_para.bx = 256;
  calc_vor_2_10_para.by = 8;
  calc_vor_2_10_para.bz = 1;
  calc_vor_2_10_para.mx = 1;
  calc_vor_2_10_para.my = 2;
  calc_vor_2_10_para.mz = 32;
  calc_vor_2_10_para.star_stateu_lat = &star_state->u_lat[Proc.lev_hw - 0+calc_vor_2_10_para.oz][Proc.lat_hw -0+calc_vor_2_10_para.oy][Proc.lon_hw -0+calc_vor_2_10_para.ox];
  calc_vor_2_10_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_vor_2_10_para.oz][Proc.lat_hw -0+calc_vor_2_10_para.oy][Proc.lon_hw -0+calc_vor_2_10_para.ox];
  calc_vor_2_10_para.le_lat = &mesh->le_lat[0][0][0];
  
  athread_spawn(calc_vor_2_10, &calc_vor_2_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vortmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 1198, 1199, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1198)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1198)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_vor_2_11_info calc_vor_2_11_para;
  calc_vor_2_11_para.lz = 32 - 0;
  calc_vor_2_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1198);
  calc_vor_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_vor_2_11_para.oz = 0;
  calc_vor_2_11_para.oy = MAX(Proc.lat_beg, 1198) - Proc.lat_beg;
  calc_vor_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_vor_2_11_para.hx = 0;
  calc_vor_2_11_para.hy = 0;
  calc_vor_2_11_para.hz = 0;
  calc_vor_2_11_para.bx = 256;
  calc_vor_2_11_para.by = 8;
  calc_vor_2_11_para.bz = 1;
  calc_vor_2_11_para.mx = 1;
  calc_vor_2_11_para.my = 2;
  calc_vor_2_11_para.mz = 32;
  calc_vor_2_11_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_vor_2_11_para.oz][Proc.lat_hw -0+calc_vor_2_11_para.oy][Proc.lon_hw -0+calc_vor_2_11_para.ox];
  calc_vor_2_11_para.star_statevor = &star_state->vor[Proc.lev_hw - 0+calc_vor_2_11_para.oz][Proc.lat_hw -0+calc_vor_2_11_para.oy][Proc.lon_hw -0+calc_vor_2_11_para.ox];
  calc_vor_2_11_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_vor_2_11, &calc_vor_2_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_vorvorTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_pv_2_3_info calc_pv_2_3_para;
  calc_pv_2_3_para.lz = 32 - 0;
  calc_pv_2_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_pv_2_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_pv_2_3_para.oz = 0;
  calc_pv_2_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_pv_2_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_pv_2_3_para.hx = 2;
  calc_pv_2_3_para.hy = 2;
  calc_pv_2_3_para.hz = 0;
  calc_pv_2_3_para.bx = 256;
  calc_pv_2_3_para.by = 8;
  calc_pv_2_3_para.bz = 1;
  calc_pv_2_3_para.mx = 1;
  calc_pv_2_3_para.my = 2;
  calc_pv_2_3_para.mz = 32;
  calc_pv_2_3_para.star_statevor = &star_state->vor[Proc.lev_hw - 0+calc_pv_2_3_para.oz][Proc.lat_hw -2+calc_pv_2_3_para.oy][Proc.lon_hw -2+calc_pv_2_3_para.ox];
  calc_pv_2_3_para.star_statem_vtx = &star_state->m_vtx[Proc.lev_hw - 0+calc_pv_2_3_para.oz][Proc.lat_hw -2+calc_pv_2_3_para.oy][Proc.lon_hw -2+calc_pv_2_3_para.ox];
  calc_pv_2_3_para.star_statepv = &star_state->pv[Proc.lev_hw - 0+calc_pv_2_3_para.oz][Proc.lat_hw -2+calc_pv_2_3_para.oy][Proc.lon_hw -2+calc_pv_2_3_para.ox];
  calc_pv_2_3_para.half_f = &mesh->half_f[0][0][0];
  
  athread_spawn(calc_pv_2_3, &calc_pv_2_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_pvpvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pv[0][0][0], &Proc.FieldReq[async_pv], false, false, true, true, true, true, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_2_6_info interp_pv_upwind_2_6_para;
  interp_pv_upwind_2_6_para.lz = 32 - 0;
  interp_pv_upwind_2_6_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  interp_pv_upwind_2_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_2_6_para.oz = 0;
  interp_pv_upwind_2_6_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  interp_pv_upwind_2_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_2_6_para.hx = 2;
  interp_pv_upwind_2_6_para.hy = 2;
  interp_pv_upwind_2_6_para.hz = 0;
  interp_pv_upwind_2_6_para.bx = 256;
  interp_pv_upwind_2_6_para.by = 8;
  interp_pv_upwind_2_6_para.bz = 1;
  interp_pv_upwind_2_6_para.mx = 1;
  interp_pv_upwind_2_6_para.my = 2;
  interp_pv_upwind_2_6_para.mz = 32;
  interp_pv_upwind_2_6_para.star_statev_lon = &star_state->v_lon[Proc.lev_hw - 0+interp_pv_upwind_2_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_6_para.ox];
  interp_pv_upwind_2_6_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 0+interp_pv_upwind_2_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_6_para.ox];
  interp_pv_upwind_2_6_para.star_statepv = &star_state->pv[Proc.lev_hw - 0+interp_pv_upwind_2_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_6_para.ox];
  interp_pv_upwind_2_6_para.star_statepv_lon = &star_state->pv_lon[Proc.lev_hw - 0+interp_pv_upwind_2_6_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_6_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_6_para.ox];
  
  athread_spawn(interp_pv_upwind_2_6, &interp_pv_upwind_2_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pv_lon[0][0][0], &Proc.FieldReq[async_pv_lon], false, true, true, true, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_pv_upwind_2_7_info interp_pv_upwind_2_7_para;
  interp_pv_upwind_2_7_para.lz = 32 - 0;
  interp_pv_upwind_2_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interp_pv_upwind_2_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_pv_upwind_2_7_para.oz = 0;
  interp_pv_upwind_2_7_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interp_pv_upwind_2_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_pv_upwind_2_7_para.hx = 2;
  interp_pv_upwind_2_7_para.hy = 2;
  interp_pv_upwind_2_7_para.hz = 0;
  interp_pv_upwind_2_7_para.bx = 256;
  interp_pv_upwind_2_7_para.by = 8;
  interp_pv_upwind_2_7_para.bz = 1;
  interp_pv_upwind_2_7_para.mx = 1;
  interp_pv_upwind_2_7_para.my = 2;
  interp_pv_upwind_2_7_para.mz = 32;
  interp_pv_upwind_2_7_para.star_stateu_lat = &star_state->u_lat[Proc.lev_hw - 0+interp_pv_upwind_2_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_7_para.ox];
  interp_pv_upwind_2_7_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 0+interp_pv_upwind_2_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_7_para.ox];
  interp_pv_upwind_2_7_para.star_statepv = &star_state->pv[Proc.lev_hw - 0+interp_pv_upwind_2_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_7_para.ox];
  interp_pv_upwind_2_7_para.star_statepv_lat = &star_state->pv_lat[Proc.lev_hw - 0+interp_pv_upwind_2_7_para.oz][Proc.lat_hw -2+interp_pv_upwind_2_7_para.oy][Proc.lon_hw -2+interp_pv_upwind_2_7_para.ox];
  
  athread_spawn(interp_pv_upwind_2_7, &interp_pv_upwind_2_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_pv_upwindpv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pv_lat[0][0][0], &Proc.FieldReq[async_pv_lat], true, false, true, false, true, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_mf_2_8_info calc_grad_mf_2_8_para;
  calc_grad_mf_2_8_para.lz = 32 - 0;
  calc_grad_mf_2_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_mf_2_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_mf_2_8_para.oz = 0;
  calc_grad_mf_2_8_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_mf_2_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_mf_2_8_para.hx = 1;
  calc_grad_mf_2_8_para.hy = 1;
  calc_grad_mf_2_8_para.hz = 0;
  calc_grad_mf_2_8_para.bx = 256;
  calc_grad_mf_2_8_para.by = 8;
  calc_grad_mf_2_8_para.bz = 1;
  calc_grad_mf_2_8_para.mx = 1;
  calc_grad_mf_2_8_para.my = 2;
  calc_grad_mf_2_8_para.mz = 32;
  calc_grad_mf_2_8_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_grad_mf_2_8_para.oz][Proc.lat_hw -1+calc_grad_mf_2_8_para.oy][Proc.lon_hw -1+calc_grad_mf_2_8_para.ox];
  calc_grad_mf_2_8_para.tend1dmfdlon = &tend1->dmfdlon[Proc.lev_hw - 0+calc_grad_mf_2_8_para.oz][Proc.lat_hw -1+calc_grad_mf_2_8_para.oy][Proc.lon_hw -1+calc_grad_mf_2_8_para.ox];
  calc_grad_mf_2_8_para.le_lon = &mesh->le_lon[0][0][0];
  calc_grad_mf_2_8_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_mf_2_8, &calc_grad_mf_2_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_mfdmfdlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_mf_2_9_info calc_grad_mf_2_9_para;
  calc_grad_mf_2_9_para.lz = 32 - 0;
  calc_grad_mf_2_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_mf_2_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_mf_2_9_para.oz = 0;
  calc_grad_mf_2_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_mf_2_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_mf_2_9_para.hx = 1;
  calc_grad_mf_2_9_para.hy = 1;
  calc_grad_mf_2_9_para.hz = 0;
  calc_grad_mf_2_9_para.bx = 256;
  calc_grad_mf_2_9_para.by = 8;
  calc_grad_mf_2_9_para.bz = 1;
  calc_grad_mf_2_9_para.mx = 1;
  calc_grad_mf_2_9_para.my = 2;
  calc_grad_mf_2_9_para.mz = 32;
  calc_grad_mf_2_9_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_grad_mf_2_9_para.oz][Proc.lat_hw -1+calc_grad_mf_2_9_para.oy][Proc.lon_hw -1+calc_grad_mf_2_9_para.ox];
  calc_grad_mf_2_9_para.tend1dmfdlat = &tend1->dmfdlat[Proc.lev_hw - 0+calc_grad_mf_2_9_para.oz][Proc.lat_hw -1+calc_grad_mf_2_9_para.oy][Proc.lon_hw -1+calc_grad_mf_2_9_para.ox];
  calc_grad_mf_2_9_para.le_lat = &mesh->le_lat[0][0][0];
  calc_grad_mf_2_9_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_mf_2_9, &calc_grad_mf_2_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_mfdmfdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_mf_2_10_info calc_grad_mf_2_10_para;
  calc_grad_mf_2_10_para.lz = 32 - 0;
  calc_grad_mf_2_10_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_grad_mf_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_mf_2_10_para.oz = 0;
  calc_grad_mf_2_10_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_grad_mf_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_mf_2_10_para.hx = 1;
  calc_grad_mf_2_10_para.hy = 1;
  calc_grad_mf_2_10_para.hz = 0;
  calc_grad_mf_2_10_para.bx = 256;
  calc_grad_mf_2_10_para.by = 8;
  calc_grad_mf_2_10_para.bz = 1;
  calc_grad_mf_2_10_para.mx = 1;
  calc_grad_mf_2_10_para.my = 2;
  calc_grad_mf_2_10_para.mz = 32;
  calc_grad_mf_2_10_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_grad_mf_2_10_para.oz][Proc.lat_hw -1+calc_grad_mf_2_10_para.oy][Proc.lon_hw -1+calc_grad_mf_2_10_para.ox];
  calc_grad_mf_2_10_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_grad_mf_2_10_para.oz][Proc.lat_hw -1+calc_grad_mf_2_10_para.oy][Proc.lon_hw -1+calc_grad_mf_2_10_para.ox];
  
  athread_spawn(calc_grad_mf_2_10, &calc_grad_mf_2_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_mftmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_mf_2_11_info calc_grad_mf_2_11_para;
  calc_grad_mf_2_11_para.lz = 32 - 0;
  calc_grad_mf_2_11_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_grad_mf_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_mf_2_11_para.oz = 0;
  calc_grad_mf_2_11_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_grad_mf_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_mf_2_11_para.hx = 0;
  calc_grad_mf_2_11_para.hy = 0;
  calc_grad_mf_2_11_para.hz = 0;
  calc_grad_mf_2_11_para.bx = 256;
  calc_grad_mf_2_11_para.by = 8;
  calc_grad_mf_2_11_para.bz = 1;
  calc_grad_mf_2_11_para.mx = 1;
  calc_grad_mf_2_11_para.my = 2;
  calc_grad_mf_2_11_para.mz = 32;
  calc_grad_mf_2_11_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_grad_mf_2_11_para.oz][Proc.lat_hw -0+calc_grad_mf_2_11_para.oy][Proc.lon_hw -0+calc_grad_mf_2_11_para.ox];
  calc_grad_mf_2_11_para.tend1dmfdlat = &tend1->dmfdlat[Proc.lev_hw - 0+calc_grad_mf_2_11_para.oz][Proc.lat_hw -0+calc_grad_mf_2_11_para.oy][Proc.lon_hw -0+calc_grad_mf_2_11_para.ox];
  calc_grad_mf_2_11_para.le_lat = &mesh->le_lat[0][0][0];
  calc_grad_mf_2_11_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_mf_2_11, &calc_grad_mf_2_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_mfdmfdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
    for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
      tend1->dphs[0][j][i] = 0.0;
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_dphsdtdphsTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_dphs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tend1->dphs[0][j][i] = ((tend1->dphs[0][j][i] - tend1->dmfdlon[k][j][i]) - tend1->dmfdlat[k][j][i]);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_dphsdtdphsTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_2d_D(Proc, &tend1->dphs[0][0][0], &Proc.FieldReq[async_dphs], true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  dt = dt;
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->we_lev[k][j][i] = 0.0;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_we_levwe_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=32+Proc.lev_hw; k<33+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->we_lev[k][j][i] = 0.0;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_we_levwe_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_dphs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=1+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        mfs = 0.0;
        for (l=0+Proc.lev_hw;l<((k - 1) + 1);l+=1){
          mfs = ((mfs + tend1->dmfdlon[l][j][i]) + tend1->dmfdlat[l][j][i]);
        }
        star_state->we_lev[k][j][i] = (-hybrid_coord_calc_dphdt_lev(mesh->hybi[k][0][0],tend1->dphs[0][j][i]) - mfs);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_we_levwe_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->we_lev[0][0][0], &Proc.FieldReq[async_we_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  advPara = advPara;
  dt = dt;
  if (((advPara->we_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_2_10_info accum_we_lev_2_10_para;
    accum_we_lev_2_10_para.lz = 33 - 0;
    accum_we_lev_2_10_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_2_10_para.oz = 0;
    accum_we_lev_2_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_2_10_para.hx = 0;
    accum_we_lev_2_10_para.hy = 0;
    accum_we_lev_2_10_para.hz = 0;
    accum_we_lev_2_10_para.bx = 256;
    accum_we_lev_2_10_para.by = 8;
    accum_we_lev_2_10_para.bz = 1;
    accum_we_lev_2_10_para.mx = 1;
    accum_we_lev_2_10_para.my = 2;
    accum_we_lev_2_10_para.mz = 32;
    accum_we_lev_2_10_para.advptwe0 = &advpt->we0[Proc.lev_hw - 0+accum_we_lev_2_10_para.oz][Proc.lat_hw -0+accum_we_lev_2_10_para.oy][Proc.lon_hw -0+accum_we_lev_2_10_para.ox];
    accum_we_lev_2_10_para.advptm0 = &advpt->m0[Proc.lev_hw - 0+accum_we_lev_2_10_para.oz][Proc.lat_hw -0+accum_we_lev_2_10_para.oy][Proc.lon_hw -0+accum_we_lev_2_10_para.ox];
    accum_we_lev_2_10_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_2_10_para.oz][Proc.lat_hw -0+accum_we_lev_2_10_para.oy][Proc.lon_hw -0+accum_we_lev_2_10_para.ox];
    accum_we_lev_2_10_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_2_10_para.oz][Proc.lat_hw -0+accum_we_lev_2_10_para.oy][Proc.lon_hw -0+accum_we_lev_2_10_para.ox];
    
    athread_spawn(accum_we_lev_2_10, &accum_we_lev_2_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->we_step) = 1;
  }
  if (((advPara->we_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_2_11_info accum_we_lev_2_11_para;
    accum_we_lev_2_11_para.lz = 33 - 0;
    accum_we_lev_2_11_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_2_11_para.oz = 0;
    accum_we_lev_2_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_2_11_para.hx = 1;
    accum_we_lev_2_11_para.hy = 1;
    accum_we_lev_2_11_para.hz = 0;
    accum_we_lev_2_11_para.bx = 256;
    accum_we_lev_2_11_para.by = 8;
    accum_we_lev_2_11_para.bz = 1;
    accum_we_lev_2_11_para.mx = 1;
    accum_we_lev_2_11_para.my = 2;
    accum_we_lev_2_11_para.mz = 32;
    accum_we_lev_2_11_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+accum_we_lev_2_11_para.oz][Proc.lat_hw -1+accum_we_lev_2_11_para.oy][Proc.lon_hw -1+accum_we_lev_2_11_para.ox];
    accum_we_lev_2_11_para.star_statem_lev = &star_state->m_lev[Proc.lev_hw - 0+accum_we_lev_2_11_para.oz][Proc.lat_hw -1+accum_we_lev_2_11_para.oy][Proc.lon_hw -1+accum_we_lev_2_11_para.ox];
    accum_we_lev_2_11_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_2_11_para.oz][Proc.lat_hw -1+accum_we_lev_2_11_para.oy][Proc.lon_hw -1+accum_we_lev_2_11_para.ox];
    accum_we_lev_2_11_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_2_11_para.oz][Proc.lat_hw -1+accum_we_lev_2_11_para.oy][Proc.lon_hw -1+accum_we_lev_2_11_para.ox];
    
    athread_spawn(accum_we_lev_2_11, &accum_we_lev_2_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->we_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_2_12_info accum_we_lev_2_12_para;
      accum_we_lev_2_12_para.lz = 33 - 0;
      accum_we_lev_2_12_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_2_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_2_12_para.oz = 0;
      accum_we_lev_2_12_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_2_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_2_12_para.hx = 1;
      accum_we_lev_2_12_para.hy = 1;
      accum_we_lev_2_12_para.hz = 0;
      accum_we_lev_2_12_para.bx = 256;
      accum_we_lev_2_12_para.by = 8;
      accum_we_lev_2_12_para.bz = 1;
      accum_we_lev_2_12_para.mx = 1;
      accum_we_lev_2_12_para.my = 2;
      accum_we_lev_2_12_para.mz = 32;
      accum_we_lev_2_12_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_2_12_para.oz][Proc.lat_hw -1+accum_we_lev_2_12_para.oy][Proc.lon_hw -1+accum_we_lev_2_12_para.ox];
      accum_we_lev_2_12_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+accum_we_lev_2_12_para.oz][Proc.lat_hw -1+accum_we_lev_2_12_para.oy][Proc.lon_hw -1+accum_we_lev_2_12_para.ox];
      accum_we_lev_2_12_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_2_12_para.oz][Proc.lat_hw -1+accum_we_lev_2_12_para.oy][Proc.lon_hw -1+accum_we_lev_2_12_para.ox];
      accum_we_lev_2_12_para.star_statem_lev = &star_state->m_lev[Proc.lev_hw - 0+accum_we_lev_2_12_para.oz][Proc.lat_hw -1+accum_we_lev_2_12_para.oy][Proc.lon_hw -1+accum_we_lev_2_12_para.ox];
      accum_we_lev_2_12_para.advptwe0 = &advpt->we0[Proc.lev_hw - 0+accum_we_lev_2_12_para.oz][Proc.lat_hw -1+accum_we_lev_2_12_para.oy][Proc.lon_hw -1+accum_we_lev_2_12_para.ox];
      accum_we_lev_2_12_para.advptm0 = &advpt->m0[Proc.lev_hw - 0+accum_we_lev_2_12_para.oz][Proc.lat_hw -1+accum_we_lev_2_12_para.oy][Proc.lon_hw -1+accum_we_lev_2_12_para.ox];
      accum_we_lev_2_12_para.nstep = advPara->nstep;
      
      athread_spawn(accum_we_lev_2_12, &accum_we_lev_2_12_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_2_13_info accum_we_lev_2_13_para;
      accum_we_lev_2_13_para.lz = 33 - 0;
      accum_we_lev_2_13_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_2_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_2_13_para.oz = 0;
      accum_we_lev_2_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_2_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_2_13_para.hx = 1;
      accum_we_lev_2_13_para.hy = 1;
      accum_we_lev_2_13_para.hz = 0;
      accum_we_lev_2_13_para.bx = 256;
      accum_we_lev_2_13_para.by = 8;
      accum_we_lev_2_13_para.bz = 1;
      accum_we_lev_2_13_para.mx = 1;
      accum_we_lev_2_13_para.my = 2;
      accum_we_lev_2_13_para.mz = 32;
      accum_we_lev_2_13_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_2_13_para.oz][Proc.lat_hw -1+accum_we_lev_2_13_para.oy][Proc.lon_hw -1+accum_we_lev_2_13_para.ox];
      accum_we_lev_2_13_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+accum_we_lev_2_13_para.oz][Proc.lat_hw -1+accum_we_lev_2_13_para.oy][Proc.lon_hw -1+accum_we_lev_2_13_para.ox];
      accum_we_lev_2_13_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_2_13_para.oz][Proc.lat_hw -1+accum_we_lev_2_13_para.oy][Proc.lon_hw -1+accum_we_lev_2_13_para.ox];
      accum_we_lev_2_13_para.star_statem_lev = &star_state->m_lev[Proc.lev_hw - 0+accum_we_lev_2_13_para.oz][Proc.lat_hw -1+accum_we_lev_2_13_para.oy][Proc.lon_hw -1+accum_we_lev_2_13_para.ox];
      
      athread_spawn(accum_we_lev_2_13, &accum_we_lev_2_13_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->we_step) = 0;
  }
  else
  {
    (advPara->we_step) = ((advPara->we_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->we_step) > (advPara->nstep))))
  {
    if (((advPara->dynamic) == 0))
    {
      (advPara->we_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_2_14_info accum_we_lev_2_14_para;
    accum_we_lev_2_14_para.lz = 32 - 1;
    accum_we_lev_2_14_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_2_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_2_14_para.oz = 1;
    accum_we_lev_2_14_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_2_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_2_14_para.hx = 0;
    accum_we_lev_2_14_para.hy = 0;
    accum_we_lev_2_14_para.hz = 0;
    accum_we_lev_2_14_para.bx = 256;
    accum_we_lev_2_14_para.by = 8;
    accum_we_lev_2_14_para.bz = 1;
    accum_we_lev_2_14_para.mx = 1;
    accum_we_lev_2_14_para.my = 2;
    accum_we_lev_2_14_para.mz = 32;
    accum_we_lev_2_14_para.advptwe = &advpt->we[Proc.lev_hw - 0+accum_we_lev_2_14_para.oz][Proc.lat_hw -0+accum_we_lev_2_14_para.oy][Proc.lon_hw -0+accum_we_lev_2_14_para.ox];
    accum_we_lev_2_14_para.advptmm = &advpt->mm[Proc.lev_hw - 0+accum_we_lev_2_14_para.oz][Proc.lat_hw -0+accum_we_lev_2_14_para.oy][Proc.lon_hw -0+accum_we_lev_2_14_para.ox];
    accum_we_lev_2_14_para.advptcflz = &advpt->cflz[Proc.lev_hw - 0+accum_we_lev_2_14_para.oz][Proc.lat_hw -0+accum_we_lev_2_14_para.oy][Proc.lon_hw -0+accum_we_lev_2_14_para.ox];
    accum_we_lev_2_14_para.dt = dt;
    
    athread_spawn(accum_we_lev_2_14, &accum_we_lev_2_14_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levcflzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_lev_edge_to_lev_lon_edge_2_2_info interp_lev_edge_to_lev_lon_edge_2_2_para;
  interp_lev_edge_to_lev_lon_edge_2_2_para.lz = 33 - 0;
  interp_lev_edge_to_lev_lon_edge_2_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  interp_lev_edge_to_lev_lon_edge_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_lev_edge_to_lev_lon_edge_2_2_para.oz = 0;
  interp_lev_edge_to_lev_lon_edge_2_2_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  interp_lev_edge_to_lev_lon_edge_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_lev_edge_to_lev_lon_edge_2_2_para.hx = 1;
  interp_lev_edge_to_lev_lon_edge_2_2_para.hy = 1;
  interp_lev_edge_to_lev_lon_edge_2_2_para.hz = 0;
  interp_lev_edge_to_lev_lon_edge_2_2_para.bx = 256;
  interp_lev_edge_to_lev_lon_edge_2_2_para.by = 8;
  interp_lev_edge_to_lev_lon_edge_2_2_para.bz = 1;
  interp_lev_edge_to_lev_lon_edge_2_2_para.mx = 1;
  interp_lev_edge_to_lev_lon_edge_2_2_para.my = 2;
  interp_lev_edge_to_lev_lon_edge_2_2_para.mz = 32;
  interp_lev_edge_to_lev_lon_edge_2_2_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+interp_lev_edge_to_lev_lon_edge_2_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lon_edge_2_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lon_edge_2_2_para.ox];
  interp_lev_edge_to_lev_lon_edge_2_2_para.star_statewe_lev_lon = &star_state->we_lev_lon[Proc.lev_hw - 0+interp_lev_edge_to_lev_lon_edge_2_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lon_edge_2_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lon_edge_2_2_para.ox];
  interp_lev_edge_to_lev_lon_edge_2_2_para.area_lon_west = &mesh->area_lon_west[0][0][0];
  interp_lev_edge_to_lev_lon_edge_2_2_para.area_lon_east = &mesh->area_lon_east[0][0][0];
  interp_lev_edge_to_lev_lon_edge_2_2_para.area_lon = &mesh->area_lon[0][0][0];
  
  athread_spawn(interp_lev_edge_to_lev_lon_edge_2_2, &interp_lev_edge_to_lev_lon_edge_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_lev_edge_to_lev_lon_edgewe_lev_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interp_lev_edge_to_lev_lat_edge_2_2_info interp_lev_edge_to_lev_lat_edge_2_2_para;
  interp_lev_edge_to_lev_lat_edge_2_2_para.lz = 33 - 0;
  interp_lev_edge_to_lev_lat_edge_2_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interp_lev_edge_to_lev_lat_edge_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interp_lev_edge_to_lev_lat_edge_2_2_para.oz = 0;
  interp_lev_edge_to_lev_lat_edge_2_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interp_lev_edge_to_lev_lat_edge_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interp_lev_edge_to_lev_lat_edge_2_2_para.hx = 1;
  interp_lev_edge_to_lev_lat_edge_2_2_para.hy = 1;
  interp_lev_edge_to_lev_lat_edge_2_2_para.hz = 0;
  interp_lev_edge_to_lev_lat_edge_2_2_para.bx = 256;
  interp_lev_edge_to_lev_lat_edge_2_2_para.by = 8;
  interp_lev_edge_to_lev_lat_edge_2_2_para.bz = 1;
  interp_lev_edge_to_lev_lat_edge_2_2_para.mx = 1;
  interp_lev_edge_to_lev_lat_edge_2_2_para.my = 2;
  interp_lev_edge_to_lev_lat_edge_2_2_para.mz = 32;
  interp_lev_edge_to_lev_lat_edge_2_2_para.star_statewe_lev = &star_state->we_lev[Proc.lev_hw - 0+interp_lev_edge_to_lev_lat_edge_2_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lat_edge_2_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lat_edge_2_2_para.ox];
  interp_lev_edge_to_lev_lat_edge_2_2_para.star_statewe_lev_lat = &star_state->we_lev_lat[Proc.lev_hw - 0+interp_lev_edge_to_lev_lat_edge_2_2_para.oz][Proc.lat_hw -1+interp_lev_edge_to_lev_lat_edge_2_2_para.oy][Proc.lon_hw -1+interp_lev_edge_to_lev_lat_edge_2_2_para.ox];
  interp_lev_edge_to_lev_lat_edge_2_2_para.area_lat_north = &mesh->area_lat_north[0][0][0];
  interp_lev_edge_to_lev_lat_edge_2_2_para.area_lat_south = &mesh->area_lat_south[0][0][0];
  interp_lev_edge_to_lev_lat_edge_2_2_para.area_lat = &mesh->area_lat[0][0][0];
  
  athread_spawn(interp_lev_edge_to_lev_lat_edge_2_2, &interp_lev_edge_to_lev_lat_edge_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interp_lev_edge_to_lev_lat_edgewe_lev_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_2_8_info calc_wedudlev_wedvdlev_2_8_para;
  calc_wedudlev_wedvdlev_2_8_para.lz = 31 - 1;
  calc_wedudlev_wedvdlev_2_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_wedudlev_wedvdlev_2_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_2_8_para.oz = 1;
  calc_wedudlev_wedvdlev_2_8_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_2_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_2_8_para.hx = 1;
  calc_wedudlev_wedvdlev_2_8_para.hy = 0;
  calc_wedudlev_wedvdlev_2_8_para.hz = 1;
  calc_wedudlev_wedvdlev_2_8_para.bx = 256;
  calc_wedudlev_wedvdlev_2_8_para.by = 1;
  calc_wedudlev_wedvdlev_2_8_para.bz = 4;
  calc_wedudlev_wedvdlev_2_8_para.mx = 1;
  calc_wedudlev_wedvdlev_2_8_para.my = 8;
  calc_wedudlev_wedvdlev_2_8_para.mz = 8;
  calc_wedudlev_wedvdlev_2_8_para.star_statewe_lev_lon = &star_state->we_lev_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_8_para.ox];
  calc_wedudlev_wedvdlev_2_8_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_8_para.ox];
  calc_wedudlev_wedvdlev_2_8_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_8_para.ox];
  calc_wedudlev_wedvdlev_2_8_para.tend1wedudlev = &tend1->wedudlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_8_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_8_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_8_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_2_8, &calc_wedudlev_wedvdlev_2_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedudlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tend1->wedudlev[k][j][i] = (((star_state->we_lev_lon[(k + 1)][j][i] * (star_state->u_lon[(k + 1)][j][i] - star_state->u_lon[k][j][i])) / star_state->m_lon[k][j][i]) / 2.0);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedudlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_2_9_info calc_wedudlev_wedvdlev_2_9_para;
  calc_wedudlev_wedvdlev_2_9_para.lz = 32 - 31;
  calc_wedudlev_wedvdlev_2_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_wedudlev_wedvdlev_2_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_2_9_para.oz = 31;
  calc_wedudlev_wedvdlev_2_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_2_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_2_9_para.hx = 1;
  calc_wedudlev_wedvdlev_2_9_para.hy = 0;
  calc_wedudlev_wedvdlev_2_9_para.hz = 1;
  calc_wedudlev_wedvdlev_2_9_para.bx = 256;
  calc_wedudlev_wedvdlev_2_9_para.by = 1;
  calc_wedudlev_wedvdlev_2_9_para.bz = 4;
  calc_wedudlev_wedvdlev_2_9_para.mx = 1;
  calc_wedudlev_wedvdlev_2_9_para.my = 8;
  calc_wedudlev_wedvdlev_2_9_para.mz = 8;
  calc_wedudlev_wedvdlev_2_9_para.star_statewe_lev_lon = &star_state->we_lev_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_9_para.ox];
  calc_wedudlev_wedvdlev_2_9_para.star_stateu_lon = &star_state->u_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_9_para.ox];
  calc_wedudlev_wedvdlev_2_9_para.star_statem_lon = &star_state->m_lon[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_9_para.ox];
  calc_wedudlev_wedvdlev_2_9_para.tend1wedudlev = &tend1->wedudlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_9_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_9_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_9_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_2_9, &calc_wedudlev_wedvdlev_2_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedudlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_2_10_info calc_wedudlev_wedvdlev_2_10_para;
  calc_wedudlev_wedvdlev_2_10_para.lz = 31 - 1;
  calc_wedudlev_wedvdlev_2_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_wedudlev_wedvdlev_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_2_10_para.oz = 1;
  calc_wedudlev_wedvdlev_2_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_2_10_para.hx = 1;
  calc_wedudlev_wedvdlev_2_10_para.hy = 0;
  calc_wedudlev_wedvdlev_2_10_para.hz = 1;
  calc_wedudlev_wedvdlev_2_10_para.bx = 256;
  calc_wedudlev_wedvdlev_2_10_para.by = 1;
  calc_wedudlev_wedvdlev_2_10_para.bz = 4;
  calc_wedudlev_wedvdlev_2_10_para.mx = 1;
  calc_wedudlev_wedvdlev_2_10_para.my = 8;
  calc_wedudlev_wedvdlev_2_10_para.mz = 8;
  calc_wedudlev_wedvdlev_2_10_para.star_statewe_lev_lat = &star_state->we_lev_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_10_para.ox];
  calc_wedudlev_wedvdlev_2_10_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_10_para.ox];
  calc_wedudlev_wedvdlev_2_10_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_10_para.ox];
  calc_wedudlev_wedvdlev_2_10_para.tend1wedvdlev = &tend1->wedvdlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_10_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_10_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_10_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_2_10, &calc_wedudlev_wedvdlev_2_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedvdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tend1->wedvdlev[k][j][i] = (((star_state->we_lev_lat[(k + 1)][j][i] * (star_state->v_lat[(k + 1)][j][i] - star_state->v_lat[k][j][i])) / star_state->m_lat[k][j][i]) / 2.0);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedvdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_wedudlev_wedvdlev_2_11_info calc_wedudlev_wedvdlev_2_11_para;
  calc_wedudlev_wedvdlev_2_11_para.lz = 32 - 31;
  calc_wedudlev_wedvdlev_2_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_wedudlev_wedvdlev_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_wedudlev_wedvdlev_2_11_para.oz = 31;
  calc_wedudlev_wedvdlev_2_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_wedudlev_wedvdlev_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_wedudlev_wedvdlev_2_11_para.hx = 1;
  calc_wedudlev_wedvdlev_2_11_para.hy = 0;
  calc_wedudlev_wedvdlev_2_11_para.hz = 1;
  calc_wedudlev_wedvdlev_2_11_para.bx = 256;
  calc_wedudlev_wedvdlev_2_11_para.by = 1;
  calc_wedudlev_wedvdlev_2_11_para.bz = 4;
  calc_wedudlev_wedvdlev_2_11_para.mx = 1;
  calc_wedudlev_wedvdlev_2_11_para.my = 8;
  calc_wedudlev_wedvdlev_2_11_para.mz = 8;
  calc_wedudlev_wedvdlev_2_11_para.star_statewe_lev_lat = &star_state->we_lev_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_11_para.ox];
  calc_wedudlev_wedvdlev_2_11_para.star_statev_lat = &star_state->v_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_11_para.ox];
  calc_wedudlev_wedvdlev_2_11_para.star_statem_lat = &star_state->m_lat[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_11_para.ox];
  calc_wedudlev_wedvdlev_2_11_para.tend1wedvdlev = &tend1->wedvdlev[Proc.lev_hw - 1+calc_wedudlev_wedvdlev_2_11_para.oz][Proc.lat_hw -0+calc_wedudlev_wedvdlev_2_11_para.oy][Proc.lon_hw -1+calc_wedudlev_wedvdlev_2_11_para.ox];
  
  athread_spawn(calc_wedudlev_wedvdlev_2_11, &calc_wedudlev_wedvdlev_2_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_wedudlev_wedvdlevwedvdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  dt = dt;
  dt = dt;
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_2_6_info hflx_ppm_inner_2_6_para;
  hflx_ppm_inner_2_6_para.lz = 32 - 0;
  hflx_ppm_inner_2_6_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_2_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_2_6_para.oz = 0;
  hflx_ppm_inner_2_6_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_2_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_2_6_para.hx = 2;
  hflx_ppm_inner_2_6_para.hy = 2;
  hflx_ppm_inner_2_6_para.hz = 0;
  hflx_ppm_inner_2_6_para.bx = 256;
  hflx_ppm_inner_2_6_para.by = 8;
  hflx_ppm_inner_2_6_para.bz = 1;
  hflx_ppm_inner_2_6_para.mx = 1;
  hflx_ppm_inner_2_6_para.my = 2;
  hflx_ppm_inner_2_6_para.mz = 32;
  hflx_ppm_inner_2_6_para.star_statept = &star_state->pt[Proc.lev_hw - 0+hflx_ppm_inner_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_6_para.ox];
  hflx_ppm_inner_2_6_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_inner_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_6_para.ox];
  hflx_ppm_inner_2_6_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_inner_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_6_para.ox];
  hflx_ppm_inner_2_6_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_inner_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_6_para.ox];
  hflx_ppm_inner_2_6_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_inner_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_6_para.ox];
  hflx_ppm_inner_2_6_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_inner_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_6_para.ox];
  hflx_ppm_inner_2_6_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_inner_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_6_para.ox];
  
  athread_spawn(hflx_ppm_inner_2_6, &hflx_ppm_inner_2_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_uu]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_2_7_info hflx_ppm_inner_2_7_para;
  hflx_ppm_inner_2_7_para.lz = 32 - 0;
  hflx_ppm_inner_2_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_inner_2_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_2_7_para.oz = 0;
  hflx_ppm_inner_2_7_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_inner_2_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_2_7_para.hx = Proc.lon_hw;
  hflx_ppm_inner_2_7_para.hy = Proc.lat_hw;
  hflx_ppm_inner_2_7_para.hz = 0;
  hflx_ppm_inner_2_7_para.bx = 64;
  hflx_ppm_inner_2_7_para.by = 1;
  hflx_ppm_inner_2_7_para.bz = 1;
  hflx_ppm_inner_2_7_para.mx = 1;
  hflx_ppm_inner_2_7_para.my = 2;
  hflx_ppm_inner_2_7_para.mz = 32;
  hflx_ppm_inner_2_7_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+hflx_ppm_inner_2_7_para.oz][Proc.lat_hw -hflx_ppm_inner_2_7_para.hy +hflx_ppm_inner_2_7_para.oy][Proc.lon_hw -hflx_ppm_inner_2_7_para.hx +hflx_ppm_inner_2_7_para.ox];
  hflx_ppm_inner_2_7_para.star_statept = &star_state->pt[Proc.lev_hw - 0+hflx_ppm_inner_2_7_para.oz][Proc.lat_hw -hflx_ppm_inner_2_7_para.hy +hflx_ppm_inner_2_7_para.oy][Proc.lon_hw -hflx_ppm_inner_2_7_para.hx +hflx_ppm_inner_2_7_para.ox];
  hflx_ppm_inner_2_7_para.advptuu = &advpt->uu[Proc.lev_hw - 0+hflx_ppm_inner_2_7_para.oz][Proc.lat_hw -hflx_ppm_inner_2_7_para.hy +hflx_ppm_inner_2_7_para.oy][Proc.lon_hw -hflx_ppm_inner_2_7_para.hx +hflx_ppm_inner_2_7_para.ox];
  hflx_ppm_inner_2_7_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_inner_2_7_para.oz][Proc.lat_hw -hflx_ppm_inner_2_7_para.hy +hflx_ppm_inner_2_7_para.oy][Proc.lon_hw -hflx_ppm_inner_2_7_para.hx +hflx_ppm_inner_2_7_para.ox];
  hflx_ppm_inner_2_7_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_inner_2_7_para.oz][Proc.lat_hw -hflx_ppm_inner_2_7_para.hy +hflx_ppm_inner_2_7_para.oy][Proc.lon_hw -hflx_ppm_inner_2_7_para.hx +hflx_ppm_inner_2_7_para.ox];
  hflx_ppm_inner_2_7_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_inner_2_7_para.oz][Proc.lat_hw -hflx_ppm_inner_2_7_para.hy +hflx_ppm_inner_2_7_para.oy][Proc.lon_hw -hflx_ppm_inner_2_7_para.hx +hflx_ppm_inner_2_7_para.ox];
  hflx_ppm_inner_2_7_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+hflx_ppm_inner_2_7_para.oz][Proc.lat_hw -hflx_ppm_inner_2_7_para.hy +hflx_ppm_inner_2_7_para.oy][Proc.lon_hw -hflx_ppm_inner_2_7_para.hx +hflx_ppm_inner_2_7_para.ox];
  
  athread_spawn(hflx_ppm_inner_2_7, &hflx_ppm_inner_2_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerptf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lon[0][0][0], &Proc.FieldReq[async_ptf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_vv]);
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_2_8_info hflx_ppm_inner_2_8_para;
  hflx_ppm_inner_2_8_para.lz = 32 - 0;
  hflx_ppm_inner_2_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_2_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_2_8_para.oz = 0;
  hflx_ppm_inner_2_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_2_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_2_8_para.hx = 0;
  hflx_ppm_inner_2_8_para.hy = 1;
  hflx_ppm_inner_2_8_para.hz = 0;
  hflx_ppm_inner_2_8_para.bx = 256;
  hflx_ppm_inner_2_8_para.by = 8;
  hflx_ppm_inner_2_8_para.bz = 1;
  hflx_ppm_inner_2_8_para.mx = 1;
  hflx_ppm_inner_2_8_para.my = 2;
  hflx_ppm_inner_2_8_para.mz = 32;
  hflx_ppm_inner_2_8_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+hflx_ppm_inner_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_8_para.ox];
  hflx_ppm_inner_2_8_para.advptvv = &advpt->vv[Proc.lev_hw - 0+hflx_ppm_inner_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_8_para.ox];
  hflx_ppm_inner_2_8_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_inner_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_8_para.ox];
  hflx_ppm_inner_2_8_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_inner_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_8_para.ox];
  hflx_ppm_inner_2_8_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_inner_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_8_para.ox];
  hflx_ppm_inner_2_8_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+hflx_ppm_inner_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_8_para.ox];
  
  athread_spawn(hflx_ppm_inner_2_8, &hflx_ppm_inner_2_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerptf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lat[0][0][0], &Proc.FieldReq[async_ptf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_2_6_info ffsl_calc_tracer_hflx_2_6_para;
  ffsl_calc_tracer_hflx_2_6_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_2_6_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  ffsl_calc_tracer_hflx_2_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_2_6_para.oz = 0;
  ffsl_calc_tracer_hflx_2_6_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_2_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_2_6_para.hx = 2;
  ffsl_calc_tracer_hflx_2_6_para.hy = 2;
  ffsl_calc_tracer_hflx_2_6_para.hz = 0;
  ffsl_calc_tracer_hflx_2_6_para.bx = 256;
  ffsl_calc_tracer_hflx_2_6_para.by = 8;
  ffsl_calc_tracer_hflx_2_6_para.bz = 1;
  ffsl_calc_tracer_hflx_2_6_para.mx = 1;
  ffsl_calc_tracer_hflx_2_6_para.my = 2;
  ffsl_calc_tracer_hflx_2_6_para.mz = 32;
  ffsl_calc_tracer_hflx_2_6_para.star_statept = &star_state->pt[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_6_para.ox];
  ffsl_calc_tracer_hflx_2_6_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_6_para.ox];
  ffsl_calc_tracer_hflx_2_6_para.advptdivx = &advpt->divx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_6_para.ox];
  ffsl_calc_tracer_hflx_2_6_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_6_para.ox];
  ffsl_calc_tracer_hflx_2_6_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_6_para.ox];
  ffsl_calc_tracer_hflx_2_6_para.advptqx = &advpt->qx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_6_para.ox];
  ffsl_calc_tracer_hflx_2_6_para.advptqy = &advpt->qy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_6_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_6_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_6_para.ox];
  ffsl_calc_tracer_hflx_2_6_para.le_lon = &mesh->le_lon[0][0][0];
  ffsl_calc_tracer_hflx_2_6_para.area_cell = &mesh->area_cell[0][0][0];
  ffsl_calc_tracer_hflx_2_6_para.le_lat = &mesh->le_lat[0][0][0];
  ffsl_calc_tracer_hflx_2_6_para.dt = dt;
  
  athread_spawn(ffsl_calc_tracer_hflx_2_6, &ffsl_calc_tracer_hflx_2_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxqxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_2_7_info ffsl_calc_tracer_hflx_2_7_para;
  ffsl_calc_tracer_hflx_2_7_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_2_7_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  ffsl_calc_tracer_hflx_2_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_2_7_para.oz = 0;
  ffsl_calc_tracer_hflx_2_7_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_2_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_2_7_para.hx = 0;
  ffsl_calc_tracer_hflx_2_7_para.hy = 1;
  ffsl_calc_tracer_hflx_2_7_para.hz = 0;
  ffsl_calc_tracer_hflx_2_7_para.bx = 256;
  ffsl_calc_tracer_hflx_2_7_para.by = 8;
  ffsl_calc_tracer_hflx_2_7_para.bz = 1;
  ffsl_calc_tracer_hflx_2_7_para.mx = 1;
  ffsl_calc_tracer_hflx_2_7_para.my = 2;
  ffsl_calc_tracer_hflx_2_7_para.mz = 32;
  ffsl_calc_tracer_hflx_2_7_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_7_para.oz][Proc.lat_hw -1+ffsl_calc_tracer_hflx_2_7_para.oy][Proc.lon_hw -0+ffsl_calc_tracer_hflx_2_7_para.ox];
  ffsl_calc_tracer_hflx_2_7_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_7_para.oz][Proc.lat_hw -1+ffsl_calc_tracer_hflx_2_7_para.oy][Proc.lon_hw -0+ffsl_calc_tracer_hflx_2_7_para.ox];
  
  athread_spawn(ffsl_calc_tracer_hflx_2_7, &ffsl_calc_tracer_hflx_2_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxtmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_2_8_info ffsl_calc_tracer_hflx_2_8_para;
  ffsl_calc_tracer_hflx_2_8_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_2_8_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  ffsl_calc_tracer_hflx_2_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_2_8_para.oz = 0;
  ffsl_calc_tracer_hflx_2_8_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_2_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_2_8_para.hx = 2;
  ffsl_calc_tracer_hflx_2_8_para.hy = 2;
  ffsl_calc_tracer_hflx_2_8_para.hz = 0;
  ffsl_calc_tracer_hflx_2_8_para.bx = 256;
  ffsl_calc_tracer_hflx_2_8_para.by = 8;
  ffsl_calc_tracer_hflx_2_8_para.bz = 1;
  ffsl_calc_tracer_hflx_2_8_para.mx = 1;
  ffsl_calc_tracer_hflx_2_8_para.my = 2;
  ffsl_calc_tracer_hflx_2_8_para.mz = 32;
  ffsl_calc_tracer_hflx_2_8_para.star_statept = &star_state->pt[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_8_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_8_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_8_para.ox];
  ffsl_calc_tracer_hflx_2_8_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_8_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_8_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_8_para.ox];
  ffsl_calc_tracer_hflx_2_8_para.advptdivy = &advpt->divy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_8_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_8_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_8_para.ox];
  ffsl_calc_tracer_hflx_2_8_para.advptqx = &advpt->qx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_8_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_8_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_8_para.ox];
  ffsl_calc_tracer_hflx_2_8_para.advptqy = &advpt->qy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_8_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_8_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_8_para.ox];
  ffsl_calc_tracer_hflx_2_8_para.le_lat = &mesh->le_lat[0][0][0];
  ffsl_calc_tracer_hflx_2_8_para.area_cell = &mesh->area_cell[0][0][0];
  ffsl_calc_tracer_hflx_2_8_para.dt = dt;
  
  athread_spawn(ffsl_calc_tracer_hflx_2_8, &ffsl_calc_tracer_hflx_2_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxqxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qx[0][0][0], &Proc.FieldReq[async_qx], true, true, true, false, false, true, true, true);
  UpdateHalo_3d_D(Proc, &advpt->qy[0][0][0], &Proc.FieldReq[async_qy], true, true, true, true, true, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qx]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_2_6_info hflx_ppm_outer_2_6_para;
  hflx_ppm_outer_2_6_para.lz = 32 - 0;
  hflx_ppm_outer_2_6_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_2_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_2_6_para.oz = 0;
  hflx_ppm_outer_2_6_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_2_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_2_6_para.hx = 2;
  hflx_ppm_outer_2_6_para.hy = 2;
  hflx_ppm_outer_2_6_para.hz = 0;
  hflx_ppm_outer_2_6_para.bx = 256;
  hflx_ppm_outer_2_6_para.by = 8;
  hflx_ppm_outer_2_6_para.bz = 1;
  hflx_ppm_outer_2_6_para.mx = 1;
  hflx_ppm_outer_2_6_para.my = 2;
  hflx_ppm_outer_2_6_para.mz = 32;
  hflx_ppm_outer_2_6_para.advptqy = &advpt->qy[Proc.lev_hw - 0+hflx_ppm_outer_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_6_para.ox];
  hflx_ppm_outer_2_6_para.advptqx = &advpt->qx[Proc.lev_hw - 0+hflx_ppm_outer_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_6_para.ox];
  hflx_ppm_outer_2_6_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_outer_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_6_para.ox];
  hflx_ppm_outer_2_6_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_outer_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_6_para.ox];
  hflx_ppm_outer_2_6_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_outer_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_6_para.ox];
  hflx_ppm_outer_2_6_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_outer_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_6_para.ox];
  hflx_ppm_outer_2_6_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_outer_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_6_para.ox];
  hflx_ppm_outer_2_6_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_outer_2_6_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_6_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_6_para.ox];
  
  athread_spawn(hflx_ppm_outer_2_6, &hflx_ppm_outer_2_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &advpt->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_2_7_info hflx_ppm_outer_2_7_para;
  hflx_ppm_outer_2_7_para.lz = 32 - 0;
  hflx_ppm_outer_2_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_outer_2_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_2_7_para.oz = 0;
  hflx_ppm_outer_2_7_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_outer_2_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_2_7_para.hx = Proc.lon_hw;
  hflx_ppm_outer_2_7_para.hy = Proc.lat_hw;
  hflx_ppm_outer_2_7_para.hz = 0;
  hflx_ppm_outer_2_7_para.bx = 64;
  hflx_ppm_outer_2_7_para.by = 1;
  hflx_ppm_outer_2_7_para.bz = 1;
  hflx_ppm_outer_2_7_para.mx = 1;
  hflx_ppm_outer_2_7_para.my = 2;
  hflx_ppm_outer_2_7_para.mz = 32;
  hflx_ppm_outer_2_7_para.advptcflx = &advpt->cflx[Proc.lev_hw - 0+hflx_ppm_outer_2_7_para.oz][Proc.lat_hw -hflx_ppm_outer_2_7_para.hy +hflx_ppm_outer_2_7_para.oy][Proc.lon_hw -hflx_ppm_outer_2_7_para.hx +hflx_ppm_outer_2_7_para.ox];
  hflx_ppm_outer_2_7_para.advptqy = &advpt->qy[Proc.lev_hw - 0+hflx_ppm_outer_2_7_para.oz][Proc.lat_hw -hflx_ppm_outer_2_7_para.hy +hflx_ppm_outer_2_7_para.oy][Proc.lon_hw -hflx_ppm_outer_2_7_para.hx +hflx_ppm_outer_2_7_para.ox];
  hflx_ppm_outer_2_7_para.advptmfx = &advpt->mfx[Proc.lev_hw - 0+hflx_ppm_outer_2_7_para.oz][Proc.lat_hw -hflx_ppm_outer_2_7_para.hy +hflx_ppm_outer_2_7_para.oy][Proc.lon_hw -hflx_ppm_outer_2_7_para.hx +hflx_ppm_outer_2_7_para.ox];
  hflx_ppm_outer_2_7_para.advptqlx = &advpt->qlx[Proc.lev_hw - 0+hflx_ppm_outer_2_7_para.oz][Proc.lat_hw -hflx_ppm_outer_2_7_para.hy +hflx_ppm_outer_2_7_para.oy][Proc.lon_hw -hflx_ppm_outer_2_7_para.hx +hflx_ppm_outer_2_7_para.ox];
  hflx_ppm_outer_2_7_para.advptdqx = &advpt->dqx[Proc.lev_hw - 0+hflx_ppm_outer_2_7_para.oz][Proc.lat_hw -hflx_ppm_outer_2_7_para.hy +hflx_ppm_outer_2_7_para.oy][Proc.lon_hw -hflx_ppm_outer_2_7_para.hx +hflx_ppm_outer_2_7_para.ox];
  hflx_ppm_outer_2_7_para.advptq6x = &advpt->q6x[Proc.lev_hw - 0+hflx_ppm_outer_2_7_para.oz][Proc.lat_hw -hflx_ppm_outer_2_7_para.hy +hflx_ppm_outer_2_7_para.oy][Proc.lon_hw -hflx_ppm_outer_2_7_para.hx +hflx_ppm_outer_2_7_para.ox];
  hflx_ppm_outer_2_7_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+hflx_ppm_outer_2_7_para.oz][Proc.lat_hw -hflx_ppm_outer_2_7_para.hy +hflx_ppm_outer_2_7_para.oy][Proc.lon_hw -hflx_ppm_outer_2_7_para.hx +hflx_ppm_outer_2_7_para.ox];
  
  athread_spawn(hflx_ppm_outer_2_7, &hflx_ppm_outer_2_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerptf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lon[0][0][0], &Proc.FieldReq[async_ptf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_2_8_info hflx_ppm_outer_2_8_para;
  hflx_ppm_outer_2_8_para.lz = 32 - 0;
  hflx_ppm_outer_2_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_2_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_2_8_para.oz = 0;
  hflx_ppm_outer_2_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_2_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_2_8_para.hx = 0;
  hflx_ppm_outer_2_8_para.hy = 1;
  hflx_ppm_outer_2_8_para.hz = 0;
  hflx_ppm_outer_2_8_para.bx = 256;
  hflx_ppm_outer_2_8_para.by = 8;
  hflx_ppm_outer_2_8_para.bz = 1;
  hflx_ppm_outer_2_8_para.mx = 1;
  hflx_ppm_outer_2_8_para.my = 2;
  hflx_ppm_outer_2_8_para.mz = 32;
  hflx_ppm_outer_2_8_para.advptcfly = &advpt->cfly[Proc.lev_hw - 0+hflx_ppm_outer_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_8_para.ox];
  hflx_ppm_outer_2_8_para.advptmfy = &advpt->mfy[Proc.lev_hw - 0+hflx_ppm_outer_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_8_para.ox];
  hflx_ppm_outer_2_8_para.advptqly = &advpt->qly[Proc.lev_hw - 0+hflx_ppm_outer_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_8_para.ox];
  hflx_ppm_outer_2_8_para.advptdqy = &advpt->dqy[Proc.lev_hw - 0+hflx_ppm_outer_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_8_para.ox];
  hflx_ppm_outer_2_8_para.advptq6y = &advpt->q6y[Proc.lev_hw - 0+hflx_ppm_outer_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_8_para.ox];
  hflx_ppm_outer_2_8_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+hflx_ppm_outer_2_8_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_8_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_8_para.ox];
  
  athread_spawn(hflx_ppm_outer_2_8, &hflx_ppm_outer_2_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerptf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->ptf_lat[0][0][0], &Proc.FieldReq[async_ptf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_2_12_info calc_grad_ptf_2_12_para;
  calc_grad_ptf_2_12_para.lz = 32 - 0;
  calc_grad_ptf_2_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_ptf_2_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_2_12_para.oz = 0;
  calc_grad_ptf_2_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_ptf_2_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_2_12_para.hx = 1;
  calc_grad_ptf_2_12_para.hy = 0;
  calc_grad_ptf_2_12_para.hz = 0;
  calc_grad_ptf_2_12_para.bx = 256;
  calc_grad_ptf_2_12_para.by = 8;
  calc_grad_ptf_2_12_para.bz = 1;
  calc_grad_ptf_2_12_para.mx = 1;
  calc_grad_ptf_2_12_para.my = 2;
  calc_grad_ptf_2_12_para.mz = 32;
  calc_grad_ptf_2_12_para.star_stateptf_lon = &star_state->ptf_lon[Proc.lev_hw - 0+calc_grad_ptf_2_12_para.oz][Proc.lat_hw -0+calc_grad_ptf_2_12_para.oy][Proc.lon_hw -1+calc_grad_ptf_2_12_para.ox];
  calc_grad_ptf_2_12_para.tend1dptfdlon = &tend1->dptfdlon[Proc.lev_hw - 0+calc_grad_ptf_2_12_para.oz][Proc.lat_hw -0+calc_grad_ptf_2_12_para.oy][Proc.lon_hw -1+calc_grad_ptf_2_12_para.ox];
  calc_grad_ptf_2_12_para.le_lon = &mesh->le_lon[0][0][0];
  calc_grad_ptf_2_12_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_ptf_2_12, &calc_grad_ptf_2_12_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfdptfdlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_2_13_info calc_grad_ptf_2_13_para;
  calc_grad_ptf_2_13_para.lz = 32 - 0;
  calc_grad_ptf_2_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_ptf_2_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_2_13_para.oz = 0;
  calc_grad_ptf_2_13_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_ptf_2_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_2_13_para.hx = 0;
  calc_grad_ptf_2_13_para.hy = 1;
  calc_grad_ptf_2_13_para.hz = 0;
  calc_grad_ptf_2_13_para.bx = 256;
  calc_grad_ptf_2_13_para.by = 8;
  calc_grad_ptf_2_13_para.bz = 1;
  calc_grad_ptf_2_13_para.mx = 1;
  calc_grad_ptf_2_13_para.my = 2;
  calc_grad_ptf_2_13_para.mz = 32;
  calc_grad_ptf_2_13_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+calc_grad_ptf_2_13_para.oz][Proc.lat_hw -1+calc_grad_ptf_2_13_para.oy][Proc.lon_hw -0+calc_grad_ptf_2_13_para.ox];
  calc_grad_ptf_2_13_para.tend1dptfdlat = &tend1->dptfdlat[Proc.lev_hw - 0+calc_grad_ptf_2_13_para.oz][Proc.lat_hw -1+calc_grad_ptf_2_13_para.oy][Proc.lon_hw -0+calc_grad_ptf_2_13_para.ox];
  calc_grad_ptf_2_13_para.le_lat = &mesh->le_lat[0][0][0];
  calc_grad_ptf_2_13_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_ptf_2_13, &calc_grad_ptf_2_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfdptfdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ptf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_2_14_info calc_grad_ptf_2_14_para;
  calc_grad_ptf_2_14_para.lz = 32 - 0;
  calc_grad_ptf_2_14_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_grad_ptf_2_14_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_2_14_para.oz = 0;
  calc_grad_ptf_2_14_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_grad_ptf_2_14_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_2_14_para.hx = 0;
  calc_grad_ptf_2_14_para.hy = 1;
  calc_grad_ptf_2_14_para.hz = 0;
  calc_grad_ptf_2_14_para.bx = 256;
  calc_grad_ptf_2_14_para.by = 8;
  calc_grad_ptf_2_14_para.bz = 1;
  calc_grad_ptf_2_14_para.mx = 1;
  calc_grad_ptf_2_14_para.my = 2;
  calc_grad_ptf_2_14_para.mz = 32;
  calc_grad_ptf_2_14_para.star_stateptf_lat = &star_state->ptf_lat[Proc.lev_hw - 0+calc_grad_ptf_2_14_para.oz][Proc.lat_hw -1+calc_grad_ptf_2_14_para.oy][Proc.lon_hw -0+calc_grad_ptf_2_14_para.ox];
  calc_grad_ptf_2_14_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_grad_ptf_2_14_para.oz][Proc.lat_hw -1+calc_grad_ptf_2_14_para.oy][Proc.lon_hw -0+calc_grad_ptf_2_14_para.ox];
  
  athread_spawn(calc_grad_ptf_2_14, &calc_grad_ptf_2_14_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptftmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:star_state->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
  tmp_star_state_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_star_state_tmpsum[k-Proc.lev_hw]=tmp_star_state_tmpsum[k-Proc.lev_hw]+star_state->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_star_state_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->tmpsum[k][j][i]=tmp_star_state_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_star_state_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_2_15_info calc_grad_ptf_2_15_para;
  calc_grad_ptf_2_15_para.lz = 32 - 0;
  calc_grad_ptf_2_15_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  calc_grad_ptf_2_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_2_15_para.oz = 0;
  calc_grad_ptf_2_15_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  calc_grad_ptf_2_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_2_15_para.hx = 0;
  calc_grad_ptf_2_15_para.hy = 0;
  calc_grad_ptf_2_15_para.hz = 0;
  calc_grad_ptf_2_15_para.bx = 256;
  calc_grad_ptf_2_15_para.by = 8;
  calc_grad_ptf_2_15_para.bz = 1;
  calc_grad_ptf_2_15_para.mx = 1;
  calc_grad_ptf_2_15_para.my = 2;
  calc_grad_ptf_2_15_para.mz = 32;
  calc_grad_ptf_2_15_para.star_statetmpsum = &star_state->tmpsum[Proc.lev_hw - 0+calc_grad_ptf_2_15_para.oz][Proc.lat_hw -0+calc_grad_ptf_2_15_para.oy][Proc.lon_hw -0+calc_grad_ptf_2_15_para.ox];
  calc_grad_ptf_2_15_para.tend1dptfdlat = &tend1->dptfdlat[Proc.lev_hw - 0+calc_grad_ptf_2_15_para.oz][Proc.lat_hw -0+calc_grad_ptf_2_15_para.oy][Proc.lon_hw -0+calc_grad_ptf_2_15_para.ox];
  calc_grad_ptf_2_15_para.le_lat = &mesh->le_lat[0][0][0];
  calc_grad_ptf_2_15_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(calc_grad_ptf_2_15, &calc_grad_ptf_2_15_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfdptfdlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=-1+Proc.lev_hw; k<0+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->pt[k][j][i] = ((2 * star_state->pt[(k + 1)][j][i]) - star_state->pt[(k + 2)][j][i]);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=-2+Proc.lev_hw; k<-1+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        star_state->pt[k][j][i] = ((2 * star_state->pt[(k + 1)][j][i]) - star_state->pt[(k + 2)][j][i]);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_2_16_info calc_grad_ptf_2_16_para;
  calc_grad_ptf_2_16_para.lz = 34 - 32;
  calc_grad_ptf_2_16_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_grad_ptf_2_16_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_2_16_para.oz = 32;
  calc_grad_ptf_2_16_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_ptf_2_16_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_2_16_para.hx = 2;
  calc_grad_ptf_2_16_para.hy = 0;
  calc_grad_ptf_2_16_para.hz = 2;
  calc_grad_ptf_2_16_para.bx = 256;
  calc_grad_ptf_2_16_para.by = 1;
  calc_grad_ptf_2_16_para.bz = 4;
  calc_grad_ptf_2_16_para.mx = 1;
  calc_grad_ptf_2_16_para.my = 8;
  calc_grad_ptf_2_16_para.mz = 8;
  calc_grad_ptf_2_16_para.star_statept = &star_state->pt[Proc.lev_hw - 2+calc_grad_ptf_2_16_para.oz][Proc.lat_hw -0+calc_grad_ptf_2_16_para.oy][Proc.lon_hw -2+calc_grad_ptf_2_16_para.ox];
  
  athread_spawn(calc_grad_ptf_2_16, &calc_grad_ptf_2_16_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &star_state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        buf = ppm(star_state->pt[(k - 2)][j][i],star_state->pt[(k - 1)][j][i],star_state->pt[k][j][i],star_state->pt[(k + 1)][j][i],star_state->pt[(k + 2)][j][i]);
        advpt->qlx[k][j][i] = buf.x;
        advpt->dqx[k][j][i] = buf.y;
        advpt->q6x[k][j][i] = buf.z;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &advpt->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &advpt->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=1+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        ci = (int)(advpt->cflz[k][j][i]);
        cf = (advpt->cflz[k][j][i] - ci);
        if ((advpt->cflz[k][j][i] > 0))
        {
          s1 = (1.0 - cf);
          s2 = 1.0;
          ds1 = (s2 - s1);
          ds2 = (pow(s2,2) - pow(s1,2));
          ds3 = (pow(s2,3) - pow(s1,3));
          cursum = 0.0;
          for (l=(k - ci);l<((k - 1) + 1);l+=1){
            cursum = (cursum + star_state->pt[l][j][i]);
          }
          star_state->ptf_lev[k][j][i] = ((advpt->we[k][j][i] * (((cursum + (advpt->qlx[((k - ci) - 1)][j][i] * ds1)) + ((0.5 * advpt->dqx[((k - ci) - 1)][j][i]) * ds2)) + (advpt->q6x[((k - ci) - 1)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / advpt->cflz[k][j][i]);
        }
        else
        {
          if ((advpt->cflz[k][j][i] < 0))
          {
            s1 = 0.0;
            s2 = -cf;
            ds1 = (s2 - s1);
            ds2 = (pow(s2,2) - pow(s1,2));
            ds3 = (pow(s2,3) - pow(s1,3));
            for (l=k;l<(((k - ci) - 1) + 1);l+=1){
              cursum = (cursum + star_state->pt[l][j][i]);
            }
            star_state->ptf_lev[k][j][i] = ((-advpt->we[k][j][i] * (((cursum + (advpt->qlx[(k - ci)][j][i] * ds1)) + ((0.5 * advpt->dqx[(k - ci)][j][i]) * ds2)) + (advpt->q6x[(k - ci)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / advpt->cflz[k][j][i]);
          }
          else
          {
            star_state->ptf_lev[k][j][i] = 0.0;
          }
        }
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmptf_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ptf_2_17_info calc_grad_ptf_2_17_para;
  calc_grad_ptf_2_17_para.lz = 32 - 0;
  calc_grad_ptf_2_17_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_grad_ptf_2_17_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ptf_2_17_para.oz = 0;
  calc_grad_ptf_2_17_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_ptf_2_17_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ptf_2_17_para.hx = 0;
  calc_grad_ptf_2_17_para.hy = 0;
  calc_grad_ptf_2_17_para.hz = 1;
  calc_grad_ptf_2_17_para.bx = 256;
  calc_grad_ptf_2_17_para.by = 1;
  calc_grad_ptf_2_17_para.bz = 4;
  calc_grad_ptf_2_17_para.mx = 1;
  calc_grad_ptf_2_17_para.my = 8;
  calc_grad_ptf_2_17_para.mz = 8;
  calc_grad_ptf_2_17_para.star_stateptf_lev = &star_state->ptf_lev[Proc.lev_hw - 1+calc_grad_ptf_2_17_para.oz][Proc.lat_hw -0+calc_grad_ptf_2_17_para.oy][Proc.lon_hw -0+calc_grad_ptf_2_17_para.ox];
  calc_grad_ptf_2_17_para.tend1dptfdlev = &tend1->dptfdlev[Proc.lev_hw - 1+calc_grad_ptf_2_17_para.oz][Proc.lat_hw -0+calc_grad_ptf_2_17_para.oy][Proc.lon_hw -0+calc_grad_ptf_2_17_para.ox];
  
  athread_spawn(calc_grad_ptf_2_17, &calc_grad_ptf_2_17_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_ptfdptfdlevTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_coriolis_2_4_info calc_coriolis_2_4_para;
  calc_coriolis_2_4_para.lz = 32 - 0;
  calc_coriolis_2_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_coriolis_2_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_coriolis_2_4_para.oz = 0;
  calc_coriolis_2_4_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_coriolis_2_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_coriolis_2_4_para.hx = 1;
  calc_coriolis_2_4_para.hy = 1;
  calc_coriolis_2_4_para.hz = 0;
  calc_coriolis_2_4_para.bx = 256;
  calc_coriolis_2_4_para.by = 8;
  calc_coriolis_2_4_para.bz = 1;
  calc_coriolis_2_4_para.mx = 1;
  calc_coriolis_2_4_para.my = 2;
  calc_coriolis_2_4_para.mz = 32;
  calc_coriolis_2_4_para.star_statemfx_lon = &star_state->mfx_lon[Proc.lev_hw - 0+calc_coriolis_2_4_para.oz][Proc.lat_hw -1+calc_coriolis_2_4_para.oy][Proc.lon_hw -1+calc_coriolis_2_4_para.ox];
  calc_coriolis_2_4_para.star_statepv_lat = &star_state->pv_lat[Proc.lev_hw - 0+calc_coriolis_2_4_para.oz][Proc.lat_hw -1+calc_coriolis_2_4_para.oy][Proc.lon_hw -1+calc_coriolis_2_4_para.ox];
  calc_coriolis_2_4_para.star_statepv_lon = &star_state->pv_lon[Proc.lev_hw - 0+calc_coriolis_2_4_para.oz][Proc.lat_hw -1+calc_coriolis_2_4_para.oy][Proc.lon_hw -1+calc_coriolis_2_4_para.ox];
  calc_coriolis_2_4_para.tend1qhu = &tend1->qhu[Proc.lev_hw - 0+calc_coriolis_2_4_para.oz][Proc.lat_hw -1+calc_coriolis_2_4_para.oy][Proc.lon_hw -1+calc_coriolis_2_4_para.ox];
  calc_coriolis_2_4_para.half_tangent_wgt_0 = &mesh->half_tangent_wgt_0[0][0][0];
  calc_coriolis_2_4_para.half_tangent_wgt_1 = &mesh->half_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_coriolis_2_4, &calc_coriolis_2_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_coriolisqhuTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_pv_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_coriolis_2_5_info calc_coriolis_2_5_para;
  calc_coriolis_2_5_para.lz = 32 - 0;
  calc_coriolis_2_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_coriolis_2_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_coriolis_2_5_para.oz = 0;
  calc_coriolis_2_5_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_coriolis_2_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_coriolis_2_5_para.hx = 1;
  calc_coriolis_2_5_para.hy = 1;
  calc_coriolis_2_5_para.hz = 0;
  calc_coriolis_2_5_para.bx = 256;
  calc_coriolis_2_5_para.by = 8;
  calc_coriolis_2_5_para.bz = 1;
  calc_coriolis_2_5_para.mx = 1;
  calc_coriolis_2_5_para.my = 2;
  calc_coriolis_2_5_para.mz = 32;
  calc_coriolis_2_5_para.star_statemfy_lat = &star_state->mfy_lat[Proc.lev_hw - 0+calc_coriolis_2_5_para.oz][Proc.lat_hw -1+calc_coriolis_2_5_para.oy][Proc.lon_hw -1+calc_coriolis_2_5_para.ox];
  calc_coriolis_2_5_para.star_statepv_lon = &star_state->pv_lon[Proc.lev_hw - 0+calc_coriolis_2_5_para.oz][Proc.lat_hw -1+calc_coriolis_2_5_para.oy][Proc.lon_hw -1+calc_coriolis_2_5_para.ox];
  calc_coriolis_2_5_para.star_statepv_lat = &star_state->pv_lat[Proc.lev_hw - 0+calc_coriolis_2_5_para.oz][Proc.lat_hw -1+calc_coriolis_2_5_para.oy][Proc.lon_hw -1+calc_coriolis_2_5_para.ox];
  calc_coriolis_2_5_para.tend1qhv = &tend1->qhv[Proc.lev_hw - 0+calc_coriolis_2_5_para.oz][Proc.lat_hw -1+calc_coriolis_2_5_para.oy][Proc.lon_hw -1+calc_coriolis_2_5_para.ox];
  calc_coriolis_2_5_para.full_tangent_wgt_0 = &mesh->full_tangent_wgt_0[0][0][0];
  calc_coriolis_2_5_para.full_tangent_wgt_1 = &mesh->full_tangent_wgt_1[0][0][0];
  
  athread_spawn(calc_coriolis_2_5, &calc_coriolis_2_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_coriolisqhvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ke_2_4_info calc_grad_ke_2_4_para;
  calc_grad_ke_2_4_para.lz = 32 - 0;
  calc_grad_ke_2_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_grad_ke_2_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ke_2_4_para.oz = 0;
  calc_grad_ke_2_4_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_grad_ke_2_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ke_2_4_para.hx = 1;
  calc_grad_ke_2_4_para.hy = 1;
  calc_grad_ke_2_4_para.hz = 0;
  calc_grad_ke_2_4_para.bx = 256;
  calc_grad_ke_2_4_para.by = 8;
  calc_grad_ke_2_4_para.bz = 1;
  calc_grad_ke_2_4_para.mx = 1;
  calc_grad_ke_2_4_para.my = 2;
  calc_grad_ke_2_4_para.mz = 32;
  calc_grad_ke_2_4_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_grad_ke_2_4_para.oz][Proc.lat_hw -1+calc_grad_ke_2_4_para.oy][Proc.lon_hw -1+calc_grad_ke_2_4_para.ox];
  calc_grad_ke_2_4_para.tend1dkedlon = &tend1->dkedlon[Proc.lev_hw - 0+calc_grad_ke_2_4_para.oz][Proc.lat_hw -1+calc_grad_ke_2_4_para.oy][Proc.lon_hw -1+calc_grad_ke_2_4_para.ox];
  calc_grad_ke_2_4_para.de_lon = &mesh->de_lon[0][0][0];
  
  athread_spawn(calc_grad_ke_2_4, &calc_grad_ke_2_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_kedkedlonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_ke]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_grad_ke_2_5_info calc_grad_ke_2_5_para;
  calc_grad_ke_2_5_para.lz = 32 - 0;
  calc_grad_ke_2_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_grad_ke_2_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_grad_ke_2_5_para.oz = 0;
  calc_grad_ke_2_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_grad_ke_2_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_grad_ke_2_5_para.hx = 1;
  calc_grad_ke_2_5_para.hy = 1;
  calc_grad_ke_2_5_para.hz = 0;
  calc_grad_ke_2_5_para.bx = 256;
  calc_grad_ke_2_5_para.by = 8;
  calc_grad_ke_2_5_para.bz = 1;
  calc_grad_ke_2_5_para.mx = 1;
  calc_grad_ke_2_5_para.my = 2;
  calc_grad_ke_2_5_para.mz = 32;
  calc_grad_ke_2_5_para.star_stateke = &star_state->ke[Proc.lev_hw - 0+calc_grad_ke_2_5_para.oz][Proc.lat_hw -1+calc_grad_ke_2_5_para.oy][Proc.lon_hw -1+calc_grad_ke_2_5_para.ox];
  calc_grad_ke_2_5_para.tend1dkedlat = &tend1->dkedlat[Proc.lev_hw - 0+calc_grad_ke_2_5_para.oz][Proc.lat_hw -1+calc_grad_ke_2_5_para.oy][Proc.lon_hw -1+calc_grad_ke_2_5_para.ox];
  calc_grad_ke_2_5_para.de_lat = &mesh->de_lat[0][0][0];
  
  athread_spawn(calc_grad_ke_2_5, &calc_grad_ke_2_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_grad_kedkedlatTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  tendPara = tendPara;
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_forward_2_6_info calc_tend_forward_2_6_para;
  calc_tend_forward_2_6_para.lz = 32 - 0;
  calc_tend_forward_2_6_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_tend_forward_2_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_forward_2_6_para.oz = 0;
  calc_tend_forward_2_6_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_tend_forward_2_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_forward_2_6_para.hx = 1;
  calc_tend_forward_2_6_para.hy = 1;
  calc_tend_forward_2_6_para.hz = 0;
  calc_tend_forward_2_6_para.bx = 256;
  calc_tend_forward_2_6_para.by = 8;
  calc_tend_forward_2_6_para.bz = 1;
  calc_tend_forward_2_6_para.mx = 1;
  calc_tend_forward_2_6_para.my = 2;
  calc_tend_forward_2_6_para.mz = 32;
  calc_tend_forward_2_6_para.tend1qhv = &tend1->qhv[Proc.lev_hw - 0+calc_tend_forward_2_6_para.oz][Proc.lat_hw -1+calc_tend_forward_2_6_para.oy][Proc.lon_hw -1+calc_tend_forward_2_6_para.ox];
  calc_tend_forward_2_6_para.tend1dkedlon = &tend1->dkedlon[Proc.lev_hw - 0+calc_tend_forward_2_6_para.oz][Proc.lat_hw -1+calc_tend_forward_2_6_para.oy][Proc.lon_hw -1+calc_tend_forward_2_6_para.ox];
  calc_tend_forward_2_6_para.tend1wedudlev = &tend1->wedudlev[Proc.lev_hw - 0+calc_tend_forward_2_6_para.oz][Proc.lat_hw -1+calc_tend_forward_2_6_para.oy][Proc.lon_hw -1+calc_tend_forward_2_6_para.ox];
  calc_tend_forward_2_6_para.tend1du = &tend1->du[Proc.lev_hw - 0+calc_tend_forward_2_6_para.oz][Proc.lat_hw -1+calc_tend_forward_2_6_para.oy][Proc.lon_hw -1+calc_tend_forward_2_6_para.ox];
  
  athread_spawn(calc_tend_forward_2_6, &calc_tend_forward_2_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_forwardduTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend1->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_forward_2_7_info calc_tend_forward_2_7_para;
  calc_tend_forward_2_7_para.lz = 32 - 0;
  calc_tend_forward_2_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_tend_forward_2_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_forward_2_7_para.oz = 0;
  calc_tend_forward_2_7_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_tend_forward_2_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_forward_2_7_para.hx = 1;
  calc_tend_forward_2_7_para.hy = 1;
  calc_tend_forward_2_7_para.hz = 0;
  calc_tend_forward_2_7_para.bx = 256;
  calc_tend_forward_2_7_para.by = 8;
  calc_tend_forward_2_7_para.bz = 1;
  calc_tend_forward_2_7_para.mx = 1;
  calc_tend_forward_2_7_para.my = 2;
  calc_tend_forward_2_7_para.mz = 32;
  calc_tend_forward_2_7_para.tend1qhu = &tend1->qhu[Proc.lev_hw - 0+calc_tend_forward_2_7_para.oz][Proc.lat_hw -1+calc_tend_forward_2_7_para.oy][Proc.lon_hw -1+calc_tend_forward_2_7_para.ox];
  calc_tend_forward_2_7_para.tend1dkedlat = &tend1->dkedlat[Proc.lev_hw - 0+calc_tend_forward_2_7_para.oz][Proc.lat_hw -1+calc_tend_forward_2_7_para.oy][Proc.lon_hw -1+calc_tend_forward_2_7_para.ox];
  calc_tend_forward_2_7_para.tend1wedvdlev = &tend1->wedvdlev[Proc.lev_hw - 0+calc_tend_forward_2_7_para.oz][Proc.lat_hw -1+calc_tend_forward_2_7_para.oy][Proc.lon_hw -1+calc_tend_forward_2_7_para.ox];
  calc_tend_forward_2_7_para.tend1dv = &tend1->dv[Proc.lev_hw - 0+calc_tend_forward_2_7_para.oz][Proc.lat_hw -1+calc_tend_forward_2_7_para.oy][Proc.lon_hw -1+calc_tend_forward_2_7_para.ox];
  
  athread_spawn(calc_tend_forward_2_7, &calc_tend_forward_2_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_forwarddvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend1->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_forward_2_8_info calc_tend_forward_2_8_para;
  calc_tend_forward_2_8_para.lz = 32 - 0;
  calc_tend_forward_2_8_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_tend_forward_2_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_forward_2_8_para.oz = 0;
  calc_tend_forward_2_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_tend_forward_2_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_forward_2_8_para.hx = 1;
  calc_tend_forward_2_8_para.hy = 1;
  calc_tend_forward_2_8_para.hz = 0;
  calc_tend_forward_2_8_para.bx = 256;
  calc_tend_forward_2_8_para.by = 8;
  calc_tend_forward_2_8_para.bz = 1;
  calc_tend_forward_2_8_para.mx = 1;
  calc_tend_forward_2_8_para.my = 2;
  calc_tend_forward_2_8_para.mz = 32;
  calc_tend_forward_2_8_para.tend1dptfdlon = &tend1->dptfdlon[Proc.lev_hw - 0+calc_tend_forward_2_8_para.oz][Proc.lat_hw -1+calc_tend_forward_2_8_para.oy][Proc.lon_hw -1+calc_tend_forward_2_8_para.ox];
  calc_tend_forward_2_8_para.tend1dptfdlat = &tend1->dptfdlat[Proc.lev_hw - 0+calc_tend_forward_2_8_para.oz][Proc.lat_hw -1+calc_tend_forward_2_8_para.oy][Proc.lon_hw -1+calc_tend_forward_2_8_para.ox];
  calc_tend_forward_2_8_para.tend1dptfdlev = &tend1->dptfdlev[Proc.lev_hw - 0+calc_tend_forward_2_8_para.oz][Proc.lat_hw -1+calc_tend_forward_2_8_para.oy][Proc.lon_hw -1+calc_tend_forward_2_8_para.ox];
  calc_tend_forward_2_8_para.tend1dpt = &tend1->dpt[Proc.lev_hw - 0+calc_tend_forward_2_8_para.oz][Proc.lat_hw -1+calc_tend_forward_2_8_para.oy][Proc.lon_hw -1+calc_tend_forward_2_8_para.ox];
  
  athread_spawn(calc_tend_forward_2_8, &calc_tend_forward_2_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_forwarddptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend1->dpt[0][0][0], &Proc.FieldReq[async_dpt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  (tendPara->phs) = 1;
  (tendPara->pt) = 1;
  tendPara = tendPara;
  dt = dt;
  if ((tendPara->phs))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,0,&tend1->dphs[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &tend1->dphs[0][0][0], &Proc.FieldReq[async_dphs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        new_state->phs[0][j][i] = (old_state->phs[0][j][i] + (dt * tend1->dphs[0][j][i]));
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statephsTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &new_state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_2_15_info calc_ph_2_15_para;
    calc_ph_2_15_para.lz = 33 - 0;
    calc_ph_2_15_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_2_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_2_15_para.oz = 0;
    calc_ph_2_15_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_2_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_2_15_para.hx = 1;
    calc_ph_2_15_para.hy = 1;
    calc_ph_2_15_para.hz = 0;
    calc_ph_2_15_para.bx = 256;
    calc_ph_2_15_para.by = 8;
    calc_ph_2_15_para.bz = 1;
    calc_ph_2_15_para.mx = 1;
    calc_ph_2_15_para.my = 2;
    calc_ph_2_15_para.mz = 32;
    calc_ph_2_15_para.new_statephs = &new_state->phs[0][Proc.lat_hw -1+calc_ph_2_15_para.oy][Proc.lon_hw -1+calc_ph_2_15_para.ox];
    calc_ph_2_15_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_2_15_para.oz][Proc.lat_hw -1+calc_ph_2_15_para.oy][Proc.lon_hw -1+calc_ph_2_15_para.ox];
    calc_ph_2_15_para.hyai = &mesh->hyai[0][0][0];
    calc_ph_2_15_para.hybi = &mesh->hybi[0][0][0];
    
    athread_spawn(calc_ph_2_15, &calc_ph_2_15_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_2_16_info calc_ph_2_16_para;
    calc_ph_2_16_para.lz = 33 - 0;
    calc_ph_2_16_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_2_16_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_2_16_para.oz = 0;
    calc_ph_2_16_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_2_16_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_2_16_para.hx = 1;
    calc_ph_2_16_para.hy = 1;
    calc_ph_2_16_para.hz = 0;
    calc_ph_2_16_para.bx = 256;
    calc_ph_2_16_para.by = 8;
    calc_ph_2_16_para.bz = 1;
    calc_ph_2_16_para.mx = 1;
    calc_ph_2_16_para.my = 2;
    calc_ph_2_16_para.mz = 32;
    calc_ph_2_16_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_2_16_para.oz][Proc.lat_hw -1+calc_ph_2_16_para.oy][Proc.lon_hw -1+calc_ph_2_16_para.ox];
    calc_ph_2_16_para.new_stateph_exn_lev = &new_state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_2_16_para.oz][Proc.lat_hw -1+calc_ph_2_16_para.oy][Proc.lon_hw -1+calc_ph_2_16_para.ox];
    
    athread_spawn(calc_ph_2_16, &calc_ph_2_16_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_exn_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_2_17_info calc_ph_2_17_para;
    calc_ph_2_17_para.lz = 32 - 0;
    calc_ph_2_17_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_2_17_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_2_17_para.oz = 0;
    calc_ph_2_17_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_2_17_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_2_17_para.hx = 0;
    calc_ph_2_17_para.hy = 0;
    calc_ph_2_17_para.hz = 1;
    calc_ph_2_17_para.bx = 256;
    calc_ph_2_17_para.by = 1;
    calc_ph_2_17_para.bz = 4;
    calc_ph_2_17_para.mx = 1;
    calc_ph_2_17_para.my = 8;
    calc_ph_2_17_para.mz = 8;
    calc_ph_2_17_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_ph_2_17_para.oz][Proc.lat_hw -0+calc_ph_2_17_para.oy][Proc.lon_hw -0+calc_ph_2_17_para.ox];
    calc_ph_2_17_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_ph_2_17_para.oz][Proc.lat_hw -0+calc_ph_2_17_para.oy][Proc.lon_hw -0+calc_ph_2_17_para.ox];
    
    athread_spawn(calc_ph_2_17, &calc_ph_2_17_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phphTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_36_info calc_m_2_36_para;
    calc_m_2_36_para.lz = 32 - 0;
    calc_m_2_36_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_36_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_36_para.oz = 0;
    calc_m_2_36_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_36_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_36_para.hx = 1;
    calc_m_2_36_para.hy = 0;
    calc_m_2_36_para.hz = 1;
    calc_m_2_36_para.bx = 256;
    calc_m_2_36_para.by = 1;
    calc_m_2_36_para.bz = 4;
    calc_m_2_36_para.mx = 1;
    calc_m_2_36_para.my = 8;
    calc_m_2_36_para.mz = 8;
    calc_m_2_36_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_2_36_para.oz][Proc.lat_hw -0+calc_m_2_36_para.oy][Proc.lon_hw -1+calc_m_2_36_para.ox];
    calc_m_2_36_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_2_36_para.oz][Proc.lat_hw -0+calc_m_2_36_para.oy][Proc.lon_hw -1+calc_m_2_36_para.ox];
    
    athread_spawn(calc_m_2_36, &calc_m_2_36_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_37_info calc_m_2_37_para;
    calc_m_2_37_para.lz = 32 - 1;
    calc_m_2_37_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_37_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_37_para.oz = 1;
    calc_m_2_37_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_37_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_37_para.hx = 0;
    calc_m_2_37_para.hy = 0;
    calc_m_2_37_para.hz = 1;
    calc_m_2_37_para.bx = 256;
    calc_m_2_37_para.by = 1;
    calc_m_2_37_para.bz = 4;
    calc_m_2_37_para.mx = 1;
    calc_m_2_37_para.my = 8;
    calc_m_2_37_para.mz = 8;
    calc_m_2_37_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_2_37_para.oz][Proc.lat_hw -0+calc_m_2_37_para.oy][Proc.lon_hw -0+calc_m_2_37_para.ox];
    calc_m_2_37_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_2_37_para.oz][Proc.lat_hw -0+calc_m_2_37_para.oy][Proc.lon_hw -0+calc_m_2_37_para.ox];
    
    athread_spawn(calc_m_2_37, &calc_m_2_37_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_38_info calc_m_2_38_para;
    calc_m_2_38_para.lz = 1 - 0;
    calc_m_2_38_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_38_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_38_para.oz = 0;
    calc_m_2_38_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_38_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_38_para.hx = 0;
    calc_m_2_38_para.hy = 0;
    calc_m_2_38_para.hz = 0;
    calc_m_2_38_para.bx = 256;
    calc_m_2_38_para.by = 8;
    calc_m_2_38_para.bz = 1;
    calc_m_2_38_para.mx = 1;
    calc_m_2_38_para.my = 2;
    calc_m_2_38_para.mz = 32;
    calc_m_2_38_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_2_38_para.oz][Proc.lat_hw -0+calc_m_2_38_para.oy][Proc.lon_hw -0+calc_m_2_38_para.ox];
    calc_m_2_38_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_2_38_para.oz][Proc.lat_hw -0+calc_m_2_38_para.oy][Proc.lon_hw -0+calc_m_2_38_para.ox];
    calc_m_2_38_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_2_38_para.oz][Proc.lat_hw -0+calc_m_2_38_para.oy][Proc.lon_hw -0+calc_m_2_38_para.ox];
    
    athread_spawn(calc_m_2_38, &calc_m_2_38_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_39_info calc_m_2_39_para;
    calc_m_2_39_para.lz = 33 - 32;
    calc_m_2_39_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_39_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_39_para.oz = 32;
    calc_m_2_39_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_39_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_39_para.hx = 0;
    calc_m_2_39_para.hy = 0;
    calc_m_2_39_para.hz = 1;
    calc_m_2_39_para.bx = 256;
    calc_m_2_39_para.by = 1;
    calc_m_2_39_para.bz = 4;
    calc_m_2_39_para.mx = 1;
    calc_m_2_39_para.my = 8;
    calc_m_2_39_para.mz = 8;
    calc_m_2_39_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_2_39_para.oz][Proc.lat_hw -0+calc_m_2_39_para.oy][Proc.lon_hw -0+calc_m_2_39_para.ox];
    calc_m_2_39_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_2_39_para.oz][Proc.lat_hw -0+calc_m_2_39_para.oy][Proc.lon_hw -0+calc_m_2_39_para.ox];
    calc_m_2_39_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_2_39_para.oz][Proc.lat_hw -0+calc_m_2_39_para.oy][Proc.lon_hw -0+calc_m_2_39_para.ox];
    
    athread_spawn(calc_m_2_39, &calc_m_2_39_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_2_9_info averageCellToLonEdge_2_9_para;
    averageCellToLonEdge_2_9_para.lz = 32 - 0;
    averageCellToLonEdge_2_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_2_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_2_9_para.oz = 0;
    averageCellToLonEdge_2_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_2_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_2_9_para.hx = 1;
    averageCellToLonEdge_2_9_para.hy = 1;
    averageCellToLonEdge_2_9_para.hz = 0;
    averageCellToLonEdge_2_9_para.bx = 256;
    averageCellToLonEdge_2_9_para.by = 8;
    averageCellToLonEdge_2_9_para.bz = 1;
    averageCellToLonEdge_2_9_para.mx = 1;
    averageCellToLonEdge_2_9_para.my = 2;
    averageCellToLonEdge_2_9_para.mz = 32;
    averageCellToLonEdge_2_9_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_2_9_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_9_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_9_para.ox];
    averageCellToLonEdge_2_9_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_2_9_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_9_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_9_para.ox];
    
    athread_spawn(averageCellToLonEdge_2_9, &averageCellToLonEdge_2_9_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_2_9_info averageCellToLatEdge_2_9_para;
    averageCellToLatEdge_2_9_para.lz = 32 - 0;
    averageCellToLatEdge_2_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_2_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_2_9_para.oz = 0;
    averageCellToLatEdge_2_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_2_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_2_9_para.hx = 1;
    averageCellToLatEdge_2_9_para.hy = 1;
    averageCellToLatEdge_2_9_para.hz = 0;
    averageCellToLatEdge_2_9_para.bx = 256;
    averageCellToLatEdge_2_9_para.by = 8;
    averageCellToLatEdge_2_9_para.bz = 1;
    averageCellToLatEdge_2_9_para.mx = 1;
    averageCellToLatEdge_2_9_para.my = 2;
    averageCellToLatEdge_2_9_para.mz = 32;
    averageCellToLatEdge_2_9_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_2_9_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_9_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_9_para.ox];
    averageCellToLatEdge_2_9_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_2_9_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_9_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_9_para.ox];
    
    athread_spawn(averageCellToLatEdge_2_9, &averageCellToLatEdge_2_9_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_2_9_info interpCellToVtx_2_9_para;
    interpCellToVtx_2_9_para.lz = 32 - 0;
    interpCellToVtx_2_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_2_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_2_9_para.oz = 0;
    interpCellToVtx_2_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_2_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_2_9_para.hx = 1;
    interpCellToVtx_2_9_para.hy = 1;
    interpCellToVtx_2_9_para.hz = 0;
    interpCellToVtx_2_9_para.bx = 256;
    interpCellToVtx_2_9_para.by = 8;
    interpCellToVtx_2_9_para.bz = 1;
    interpCellToVtx_2_9_para.mx = 1;
    interpCellToVtx_2_9_para.my = 2;
    interpCellToVtx_2_9_para.mz = 32;
    interpCellToVtx_2_9_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_2_9_para.oz][Proc.lat_hw -1+interpCellToVtx_2_9_para.oy][Proc.lon_hw -1+interpCellToVtx_2_9_para.ox];
    interpCellToVtx_2_9_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_2_9_para.oz][Proc.lat_hw -1+interpCellToVtx_2_9_para.oy][Proc.lon_hw -1+interpCellToVtx_2_9_para.ox];
    interpCellToVtx_2_9_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_2_9_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_2_9_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_2_9, &interpCellToVtx_2_9_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->pt))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,1,&tend1->dpt[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend1->dpt[0][0][0], &Proc.FieldReq[async_dpt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_pt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_2_16_info update_state_2_16_para;
    update_state_2_16_para.lz = 32 - 0;
    update_state_2_16_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_2_16_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_2_16_para.oz = 0;
    update_state_2_16_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_2_16_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_2_16_para.hx = 2;
    update_state_2_16_para.hy = 2;
    update_state_2_16_para.hz = 0;
    update_state_2_16_para.bx = 256;
    update_state_2_16_para.by = 8;
    update_state_2_16_para.bz = 1;
    update_state_2_16_para.mx = 1;
    update_state_2_16_para.my = 2;
    update_state_2_16_para.mz = 32;
    update_state_2_16_para.old_statept = &old_state->pt[Proc.lev_hw - 0+update_state_2_16_para.oz][Proc.lat_hw -2+update_state_2_16_para.oy][Proc.lon_hw -2+update_state_2_16_para.ox];
    update_state_2_16_para.old_statem = &old_state->m[Proc.lev_hw - 0+update_state_2_16_para.oz][Proc.lat_hw -2+update_state_2_16_para.oy][Proc.lon_hw -2+update_state_2_16_para.ox];
    update_state_2_16_para.tend1dpt = &tend1->dpt[Proc.lev_hw - 0+update_state_2_16_para.oz][Proc.lat_hw -2+update_state_2_16_para.oy][Proc.lon_hw -2+update_state_2_16_para.ox];
    update_state_2_16_para.new_statem = &new_state->m[Proc.lev_hw - 0+update_state_2_16_para.oz][Proc.lat_hw -2+update_state_2_16_para.oy][Proc.lon_hw -2+update_state_2_16_para.ox];
    update_state_2_16_para.new_statept = &new_state->pt[Proc.lev_hw - 0+update_state_2_16_para.oz][Proc.lat_hw -2+update_state_2_16_para.oy][Proc.lon_hw -2+update_state_2_16_para.ox];
    update_state_2_16_para.dt = dt;
    
    athread_spawn(update_state_2_16, &update_state_2_16_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateptTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->gz))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_2_17_info update_state_2_17_para;
    update_state_2_17_para.lz = 32 - 0;
    update_state_2_17_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_2_17_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_2_17_para.oz = 0;
    update_state_2_17_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_2_17_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_2_17_para.hx = 0;
    update_state_2_17_para.hy = 0;
    update_state_2_17_para.hz = 0;
    update_state_2_17_para.bx = 256;
    update_state_2_17_para.by = 8;
    update_state_2_17_para.bz = 1;
    update_state_2_17_para.mx = 1;
    update_state_2_17_para.my = 2;
    update_state_2_17_para.mz = 32;
    update_state_2_17_para.old_stategz = &old_state->gz[Proc.lev_hw - 0+update_state_2_17_para.oz][Proc.lat_hw -0+update_state_2_17_para.oy][Proc.lon_hw -0+update_state_2_17_para.ox];
    update_state_2_17_para.tend1dgz = &tend1->dgz[Proc.lev_hw - 0+update_state_2_17_para.oz][Proc.lat_hw -0+update_state_2_17_para.oy][Proc.lon_hw -0+update_state_2_17_para.ox];
    update_state_2_17_para.new_stategz = &new_state->gz[Proc.lev_hw - 0+update_state_2_17_para.oz][Proc.lat_hw -0+update_state_2_17_para.oy][Proc.lon_hw -0+update_state_2_17_para.ox];
    update_state_2_17_para.dt = dt;
    
    athread_spawn(update_state_2_17, &update_state_2_17_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stategzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_40_info calc_m_2_40_para;
    calc_m_2_40_para.lz = 32 - 0;
    calc_m_2_40_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_40_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_40_para.oz = 0;
    calc_m_2_40_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_40_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_40_para.hx = 1;
    calc_m_2_40_para.hy = 0;
    calc_m_2_40_para.hz = 1;
    calc_m_2_40_para.bx = 256;
    calc_m_2_40_para.by = 1;
    calc_m_2_40_para.bz = 4;
    calc_m_2_40_para.mx = 1;
    calc_m_2_40_para.my = 8;
    calc_m_2_40_para.mz = 8;
    calc_m_2_40_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_2_40_para.oz][Proc.lat_hw -0+calc_m_2_40_para.oy][Proc.lon_hw -1+calc_m_2_40_para.ox];
    calc_m_2_40_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_2_40_para.oz][Proc.lat_hw -0+calc_m_2_40_para.oy][Proc.lon_hw -1+calc_m_2_40_para.ox];
    
    athread_spawn(calc_m_2_40, &calc_m_2_40_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_41_info calc_m_2_41_para;
    calc_m_2_41_para.lz = 32 - 1;
    calc_m_2_41_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_41_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_41_para.oz = 1;
    calc_m_2_41_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_41_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_41_para.hx = 0;
    calc_m_2_41_para.hy = 0;
    calc_m_2_41_para.hz = 1;
    calc_m_2_41_para.bx = 256;
    calc_m_2_41_para.by = 1;
    calc_m_2_41_para.bz = 4;
    calc_m_2_41_para.mx = 1;
    calc_m_2_41_para.my = 8;
    calc_m_2_41_para.mz = 8;
    calc_m_2_41_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_2_41_para.oz][Proc.lat_hw -0+calc_m_2_41_para.oy][Proc.lon_hw -0+calc_m_2_41_para.ox];
    calc_m_2_41_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_2_41_para.oz][Proc.lat_hw -0+calc_m_2_41_para.oy][Proc.lon_hw -0+calc_m_2_41_para.ox];
    
    athread_spawn(calc_m_2_41, &calc_m_2_41_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_42_info calc_m_2_42_para;
    calc_m_2_42_para.lz = 1 - 0;
    calc_m_2_42_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_42_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_42_para.oz = 0;
    calc_m_2_42_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_42_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_42_para.hx = 0;
    calc_m_2_42_para.hy = 0;
    calc_m_2_42_para.hz = 0;
    calc_m_2_42_para.bx = 256;
    calc_m_2_42_para.by = 8;
    calc_m_2_42_para.bz = 1;
    calc_m_2_42_para.mx = 1;
    calc_m_2_42_para.my = 2;
    calc_m_2_42_para.mz = 32;
    calc_m_2_42_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_2_42_para.oz][Proc.lat_hw -0+calc_m_2_42_para.oy][Proc.lon_hw -0+calc_m_2_42_para.ox];
    calc_m_2_42_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_2_42_para.oz][Proc.lat_hw -0+calc_m_2_42_para.oy][Proc.lon_hw -0+calc_m_2_42_para.ox];
    calc_m_2_42_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_2_42_para.oz][Proc.lat_hw -0+calc_m_2_42_para.oy][Proc.lon_hw -0+calc_m_2_42_para.ox];
    
    athread_spawn(calc_m_2_42, &calc_m_2_42_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_43_info calc_m_2_43_para;
    calc_m_2_43_para.lz = 33 - 32;
    calc_m_2_43_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_43_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_43_para.oz = 32;
    calc_m_2_43_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_43_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_43_para.hx = 0;
    calc_m_2_43_para.hy = 0;
    calc_m_2_43_para.hz = 1;
    calc_m_2_43_para.bx = 256;
    calc_m_2_43_para.by = 1;
    calc_m_2_43_para.bz = 4;
    calc_m_2_43_para.mx = 1;
    calc_m_2_43_para.my = 8;
    calc_m_2_43_para.mz = 8;
    calc_m_2_43_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_2_43_para.oz][Proc.lat_hw -0+calc_m_2_43_para.oy][Proc.lon_hw -0+calc_m_2_43_para.ox];
    calc_m_2_43_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_2_43_para.oz][Proc.lat_hw -0+calc_m_2_43_para.oy][Proc.lon_hw -0+calc_m_2_43_para.ox];
    calc_m_2_43_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_2_43_para.oz][Proc.lat_hw -0+calc_m_2_43_para.oy][Proc.lon_hw -0+calc_m_2_43_para.ox];
    
    athread_spawn(calc_m_2_43, &calc_m_2_43_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_2_10_info averageCellToLonEdge_2_10_para;
    averageCellToLonEdge_2_10_para.lz = 32 - 0;
    averageCellToLonEdge_2_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_2_10_para.oz = 0;
    averageCellToLonEdge_2_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_2_10_para.hx = 1;
    averageCellToLonEdge_2_10_para.hy = 1;
    averageCellToLonEdge_2_10_para.hz = 0;
    averageCellToLonEdge_2_10_para.bx = 256;
    averageCellToLonEdge_2_10_para.by = 8;
    averageCellToLonEdge_2_10_para.bz = 1;
    averageCellToLonEdge_2_10_para.mx = 1;
    averageCellToLonEdge_2_10_para.my = 2;
    averageCellToLonEdge_2_10_para.mz = 32;
    averageCellToLonEdge_2_10_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_2_10_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_10_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_10_para.ox];
    averageCellToLonEdge_2_10_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_2_10_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_10_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_10_para.ox];
    
    athread_spawn(averageCellToLonEdge_2_10, &averageCellToLonEdge_2_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_2_10_info averageCellToLatEdge_2_10_para;
    averageCellToLatEdge_2_10_para.lz = 32 - 0;
    averageCellToLatEdge_2_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_2_10_para.oz = 0;
    averageCellToLatEdge_2_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_2_10_para.hx = 1;
    averageCellToLatEdge_2_10_para.hy = 1;
    averageCellToLatEdge_2_10_para.hz = 0;
    averageCellToLatEdge_2_10_para.bx = 256;
    averageCellToLatEdge_2_10_para.by = 8;
    averageCellToLatEdge_2_10_para.bz = 1;
    averageCellToLatEdge_2_10_para.mx = 1;
    averageCellToLatEdge_2_10_para.my = 2;
    averageCellToLatEdge_2_10_para.mz = 32;
    averageCellToLatEdge_2_10_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_2_10_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_10_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_10_para.ox];
    averageCellToLatEdge_2_10_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_2_10_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_10_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_10_para.ox];
    
    athread_spawn(averageCellToLatEdge_2_10, &averageCellToLatEdge_2_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_2_10_info interpCellToVtx_2_10_para;
    interpCellToVtx_2_10_para.lz = 32 - 0;
    interpCellToVtx_2_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_2_10_para.oz = 0;
    interpCellToVtx_2_10_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_2_10_para.hx = 1;
    interpCellToVtx_2_10_para.hy = 1;
    interpCellToVtx_2_10_para.hz = 0;
    interpCellToVtx_2_10_para.bx = 256;
    interpCellToVtx_2_10_para.by = 8;
    interpCellToVtx_2_10_para.bz = 1;
    interpCellToVtx_2_10_para.mx = 1;
    interpCellToVtx_2_10_para.my = 2;
    interpCellToVtx_2_10_para.mz = 32;
    interpCellToVtx_2_10_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_2_10_para.oz][Proc.lat_hw -1+interpCellToVtx_2_10_para.oy][Proc.lon_hw -1+interpCellToVtx_2_10_para.ox];
    interpCellToVtx_2_10_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_2_10_para.oz][Proc.lat_hw -1+interpCellToVtx_2_10_para.oy][Proc.lon_hw -1+interpCellToVtx_2_10_para.ox];
    interpCellToVtx_2_10_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_2_10_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_2_10_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_2_10, &interpCellToVtx_2_10_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if (((tendPara->u) && (tendPara->v)))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lon_edge(0,&tend1->du[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lon_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend1->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lat_edge(0,&tend1->dv[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lat_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend1->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_2_18_info update_state_2_18_para;
    update_state_2_18_para.lz = 32 - 0;
    update_state_2_18_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    update_state_2_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_2_18_para.oz = 0;
    update_state_2_18_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    update_state_2_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_2_18_para.hx = 1;
    update_state_2_18_para.hy = 1;
    update_state_2_18_para.hz = 0;
    update_state_2_18_para.bx = 256;
    update_state_2_18_para.by = 8;
    update_state_2_18_para.bz = 1;
    update_state_2_18_para.mx = 1;
    update_state_2_18_para.my = 2;
    update_state_2_18_para.mz = 32;
    update_state_2_18_para.old_stateu_lon = &old_state->u_lon[Proc.lev_hw - 0+update_state_2_18_para.oz][Proc.lat_hw -1+update_state_2_18_para.oy][Proc.lon_hw -1+update_state_2_18_para.ox];
    update_state_2_18_para.tend1du = &tend1->du[Proc.lev_hw - 0+update_state_2_18_para.oz][Proc.lat_hw -1+update_state_2_18_para.oy][Proc.lon_hw -1+update_state_2_18_para.ox];
    update_state_2_18_para.new_stateu_lon = &new_state->u_lon[Proc.lev_hw - 0+update_state_2_18_para.oz][Proc.lat_hw -1+update_state_2_18_para.oy][Proc.lon_hw -1+update_state_2_18_para.ox];
    update_state_2_18_para.dt = dt;
    
    athread_spawn(update_state_2_18, &update_state_2_18_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateu_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_2_19_info update_state_2_19_para;
    update_state_2_19_para.lz = 32 - 0;
    update_state_2_19_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    update_state_2_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_2_19_para.oz = 0;
    update_state_2_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_2_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_2_19_para.hx = 1;
    update_state_2_19_para.hy = 1;
    update_state_2_19_para.hz = 0;
    update_state_2_19_para.bx = 256;
    update_state_2_19_para.by = 8;
    update_state_2_19_para.bz = 1;
    update_state_2_19_para.mx = 1;
    update_state_2_19_para.my = 2;
    update_state_2_19_para.mz = 32;
    update_state_2_19_para.old_statev_lat = &old_state->v_lat[Proc.lev_hw - 0+update_state_2_19_para.oz][Proc.lat_hw -1+update_state_2_19_para.oy][Proc.lon_hw -1+update_state_2_19_para.ox];
    update_state_2_19_para.tend1dv = &tend1->dv[Proc.lev_hw - 0+update_state_2_19_para.oz][Proc.lat_hw -1+update_state_2_19_para.oy][Proc.lon_hw -1+update_state_2_19_para.ox];
    update_state_2_19_para.new_statev_lat = &new_state->v_lat[Proc.lev_hw - 0+update_state_2_19_para.oz][Proc.lat_hw -1+update_state_2_19_para.oy][Proc.lon_hw -1+update_state_2_19_para.ox];
    update_state_2_19_para.dt = dt;
    
    athread_spawn(update_state_2_19, &update_state_2_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statev_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  tendPara = tendPara;
  advPara = advPara;
  dt = dt;
  tendPara = tendPara;
  (tendPara->u) = 0;
  (tendPara->v) = 0;
  (tendPara->pt) = 0;
  (tendPara->gz) = 0;
  (tendPara->phs) = 0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_t_2_3_info calc_t_2_3_para;
  calc_t_2_3_para.lz = 32 - 0;
  calc_t_2_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_t_2_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_t_2_3_para.oz = 0;
  calc_t_2_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_t_2_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_t_2_3_para.hx = 2;
  calc_t_2_3_para.hy = 2;
  calc_t_2_3_para.hz = 0;
  calc_t_2_3_para.bx = 256;
  calc_t_2_3_para.by = 8;
  calc_t_2_3_para.bz = 1;
  calc_t_2_3_para.mx = 1;
  calc_t_2_3_para.my = 2;
  calc_t_2_3_para.mz = 32;
  calc_t_2_3_para.new_statept = &new_state->pt[Proc.lev_hw - 0+calc_t_2_3_para.oz][Proc.lat_hw -2+calc_t_2_3_para.oy][Proc.lon_hw -2+calc_t_2_3_para.ox];
  calc_t_2_3_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_t_2_3_para.oz][Proc.lat_hw -2+calc_t_2_3_para.oy][Proc.lon_hw -2+calc_t_2_3_para.ox];
  calc_t_2_3_para.new_stateqv = &new_state->qv[Proc.lev_hw - 0+calc_t_2_3_para.oz][Proc.lat_hw -2+calc_t_2_3_para.oy][Proc.lon_hw -2+calc_t_2_3_para.ox];
  calc_t_2_3_para.new_statet = &new_state->t[Proc.lev_hw - 0+calc_t_2_3_para.oz][Proc.lat_hw -2+calc_t_2_3_para.oy][Proc.lon_hw -2+calc_t_2_3_para.ox];
  
  athread_spawn(calc_t_2_3, &calc_t_2_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_ttTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_gzs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_gz_lev_2_3_info calc_gz_lev_2_3_para;
  calc_gz_lev_2_3_para.lz = 32 - 0;
  calc_gz_lev_2_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_gz_lev_2_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_gz_lev_2_3_para.oz = 0;
  calc_gz_lev_2_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_gz_lev_2_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_gz_lev_2_3_para.hx = 1;
  calc_gz_lev_2_3_para.hy = 0;
  calc_gz_lev_2_3_para.hz = Proc.lev_hw;
  calc_gz_lev_2_3_para.bx = 64;
  calc_gz_lev_2_3_para.by = 1;
  calc_gz_lev_2_3_para.bz = 32;
  calc_gz_lev_2_3_para.mx = 8;
  calc_gz_lev_2_3_para.my = 8;
  calc_gz_lev_2_3_para.mz = 1;
  calc_gz_lev_2_3_para.new_statet = &new_state->t[Proc.lev_hw - calc_gz_lev_2_3_para.hz+calc_gz_lev_2_3_para.oz][Proc.lat_hw -0+calc_gz_lev_2_3_para.oy][Proc.lon_hw -1+calc_gz_lev_2_3_para.ox];
  calc_gz_lev_2_3_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - calc_gz_lev_2_3_para.hz+calc_gz_lev_2_3_para.oz][Proc.lat_hw -0+calc_gz_lev_2_3_para.oy][Proc.lon_hw -1+calc_gz_lev_2_3_para.ox];
  calc_gz_lev_2_3_para.staticvgzs = &staticv->gzs[0][Proc.lat_hw -0+calc_gz_lev_2_3_para.oy][Proc.lon_hw -1+calc_gz_lev_2_3_para.ox];
  calc_gz_lev_2_3_para.new_stategz_lev = &new_state->gz_lev[Proc.lev_hw - calc_gz_lev_2_3_para.hz+calc_gz_lev_2_3_para.oz][Proc.lat_hw -0+calc_gz_lev_2_3_para.oy][Proc.lon_hw -1+calc_gz_lev_2_3_para.ox];
  
  athread_spawn(calc_gz_lev_2_3, &calc_gz_lev_2_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_gz_levgz_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &new_state->gz_lev[0][0][0], &Proc.FieldReq[async_gz_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qm]);
  HaloWait(Proc,&Proc.FieldReq[async_ph_exn_lev]);
  HaloWait(Proc,&Proc.FieldReq[async_gz_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  pgf_lin97_2_2_info pgf_lin97_2_2_para;
  pgf_lin97_2_2_para.lz = 32 - 0;
  pgf_lin97_2_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  pgf_lin97_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  pgf_lin97_2_2_para.oz = 0;
  pgf_lin97_2_2_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  pgf_lin97_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  pgf_lin97_2_2_para.hx = 1;
  pgf_lin97_2_2_para.hy = 0;
  pgf_lin97_2_2_para.hz = 1;
  pgf_lin97_2_2_para.bx = 256;
  pgf_lin97_2_2_para.by = 1;
  pgf_lin97_2_2_para.bz = 4;
  pgf_lin97_2_2_para.mx = 1;
  pgf_lin97_2_2_para.my = 8;
  pgf_lin97_2_2_para.mz = 8;
  pgf_lin97_2_2_para.new_stateqm = &new_state->qm[Proc.lev_hw - 1+pgf_lin97_2_2_para.oz][Proc.lat_hw -0+pgf_lin97_2_2_para.oy][Proc.lon_hw -1+pgf_lin97_2_2_para.ox];
  pgf_lin97_2_2_para.new_stateph_exn_lev = &new_state->ph_exn_lev[Proc.lev_hw - 1+pgf_lin97_2_2_para.oz][Proc.lat_hw -0+pgf_lin97_2_2_para.oy][Proc.lon_hw -1+pgf_lin97_2_2_para.ox];
  pgf_lin97_2_2_para.new_stategz_lev = &new_state->gz_lev[Proc.lev_hw - 1+pgf_lin97_2_2_para.oz][Proc.lat_hw -0+pgf_lin97_2_2_para.oy][Proc.lon_hw -1+pgf_lin97_2_2_para.ox];
  pgf_lin97_2_2_para.tend2pgf_lon = &tend2->pgf_lon[Proc.lev_hw - 1+pgf_lin97_2_2_para.oz][Proc.lat_hw -0+pgf_lin97_2_2_para.oy][Proc.lon_hw -1+pgf_lin97_2_2_para.ox];
  pgf_lin97_2_2_para.de_lon = &mesh->de_lon[0][0][0];
  
  athread_spawn(pgf_lin97_2_2, &pgf_lin97_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  pgf_lin97pgf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qm]);
  HaloWait(Proc,&Proc.FieldReq[async_ph_exn_lev]);
  HaloWait(Proc,&Proc.FieldReq[async_gz_lev]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tl = (1 + (0.5 * (new_state->qm[k][j][i] + new_state->qm[k][(j + 1)][i])));
        dph1 = (new_state->ph_exn_lev[(k + 1)][(j + 1)][i] - new_state->ph_exn_lev[k][j][i]);
        dph2 = (new_state->ph_exn_lev[(k + 1)][j][i] - new_state->ph_exn_lev[k][(j + 1)][i]);
        dgz1 = (new_state->gz_lev[(k + 1)][j][i] - new_state->gz_lev[k][(j + 1)][i]);
        dgz2 = (new_state->gz_lev[k][j][i] - new_state->gz_lev[(k + 1)][(j + 1)][i]);
        tend2->pgf_lat[k][j][i] = (((-((dph1 * dgz1) + (dph2 * dgz2)) / mesh->de_lat[0][j][0]) / (dph1 + dph2)) / tl);
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  pgf_lin97pgf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  tendPara = tendPara;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_du]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_backward_2_4_info calc_tend_backward_2_4_para;
  calc_tend_backward_2_4_para.lz = 32 - 0;
  calc_tend_backward_2_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  calc_tend_backward_2_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_backward_2_4_para.oz = 0;
  calc_tend_backward_2_4_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  calc_tend_backward_2_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_backward_2_4_para.hx = 1;
  calc_tend_backward_2_4_para.hy = 1;
  calc_tend_backward_2_4_para.hz = 0;
  calc_tend_backward_2_4_para.bx = 256;
  calc_tend_backward_2_4_para.by = 8;
  calc_tend_backward_2_4_para.bz = 1;
  calc_tend_backward_2_4_para.mx = 1;
  calc_tend_backward_2_4_para.my = 2;
  calc_tend_backward_2_4_para.mz = 32;
  calc_tend_backward_2_4_para.tend1du = &tend1->du[Proc.lev_hw - 0+calc_tend_backward_2_4_para.oz][Proc.lat_hw -1+calc_tend_backward_2_4_para.oy][Proc.lon_hw -1+calc_tend_backward_2_4_para.ox];
  calc_tend_backward_2_4_para.tend2pgf_lon = &tend2->pgf_lon[Proc.lev_hw - 0+calc_tend_backward_2_4_para.oz][Proc.lat_hw -1+calc_tend_backward_2_4_para.oy][Proc.lon_hw -1+calc_tend_backward_2_4_para.ox];
  calc_tend_backward_2_4_para.tend2du = &tend2->du[Proc.lev_hw - 0+calc_tend_backward_2_4_para.oz][Proc.lat_hw -1+calc_tend_backward_2_4_para.oy][Proc.lon_hw -1+calc_tend_backward_2_4_para.ox];
  
  athread_spawn(calc_tend_backward_2_4, &calc_tend_backward_2_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_backwardduTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend2->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_dv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_tend_backward_2_5_info calc_tend_backward_2_5_para;
  calc_tend_backward_2_5_para.lz = 32 - 0;
  calc_tend_backward_2_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  calc_tend_backward_2_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_tend_backward_2_5_para.oz = 0;
  calc_tend_backward_2_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_tend_backward_2_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_tend_backward_2_5_para.hx = 1;
  calc_tend_backward_2_5_para.hy = 1;
  calc_tend_backward_2_5_para.hz = 0;
  calc_tend_backward_2_5_para.bx = 256;
  calc_tend_backward_2_5_para.by = 8;
  calc_tend_backward_2_5_para.bz = 1;
  calc_tend_backward_2_5_para.mx = 1;
  calc_tend_backward_2_5_para.my = 2;
  calc_tend_backward_2_5_para.mz = 32;
  calc_tend_backward_2_5_para.tend1dv = &tend1->dv[Proc.lev_hw - 0+calc_tend_backward_2_5_para.oz][Proc.lat_hw -1+calc_tend_backward_2_5_para.oy][Proc.lon_hw -1+calc_tend_backward_2_5_para.ox];
  calc_tend_backward_2_5_para.tend2pgf_lat = &tend2->pgf_lat[Proc.lev_hw - 0+calc_tend_backward_2_5_para.oz][Proc.lat_hw -1+calc_tend_backward_2_5_para.oy][Proc.lon_hw -1+calc_tend_backward_2_5_para.ox];
  calc_tend_backward_2_5_para.tend2dv = &tend2->dv[Proc.lev_hw - 0+calc_tend_backward_2_5_para.oz][Proc.lat_hw -1+calc_tend_backward_2_5_para.oy][Proc.lon_hw -1+calc_tend_backward_2_5_para.ox];
  
  athread_spawn(calc_tend_backward_2_5, &calc_tend_backward_2_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_tend_backwarddvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &tend2->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  (tendPara->u) = 1;
  (tendPara->v) = 1;
  tendPara = tendPara;
  dt = dt;
  if ((tendPara->phs))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,0,&tend2->dphs[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &tend2->dphs[0][0][0], &Proc.FieldReq[async_dphs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    HaloWait(Proc,&Proc.FieldReq[async_dphs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        new_state->phs[0][j][i] = (old_state->phs[0][j][i] + (dt * tend2->dphs[0][j][i]));
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statephsTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_2d_D(Proc, &new_state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_phs]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_2_18_info calc_ph_2_18_para;
    calc_ph_2_18_para.lz = 33 - 0;
    calc_ph_2_18_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_2_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_2_18_para.oz = 0;
    calc_ph_2_18_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_2_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_2_18_para.hx = 1;
    calc_ph_2_18_para.hy = 1;
    calc_ph_2_18_para.hz = 0;
    calc_ph_2_18_para.bx = 256;
    calc_ph_2_18_para.by = 8;
    calc_ph_2_18_para.bz = 1;
    calc_ph_2_18_para.mx = 1;
    calc_ph_2_18_para.my = 2;
    calc_ph_2_18_para.mz = 32;
    calc_ph_2_18_para.new_statephs = &new_state->phs[0][Proc.lat_hw -1+calc_ph_2_18_para.oy][Proc.lon_hw -1+calc_ph_2_18_para.ox];
    calc_ph_2_18_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_2_18_para.oz][Proc.lat_hw -1+calc_ph_2_18_para.oy][Proc.lon_hw -1+calc_ph_2_18_para.ox];
    calc_ph_2_18_para.hyai = &mesh->hyai[0][0][0];
    calc_ph_2_18_para.hybi = &mesh->hybi[0][0][0];
    
    athread_spawn(calc_ph_2_18, &calc_ph_2_18_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_2_19_info calc_ph_2_19_para;
    calc_ph_2_19_para.lz = 33 - 0;
    calc_ph_2_19_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_2_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_2_19_para.oz = 0;
    calc_ph_2_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_2_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_2_19_para.hx = 1;
    calc_ph_2_19_para.hy = 1;
    calc_ph_2_19_para.hz = 0;
    calc_ph_2_19_para.bx = 256;
    calc_ph_2_19_para.by = 8;
    calc_ph_2_19_para.bz = 1;
    calc_ph_2_19_para.mx = 1;
    calc_ph_2_19_para.my = 2;
    calc_ph_2_19_para.mz = 32;
    calc_ph_2_19_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_ph_2_19_para.oz][Proc.lat_hw -1+calc_ph_2_19_para.oy][Proc.lon_hw -1+calc_ph_2_19_para.ox];
    calc_ph_2_19_para.new_stateph_exn_lev = &new_state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_2_19_para.oz][Proc.lat_hw -1+calc_ph_2_19_para.oy][Proc.lon_hw -1+calc_ph_2_19_para.ox];
    
    athread_spawn(calc_ph_2_19, &calc_ph_2_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phph_exn_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_ph_2_20_info calc_ph_2_20_para;
    calc_ph_2_20_para.lz = 32 - 0;
    calc_ph_2_20_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_ph_2_20_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_ph_2_20_para.oz = 0;
    calc_ph_2_20_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_ph_2_20_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_ph_2_20_para.hx = 0;
    calc_ph_2_20_para.hy = 0;
    calc_ph_2_20_para.hz = 1;
    calc_ph_2_20_para.bx = 256;
    calc_ph_2_20_para.by = 1;
    calc_ph_2_20_para.bz = 4;
    calc_ph_2_20_para.mx = 1;
    calc_ph_2_20_para.my = 8;
    calc_ph_2_20_para.mz = 8;
    calc_ph_2_20_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_ph_2_20_para.oz][Proc.lat_hw -0+calc_ph_2_20_para.oy][Proc.lon_hw -0+calc_ph_2_20_para.ox];
    calc_ph_2_20_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_ph_2_20_para.oz][Proc.lat_hw -0+calc_ph_2_20_para.oy][Proc.lon_hw -0+calc_ph_2_20_para.ox];
    
    athread_spawn(calc_ph_2_20, &calc_ph_2_20_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_phphTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_44_info calc_m_2_44_para;
    calc_m_2_44_para.lz = 32 - 0;
    calc_m_2_44_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_44_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_44_para.oz = 0;
    calc_m_2_44_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_44_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_44_para.hx = 1;
    calc_m_2_44_para.hy = 0;
    calc_m_2_44_para.hz = 1;
    calc_m_2_44_para.bx = 256;
    calc_m_2_44_para.by = 1;
    calc_m_2_44_para.bz = 4;
    calc_m_2_44_para.mx = 1;
    calc_m_2_44_para.my = 8;
    calc_m_2_44_para.mz = 8;
    calc_m_2_44_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_2_44_para.oz][Proc.lat_hw -0+calc_m_2_44_para.oy][Proc.lon_hw -1+calc_m_2_44_para.ox];
    calc_m_2_44_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_2_44_para.oz][Proc.lat_hw -0+calc_m_2_44_para.oy][Proc.lon_hw -1+calc_m_2_44_para.ox];
    
    athread_spawn(calc_m_2_44, &calc_m_2_44_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_45_info calc_m_2_45_para;
    calc_m_2_45_para.lz = 32 - 1;
    calc_m_2_45_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_45_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_45_para.oz = 1;
    calc_m_2_45_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_45_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_45_para.hx = 0;
    calc_m_2_45_para.hy = 0;
    calc_m_2_45_para.hz = 1;
    calc_m_2_45_para.bx = 256;
    calc_m_2_45_para.by = 1;
    calc_m_2_45_para.bz = 4;
    calc_m_2_45_para.mx = 1;
    calc_m_2_45_para.my = 8;
    calc_m_2_45_para.mz = 8;
    calc_m_2_45_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_2_45_para.oz][Proc.lat_hw -0+calc_m_2_45_para.oy][Proc.lon_hw -0+calc_m_2_45_para.ox];
    calc_m_2_45_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_2_45_para.oz][Proc.lat_hw -0+calc_m_2_45_para.oy][Proc.lon_hw -0+calc_m_2_45_para.ox];
    
    athread_spawn(calc_m_2_45, &calc_m_2_45_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_46_info calc_m_2_46_para;
    calc_m_2_46_para.lz = 1 - 0;
    calc_m_2_46_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_46_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_46_para.oz = 0;
    calc_m_2_46_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_46_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_46_para.hx = 0;
    calc_m_2_46_para.hy = 0;
    calc_m_2_46_para.hz = 0;
    calc_m_2_46_para.bx = 256;
    calc_m_2_46_para.by = 8;
    calc_m_2_46_para.bz = 1;
    calc_m_2_46_para.mx = 1;
    calc_m_2_46_para.my = 2;
    calc_m_2_46_para.mz = 32;
    calc_m_2_46_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_2_46_para.oz][Proc.lat_hw -0+calc_m_2_46_para.oy][Proc.lon_hw -0+calc_m_2_46_para.ox];
    calc_m_2_46_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_2_46_para.oz][Proc.lat_hw -0+calc_m_2_46_para.oy][Proc.lon_hw -0+calc_m_2_46_para.ox];
    calc_m_2_46_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_2_46_para.oz][Proc.lat_hw -0+calc_m_2_46_para.oy][Proc.lon_hw -0+calc_m_2_46_para.ox];
    
    athread_spawn(calc_m_2_46, &calc_m_2_46_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_47_info calc_m_2_47_para;
    calc_m_2_47_para.lz = 33 - 32;
    calc_m_2_47_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_47_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_47_para.oz = 32;
    calc_m_2_47_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_47_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_47_para.hx = 0;
    calc_m_2_47_para.hy = 0;
    calc_m_2_47_para.hz = 1;
    calc_m_2_47_para.bx = 256;
    calc_m_2_47_para.by = 1;
    calc_m_2_47_para.bz = 4;
    calc_m_2_47_para.mx = 1;
    calc_m_2_47_para.my = 8;
    calc_m_2_47_para.mz = 8;
    calc_m_2_47_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_2_47_para.oz][Proc.lat_hw -0+calc_m_2_47_para.oy][Proc.lon_hw -0+calc_m_2_47_para.ox];
    calc_m_2_47_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_2_47_para.oz][Proc.lat_hw -0+calc_m_2_47_para.oy][Proc.lon_hw -0+calc_m_2_47_para.ox];
    calc_m_2_47_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_2_47_para.oz][Proc.lat_hw -0+calc_m_2_47_para.oy][Proc.lon_hw -0+calc_m_2_47_para.ox];
    
    athread_spawn(calc_m_2_47, &calc_m_2_47_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_2_11_info averageCellToLonEdge_2_11_para;
    averageCellToLonEdge_2_11_para.lz = 32 - 0;
    averageCellToLonEdge_2_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_2_11_para.oz = 0;
    averageCellToLonEdge_2_11_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_2_11_para.hx = 1;
    averageCellToLonEdge_2_11_para.hy = 1;
    averageCellToLonEdge_2_11_para.hz = 0;
    averageCellToLonEdge_2_11_para.bx = 256;
    averageCellToLonEdge_2_11_para.by = 8;
    averageCellToLonEdge_2_11_para.bz = 1;
    averageCellToLonEdge_2_11_para.mx = 1;
    averageCellToLonEdge_2_11_para.my = 2;
    averageCellToLonEdge_2_11_para.mz = 32;
    averageCellToLonEdge_2_11_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_2_11_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_11_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_11_para.ox];
    averageCellToLonEdge_2_11_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_2_11_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_11_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_11_para.ox];
    
    athread_spawn(averageCellToLonEdge_2_11, &averageCellToLonEdge_2_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_2_11_info averageCellToLatEdge_2_11_para;
    averageCellToLatEdge_2_11_para.lz = 32 - 0;
    averageCellToLatEdge_2_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_2_11_para.oz = 0;
    averageCellToLatEdge_2_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_2_11_para.hx = 1;
    averageCellToLatEdge_2_11_para.hy = 1;
    averageCellToLatEdge_2_11_para.hz = 0;
    averageCellToLatEdge_2_11_para.bx = 256;
    averageCellToLatEdge_2_11_para.by = 8;
    averageCellToLatEdge_2_11_para.bz = 1;
    averageCellToLatEdge_2_11_para.mx = 1;
    averageCellToLatEdge_2_11_para.my = 2;
    averageCellToLatEdge_2_11_para.mz = 32;
    averageCellToLatEdge_2_11_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_2_11_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_11_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_11_para.ox];
    averageCellToLatEdge_2_11_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_2_11_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_11_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_11_para.ox];
    
    athread_spawn(averageCellToLatEdge_2_11, &averageCellToLatEdge_2_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_2_11_info interpCellToVtx_2_11_para;
    interpCellToVtx_2_11_para.lz = 32 - 0;
    interpCellToVtx_2_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_2_11_para.oz = 0;
    interpCellToVtx_2_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_2_11_para.hx = 1;
    interpCellToVtx_2_11_para.hy = 1;
    interpCellToVtx_2_11_para.hz = 0;
    interpCellToVtx_2_11_para.bx = 256;
    interpCellToVtx_2_11_para.by = 8;
    interpCellToVtx_2_11_para.bz = 1;
    interpCellToVtx_2_11_para.mx = 1;
    interpCellToVtx_2_11_para.my = 2;
    interpCellToVtx_2_11_para.mz = 32;
    interpCellToVtx_2_11_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_2_11_para.oz][Proc.lat_hw -1+interpCellToVtx_2_11_para.oy][Proc.lon_hw -1+interpCellToVtx_2_11_para.ox];
    interpCellToVtx_2_11_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_2_11_para.oz][Proc.lat_hw -1+interpCellToVtx_2_11_para.oy][Proc.lon_hw -1+interpCellToVtx_2_11_para.ox];
    interpCellToVtx_2_11_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_2_11_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_2_11_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_2_11, &interpCellToVtx_2_11_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->pt))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_On_Cell(0,1,&tend2->dpt[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_On_CellTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend2->dpt[0][0][0], &Proc.FieldReq[async_dpt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_pt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    HaloWait(Proc,&Proc.FieldReq[async_dpt]);
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_2_20_info update_state_2_20_para;
    update_state_2_20_para.lz = 32 - 0;
    update_state_2_20_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_2_20_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_2_20_para.oz = 0;
    update_state_2_20_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_2_20_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_2_20_para.hx = 2;
    update_state_2_20_para.hy = 2;
    update_state_2_20_para.hz = 0;
    update_state_2_20_para.bx = 256;
    update_state_2_20_para.by = 8;
    update_state_2_20_para.bz = 1;
    update_state_2_20_para.mx = 1;
    update_state_2_20_para.my = 2;
    update_state_2_20_para.mz = 32;
    update_state_2_20_para.old_statept = &old_state->pt[Proc.lev_hw - 0+update_state_2_20_para.oz][Proc.lat_hw -2+update_state_2_20_para.oy][Proc.lon_hw -2+update_state_2_20_para.ox];
    update_state_2_20_para.old_statem = &old_state->m[Proc.lev_hw - 0+update_state_2_20_para.oz][Proc.lat_hw -2+update_state_2_20_para.oy][Proc.lon_hw -2+update_state_2_20_para.ox];
    update_state_2_20_para.tend2dpt = &tend2->dpt[Proc.lev_hw - 0+update_state_2_20_para.oz][Proc.lat_hw -2+update_state_2_20_para.oy][Proc.lon_hw -2+update_state_2_20_para.ox];
    update_state_2_20_para.new_statem = &new_state->m[Proc.lev_hw - 0+update_state_2_20_para.oz][Proc.lat_hw -2+update_state_2_20_para.oy][Proc.lon_hw -2+update_state_2_20_para.ox];
    update_state_2_20_para.new_statept = &new_state->pt[Proc.lev_hw - 0+update_state_2_20_para.oz][Proc.lat_hw -2+update_state_2_20_para.oy][Proc.lon_hw -2+update_state_2_20_para.ox];
    update_state_2_20_para.dt = dt;
    
    athread_spawn(update_state_2_20, &update_state_2_20_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateptTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if ((tendPara->gz))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_2_21_info update_state_2_21_para;
    update_state_2_21_para.lz = 32 - 0;
    update_state_2_21_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    update_state_2_21_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_2_21_para.oz = 0;
    update_state_2_21_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_2_21_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_2_21_para.hx = 0;
    update_state_2_21_para.hy = 0;
    update_state_2_21_para.hz = 0;
    update_state_2_21_para.bx = 256;
    update_state_2_21_para.by = 8;
    update_state_2_21_para.bz = 1;
    update_state_2_21_para.mx = 1;
    update_state_2_21_para.my = 2;
    update_state_2_21_para.mz = 32;
    update_state_2_21_para.old_stategz = &old_state->gz[Proc.lev_hw - 0+update_state_2_21_para.oz][Proc.lat_hw -0+update_state_2_21_para.oy][Proc.lon_hw -0+update_state_2_21_para.ox];
    update_state_2_21_para.tend2dgz = &tend2->dgz[Proc.lev_hw - 0+update_state_2_21_para.oz][Proc.lat_hw -0+update_state_2_21_para.oy][Proc.lon_hw -0+update_state_2_21_para.ox];
    update_state_2_21_para.new_stategz = &new_state->gz[Proc.lev_hw - 0+update_state_2_21_para.oz][Proc.lat_hw -0+update_state_2_21_para.oy][Proc.lon_hw -0+update_state_2_21_para.ox];
    update_state_2_21_para.dt = dt;
    
    athread_spawn(update_state_2_21, &update_state_2_21_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stategzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_48_info calc_m_2_48_para;
    calc_m_2_48_para.lz = 32 - 0;
    calc_m_2_48_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_48_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_48_para.oz = 0;
    calc_m_2_48_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_48_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_48_para.hx = 1;
    calc_m_2_48_para.hy = 0;
    calc_m_2_48_para.hz = 1;
    calc_m_2_48_para.bx = 256;
    calc_m_2_48_para.by = 1;
    calc_m_2_48_para.bz = 4;
    calc_m_2_48_para.mx = 1;
    calc_m_2_48_para.my = 8;
    calc_m_2_48_para.mz = 8;
    calc_m_2_48_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_2_48_para.oz][Proc.lat_hw -0+calc_m_2_48_para.oy][Proc.lon_hw -1+calc_m_2_48_para.ox];
    calc_m_2_48_para.new_statem = &new_state->m[Proc.lev_hw - 1+calc_m_2_48_para.oz][Proc.lat_hw -0+calc_m_2_48_para.oy][Proc.lon_hw -1+calc_m_2_48_para.ox];
    
    athread_spawn(calc_m_2_48, &calc_m_2_48_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mmTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_49_info calc_m_2_49_para;
    calc_m_2_49_para.lz = 32 - 1;
    calc_m_2_49_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_49_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_49_para.oz = 1;
    calc_m_2_49_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_49_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_49_para.hx = 0;
    calc_m_2_49_para.hy = 0;
    calc_m_2_49_para.hz = 1;
    calc_m_2_49_para.bx = 256;
    calc_m_2_49_para.by = 1;
    calc_m_2_49_para.bz = 4;
    calc_m_2_49_para.mx = 1;
    calc_m_2_49_para.my = 8;
    calc_m_2_49_para.mz = 8;
    calc_m_2_49_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_2_49_para.oz][Proc.lat_hw -0+calc_m_2_49_para.oy][Proc.lon_hw -0+calc_m_2_49_para.ox];
    calc_m_2_49_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_2_49_para.oz][Proc.lat_hw -0+calc_m_2_49_para.oy][Proc.lon_hw -0+calc_m_2_49_para.ox];
    
    athread_spawn(calc_m_2_49, &calc_m_2_49_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_50_info calc_m_2_50_para;
    calc_m_2_50_para.lz = 1 - 0;
    calc_m_2_50_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_50_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_50_para.oz = 0;
    calc_m_2_50_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_50_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_50_para.hx = 0;
    calc_m_2_50_para.hy = 0;
    calc_m_2_50_para.hz = 0;
    calc_m_2_50_para.bx = 256;
    calc_m_2_50_para.by = 8;
    calc_m_2_50_para.bz = 1;
    calc_m_2_50_para.mx = 1;
    calc_m_2_50_para.my = 2;
    calc_m_2_50_para.mz = 32;
    calc_m_2_50_para.new_stateph = &new_state->ph[Proc.lev_hw - 0+calc_m_2_50_para.oz][Proc.lat_hw -0+calc_m_2_50_para.oy][Proc.lon_hw -0+calc_m_2_50_para.ox];
    calc_m_2_50_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 0+calc_m_2_50_para.oz][Proc.lat_hw -0+calc_m_2_50_para.oy][Proc.lon_hw -0+calc_m_2_50_para.ox];
    calc_m_2_50_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 0+calc_m_2_50_para.oz][Proc.lat_hw -0+calc_m_2_50_para.oy][Proc.lon_hw -0+calc_m_2_50_para.ox];
    
    athread_spawn(calc_m_2_50, &calc_m_2_50_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    calc_m_2_51_info calc_m_2_51_para;
    calc_m_2_51_para.lz = 33 - 32;
    calc_m_2_51_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    calc_m_2_51_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    calc_m_2_51_para.oz = 32;
    calc_m_2_51_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    calc_m_2_51_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    calc_m_2_51_para.hx = 0;
    calc_m_2_51_para.hy = 0;
    calc_m_2_51_para.hz = 1;
    calc_m_2_51_para.bx = 256;
    calc_m_2_51_para.by = 1;
    calc_m_2_51_para.bz = 4;
    calc_m_2_51_para.mx = 1;
    calc_m_2_51_para.my = 8;
    calc_m_2_51_para.mz = 8;
    calc_m_2_51_para.new_stateph_lev = &new_state->ph_lev[Proc.lev_hw - 1+calc_m_2_51_para.oz][Proc.lat_hw -0+calc_m_2_51_para.oy][Proc.lon_hw -0+calc_m_2_51_para.ox];
    calc_m_2_51_para.new_stateph = &new_state->ph[Proc.lev_hw - 1+calc_m_2_51_para.oz][Proc.lat_hw -0+calc_m_2_51_para.oy][Proc.lon_hw -0+calc_m_2_51_para.ox];
    calc_m_2_51_para.new_statem_lev = &new_state->m_lev[Proc.lev_hw - 1+calc_m_2_51_para.oz][Proc.lat_hw -0+calc_m_2_51_para.oy][Proc.lon_hw -0+calc_m_2_51_para.ox];
    
    athread_spawn(calc_m_2_51, &calc_m_2_51_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    calc_mm_levTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLonEdge_2_12_info averageCellToLonEdge_2_12_para;
    averageCellToLonEdge_2_12_para.lz = 32 - 0;
    averageCellToLonEdge_2_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    averageCellToLonEdge_2_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLonEdge_2_12_para.oz = 0;
    averageCellToLonEdge_2_12_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    averageCellToLonEdge_2_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLonEdge_2_12_para.hx = 1;
    averageCellToLonEdge_2_12_para.hy = 1;
    averageCellToLonEdge_2_12_para.hz = 0;
    averageCellToLonEdge_2_12_para.bx = 256;
    averageCellToLonEdge_2_12_para.by = 8;
    averageCellToLonEdge_2_12_para.bz = 1;
    averageCellToLonEdge_2_12_para.mx = 1;
    averageCellToLonEdge_2_12_para.my = 2;
    averageCellToLonEdge_2_12_para.mz = 32;
    averageCellToLonEdge_2_12_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLonEdge_2_12_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_12_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_12_para.ox];
    averageCellToLonEdge_2_12_para.new_statem_lon = &new_state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_2_12_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_12_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_12_para.ox];
    
    athread_spawn(averageCellToLonEdge_2_12, &averageCellToLonEdge_2_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    averageCellToLatEdge_2_12_info averageCellToLatEdge_2_12_para;
    averageCellToLatEdge_2_12_para.lz = 32 - 0;
    averageCellToLatEdge_2_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    averageCellToLatEdge_2_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    averageCellToLatEdge_2_12_para.oz = 0;
    averageCellToLatEdge_2_12_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    averageCellToLatEdge_2_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    averageCellToLatEdge_2_12_para.hx = 1;
    averageCellToLatEdge_2_12_para.hy = 1;
    averageCellToLatEdge_2_12_para.hz = 0;
    averageCellToLatEdge_2_12_para.bx = 256;
    averageCellToLatEdge_2_12_para.by = 8;
    averageCellToLatEdge_2_12_para.bz = 1;
    averageCellToLatEdge_2_12_para.mx = 1;
    averageCellToLatEdge_2_12_para.my = 2;
    averageCellToLatEdge_2_12_para.mz = 32;
    averageCellToLatEdge_2_12_para.new_statem = &new_state->m[Proc.lev_hw - 0+averageCellToLatEdge_2_12_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_12_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_12_para.ox];
    averageCellToLatEdge_2_12_para.new_statem_lat = &new_state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_2_12_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_12_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_12_para.ox];
    
    athread_spawn(averageCellToLatEdge_2_12, &averageCellToLatEdge_2_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_m]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    interpCellToVtx_2_12_info interpCellToVtx_2_12_para;
    interpCellToVtx_2_12_para.lz = 32 - 0;
    interpCellToVtx_2_12_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    interpCellToVtx_2_12_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    interpCellToVtx_2_12_para.oz = 0;
    interpCellToVtx_2_12_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    interpCellToVtx_2_12_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    interpCellToVtx_2_12_para.hx = 1;
    interpCellToVtx_2_12_para.hy = 1;
    interpCellToVtx_2_12_para.hz = 0;
    interpCellToVtx_2_12_para.bx = 256;
    interpCellToVtx_2_12_para.by = 8;
    interpCellToVtx_2_12_para.bz = 1;
    interpCellToVtx_2_12_para.mx = 1;
    interpCellToVtx_2_12_para.my = 2;
    interpCellToVtx_2_12_para.mz = 32;
    interpCellToVtx_2_12_para.new_statem = &new_state->m[Proc.lev_hw - 0+interpCellToVtx_2_12_para.oz][Proc.lat_hw -1+interpCellToVtx_2_12_para.oy][Proc.lon_hw -1+interpCellToVtx_2_12_para.ox];
    interpCellToVtx_2_12_para.new_statem_vtx = &new_state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_2_12_para.oz][Proc.lat_hw -1+interpCellToVtx_2_12_para.oy][Proc.lon_hw -1+interpCellToVtx_2_12_para.ox];
    interpCellToVtx_2_12_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
    interpCellToVtx_2_12_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
    interpCellToVtx_2_12_para.area_vtx = &mesh->area_vtx[0][0][0];
    
    athread_spawn(interpCellToVtx_2_12, &interpCellToVtx_2_12_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  if (((tendPara->u) && (tendPara->v)))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lon_edge(0,&tend2->du[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lon_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend2->du[0][0][0], &Proc.FieldReq[async_du], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    Filter_on_lat_edge(0,&tend2->dv[0][0][0]);
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    Filter_on_lat_edgeTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &tend2->dv[0][0][0], &Proc.FieldReq[async_dv], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    HaloWait(Proc,&Proc.FieldReq[async_du]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_2_22_info update_state_2_22_para;
    update_state_2_22_para.lz = 32 - 0;
    update_state_2_22_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    update_state_2_22_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_2_22_para.oz = 0;
    update_state_2_22_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    update_state_2_22_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_2_22_para.hx = 1;
    update_state_2_22_para.hy = 1;
    update_state_2_22_para.hz = 0;
    update_state_2_22_para.bx = 256;
    update_state_2_22_para.by = 8;
    update_state_2_22_para.bz = 1;
    update_state_2_22_para.mx = 1;
    update_state_2_22_para.my = 2;
    update_state_2_22_para.mz = 32;
    update_state_2_22_para.old_stateu_lon = &old_state->u_lon[Proc.lev_hw - 0+update_state_2_22_para.oz][Proc.lat_hw -1+update_state_2_22_para.oy][Proc.lon_hw -1+update_state_2_22_para.ox];
    update_state_2_22_para.tend2du = &tend2->du[Proc.lev_hw - 0+update_state_2_22_para.oz][Proc.lat_hw -1+update_state_2_22_para.oy][Proc.lon_hw -1+update_state_2_22_para.ox];
    update_state_2_22_para.new_stateu_lon = &new_state->u_lon[Proc.lev_hw - 0+update_state_2_22_para.oz][Proc.lat_hw -1+update_state_2_22_para.oy][Proc.lon_hw -1+update_state_2_22_para.ox];
    update_state_2_22_para.dt = dt;
    
    athread_spawn(update_state_2_22, &update_state_2_22_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_stateu_lonTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    HaloWait(Proc,&Proc.FieldReq[async_dv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    update_state_2_23_info update_state_2_23_para;
    update_state_2_23_para.lz = 32 - 0;
    update_state_2_23_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    update_state_2_23_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    update_state_2_23_para.oz = 0;
    update_state_2_23_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    update_state_2_23_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    update_state_2_23_para.hx = 1;
    update_state_2_23_para.hy = 1;
    update_state_2_23_para.hz = 0;
    update_state_2_23_para.bx = 256;
    update_state_2_23_para.by = 8;
    update_state_2_23_para.bz = 1;
    update_state_2_23_para.mx = 1;
    update_state_2_23_para.my = 2;
    update_state_2_23_para.mz = 32;
    update_state_2_23_para.old_statev_lat = &old_state->v_lat[Proc.lev_hw - 0+update_state_2_23_para.oz][Proc.lat_hw -1+update_state_2_23_para.oy][Proc.lon_hw -1+update_state_2_23_para.ox];
    update_state_2_23_para.tend2dv = &tend2->dv[Proc.lev_hw - 0+update_state_2_23_para.oz][Proc.lat_hw -1+update_state_2_23_para.oy][Proc.lon_hw -1+update_state_2_23_para.ox];
    update_state_2_23_para.new_statev_lat = &new_state->v_lat[Proc.lev_hw - 0+update_state_2_23_para.oz][Proc.lat_hw -1+update_state_2_23_para.oy][Proc.lon_hw -1+update_state_2_23_para.ox];
    update_state_2_23_para.dt = dt;
    
    athread_spawn(update_state_2_23, &update_state_2_23_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    update_statev_latTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &new_state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
}

void damp_run_2(struct HybridStateField* state, struct HybridTendField* tend, struct HybridMeshField* mesh, double dt)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_div]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->u_lon[k][j][i] = (state->u_lon[k][j][i] + ((mesh->c_lon[k][j][0] * (state->div[k][j][(i + 1)] - state->div[k][j][i])) / mesh->de_lon[0][j][0]));
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  div_damp_runu_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_div]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state->v_lat[k][j][i] = (state->v_lat[k][j][i] + ((mesh->c_lat[k][j][0] * (state->div[k][(j + 1)][i] - state->div[k][j][i])) / mesh->de_lat[0][j][0]));
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  div_damp_runv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  dt = dt;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_2_0_info smag_damp_run_2_0_para;
  smag_damp_run_2_0_para.lz = 32 - 0;
  smag_damp_run_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_2_0_para.oz = 0;
  smag_damp_run_2_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_2_0_para.hx = 1;
  smag_damp_run_2_0_para.hy = 1;
  smag_damp_run_2_0_para.hz = 0;
  smag_damp_run_2_0_para.bx = 256;
  smag_damp_run_2_0_para.by = 8;
  smag_damp_run_2_0_para.bz = 1;
  smag_damp_run_2_0_para.mx = 1;
  smag_damp_run_2_0_para.my = 2;
  smag_damp_run_2_0_para.mz = 32;
  smag_damp_run_2_0_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_2_0_para.oz][Proc.lat_hw -1+smag_damp_run_2_0_para.oy][Proc.lon_hw -1+smag_damp_run_2_0_para.ox];
  smag_damp_run_2_0_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_2_0_para.oz][Proc.lat_hw -1+smag_damp_run_2_0_para.oy][Proc.lon_hw -1+smag_damp_run_2_0_para.ox];
  smag_damp_run_2_0_para.statesmag_t = &state->smag_t[Proc.lev_hw - 0+smag_damp_run_2_0_para.oz][Proc.lat_hw -1+smag_damp_run_2_0_para.oy][Proc.lon_hw -1+smag_damp_run_2_0_para.ox];
  smag_damp_run_2_0_para.de_lon = &mesh->de_lon[0][0][0];
  smag_damp_run_2_0_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  smag_damp_run_2_0_para.le_lon = &mesh->le_lon[0][0][0];
  smag_damp_run_2_0_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_2_0, &smag_damp_run_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_tTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->smag_t[0][0][0], &Proc.FieldReq[async_smag_t], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_2_1_info smag_damp_run_2_1_para;
  smag_damp_run_2_1_para.lz = 32 - 0;
  smag_damp_run_2_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  smag_damp_run_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_2_1_para.oz = 0;
  smag_damp_run_2_1_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  smag_damp_run_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_2_1_para.hx = 1;
  smag_damp_run_2_1_para.hy = 1;
  smag_damp_run_2_1_para.hz = 0;
  smag_damp_run_2_1_para.bx = 256;
  smag_damp_run_2_1_para.by = 8;
  smag_damp_run_2_1_para.bz = 1;
  smag_damp_run_2_1_para.mx = 1;
  smag_damp_run_2_1_para.my = 2;
  smag_damp_run_2_1_para.mz = 32;
  smag_damp_run_2_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_2_1_para.oz][Proc.lat_hw -1+smag_damp_run_2_1_para.oy][Proc.lon_hw -1+smag_damp_run_2_1_para.ox];
  smag_damp_run_2_1_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_2_1_para.oz][Proc.lat_hw -1+smag_damp_run_2_1_para.oy][Proc.lon_hw -1+smag_damp_run_2_1_para.ox];
  smag_damp_run_2_1_para.statesmag_s = &state->smag_s[Proc.lev_hw - 0+smag_damp_run_2_1_para.oz][Proc.lat_hw -1+smag_damp_run_2_1_para.oy][Proc.lon_hw -1+smag_damp_run_2_1_para.ox];
  smag_damp_run_2_1_para.le_lat = &mesh->le_lat[0][0][0];
  smag_damp_run_2_1_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  smag_damp_run_2_1_para.de_lat = &mesh->de_lat[0][0][0];
  smag_damp_run_2_1_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_2_1, &smag_damp_run_2_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_sTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->smag_s[0][0][0], &Proc.FieldReq[async_smag_s], false, false, true, true, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_smag_t]);
  HaloWait(Proc,&Proc.FieldReq[async_smag_s]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_2_2_info smag_damp_run_2_2_para;
  smag_damp_run_2_2_para.lz = 32 - 0;
  smag_damp_run_2_2_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_2_2_para.oz = 0;
  smag_damp_run_2_2_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_2_2_para.hx = 1;
  smag_damp_run_2_2_para.hy = 1;
  smag_damp_run_2_2_para.hz = 0;
  smag_damp_run_2_2_para.bx = 256;
  smag_damp_run_2_2_para.by = 8;
  smag_damp_run_2_2_para.bz = 1;
  smag_damp_run_2_2_para.mx = 1;
  smag_damp_run_2_2_para.my = 2;
  smag_damp_run_2_2_para.mz = 32;
  smag_damp_run_2_2_para.statesmag_t = &state->smag_t[Proc.lev_hw - 0+smag_damp_run_2_2_para.oz][Proc.lat_hw -1+smag_damp_run_2_2_para.oy][Proc.lon_hw -1+smag_damp_run_2_2_para.ox];
  smag_damp_run_2_2_para.statesmag_s = &state->smag_s[Proc.lev_hw - 0+smag_damp_run_2_2_para.oz][Proc.lat_hw -1+smag_damp_run_2_2_para.oy][Proc.lon_hw -1+smag_damp_run_2_2_para.ox];
  smag_damp_run_2_2_para.statekmh_lon = &state->kmh_lon[Proc.lev_hw - 0+smag_damp_run_2_2_para.oz][Proc.lat_hw -1+smag_damp_run_2_2_para.oy][Proc.lon_hw -1+smag_damp_run_2_2_para.ox];
  smag_damp_run_2_2_para.de_lon = &mesh->de_lon[0][0][0];
  smag_damp_run_2_2_para.le_lon = &mesh->le_lon[0][0][0];
  
  athread_spawn(smag_damp_run_2_2, &smag_damp_run_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runkmh_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_smag_t]);
  HaloWait(Proc,&Proc.FieldReq[async_smag_s]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_2_3_info smag_damp_run_2_3_para;
  smag_damp_run_2_3_para.lz = 32 - 0;
  smag_damp_run_2_3_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  smag_damp_run_2_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_2_3_para.oz = 0;
  smag_damp_run_2_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  smag_damp_run_2_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_2_3_para.hx = 1;
  smag_damp_run_2_3_para.hy = 1;
  smag_damp_run_2_3_para.hz = 0;
  smag_damp_run_2_3_para.bx = 256;
  smag_damp_run_2_3_para.by = 8;
  smag_damp_run_2_3_para.bz = 1;
  smag_damp_run_2_3_para.mx = 1;
  smag_damp_run_2_3_para.my = 2;
  smag_damp_run_2_3_para.mz = 32;
  smag_damp_run_2_3_para.statesmag_t = &state->smag_t[Proc.lev_hw - 0+smag_damp_run_2_3_para.oz][Proc.lat_hw -1+smag_damp_run_2_3_para.oy][Proc.lon_hw -1+smag_damp_run_2_3_para.ox];
  smag_damp_run_2_3_para.statesmag_s = &state->smag_s[Proc.lev_hw - 0+smag_damp_run_2_3_para.oz][Proc.lat_hw -1+smag_damp_run_2_3_para.oy][Proc.lon_hw -1+smag_damp_run_2_3_para.ox];
  smag_damp_run_2_3_para.statekmh_lat = &state->kmh_lat[Proc.lev_hw - 0+smag_damp_run_2_3_para.oz][Proc.lat_hw -1+smag_damp_run_2_3_para.oy][Proc.lon_hw -1+smag_damp_run_2_3_para.ox];
  smag_damp_run_2_3_para.le_lat = &mesh->le_lat[0][0][0];
  smag_damp_run_2_3_para.de_lat = &mesh->de_lat[0][0][0];
  
  athread_spawn(smag_damp_run_2_3, &smag_damp_run_2_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runkmh_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_2_4_info smag_damp_run_2_4_para;
  smag_damp_run_2_4_para.lz = 32 - 0;
  smag_damp_run_2_4_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_2_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_2_4_para.oz = 0;
  smag_damp_run_2_4_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_2_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_2_4_para.hx = 1;
  smag_damp_run_2_4_para.hy = 1;
  smag_damp_run_2_4_para.hz = 0;
  smag_damp_run_2_4_para.bx = 256;
  smag_damp_run_2_4_para.by = 8;
  smag_damp_run_2_4_para.bz = 1;
  smag_damp_run_2_4_para.mx = 1;
  smag_damp_run_2_4_para.my = 2;
  smag_damp_run_2_4_para.mz = 32;
  smag_damp_run_2_4_para.statekmh_lon = &state->kmh_lon[Proc.lev_hw - 0+smag_damp_run_2_4_para.oz][Proc.lat_hw -1+smag_damp_run_2_4_para.oy][Proc.lon_hw -1+smag_damp_run_2_4_para.ox];
  smag_damp_run_2_4_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_2_4_para.oz][Proc.lat_hw -1+smag_damp_run_2_4_para.oy][Proc.lon_hw -1+smag_damp_run_2_4_para.ox];
  smag_damp_run_2_4_para.tendsmag_dudt = &tend->smag_dudt[Proc.lev_hw - 0+smag_damp_run_2_4_para.oz][Proc.lat_hw -1+smag_damp_run_2_4_para.oy][Proc.lon_hw -1+smag_damp_run_2_4_para.ox];
  smag_damp_run_2_4_para.de_lon = &mesh->de_lon[0][0][0];
  smag_damp_run_2_4_para.de_lat = &mesh->de_lat[0][0][0];
  smag_damp_run_2_4_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  smag_damp_run_2_4_para.le_lon = &mesh->le_lon[0][0][0];
  smag_damp_run_2_4_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_2_4, &smag_damp_run_2_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_dudtTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_2_5_info smag_damp_run_2_5_para;
  smag_damp_run_2_5_para.lz = 32 - 0;
  smag_damp_run_2_5_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  smag_damp_run_2_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_2_5_para.oz = 0;
  smag_damp_run_2_5_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_2_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_2_5_para.hx = 1;
  smag_damp_run_2_5_para.hy = 1;
  smag_damp_run_2_5_para.hz = 0;
  smag_damp_run_2_5_para.bx = 256;
  smag_damp_run_2_5_para.by = 8;
  smag_damp_run_2_5_para.bz = 1;
  smag_damp_run_2_5_para.mx = 1;
  smag_damp_run_2_5_para.my = 2;
  smag_damp_run_2_5_para.mz = 32;
  smag_damp_run_2_5_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+smag_damp_run_2_5_para.oz][Proc.lat_hw -1+smag_damp_run_2_5_para.oy][Proc.lon_hw -1+smag_damp_run_2_5_para.ox];
  smag_damp_run_2_5_para.tendsmag_dudt = &tend->smag_dudt[Proc.lev_hw - 0+smag_damp_run_2_5_para.oz][Proc.lat_hw -1+smag_damp_run_2_5_para.oy][Proc.lon_hw -1+smag_damp_run_2_5_para.ox];
  smag_damp_run_2_5_para.dt = dt;
  
  athread_spawn(smag_damp_run_2_5, &smag_damp_run_2_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runu_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_2_6_info smag_damp_run_2_6_para;
  smag_damp_run_2_6_para.lz = 32 - 0;
  smag_damp_run_2_6_para.ly = MIN(Proc.lat_end+1, 1198) - MAX(Proc.lat_beg, 1);
  smag_damp_run_2_6_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_2_6_para.oz = 0;
  smag_damp_run_2_6_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  smag_damp_run_2_6_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_2_6_para.hx = 1;
  smag_damp_run_2_6_para.hy = 1;
  smag_damp_run_2_6_para.hz = 0;
  smag_damp_run_2_6_para.bx = 256;
  smag_damp_run_2_6_para.by = 8;
  smag_damp_run_2_6_para.bz = 1;
  smag_damp_run_2_6_para.mx = 1;
  smag_damp_run_2_6_para.my = 2;
  smag_damp_run_2_6_para.mz = 32;
  smag_damp_run_2_6_para.statekmh_lat = &state->kmh_lat[Proc.lev_hw - 0+smag_damp_run_2_6_para.oz][Proc.lat_hw -1+smag_damp_run_2_6_para.oy][Proc.lon_hw -1+smag_damp_run_2_6_para.ox];
  smag_damp_run_2_6_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_2_6_para.oz][Proc.lat_hw -1+smag_damp_run_2_6_para.oy][Proc.lon_hw -1+smag_damp_run_2_6_para.ox];
  smag_damp_run_2_6_para.tendsmag_dvdt = &tend->smag_dvdt[Proc.lev_hw - 0+smag_damp_run_2_6_para.oz][Proc.lat_hw -1+smag_damp_run_2_6_para.oy][Proc.lon_hw -1+smag_damp_run_2_6_para.ox];
  smag_damp_run_2_6_para.le_lat = &mesh->le_lat[0][0][0];
  smag_damp_run_2_6_para.le_lon = &mesh->le_lon[0][0][0];
  smag_damp_run_2_6_para.full_cos_lat = &mesh->full_cos_lat[0][0][0];
  smag_damp_run_2_6_para.de_lat = &mesh->de_lat[0][0][0];
  smag_damp_run_2_6_para.half_cos_lat = &mesh->half_cos_lat[0][0][0];
  
  athread_spawn(smag_damp_run_2_6, &smag_damp_run_2_6_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_dvdtTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_2_7_info smag_damp_run_2_7_para;
  smag_damp_run_2_7_para.lz = 32 - 0;
  smag_damp_run_2_7_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1198);
  smag_damp_run_2_7_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_2_7_para.oz = 0;
  smag_damp_run_2_7_para.oy = MAX(Proc.lat_beg, 1198) - Proc.lat_beg;
  smag_damp_run_2_7_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_2_7_para.hx = 1;
  smag_damp_run_2_7_para.hy = 1;
  smag_damp_run_2_7_para.hz = 0;
  smag_damp_run_2_7_para.bx = 256;
  smag_damp_run_2_7_para.by = 8;
  smag_damp_run_2_7_para.bz = 1;
  smag_damp_run_2_7_para.mx = 1;
  smag_damp_run_2_7_para.my = 2;
  smag_damp_run_2_7_para.mz = 32;
  smag_damp_run_2_7_para.statekmh_lat = &state->kmh_lat[Proc.lev_hw - 0+smag_damp_run_2_7_para.oz][Proc.lat_hw -1+smag_damp_run_2_7_para.oy][Proc.lon_hw -1+smag_damp_run_2_7_para.ox];
  smag_damp_run_2_7_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_2_7_para.oz][Proc.lat_hw -1+smag_damp_run_2_7_para.oy][Proc.lon_hw -1+smag_damp_run_2_7_para.ox];
  smag_damp_run_2_7_para.tendsmag_dvdt = &tend->smag_dvdt[Proc.lev_hw - 0+smag_damp_run_2_7_para.oz][Proc.lat_hw -1+smag_damp_run_2_7_para.oy][Proc.lon_hw -1+smag_damp_run_2_7_para.ox];
  smag_damp_run_2_7_para.le_lat = &mesh->le_lat[0][0][0];
  
  athread_spawn(smag_damp_run_2_7, &smag_damp_run_2_7_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runsmag_dvdtTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  smag_damp_run_2_8_info smag_damp_run_2_8_para;
  smag_damp_run_2_8_para.lz = 32 - 0;
  smag_damp_run_2_8_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  smag_damp_run_2_8_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  smag_damp_run_2_8_para.oz = 0;
  smag_damp_run_2_8_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  smag_damp_run_2_8_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  smag_damp_run_2_8_para.hx = 1;
  smag_damp_run_2_8_para.hy = 1;
  smag_damp_run_2_8_para.hz = 0;
  smag_damp_run_2_8_para.bx = 256;
  smag_damp_run_2_8_para.by = 8;
  smag_damp_run_2_8_para.bz = 1;
  smag_damp_run_2_8_para.mx = 1;
  smag_damp_run_2_8_para.my = 2;
  smag_damp_run_2_8_para.mz = 32;
  smag_damp_run_2_8_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+smag_damp_run_2_8_para.oz][Proc.lat_hw -1+smag_damp_run_2_8_para.oy][Proc.lon_hw -1+smag_damp_run_2_8_para.ox];
  smag_damp_run_2_8_para.tendsmag_dvdt = &tend->smag_dvdt[Proc.lev_hw - 0+smag_damp_run_2_8_para.oz][Proc.lat_hw -1+smag_damp_run_2_8_para.oy][Proc.lon_hw -1+smag_damp_run_2_8_para.ox];
  smag_damp_run_2_8_para.dt = dt;
  
  athread_spawn(smag_damp_run_2_8, &smag_damp_run_2_8_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  smag_damp_runv_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  trickypt_2_0_info trickypt_2_0_para;
  trickypt_2_0_para.lz = 32 - 0;
  trickypt_2_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  trickypt_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  trickypt_2_0_para.oz = 0;
  trickypt_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  trickypt_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  trickypt_2_0_para.hx = 2;
  trickypt_2_0_para.hy = 2;
  trickypt_2_0_para.hz = 0;
  trickypt_2_0_para.bx = 256;
  trickypt_2_0_para.by = 8;
  trickypt_2_0_para.bz = 1;
  trickypt_2_0_para.mx = 1;
  trickypt_2_0_para.my = 2;
  trickypt_2_0_para.mz = 32;
  trickypt_2_0_para.statept = &state->pt[Proc.lev_hw - 0+trickypt_2_0_para.oz][Proc.lat_hw -2+trickypt_2_0_para.oy][Proc.lon_hw -2+trickypt_2_0_para.ox];
  trickypt_2_0_para.statem = &state->m[Proc.lev_hw - 0+trickypt_2_0_para.oz][Proc.lat_hw -2+trickypt_2_0_para.oy][Proc.lon_hw -2+trickypt_2_0_para.ox];
  
  athread_spawn(trickypt_2_0, &trickypt_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  trickyptptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_phs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_On_Cell(1,0,&state->phs[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_On_CellTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_2d_D(Proc, &state->phs[0][0][0], &Proc.FieldReq[async_phs], true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_phs]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_2_21_info calc_ph_2_21_para;
  calc_ph_2_21_para.lz = 33 - 0;
  calc_ph_2_21_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_2_21_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_2_21_para.oz = 0;
  calc_ph_2_21_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_2_21_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_2_21_para.hx = 1;
  calc_ph_2_21_para.hy = 1;
  calc_ph_2_21_para.hz = 0;
  calc_ph_2_21_para.bx = 256;
  calc_ph_2_21_para.by = 8;
  calc_ph_2_21_para.bz = 1;
  calc_ph_2_21_para.mx = 1;
  calc_ph_2_21_para.my = 2;
  calc_ph_2_21_para.mz = 32;
  calc_ph_2_21_para.statephs = &state->phs[0][Proc.lat_hw -1+calc_ph_2_21_para.oy][Proc.lon_hw -1+calc_ph_2_21_para.ox];
  calc_ph_2_21_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_2_21_para.oz][Proc.lat_hw -1+calc_ph_2_21_para.oy][Proc.lon_hw -1+calc_ph_2_21_para.ox];
  calc_ph_2_21_para.hyai = &mesh->hyai[0][0][0];
  calc_ph_2_21_para.hybi = &mesh->hybi[0][0][0];
  
  athread_spawn(calc_ph_2_21, &calc_ph_2_21_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_2_22_info calc_ph_2_22_para;
  calc_ph_2_22_para.lz = 33 - 0;
  calc_ph_2_22_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_2_22_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_2_22_para.oz = 0;
  calc_ph_2_22_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_2_22_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_2_22_para.hx = 1;
  calc_ph_2_22_para.hy = 1;
  calc_ph_2_22_para.hz = 0;
  calc_ph_2_22_para.bx = 256;
  calc_ph_2_22_para.by = 8;
  calc_ph_2_22_para.bz = 1;
  calc_ph_2_22_para.mx = 1;
  calc_ph_2_22_para.my = 2;
  calc_ph_2_22_para.mz = 32;
  calc_ph_2_22_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_ph_2_22_para.oz][Proc.lat_hw -1+calc_ph_2_22_para.oy][Proc.lon_hw -1+calc_ph_2_22_para.ox];
  calc_ph_2_22_para.stateph_exn_lev = &state->ph_exn_lev[Proc.lev_hw - 0+calc_ph_2_22_para.oz][Proc.lat_hw -1+calc_ph_2_22_para.oy][Proc.lon_hw -1+calc_ph_2_22_para.ox];
  
  athread_spawn(calc_ph_2_22, &calc_ph_2_22_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phph_exn_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->ph_exn_lev[0][0][0], &Proc.FieldReq[async_ph_exn_lev], true, true, false, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_ph_2_23_info calc_ph_2_23_para;
  calc_ph_2_23_para.lz = 32 - 0;
  calc_ph_2_23_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_ph_2_23_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_ph_2_23_para.oz = 0;
  calc_ph_2_23_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_ph_2_23_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_ph_2_23_para.hx = 0;
  calc_ph_2_23_para.hy = 0;
  calc_ph_2_23_para.hz = 1;
  calc_ph_2_23_para.bx = 256;
  calc_ph_2_23_para.by = 1;
  calc_ph_2_23_para.bz = 4;
  calc_ph_2_23_para.mx = 1;
  calc_ph_2_23_para.my = 8;
  calc_ph_2_23_para.mz = 8;
  calc_ph_2_23_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_ph_2_23_para.oz][Proc.lat_hw -0+calc_ph_2_23_para.oy][Proc.lon_hw -0+calc_ph_2_23_para.ox];
  calc_ph_2_23_para.stateph = &state->ph[Proc.lev_hw - 1+calc_ph_2_23_para.oz][Proc.lat_hw -0+calc_ph_2_23_para.oy][Proc.lon_hw -0+calc_ph_2_23_para.ox];
  
  athread_spawn(calc_ph_2_23, &calc_ph_2_23_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_phphTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_2_52_info calc_m_2_52_para;
  calc_m_2_52_para.lz = 32 - 0;
  calc_m_2_52_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_2_52_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_2_52_para.oz = 0;
  calc_m_2_52_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_2_52_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_2_52_para.hx = 1;
  calc_m_2_52_para.hy = 0;
  calc_m_2_52_para.hz = 1;
  calc_m_2_52_para.bx = 256;
  calc_m_2_52_para.by = 1;
  calc_m_2_52_para.bz = 4;
  calc_m_2_52_para.mx = 1;
  calc_m_2_52_para.my = 8;
  calc_m_2_52_para.mz = 8;
  calc_m_2_52_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_2_52_para.oz][Proc.lat_hw -0+calc_m_2_52_para.oy][Proc.lon_hw -1+calc_m_2_52_para.ox];
  calc_m_2_52_para.statem = &state->m[Proc.lev_hw - 1+calc_m_2_52_para.oz][Proc.lat_hw -0+calc_m_2_52_para.oy][Proc.lon_hw -1+calc_m_2_52_para.ox];
  
  athread_spawn(calc_m_2_52, &calc_m_2_52_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mmTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->m[0][0][0], &Proc.FieldReq[async_m], true, true, true, false, true, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_2_53_info calc_m_2_53_para;
  calc_m_2_53_para.lz = 32 - 1;
  calc_m_2_53_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_2_53_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_2_53_para.oz = 1;
  calc_m_2_53_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_2_53_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_2_53_para.hx = 0;
  calc_m_2_53_para.hy = 0;
  calc_m_2_53_para.hz = 1;
  calc_m_2_53_para.bx = 256;
  calc_m_2_53_para.by = 1;
  calc_m_2_53_para.bz = 4;
  calc_m_2_53_para.mx = 1;
  calc_m_2_53_para.my = 8;
  calc_m_2_53_para.mz = 8;
  calc_m_2_53_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_2_53_para.oz][Proc.lat_hw -0+calc_m_2_53_para.oy][Proc.lon_hw -0+calc_m_2_53_para.ox];
  calc_m_2_53_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_2_53_para.oz][Proc.lat_hw -0+calc_m_2_53_para.oy][Proc.lon_hw -0+calc_m_2_53_para.ox];
  
  athread_spawn(calc_m_2_53, &calc_m_2_53_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_2_54_info calc_m_2_54_para;
  calc_m_2_54_para.lz = 1 - 0;
  calc_m_2_54_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_2_54_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_2_54_para.oz = 0;
  calc_m_2_54_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_2_54_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_2_54_para.hx = 0;
  calc_m_2_54_para.hy = 0;
  calc_m_2_54_para.hz = 0;
  calc_m_2_54_para.bx = 256;
  calc_m_2_54_para.by = 8;
  calc_m_2_54_para.bz = 1;
  calc_m_2_54_para.mx = 1;
  calc_m_2_54_para.my = 2;
  calc_m_2_54_para.mz = 32;
  calc_m_2_54_para.stateph = &state->ph[Proc.lev_hw - 0+calc_m_2_54_para.oz][Proc.lat_hw -0+calc_m_2_54_para.oy][Proc.lon_hw -0+calc_m_2_54_para.ox];
  calc_m_2_54_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 0+calc_m_2_54_para.oz][Proc.lat_hw -0+calc_m_2_54_para.oy][Proc.lon_hw -0+calc_m_2_54_para.ox];
  calc_m_2_54_para.statem_lev = &state->m_lev[Proc.lev_hw - 0+calc_m_2_54_para.oz][Proc.lat_hw -0+calc_m_2_54_para.oy][Proc.lon_hw -0+calc_m_2_54_para.ox];
  
  athread_spawn(calc_m_2_54, &calc_m_2_54_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  calc_m_2_55_info calc_m_2_55_para;
  calc_m_2_55_para.lz = 33 - 32;
  calc_m_2_55_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  calc_m_2_55_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  calc_m_2_55_para.oz = 32;
  calc_m_2_55_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  calc_m_2_55_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  calc_m_2_55_para.hx = 0;
  calc_m_2_55_para.hy = 0;
  calc_m_2_55_para.hz = 1;
  calc_m_2_55_para.bx = 256;
  calc_m_2_55_para.by = 1;
  calc_m_2_55_para.bz = 4;
  calc_m_2_55_para.mx = 1;
  calc_m_2_55_para.my = 8;
  calc_m_2_55_para.mz = 8;
  calc_m_2_55_para.stateph_lev = &state->ph_lev[Proc.lev_hw - 1+calc_m_2_55_para.oz][Proc.lat_hw -0+calc_m_2_55_para.oy][Proc.lon_hw -0+calc_m_2_55_para.ox];
  calc_m_2_55_para.stateph = &state->ph[Proc.lev_hw - 1+calc_m_2_55_para.oz][Proc.lat_hw -0+calc_m_2_55_para.oy][Proc.lon_hw -0+calc_m_2_55_para.ox];
  calc_m_2_55_para.statem_lev = &state->m_lev[Proc.lev_hw - 1+calc_m_2_55_para.oz][Proc.lat_hw -0+calc_m_2_55_para.oy][Proc.lon_hw -0+calc_m_2_55_para.ox];
  
  athread_spawn(calc_m_2_55, &calc_m_2_55_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  calc_mm_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLonEdge_2_13_info averageCellToLonEdge_2_13_para;
  averageCellToLonEdge_2_13_para.lz = 32 - 0;
  averageCellToLonEdge_2_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  averageCellToLonEdge_2_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLonEdge_2_13_para.oz = 0;
  averageCellToLonEdge_2_13_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  averageCellToLonEdge_2_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLonEdge_2_13_para.hx = 1;
  averageCellToLonEdge_2_13_para.hy = 1;
  averageCellToLonEdge_2_13_para.hz = 0;
  averageCellToLonEdge_2_13_para.bx = 256;
  averageCellToLonEdge_2_13_para.by = 8;
  averageCellToLonEdge_2_13_para.bz = 1;
  averageCellToLonEdge_2_13_para.mx = 1;
  averageCellToLonEdge_2_13_para.my = 2;
  averageCellToLonEdge_2_13_para.mz = 32;
  averageCellToLonEdge_2_13_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLonEdge_2_13_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_13_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_13_para.ox];
  averageCellToLonEdge_2_13_para.statem_lon = &state->m_lon[Proc.lev_hw - 0+averageCellToLonEdge_2_13_para.oz][Proc.lat_hw -1+averageCellToLonEdge_2_13_para.oy][Proc.lon_hw -1+averageCellToLonEdge_2_13_para.ox];
  
  athread_spawn(averageCellToLonEdge_2_13, &averageCellToLonEdge_2_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLonEdgem_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  averageCellToLatEdge_2_13_info averageCellToLatEdge_2_13_para;
  averageCellToLatEdge_2_13_para.lz = 32 - 0;
  averageCellToLatEdge_2_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  averageCellToLatEdge_2_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  averageCellToLatEdge_2_13_para.oz = 0;
  averageCellToLatEdge_2_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  averageCellToLatEdge_2_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  averageCellToLatEdge_2_13_para.hx = 1;
  averageCellToLatEdge_2_13_para.hy = 1;
  averageCellToLatEdge_2_13_para.hz = 0;
  averageCellToLatEdge_2_13_para.bx = 256;
  averageCellToLatEdge_2_13_para.by = 8;
  averageCellToLatEdge_2_13_para.bz = 1;
  averageCellToLatEdge_2_13_para.mx = 1;
  averageCellToLatEdge_2_13_para.my = 2;
  averageCellToLatEdge_2_13_para.mz = 32;
  averageCellToLatEdge_2_13_para.statem = &state->m[Proc.lev_hw - 0+averageCellToLatEdge_2_13_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_13_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_13_para.ox];
  averageCellToLatEdge_2_13_para.statem_lat = &state->m_lat[Proc.lev_hw - 0+averageCellToLatEdge_2_13_para.oz][Proc.lat_hw -1+averageCellToLatEdge_2_13_para.oy][Proc.lon_hw -1+averageCellToLatEdge_2_13_para.ox];
  
  athread_spawn(averageCellToLatEdge_2_13, &averageCellToLatEdge_2_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  averageCellToLatEdgem_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  interpCellToVtx_2_13_info interpCellToVtx_2_13_para;
  interpCellToVtx_2_13_para.lz = 32 - 0;
  interpCellToVtx_2_13_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  interpCellToVtx_2_13_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  interpCellToVtx_2_13_para.oz = 0;
  interpCellToVtx_2_13_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  interpCellToVtx_2_13_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  interpCellToVtx_2_13_para.hx = 1;
  interpCellToVtx_2_13_para.hy = 1;
  interpCellToVtx_2_13_para.hz = 0;
  interpCellToVtx_2_13_para.bx = 256;
  interpCellToVtx_2_13_para.by = 8;
  interpCellToVtx_2_13_para.bz = 1;
  interpCellToVtx_2_13_para.mx = 1;
  interpCellToVtx_2_13_para.my = 2;
  interpCellToVtx_2_13_para.mz = 32;
  interpCellToVtx_2_13_para.statem = &state->m[Proc.lev_hw - 0+interpCellToVtx_2_13_para.oz][Proc.lat_hw -1+interpCellToVtx_2_13_para.oy][Proc.lon_hw -1+interpCellToVtx_2_13_para.ox];
  interpCellToVtx_2_13_para.statem_vtx = &state->m_vtx[Proc.lev_hw - 0+interpCellToVtx_2_13_para.oz][Proc.lat_hw -1+interpCellToVtx_2_13_para.oy][Proc.lon_hw -1+interpCellToVtx_2_13_para.ox];
  interpCellToVtx_2_13_para.area_subcell_1 = &mesh->area_subcell_1[0][0][0];
  interpCellToVtx_2_13_para.area_subcell_0 = &mesh->area_subcell_0[0][0][0];
  interpCellToVtx_2_13_para.area_vtx = &mesh->area_vtx[0][0][0];
  
  athread_spawn(interpCellToVtx_2_13, &interpCellToVtx_2_13_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  interpCellToVtxm_vtxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_On_Cell(2,1,&state->pt[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_On_CellTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_pt]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  pole_damp_run_2_0_info pole_damp_run_2_0_para;
  pole_damp_run_2_0_para.lz = 32 - 0;
  pole_damp_run_2_0_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  pole_damp_run_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  pole_damp_run_2_0_para.oz = 0;
  pole_damp_run_2_0_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  pole_damp_run_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  pole_damp_run_2_0_para.hx = 2;
  pole_damp_run_2_0_para.hy = 2;
  pole_damp_run_2_0_para.hz = 0;
  pole_damp_run_2_0_para.bx = 256;
  pole_damp_run_2_0_para.by = 8;
  pole_damp_run_2_0_para.bz = 1;
  pole_damp_run_2_0_para.mx = 1;
  pole_damp_run_2_0_para.my = 2;
  pole_damp_run_2_0_para.mz = 32;
  pole_damp_run_2_0_para.statept = &state->pt[Proc.lev_hw - 0+pole_damp_run_2_0_para.oz][Proc.lat_hw -2+pole_damp_run_2_0_para.oy][Proc.lon_hw -2+pole_damp_run_2_0_para.ox];
  pole_damp_run_2_0_para.statem = &state->m[Proc.lev_hw - 0+pole_damp_run_2_0_para.oz][Proc.lat_hw -2+pole_damp_run_2_0_para.oy][Proc.lon_hw -2+pole_damp_run_2_0_para.ox];
  
  athread_spawn(pole_damp_run_2_0, &pole_damp_run_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  pole_damp_runptTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->pt[0][0][0], &Proc.FieldReq[async_pt], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_on_lon_edge(3,&state->u_lon[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_on_lon_edgeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->u_lon[0][0][0], &Proc.FieldReq[async_u_lon], false, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_on_lat_edge(3,&state->v_lat[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_on_lat_edgeTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state->v_lat[0][0][0], &Proc.FieldReq[async_v_lat], true, false, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void c2a_2(struct HybridStateField* state)
{
  int k, j, i;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  c2a_2_1_info c2a_2_1_para;
  c2a_2_1_para.lz = 32 - 0;
  c2a_2_1_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  c2a_2_1_para.lx = MIN(Proc.lon_end+1, 2399) - MAX(Proc.lon_beg, 0);
  c2a_2_1_para.oz = 0;
  c2a_2_1_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  c2a_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  c2a_2_1_para.hx = 1;
  c2a_2_1_para.hy = 1;
  c2a_2_1_para.hz = 0;
  c2a_2_1_para.bx = 256;
  c2a_2_1_para.by = 8;
  c2a_2_1_para.bz = 1;
  c2a_2_1_para.mx = 1;
  c2a_2_1_para.my = 2;
  c2a_2_1_para.mz = 32;
  c2a_2_1_para.stateu_lon = &state->u_lon[Proc.lev_hw - 0+c2a_2_1_para.oz][Proc.lat_hw -1+c2a_2_1_para.oy][Proc.lon_hw -1+c2a_2_1_para.ox];
  c2a_2_1_para.statev_lat = &state->v_lat[Proc.lev_hw - 0+c2a_2_1_para.oz][Proc.lat_hw -1+c2a_2_1_para.oy][Proc.lon_hw -1+c2a_2_1_para.ox];
  c2a_2_1_para.stateu = &state->u[Proc.lev_hw - 0+c2a_2_1_para.oz][Proc.lat_hw -1+c2a_2_1_para.oy][Proc.lon_hw -1+c2a_2_1_para.ox];
  c2a_2_1_para.statev = &state->v[Proc.lev_hw - 0+c2a_2_1_para.oz][Proc.lat_hw -1+c2a_2_1_para.oy][Proc.lon_hw -1+c2a_2_1_para.ox];
  
  athread_spawn(c2a_2_1, &c2a_2_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  c2auTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void timeadvance_2()
{
  Time_Advance();
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Time_AdvanceTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void adv_run_2(struct HybridStateField* state_old, struct HybridStateField* state_new, struct HybridAdvField* adv, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  double cursum, cf, s1, s2, ds1, ds2, ds3;
  int k, j, i, ci, l;
  double *tmp_state_old_tmpsum, *tmp_state_new_tmpsum;
  struct Vector3 buf;
  advPara = advPara;
  dt = dt;
  advPara = advPara;
  dt = dt;
  if (((advPara->uv_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_60_info accum_uv_cell_2_60_para;
    accum_uv_cell_2_60_para.lz = 32 - 0;
    accum_uv_cell_2_60_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_60_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_60_para.oz = 0;
    accum_uv_cell_2_60_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_60_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_60_para.hx = 1;
    accum_uv_cell_2_60_para.hy = 0;
    accum_uv_cell_2_60_para.hz = 0;
    accum_uv_cell_2_60_para.bx = 256;
    accum_uv_cell_2_60_para.by = 8;
    accum_uv_cell_2_60_para.bz = 1;
    accum_uv_cell_2_60_para.mx = 1;
    accum_uv_cell_2_60_para.my = 2;
    accum_uv_cell_2_60_para.mz = 32;
    accum_uv_cell_2_60_para.advu0 = &adv->u0[Proc.lev_hw - 0+accum_uv_cell_2_60_para.oz][Proc.lat_hw -0+accum_uv_cell_2_60_para.oy][Proc.lon_hw -1+accum_uv_cell_2_60_para.ox];
    accum_uv_cell_2_60_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_2_60_para.oz][Proc.lat_hw -0+accum_uv_cell_2_60_para.oy][Proc.lon_hw -1+accum_uv_cell_2_60_para.ox];
    
    athread_spawn(accum_uv_cell_2_60, &accum_uv_cell_2_60_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_61_info accum_uv_cell_2_61_para;
    accum_uv_cell_2_61_para.lz = 32 - 0;
    accum_uv_cell_2_61_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_61_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_61_para.oz = 0;
    accum_uv_cell_2_61_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_61_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_61_para.hx = 0;
    accum_uv_cell_2_61_para.hy = 1;
    accum_uv_cell_2_61_para.hz = 0;
    accum_uv_cell_2_61_para.bx = 256;
    accum_uv_cell_2_61_para.by = 8;
    accum_uv_cell_2_61_para.bz = 1;
    accum_uv_cell_2_61_para.mx = 1;
    accum_uv_cell_2_61_para.my = 2;
    accum_uv_cell_2_61_para.mz = 32;
    accum_uv_cell_2_61_para.advv0 = &adv->v0[Proc.lev_hw - 0+accum_uv_cell_2_61_para.oz][Proc.lat_hw -1+accum_uv_cell_2_61_para.oy][Proc.lon_hw -0+accum_uv_cell_2_61_para.ox];
    accum_uv_cell_2_61_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_2_61_para.oz][Proc.lat_hw -1+accum_uv_cell_2_61_para.oy][Proc.lon_hw -0+accum_uv_cell_2_61_para.ox];
    
    athread_spawn(accum_uv_cell_2_61, &accum_uv_cell_2_61_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->uv_step) = 1;
  }
  if (((advPara->uv_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_62_info accum_uv_cell_2_62_para;
    accum_uv_cell_2_62_para.lz = 32 - 0;
    accum_uv_cell_2_62_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_62_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_62_para.oz = 0;
    accum_uv_cell_2_62_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_62_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_62_para.hx = 1;
    accum_uv_cell_2_62_para.hy = 1;
    accum_uv_cell_2_62_para.hz = 0;
    accum_uv_cell_2_62_para.bx = 256;
    accum_uv_cell_2_62_para.by = 8;
    accum_uv_cell_2_62_para.bz = 1;
    accum_uv_cell_2_62_para.mx = 1;
    accum_uv_cell_2_62_para.my = 2;
    accum_uv_cell_2_62_para.mz = 32;
    accum_uv_cell_2_62_para.state_oldu_lon = &state_old->u_lon[Proc.lev_hw - 0+accum_uv_cell_2_62_para.oz][Proc.lat_hw -1+accum_uv_cell_2_62_para.oy][Proc.lon_hw -1+accum_uv_cell_2_62_para.ox];
    accum_uv_cell_2_62_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_2_62_para.oz][Proc.lat_hw -1+accum_uv_cell_2_62_para.oy][Proc.lon_hw -1+accum_uv_cell_2_62_para.ox];
    
    athread_spawn(accum_uv_cell_2_62, &accum_uv_cell_2_62_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celluuTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_63_info accum_uv_cell_2_63_para;
    accum_uv_cell_2_63_para.lz = 32 - 0;
    accum_uv_cell_2_63_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_63_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_63_para.oz = 0;
    accum_uv_cell_2_63_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_63_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_63_para.hx = 1;
    accum_uv_cell_2_63_para.hy = 1;
    accum_uv_cell_2_63_para.hz = 0;
    accum_uv_cell_2_63_para.bx = 256;
    accum_uv_cell_2_63_para.by = 8;
    accum_uv_cell_2_63_para.bz = 1;
    accum_uv_cell_2_63_para.mx = 1;
    accum_uv_cell_2_63_para.my = 2;
    accum_uv_cell_2_63_para.mz = 32;
    accum_uv_cell_2_63_para.state_oldv_lat = &state_old->v_lat[Proc.lev_hw - 0+accum_uv_cell_2_63_para.oz][Proc.lat_hw -1+accum_uv_cell_2_63_para.oy][Proc.lon_hw -1+accum_uv_cell_2_63_para.ox];
    accum_uv_cell_2_63_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_2_63_para.oz][Proc.lat_hw -1+accum_uv_cell_2_63_para.oy][Proc.lon_hw -1+accum_uv_cell_2_63_para.ox];
    
    athread_spawn(accum_uv_cell_2_63, &accum_uv_cell_2_63_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellvvTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->uv_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_64_info accum_uv_cell_2_64_para;
      accum_uv_cell_2_64_para.lz = 32 - 0;
      accum_uv_cell_2_64_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_64_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_64_para.oz = 0;
      accum_uv_cell_2_64_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_64_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_64_para.hx = 1;
      accum_uv_cell_2_64_para.hy = 1;
      accum_uv_cell_2_64_para.hz = 0;
      accum_uv_cell_2_64_para.bx = 256;
      accum_uv_cell_2_64_para.by = 8;
      accum_uv_cell_2_64_para.bz = 1;
      accum_uv_cell_2_64_para.mx = 1;
      accum_uv_cell_2_64_para.my = 2;
      accum_uv_cell_2_64_para.mz = 32;
      accum_uv_cell_2_64_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_2_64_para.oz][Proc.lat_hw -1+accum_uv_cell_2_64_para.oy][Proc.lon_hw -1+accum_uv_cell_2_64_para.ox];
      accum_uv_cell_2_64_para.state_oldu_lon = &state_old->u_lon[Proc.lev_hw - 0+accum_uv_cell_2_64_para.oz][Proc.lat_hw -1+accum_uv_cell_2_64_para.oy][Proc.lon_hw -1+accum_uv_cell_2_64_para.ox];
      accum_uv_cell_2_64_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_2_64, &accum_uv_cell_2_64_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_65_info accum_uv_cell_2_65_para;
      accum_uv_cell_2_65_para.lz = 32 - 0;
      accum_uv_cell_2_65_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_65_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_65_para.oz = 0;
      accum_uv_cell_2_65_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_65_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_65_para.hx = 1;
      accum_uv_cell_2_65_para.hy = 1;
      accum_uv_cell_2_65_para.hz = 0;
      accum_uv_cell_2_65_para.bx = 256;
      accum_uv_cell_2_65_para.by = 8;
      accum_uv_cell_2_65_para.bz = 1;
      accum_uv_cell_2_65_para.mx = 1;
      accum_uv_cell_2_65_para.my = 2;
      accum_uv_cell_2_65_para.mz = 32;
      accum_uv_cell_2_65_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_2_65_para.oz][Proc.lat_hw -1+accum_uv_cell_2_65_para.oy][Proc.lon_hw -1+accum_uv_cell_2_65_para.ox];
      accum_uv_cell_2_65_para.state_oldv_lat = &state_old->v_lat[Proc.lev_hw - 0+accum_uv_cell_2_65_para.oz][Proc.lat_hw -1+accum_uv_cell_2_65_para.oy][Proc.lon_hw -1+accum_uv_cell_2_65_para.ox];
      accum_uv_cell_2_65_para.nstep = advPara->nstep;
      
      athread_spawn(accum_uv_cell_2_65, &accum_uv_cell_2_65_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_66_info accum_uv_cell_2_66_para;
      accum_uv_cell_2_66_para.lz = 32 - 0;
      accum_uv_cell_2_66_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_66_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_66_para.oz = 0;
      accum_uv_cell_2_66_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_66_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_66_para.hx = 1;
      accum_uv_cell_2_66_para.hy = 0;
      accum_uv_cell_2_66_para.hz = 0;
      accum_uv_cell_2_66_para.bx = 256;
      accum_uv_cell_2_66_para.by = 8;
      accum_uv_cell_2_66_para.bz = 1;
      accum_uv_cell_2_66_para.mx = 1;
      accum_uv_cell_2_66_para.my = 2;
      accum_uv_cell_2_66_para.mz = 32;
      accum_uv_cell_2_66_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_2_66_para.oz][Proc.lat_hw -0+accum_uv_cell_2_66_para.oy][Proc.lon_hw -1+accum_uv_cell_2_66_para.ox];
      accum_uv_cell_2_66_para.advu0 = &adv->u0[Proc.lev_hw - 0+accum_uv_cell_2_66_para.oz][Proc.lat_hw -0+accum_uv_cell_2_66_para.oy][Proc.lon_hw -1+accum_uv_cell_2_66_para.ox];
      
      athread_spawn(accum_uv_cell_2_66, &accum_uv_cell_2_66_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellu0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_67_info accum_uv_cell_2_67_para;
      accum_uv_cell_2_67_para.lz = 32 - 0;
      accum_uv_cell_2_67_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_67_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_67_para.oz = 0;
      accum_uv_cell_2_67_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_67_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_67_para.hx = 0;
      accum_uv_cell_2_67_para.hy = 1;
      accum_uv_cell_2_67_para.hz = 0;
      accum_uv_cell_2_67_para.bx = 256;
      accum_uv_cell_2_67_para.by = 8;
      accum_uv_cell_2_67_para.bz = 1;
      accum_uv_cell_2_67_para.mx = 1;
      accum_uv_cell_2_67_para.my = 2;
      accum_uv_cell_2_67_para.mz = 32;
      accum_uv_cell_2_67_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_2_67_para.oz][Proc.lat_hw -1+accum_uv_cell_2_67_para.oy][Proc.lon_hw -0+accum_uv_cell_2_67_para.ox];
      accum_uv_cell_2_67_para.advv0 = &adv->v0[Proc.lev_hw - 0+accum_uv_cell_2_67_para.oz][Proc.lat_hw -1+accum_uv_cell_2_67_para.oy][Proc.lon_hw -0+accum_uv_cell_2_67_para.ox];
      
      athread_spawn(accum_uv_cell_2_67, &accum_uv_cell_2_67_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellv0Time += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_uu]);
      HaloWait(Proc,&Proc.FieldReq[async_u_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_68_info accum_uv_cell_2_68_para;
      accum_uv_cell_2_68_para.lz = 32 - 0;
      accum_uv_cell_2_68_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_68_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_68_para.oz = 0;
      accum_uv_cell_2_68_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_68_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_68_para.hx = 1;
      accum_uv_cell_2_68_para.hy = 1;
      accum_uv_cell_2_68_para.hz = 0;
      accum_uv_cell_2_68_para.bx = 256;
      accum_uv_cell_2_68_para.by = 8;
      accum_uv_cell_2_68_para.bz = 1;
      accum_uv_cell_2_68_para.mx = 1;
      accum_uv_cell_2_68_para.my = 2;
      accum_uv_cell_2_68_para.mz = 32;
      accum_uv_cell_2_68_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_2_68_para.oz][Proc.lat_hw -1+accum_uv_cell_2_68_para.oy][Proc.lon_hw -1+accum_uv_cell_2_68_para.ox];
      accum_uv_cell_2_68_para.state_oldu_lon = &state_old->u_lon[Proc.lev_hw - 0+accum_uv_cell_2_68_para.oz][Proc.lat_hw -1+accum_uv_cell_2_68_para.oy][Proc.lon_hw -1+accum_uv_cell_2_68_para.ox];
      
      athread_spawn(accum_uv_cell_2_68, &accum_uv_cell_2_68_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_celluuTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->uu[0][0][0], &Proc.FieldReq[async_uu], false, true, true, true, false, false, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_vv]);
      HaloWait(Proc,&Proc.FieldReq[async_v_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_uv_cell_2_69_info accum_uv_cell_2_69_para;
      accum_uv_cell_2_69_para.lz = 32 - 0;
      accum_uv_cell_2_69_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_uv_cell_2_69_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_uv_cell_2_69_para.oz = 0;
      accum_uv_cell_2_69_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_uv_cell_2_69_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_uv_cell_2_69_para.hx = 1;
      accum_uv_cell_2_69_para.hy = 1;
      accum_uv_cell_2_69_para.hz = 0;
      accum_uv_cell_2_69_para.bx = 256;
      accum_uv_cell_2_69_para.by = 8;
      accum_uv_cell_2_69_para.bz = 1;
      accum_uv_cell_2_69_para.mx = 1;
      accum_uv_cell_2_69_para.my = 2;
      accum_uv_cell_2_69_para.mz = 32;
      accum_uv_cell_2_69_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_2_69_para.oz][Proc.lat_hw -1+accum_uv_cell_2_69_para.oy][Proc.lon_hw -1+accum_uv_cell_2_69_para.ox];
      accum_uv_cell_2_69_para.state_oldv_lat = &state_old->v_lat[Proc.lev_hw - 0+accum_uv_cell_2_69_para.oz][Proc.lat_hw -1+accum_uv_cell_2_69_para.oy][Proc.lon_hw -1+accum_uv_cell_2_69_para.ox];
      
      athread_spawn(accum_uv_cell_2_69, &accum_uv_cell_2_69_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_uv_cellvvTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      UpdateHalo_3d_D(Proc, &adv->vv[0][0][0], &Proc.FieldReq[async_vv], true, false, true, false, false, true, false, true);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->uv_step) = 0;
  }
  else
  {
    (advPara->uv_step) = ((advPara->uv_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->uv_step) > (advPara->nstep))))
  {
    if (!(advPara->dynamic))
    {
      (advPara->uv_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_70_info accum_uv_cell_2_70_para;
    accum_uv_cell_2_70_para.lz = 32 - 0;
    accum_uv_cell_2_70_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_2_70_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_70_para.oz = 0;
    accum_uv_cell_2_70_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_2_70_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_70_para.hx = 1;
    accum_uv_cell_2_70_para.hy = 0;
    accum_uv_cell_2_70_para.hz = 0;
    accum_uv_cell_2_70_para.bx = 256;
    accum_uv_cell_2_70_para.by = 8;
    accum_uv_cell_2_70_para.bz = 1;
    accum_uv_cell_2_70_para.mx = 1;
    accum_uv_cell_2_70_para.my = 2;
    accum_uv_cell_2_70_para.mz = 32;
    accum_uv_cell_2_70_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_2_70_para.oz][Proc.lat_hw -0+accum_uv_cell_2_70_para.oy][Proc.lon_hw -1+accum_uv_cell_2_70_para.ox];
    accum_uv_cell_2_70_para.advcflx = &adv->cflx[Proc.lev_hw - 0+accum_uv_cell_2_70_para.oz][Proc.lat_hw -0+accum_uv_cell_2_70_para.oy][Proc.lon_hw -1+accum_uv_cell_2_70_para.ox];
    accum_uv_cell_2_70_para.de_lon = &mesh->de_lon[0][0][0];
    accum_uv_cell_2_70_para.dt = dt;
    
    athread_spawn(accum_uv_cell_2_70, &accum_uv_cell_2_70_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_71_info accum_uv_cell_2_71_para;
    accum_uv_cell_2_71_para.lz = 32 - 0;
    accum_uv_cell_2_71_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_uv_cell_2_71_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_71_para.oz = 0;
    accum_uv_cell_2_71_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_uv_cell_2_71_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_71_para.hx = 0;
    accum_uv_cell_2_71_para.hy = 1;
    accum_uv_cell_2_71_para.hz = 0;
    accum_uv_cell_2_71_para.bx = 256;
    accum_uv_cell_2_71_para.by = 8;
    accum_uv_cell_2_71_para.bz = 1;
    accum_uv_cell_2_71_para.mx = 1;
    accum_uv_cell_2_71_para.my = 2;
    accum_uv_cell_2_71_para.mz = 32;
    accum_uv_cell_2_71_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_2_71_para.oz][Proc.lat_hw -1+accum_uv_cell_2_71_para.oy][Proc.lon_hw -0+accum_uv_cell_2_71_para.ox];
    accum_uv_cell_2_71_para.advcfly = &adv->cfly[Proc.lev_hw - 0+accum_uv_cell_2_71_para.oz][Proc.lat_hw -1+accum_uv_cell_2_71_para.oy][Proc.lon_hw -0+accum_uv_cell_2_71_para.ox];
    accum_uv_cell_2_71_para.de_lat = &mesh->de_lat[0][0][0];
    accum_uv_cell_2_71_para.dt = dt;
    
    athread_spawn(accum_uv_cell_2_71, &accum_uv_cell_2_71_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_cellcflyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_uu]);
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_72_info accum_uv_cell_2_72_para;
    accum_uv_cell_2_72_para.lz = 32 - 0;
    accum_uv_cell_2_72_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
    accum_uv_cell_2_72_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_72_para.oz = 0;
    accum_uv_cell_2_72_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
    accum_uv_cell_2_72_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_72_para.hx = 1;
    accum_uv_cell_2_72_para.hy = 1;
    accum_uv_cell_2_72_para.hz = 0;
    accum_uv_cell_2_72_para.bx = 256;
    accum_uv_cell_2_72_para.by = 8;
    accum_uv_cell_2_72_para.bz = 1;
    accum_uv_cell_2_72_para.mx = 1;
    accum_uv_cell_2_72_para.my = 2;
    accum_uv_cell_2_72_para.mz = 32;
    accum_uv_cell_2_72_para.advuu = &adv->uu[Proc.lev_hw - 0+accum_uv_cell_2_72_para.oz][Proc.lat_hw -1+accum_uv_cell_2_72_para.oy][Proc.lon_hw -1+accum_uv_cell_2_72_para.ox];
    accum_uv_cell_2_72_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_2_72_para.oz][Proc.lat_hw -1+accum_uv_cell_2_72_para.oy][Proc.lon_hw -1+accum_uv_cell_2_72_para.ox];
    accum_uv_cell_2_72_para.advdivx = &adv->divx[Proc.lev_hw - 0+accum_uv_cell_2_72_para.oz][Proc.lat_hw -1+accum_uv_cell_2_72_para.oy][Proc.lon_hw -1+accum_uv_cell_2_72_para.ox];
    accum_uv_cell_2_72_para.advdivy = &adv->divy[Proc.lev_hw - 0+accum_uv_cell_2_72_para.oz][Proc.lat_hw -1+accum_uv_cell_2_72_para.oy][Proc.lon_hw -1+accum_uv_cell_2_72_para.ox];
    accum_uv_cell_2_72_para.le_lon = &mesh->le_lon[0][0][0];
    accum_uv_cell_2_72_para.area_cell = &mesh->area_cell[0][0][0];
    accum_uv_cell_2_72_para.le_lat = &mesh->le_lat[0][0][0];
    
    athread_spawn(accum_uv_cell_2_72, &accum_uv_cell_2_72_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_vv]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_73_info accum_uv_cell_2_73_para;
    accum_uv_cell_2_73_para.lz = 32 - 0;
    accum_uv_cell_2_73_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
    accum_uv_cell_2_73_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_73_para.oz = 0;
    accum_uv_cell_2_73_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
    accum_uv_cell_2_73_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_73_para.hx = 0;
    accum_uv_cell_2_73_para.hy = 1;
    accum_uv_cell_2_73_para.hz = 0;
    accum_uv_cell_2_73_para.bx = 256;
    accum_uv_cell_2_73_para.by = 8;
    accum_uv_cell_2_73_para.bz = 1;
    accum_uv_cell_2_73_para.mx = 1;
    accum_uv_cell_2_73_para.my = 2;
    accum_uv_cell_2_73_para.mz = 32;
    accum_uv_cell_2_73_para.advvv = &adv->vv[Proc.lev_hw - 0+accum_uv_cell_2_73_para.oz][Proc.lat_hw -1+accum_uv_cell_2_73_para.oy][Proc.lon_hw -0+accum_uv_cell_2_73_para.ox];
    accum_uv_cell_2_73_para.state_oldtmpsum = &state_old->tmpsum[Proc.lev_hw - 0+accum_uv_cell_2_73_para.oz][Proc.lat_hw -1+accum_uv_cell_2_73_para.oy][Proc.lon_hw -0+accum_uv_cell_2_73_para.ox];
    
    athread_spawn(accum_uv_cell_2_73, &accum_uv_cell_2_73_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celltmpsumTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    // SumCall:state_old->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
    tmp_state_old_tmpsum = allocate_1d_array_D(32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          tmp_state_old_tmpsum[k-Proc.lev_hw]=tmp_state_old_tmpsum[k-Proc.lev_hw]+state_old->tmpsum[k][j][i];
        }
      }
    }
    Zonal_Sum_1d_D(Proc, &tmp_state_old_tmpsum,32);
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          state_old->tmpsum[k][j][i]=tmp_state_old_tmpsum[k-Proc.lev_hw];
        }
      }
    }
    free_1d_array_D(tmp_state_old_tmpsum,32);
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_uv_cell_2_74_info accum_uv_cell_2_74_para;
    accum_uv_cell_2_74_para.lz = 32 - 0;
    accum_uv_cell_2_74_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
    accum_uv_cell_2_74_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_uv_cell_2_74_para.oz = 0;
    accum_uv_cell_2_74_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
    accum_uv_cell_2_74_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_uv_cell_2_74_para.hx = 0;
    accum_uv_cell_2_74_para.hy = 0;
    accum_uv_cell_2_74_para.hz = 0;
    accum_uv_cell_2_74_para.bx = 256;
    accum_uv_cell_2_74_para.by = 8;
    accum_uv_cell_2_74_para.bz = 1;
    accum_uv_cell_2_74_para.mx = 1;
    accum_uv_cell_2_74_para.my = 2;
    accum_uv_cell_2_74_para.mz = 32;
    accum_uv_cell_2_74_para.state_oldtmpsum = &state_old->tmpsum[Proc.lev_hw - 0+accum_uv_cell_2_74_para.oz][Proc.lat_hw -0+accum_uv_cell_2_74_para.oy][Proc.lon_hw -0+accum_uv_cell_2_74_para.ox];
    accum_uv_cell_2_74_para.advdivy = &adv->divy[Proc.lev_hw - 0+accum_uv_cell_2_74_para.oz][Proc.lat_hw -0+accum_uv_cell_2_74_para.oy][Proc.lon_hw -0+accum_uv_cell_2_74_para.ox];
    accum_uv_cell_2_74_para.le_lat = &mesh->le_lat[0][0][0];
    accum_uv_cell_2_74_para.area_cell = &mesh->area_cell[0][0][0];
    
    athread_spawn(accum_uv_cell_2_74, &accum_uv_cell_2_74_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_uv_celldivyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  advPara = advPara;
  if (((advPara->mf_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          adv->mfx[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
      for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1199)-Proc.lat_beg+Proc.lat_hw; j+=1){
        for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
          adv->mfy[k][j][i] = 0.0;
        }
      }
    }
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->mf_step) = 1;
  }
  if (((advPara->mf_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_2_24_info accum_mf_cell_2_24_para;
    accum_mf_cell_2_24_para.lz = 32 - 0;
    accum_mf_cell_2_24_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_2_24_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_2_24_para.oz = 0;
    accum_mf_cell_2_24_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_2_24_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_2_24_para.hx = 1;
    accum_mf_cell_2_24_para.hy = 1;
    accum_mf_cell_2_24_para.hz = 0;
    accum_mf_cell_2_24_para.bx = 256;
    accum_mf_cell_2_24_para.by = 8;
    accum_mf_cell_2_24_para.bz = 1;
    accum_mf_cell_2_24_para.mx = 1;
    accum_mf_cell_2_24_para.my = 2;
    accum_mf_cell_2_24_para.mz = 32;
    accum_mf_cell_2_24_para.state_oldmfx_lon = &state_old->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_2_24_para.oz][Proc.lat_hw -1+accum_mf_cell_2_24_para.oy][Proc.lon_hw -1+accum_mf_cell_2_24_para.ox];
    accum_mf_cell_2_24_para.advmfx = &adv->mfx[Proc.lev_hw - 0+accum_mf_cell_2_24_para.oz][Proc.lat_hw -1+accum_mf_cell_2_24_para.oy][Proc.lon_hw -1+accum_mf_cell_2_24_para.ox];
    
    athread_spawn(accum_mf_cell_2_24, &accum_mf_cell_2_24_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_mf_cell_2_25_info accum_mf_cell_2_25_para;
    accum_mf_cell_2_25_para.lz = 32 - 0;
    accum_mf_cell_2_25_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
    accum_mf_cell_2_25_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_mf_cell_2_25_para.oz = 0;
    accum_mf_cell_2_25_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_mf_cell_2_25_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_mf_cell_2_25_para.hx = 1;
    accum_mf_cell_2_25_para.hy = 1;
    accum_mf_cell_2_25_para.hz = 0;
    accum_mf_cell_2_25_para.bx = 256;
    accum_mf_cell_2_25_para.by = 8;
    accum_mf_cell_2_25_para.bz = 1;
    accum_mf_cell_2_25_para.mx = 1;
    accum_mf_cell_2_25_para.my = 2;
    accum_mf_cell_2_25_para.mz = 32;
    accum_mf_cell_2_25_para.state_oldmfy_lat = &state_old->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_2_25_para.oz][Proc.lat_hw -1+accum_mf_cell_2_25_para.oy][Proc.lon_hw -1+accum_mf_cell_2_25_para.ox];
    accum_mf_cell_2_25_para.advmfy = &adv->mfy[Proc.lev_hw - 0+accum_mf_cell_2_25_para.oz][Proc.lat_hw -1+accum_mf_cell_2_25_para.oy][Proc.lon_hw -1+accum_mf_cell_2_25_para.ox];
    
    athread_spawn(accum_mf_cell_2_25, &accum_mf_cell_2_25_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->mf_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_26_info accum_mf_cell_2_26_para;
      accum_mf_cell_2_26_para.lz = 32 - 0;
      accum_mf_cell_2_26_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_26_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_26_para.oz = 0;
      accum_mf_cell_2_26_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_26_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_26_para.hx = 1;
      accum_mf_cell_2_26_para.hy = 1;
      accum_mf_cell_2_26_para.hz = 0;
      accum_mf_cell_2_26_para.bx = 256;
      accum_mf_cell_2_26_para.by = 8;
      accum_mf_cell_2_26_para.bz = 1;
      accum_mf_cell_2_26_para.mx = 1;
      accum_mf_cell_2_26_para.my = 2;
      accum_mf_cell_2_26_para.mz = 32;
      accum_mf_cell_2_26_para.advmfx = &adv->mfx[Proc.lev_hw - 0+accum_mf_cell_2_26_para.oz][Proc.lat_hw -1+accum_mf_cell_2_26_para.oy][Proc.lon_hw -1+accum_mf_cell_2_26_para.ox];
      accum_mf_cell_2_26_para.state_oldmfx_lon = &state_old->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_2_26_para.oz][Proc.lat_hw -1+accum_mf_cell_2_26_para.oy][Proc.lon_hw -1+accum_mf_cell_2_26_para.ox];
      accum_mf_cell_2_26_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_2_26, &accum_mf_cell_2_26_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_27_info accum_mf_cell_2_27_para;
      accum_mf_cell_2_27_para.lz = 32 - 0;
      accum_mf_cell_2_27_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_27_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_27_para.oz = 0;
      accum_mf_cell_2_27_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_27_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_27_para.hx = 1;
      accum_mf_cell_2_27_para.hy = 1;
      accum_mf_cell_2_27_para.hz = 0;
      accum_mf_cell_2_27_para.bx = 256;
      accum_mf_cell_2_27_para.by = 8;
      accum_mf_cell_2_27_para.bz = 1;
      accum_mf_cell_2_27_para.mx = 1;
      accum_mf_cell_2_27_para.my = 2;
      accum_mf_cell_2_27_para.mz = 32;
      accum_mf_cell_2_27_para.advmfy = &adv->mfy[Proc.lev_hw - 0+accum_mf_cell_2_27_para.oz][Proc.lat_hw -1+accum_mf_cell_2_27_para.oy][Proc.lon_hw -1+accum_mf_cell_2_27_para.ox];
      accum_mf_cell_2_27_para.state_oldmfy_lat = &state_old->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_2_27_para.oz][Proc.lat_hw -1+accum_mf_cell_2_27_para.oy][Proc.lon_hw -1+accum_mf_cell_2_27_para.ox];
      accum_mf_cell_2_27_para.nstep = advPara->nstep;
      
      athread_spawn(accum_mf_cell_2_27, &accum_mf_cell_2_27_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfx_lon]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_28_info accum_mf_cell_2_28_para;
      accum_mf_cell_2_28_para.lz = 32 - 0;
      accum_mf_cell_2_28_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_28_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_28_para.oz = 0;
      accum_mf_cell_2_28_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_28_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_28_para.hx = 1;
      accum_mf_cell_2_28_para.hy = 1;
      accum_mf_cell_2_28_para.hz = 0;
      accum_mf_cell_2_28_para.bx = 256;
      accum_mf_cell_2_28_para.by = 8;
      accum_mf_cell_2_28_para.bz = 1;
      accum_mf_cell_2_28_para.mx = 1;
      accum_mf_cell_2_28_para.my = 2;
      accum_mf_cell_2_28_para.mz = 32;
      accum_mf_cell_2_28_para.advmfx = &adv->mfx[Proc.lev_hw - 0+accum_mf_cell_2_28_para.oz][Proc.lat_hw -1+accum_mf_cell_2_28_para.oy][Proc.lon_hw -1+accum_mf_cell_2_28_para.ox];
      accum_mf_cell_2_28_para.state_oldmfx_lon = &state_old->mfx_lon[Proc.lev_hw - 0+accum_mf_cell_2_28_para.oz][Proc.lat_hw -1+accum_mf_cell_2_28_para.oy][Proc.lon_hw -1+accum_mf_cell_2_28_para.ox];
      
      athread_spawn(accum_mf_cell_2_28, &accum_mf_cell_2_28_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfxTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_mfy_lat]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_mf_cell_2_29_info accum_mf_cell_2_29_para;
      accum_mf_cell_2_29_para.lz = 32 - 0;
      accum_mf_cell_2_29_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
      accum_mf_cell_2_29_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_mf_cell_2_29_para.oz = 0;
      accum_mf_cell_2_29_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_mf_cell_2_29_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_mf_cell_2_29_para.hx = 1;
      accum_mf_cell_2_29_para.hy = 1;
      accum_mf_cell_2_29_para.hz = 0;
      accum_mf_cell_2_29_para.bx = 256;
      accum_mf_cell_2_29_para.by = 8;
      accum_mf_cell_2_29_para.bz = 1;
      accum_mf_cell_2_29_para.mx = 1;
      accum_mf_cell_2_29_para.my = 2;
      accum_mf_cell_2_29_para.mz = 32;
      accum_mf_cell_2_29_para.advmfy = &adv->mfy[Proc.lev_hw - 0+accum_mf_cell_2_29_para.oz][Proc.lat_hw -1+accum_mf_cell_2_29_para.oy][Proc.lon_hw -1+accum_mf_cell_2_29_para.ox];
      accum_mf_cell_2_29_para.state_oldmfy_lat = &state_old->mfy_lat[Proc.lev_hw - 0+accum_mf_cell_2_29_para.oz][Proc.lat_hw -1+accum_mf_cell_2_29_para.oy][Proc.lon_hw -1+accum_mf_cell_2_29_para.ox];
      
      athread_spawn(accum_mf_cell_2_29, &accum_mf_cell_2_29_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_mf_cellmfyTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->mf_step) = 0;
  }
  else
  {
    (advPara->mf_step) = ((advPara->mf_step) + 1);
  }
  if ((!(advPara->dynamic) && ((advPara->mf_step) > (advPara->nstep))))
  {
    (advPara->mf_step) = -1;
  }
  advPara = advPara;
  dt = dt;
  if (((advPara->we_step) == -1))
  {
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_2_15_info accum_we_lev_2_15_para;
    accum_we_lev_2_15_para.lz = 33 - 0;
    accum_we_lev_2_15_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_2_15_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_2_15_para.oz = 0;
    accum_we_lev_2_15_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_2_15_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_2_15_para.hx = 0;
    accum_we_lev_2_15_para.hy = 0;
    accum_we_lev_2_15_para.hz = 0;
    accum_we_lev_2_15_para.bx = 256;
    accum_we_lev_2_15_para.by = 8;
    accum_we_lev_2_15_para.bz = 1;
    accum_we_lev_2_15_para.mx = 1;
    accum_we_lev_2_15_para.my = 2;
    accum_we_lev_2_15_para.mz = 32;
    accum_we_lev_2_15_para.advwe0 = &adv->we0[Proc.lev_hw - 0+accum_we_lev_2_15_para.oz][Proc.lat_hw -0+accum_we_lev_2_15_para.oy][Proc.lon_hw -0+accum_we_lev_2_15_para.ox];
    accum_we_lev_2_15_para.advm0 = &adv->m0[Proc.lev_hw - 0+accum_we_lev_2_15_para.oz][Proc.lat_hw -0+accum_we_lev_2_15_para.oy][Proc.lon_hw -0+accum_we_lev_2_15_para.ox];
    accum_we_lev_2_15_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_2_15_para.oz][Proc.lat_hw -0+accum_we_lev_2_15_para.oy][Proc.lon_hw -0+accum_we_lev_2_15_para.ox];
    accum_we_lev_2_15_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_2_15_para.oz][Proc.lat_hw -0+accum_we_lev_2_15_para.oy][Proc.lon_hw -0+accum_we_lev_2_15_para.ox];
    
    athread_spawn(accum_we_lev_2_15, &accum_we_lev_2_15_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
    (advPara->we_step) = 1;
  }
  if (((advPara->we_step) == 0))
  {
    TimeBeg = MPI_Wtime();
    
    HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_2_16_info accum_we_lev_2_16_para;
    accum_we_lev_2_16_para.lz = 33 - 0;
    accum_we_lev_2_16_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_2_16_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_2_16_para.oz = 0;
    accum_we_lev_2_16_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_2_16_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_2_16_para.hx = 1;
    accum_we_lev_2_16_para.hy = 1;
    accum_we_lev_2_16_para.hz = 0;
    accum_we_lev_2_16_para.bx = 256;
    accum_we_lev_2_16_para.by = 8;
    accum_we_lev_2_16_para.bz = 1;
    accum_we_lev_2_16_para.mx = 1;
    accum_we_lev_2_16_para.my = 2;
    accum_we_lev_2_16_para.mz = 32;
    accum_we_lev_2_16_para.state_oldwe_lev = &state_old->we_lev[Proc.lev_hw - 0+accum_we_lev_2_16_para.oz][Proc.lat_hw -1+accum_we_lev_2_16_para.oy][Proc.lon_hw -1+accum_we_lev_2_16_para.ox];
    accum_we_lev_2_16_para.state_oldm_lev = &state_old->m_lev[Proc.lev_hw - 0+accum_we_lev_2_16_para.oz][Proc.lat_hw -1+accum_we_lev_2_16_para.oy][Proc.lon_hw -1+accum_we_lev_2_16_para.ox];
    accum_we_lev_2_16_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_2_16_para.oz][Proc.lat_hw -1+accum_we_lev_2_16_para.oy][Proc.lon_hw -1+accum_we_lev_2_16_para.ox];
    accum_we_lev_2_16_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_2_16_para.oz][Proc.lat_hw -1+accum_we_lev_2_16_para.oy][Proc.lon_hw -1+accum_we_lev_2_16_para.ox];
    
    athread_spawn(accum_we_lev_2_16, &accum_we_lev_2_16_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levweTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  else
  {
    if (((advPara->we_step) == (advPara->nstep)))
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_2_17_info accum_we_lev_2_17_para;
      accum_we_lev_2_17_para.lz = 33 - 0;
      accum_we_lev_2_17_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_2_17_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_2_17_para.oz = 0;
      accum_we_lev_2_17_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_2_17_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_2_17_para.hx = 1;
      accum_we_lev_2_17_para.hy = 1;
      accum_we_lev_2_17_para.hz = 0;
      accum_we_lev_2_17_para.bx = 256;
      accum_we_lev_2_17_para.by = 8;
      accum_we_lev_2_17_para.bz = 1;
      accum_we_lev_2_17_para.mx = 1;
      accum_we_lev_2_17_para.my = 2;
      accum_we_lev_2_17_para.mz = 32;
      accum_we_lev_2_17_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_2_17_para.oz][Proc.lat_hw -1+accum_we_lev_2_17_para.oy][Proc.lon_hw -1+accum_we_lev_2_17_para.ox];
      accum_we_lev_2_17_para.state_oldwe_lev = &state_old->we_lev[Proc.lev_hw - 0+accum_we_lev_2_17_para.oz][Proc.lat_hw -1+accum_we_lev_2_17_para.oy][Proc.lon_hw -1+accum_we_lev_2_17_para.ox];
      accum_we_lev_2_17_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_2_17_para.oz][Proc.lat_hw -1+accum_we_lev_2_17_para.oy][Proc.lon_hw -1+accum_we_lev_2_17_para.ox];
      accum_we_lev_2_17_para.state_oldm_lev = &state_old->m_lev[Proc.lev_hw - 0+accum_we_lev_2_17_para.oz][Proc.lat_hw -1+accum_we_lev_2_17_para.oy][Proc.lon_hw -1+accum_we_lev_2_17_para.ox];
      accum_we_lev_2_17_para.advwe0 = &adv->we0[Proc.lev_hw - 0+accum_we_lev_2_17_para.oz][Proc.lat_hw -1+accum_we_lev_2_17_para.oy][Proc.lon_hw -1+accum_we_lev_2_17_para.ox];
      accum_we_lev_2_17_para.advm0 = &adv->m0[Proc.lev_hw - 0+accum_we_lev_2_17_para.oz][Proc.lat_hw -1+accum_we_lev_2_17_para.oy][Proc.lon_hw -1+accum_we_lev_2_17_para.ox];
      accum_we_lev_2_17_para.nstep = advPara->nstep;
      
      athread_spawn(accum_we_lev_2_17, &accum_we_lev_2_17_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
    else
    {
      TimeBeg = MPI_Wtime();
      
      HaloWait(Proc,&Proc.FieldReq[async_we_lev]);
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      accum_we_lev_2_18_info accum_we_lev_2_18_para;
      accum_we_lev_2_18_para.lz = 33 - 0;
      accum_we_lev_2_18_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
      accum_we_lev_2_18_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
      accum_we_lev_2_18_para.oz = 0;
      accum_we_lev_2_18_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
      accum_we_lev_2_18_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
      accum_we_lev_2_18_para.hx = 1;
      accum_we_lev_2_18_para.hy = 1;
      accum_we_lev_2_18_para.hz = 0;
      accum_we_lev_2_18_para.bx = 256;
      accum_we_lev_2_18_para.by = 8;
      accum_we_lev_2_18_para.bz = 1;
      accum_we_lev_2_18_para.mx = 1;
      accum_we_lev_2_18_para.my = 2;
      accum_we_lev_2_18_para.mz = 32;
      accum_we_lev_2_18_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_2_18_para.oz][Proc.lat_hw -1+accum_we_lev_2_18_para.oy][Proc.lon_hw -1+accum_we_lev_2_18_para.ox];
      accum_we_lev_2_18_para.state_oldwe_lev = &state_old->we_lev[Proc.lev_hw - 0+accum_we_lev_2_18_para.oz][Proc.lat_hw -1+accum_we_lev_2_18_para.oy][Proc.lon_hw -1+accum_we_lev_2_18_para.ox];
      accum_we_lev_2_18_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_2_18_para.oz][Proc.lat_hw -1+accum_we_lev_2_18_para.oy][Proc.lon_hw -1+accum_we_lev_2_18_para.ox];
      accum_we_lev_2_18_para.state_oldm_lev = &state_old->m_lev[Proc.lev_hw - 0+accum_we_lev_2_18_para.oz][Proc.lat_hw -1+accum_we_lev_2_18_para.oy][Proc.lon_hw -1+accum_we_lev_2_18_para.ox];
      
      athread_spawn(accum_we_lev_2_18, &accum_we_lev_2_18_para);
      athread_join();
      
      TimeEnd = MPI_Wtime();
      CompTime += (TimeEnd - TimeBeg);
      accum_we_levweTime += (TimeEnd - TimeBeg);
      TimeBeg = MPI_Wtime();
      
      TimeEnd = MPI_Wtime();
      CommTime += (TimeEnd - TimeBeg);
      
      
    }
  }
  if ((advPara->dynamic))
  {
    (advPara->we_step) = 0;
  }
  else
  {
    (advPara->we_step) = ((advPara->we_step) + 1);
  }
  if (((advPara->dynamic) || ((advPara->we_step) > (advPara->nstep))))
  {
    if (((advPara->dynamic) == 0))
    {
      (advPara->we_step) = -1;
    }
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    accum_we_lev_2_19_info accum_we_lev_2_19_para;
    accum_we_lev_2_19_para.lz = 32 - 1;
    accum_we_lev_2_19_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
    accum_we_lev_2_19_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
    accum_we_lev_2_19_para.oz = 1;
    accum_we_lev_2_19_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
    accum_we_lev_2_19_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
    accum_we_lev_2_19_para.hx = 0;
    accum_we_lev_2_19_para.hy = 0;
    accum_we_lev_2_19_para.hz = 0;
    accum_we_lev_2_19_para.bx = 256;
    accum_we_lev_2_19_para.by = 8;
    accum_we_lev_2_19_para.bz = 1;
    accum_we_lev_2_19_para.mx = 1;
    accum_we_lev_2_19_para.my = 2;
    accum_we_lev_2_19_para.mz = 32;
    accum_we_lev_2_19_para.advwe = &adv->we[Proc.lev_hw - 0+accum_we_lev_2_19_para.oz][Proc.lat_hw -0+accum_we_lev_2_19_para.oy][Proc.lon_hw -0+accum_we_lev_2_19_para.ox];
    accum_we_lev_2_19_para.advmm = &adv->mm[Proc.lev_hw - 0+accum_we_lev_2_19_para.oz][Proc.lat_hw -0+accum_we_lev_2_19_para.oy][Proc.lon_hw -0+accum_we_lev_2_19_para.ox];
    accum_we_lev_2_19_para.advcflz = &adv->cflz[Proc.lev_hw - 0+accum_we_lev_2_19_para.oz][Proc.lat_hw -0+accum_we_lev_2_19_para.oy][Proc.lon_hw -0+accum_we_lev_2_19_para.ox];
    accum_we_lev_2_19_para.dt = dt;
    
    athread_spawn(accum_we_lev_2_19, &accum_we_lev_2_19_para);
    athread_join();
    
    TimeEnd = MPI_Wtime();
    CompTime += (TimeEnd - TimeBeg);
    accum_we_levcflzTime += (TimeEnd - TimeBeg);
    TimeBeg = MPI_Wtime();
    
    TimeEnd = MPI_Wtime();
    CommTime += (TimeEnd - TimeBeg);
    
    
  }
  dt = dt;
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_2_9_info hflx_ppm_inner_2_9_para;
  hflx_ppm_inner_2_9_para.lz = 32 - 0;
  hflx_ppm_inner_2_9_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_2_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_2_9_para.oz = 0;
  hflx_ppm_inner_2_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_2_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_2_9_para.hx = 2;
  hflx_ppm_inner_2_9_para.hy = 2;
  hflx_ppm_inner_2_9_para.hz = 0;
  hflx_ppm_inner_2_9_para.bx = 256;
  hflx_ppm_inner_2_9_para.by = 8;
  hflx_ppm_inner_2_9_para.bz = 1;
  hflx_ppm_inner_2_9_para.mx = 1;
  hflx_ppm_inner_2_9_para.my = 2;
  hflx_ppm_inner_2_9_para.mz = 32;
  hflx_ppm_inner_2_9_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+hflx_ppm_inner_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_9_para.ox];
  hflx_ppm_inner_2_9_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_inner_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_9_para.ox];
  hflx_ppm_inner_2_9_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_inner_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_9_para.ox];
  hflx_ppm_inner_2_9_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_inner_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_9_para.ox];
  hflx_ppm_inner_2_9_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_inner_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_9_para.ox];
  hflx_ppm_inner_2_9_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_inner_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_9_para.ox];
  hflx_ppm_inner_2_9_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_inner_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_inner_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_inner_2_9_para.ox];
  
  athread_spawn(hflx_ppm_inner_2_9, &hflx_ppm_inner_2_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_uu]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_2_10_info hflx_ppm_inner_2_10_para;
  hflx_ppm_inner_2_10_para.lz = 32 - 0;
  hflx_ppm_inner_2_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_inner_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_2_10_para.oz = 0;
  hflx_ppm_inner_2_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_inner_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_2_10_para.hx = Proc.lon_hw;
  hflx_ppm_inner_2_10_para.hy = Proc.lat_hw;
  hflx_ppm_inner_2_10_para.hz = 0;
  hflx_ppm_inner_2_10_para.bx = 64;
  hflx_ppm_inner_2_10_para.by = 1;
  hflx_ppm_inner_2_10_para.bz = 1;
  hflx_ppm_inner_2_10_para.mx = 1;
  hflx_ppm_inner_2_10_para.my = 2;
  hflx_ppm_inner_2_10_para.mz = 32;
  hflx_ppm_inner_2_10_para.advcflx = &adv->cflx[Proc.lev_hw - 0+hflx_ppm_inner_2_10_para.oz][Proc.lat_hw -hflx_ppm_inner_2_10_para.hy +hflx_ppm_inner_2_10_para.oy][Proc.lon_hw -hflx_ppm_inner_2_10_para.hx +hflx_ppm_inner_2_10_para.ox];
  hflx_ppm_inner_2_10_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+hflx_ppm_inner_2_10_para.oz][Proc.lat_hw -hflx_ppm_inner_2_10_para.hy +hflx_ppm_inner_2_10_para.oy][Proc.lon_hw -hflx_ppm_inner_2_10_para.hx +hflx_ppm_inner_2_10_para.ox];
  hflx_ppm_inner_2_10_para.advuu = &adv->uu[Proc.lev_hw - 0+hflx_ppm_inner_2_10_para.oz][Proc.lat_hw -hflx_ppm_inner_2_10_para.hy +hflx_ppm_inner_2_10_para.oy][Proc.lon_hw -hflx_ppm_inner_2_10_para.hx +hflx_ppm_inner_2_10_para.ox];
  hflx_ppm_inner_2_10_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_inner_2_10_para.oz][Proc.lat_hw -hflx_ppm_inner_2_10_para.hy +hflx_ppm_inner_2_10_para.oy][Proc.lon_hw -hflx_ppm_inner_2_10_para.hx +hflx_ppm_inner_2_10_para.ox];
  hflx_ppm_inner_2_10_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_inner_2_10_para.oz][Proc.lat_hw -hflx_ppm_inner_2_10_para.hy +hflx_ppm_inner_2_10_para.oy][Proc.lon_hw -hflx_ppm_inner_2_10_para.hx +hflx_ppm_inner_2_10_para.ox];
  hflx_ppm_inner_2_10_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_inner_2_10_para.oz][Proc.lat_hw -hflx_ppm_inner_2_10_para.hy +hflx_ppm_inner_2_10_para.oy][Proc.lon_hw -hflx_ppm_inner_2_10_para.hx +hflx_ppm_inner_2_10_para.ox];
  hflx_ppm_inner_2_10_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+hflx_ppm_inner_2_10_para.oz][Proc.lat_hw -hflx_ppm_inner_2_10_para.hy +hflx_ppm_inner_2_10_para.oy][Proc.lon_hw -hflx_ppm_inner_2_10_para.hx +hflx_ppm_inner_2_10_para.ox];
  
  athread_spawn(hflx_ppm_inner_2_10, &hflx_ppm_inner_2_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqmf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lon[0][0][0], &Proc.FieldReq[async_qmf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_vv]);
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_inner_2_11_info hflx_ppm_inner_2_11_para;
  hflx_ppm_inner_2_11_para.lz = 32 - 0;
  hflx_ppm_inner_2_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_inner_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_inner_2_11_para.oz = 0;
  hflx_ppm_inner_2_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_inner_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_inner_2_11_para.hx = 0;
  hflx_ppm_inner_2_11_para.hy = 1;
  hflx_ppm_inner_2_11_para.hz = 0;
  hflx_ppm_inner_2_11_para.bx = 256;
  hflx_ppm_inner_2_11_para.by = 8;
  hflx_ppm_inner_2_11_para.bz = 1;
  hflx_ppm_inner_2_11_para.mx = 1;
  hflx_ppm_inner_2_11_para.my = 2;
  hflx_ppm_inner_2_11_para.mz = 32;
  hflx_ppm_inner_2_11_para.advcfly = &adv->cfly[Proc.lev_hw - 0+hflx_ppm_inner_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_11_para.ox];
  hflx_ppm_inner_2_11_para.advvv = &adv->vv[Proc.lev_hw - 0+hflx_ppm_inner_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_11_para.ox];
  hflx_ppm_inner_2_11_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_inner_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_11_para.ox];
  hflx_ppm_inner_2_11_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_inner_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_11_para.ox];
  hflx_ppm_inner_2_11_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_inner_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_11_para.ox];
  hflx_ppm_inner_2_11_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+hflx_ppm_inner_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_inner_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_inner_2_11_para.ox];
  
  athread_spawn(hflx_ppm_inner_2_11, &hflx_ppm_inner_2_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_innerqmf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lat[0][0][0], &Proc.FieldReq[async_qmf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_2_9_info ffsl_calc_tracer_hflx_2_9_para;
  ffsl_calc_tracer_hflx_2_9_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_2_9_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  ffsl_calc_tracer_hflx_2_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_2_9_para.oz = 0;
  ffsl_calc_tracer_hflx_2_9_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_2_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_2_9_para.hx = 2;
  ffsl_calc_tracer_hflx_2_9_para.hy = 2;
  ffsl_calc_tracer_hflx_2_9_para.hz = 0;
  ffsl_calc_tracer_hflx_2_9_para.bx = 256;
  ffsl_calc_tracer_hflx_2_9_para.by = 8;
  ffsl_calc_tracer_hflx_2_9_para.bz = 1;
  ffsl_calc_tracer_hflx_2_9_para.mx = 1;
  ffsl_calc_tracer_hflx_2_9_para.my = 2;
  ffsl_calc_tracer_hflx_2_9_para.mz = 32;
  ffsl_calc_tracer_hflx_2_9_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_9_para.ox];
  ffsl_calc_tracer_hflx_2_9_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_9_para.ox];
  ffsl_calc_tracer_hflx_2_9_para.advdivx = &adv->divx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_9_para.ox];
  ffsl_calc_tracer_hflx_2_9_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_9_para.ox];
  ffsl_calc_tracer_hflx_2_9_para.advdivy = &adv->divy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_9_para.ox];
  ffsl_calc_tracer_hflx_2_9_para.advqx = &adv->qx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_9_para.ox];
  ffsl_calc_tracer_hflx_2_9_para.advqy = &adv->qy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_9_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_9_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_9_para.ox];
  ffsl_calc_tracer_hflx_2_9_para.le_lon = &mesh->le_lon[0][0][0];
  ffsl_calc_tracer_hflx_2_9_para.area_cell = &mesh->area_cell[0][0][0];
  ffsl_calc_tracer_hflx_2_9_para.le_lat = &mesh->le_lat[0][0][0];
  ffsl_calc_tracer_hflx_2_9_para.dt = dt;
  
  athread_spawn(ffsl_calc_tracer_hflx_2_9, &ffsl_calc_tracer_hflx_2_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxqxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_2_10_info ffsl_calc_tracer_hflx_2_10_para;
  ffsl_calc_tracer_hflx_2_10_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_2_10_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  ffsl_calc_tracer_hflx_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_2_10_para.oz = 0;
  ffsl_calc_tracer_hflx_2_10_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_2_10_para.hx = 0;
  ffsl_calc_tracer_hflx_2_10_para.hy = 1;
  ffsl_calc_tracer_hflx_2_10_para.hz = 0;
  ffsl_calc_tracer_hflx_2_10_para.bx = 256;
  ffsl_calc_tracer_hflx_2_10_para.by = 8;
  ffsl_calc_tracer_hflx_2_10_para.bz = 1;
  ffsl_calc_tracer_hflx_2_10_para.mx = 1;
  ffsl_calc_tracer_hflx_2_10_para.my = 2;
  ffsl_calc_tracer_hflx_2_10_para.mz = 32;
  ffsl_calc_tracer_hflx_2_10_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_10_para.oz][Proc.lat_hw -1+ffsl_calc_tracer_hflx_2_10_para.oy][Proc.lon_hw -0+ffsl_calc_tracer_hflx_2_10_para.ox];
  ffsl_calc_tracer_hflx_2_10_para.state_oldtmpsum = &state_old->tmpsum[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_10_para.oz][Proc.lat_hw -1+ffsl_calc_tracer_hflx_2_10_para.oy][Proc.lon_hw -0+ffsl_calc_tracer_hflx_2_10_para.ox];
  
  athread_spawn(ffsl_calc_tracer_hflx_2_10, &ffsl_calc_tracer_hflx_2_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxtmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:state_old->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
  tmp_state_old_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_state_old_tmpsum[k-Proc.lev_hw]=tmp_state_old_tmpsum[k-Proc.lev_hw]+state_old->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_state_old_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state_old->tmpsum[k][j][i]=tmp_state_old_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_state_old_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  ffsl_calc_tracer_hflx_2_11_info ffsl_calc_tracer_hflx_2_11_para;
  ffsl_calc_tracer_hflx_2_11_para.lz = 32 - 0;
  ffsl_calc_tracer_hflx_2_11_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  ffsl_calc_tracer_hflx_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  ffsl_calc_tracer_hflx_2_11_para.oz = 0;
  ffsl_calc_tracer_hflx_2_11_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  ffsl_calc_tracer_hflx_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  ffsl_calc_tracer_hflx_2_11_para.hx = 2;
  ffsl_calc_tracer_hflx_2_11_para.hy = 2;
  ffsl_calc_tracer_hflx_2_11_para.hz = 0;
  ffsl_calc_tracer_hflx_2_11_para.bx = 256;
  ffsl_calc_tracer_hflx_2_11_para.by = 8;
  ffsl_calc_tracer_hflx_2_11_para.bz = 1;
  ffsl_calc_tracer_hflx_2_11_para.mx = 1;
  ffsl_calc_tracer_hflx_2_11_para.my = 2;
  ffsl_calc_tracer_hflx_2_11_para.mz = 32;
  ffsl_calc_tracer_hflx_2_11_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_11_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_11_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_11_para.ox];
  ffsl_calc_tracer_hflx_2_11_para.state_oldtmpsum = &state_old->tmpsum[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_11_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_11_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_11_para.ox];
  ffsl_calc_tracer_hflx_2_11_para.advdivy = &adv->divy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_11_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_11_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_11_para.ox];
  ffsl_calc_tracer_hflx_2_11_para.advqx = &adv->qx[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_11_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_11_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_11_para.ox];
  ffsl_calc_tracer_hflx_2_11_para.advqy = &adv->qy[Proc.lev_hw - 0+ffsl_calc_tracer_hflx_2_11_para.oz][Proc.lat_hw -2+ffsl_calc_tracer_hflx_2_11_para.oy][Proc.lon_hw -2+ffsl_calc_tracer_hflx_2_11_para.ox];
  ffsl_calc_tracer_hflx_2_11_para.le_lat = &mesh->le_lat[0][0][0];
  ffsl_calc_tracer_hflx_2_11_para.area_cell = &mesh->area_cell[0][0][0];
  ffsl_calc_tracer_hflx_2_11_para.dt = dt;
  
  athread_spawn(ffsl_calc_tracer_hflx_2_11, &ffsl_calc_tracer_hflx_2_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  ffsl_calc_tracer_hflxqxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qx[0][0][0], &Proc.FieldReq[async_qx], true, true, true, false, false, true, true, true);
  UpdateHalo_3d_D(Proc, &adv->qy[0][0][0], &Proc.FieldReq[async_qy], true, true, true, true, true, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qx]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_2_9_info hflx_ppm_outer_2_9_para;
  hflx_ppm_outer_2_9_para.lz = 32 - 0;
  hflx_ppm_outer_2_9_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_2_9_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_2_9_para.oz = 0;
  hflx_ppm_outer_2_9_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_2_9_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_2_9_para.hx = 2;
  hflx_ppm_outer_2_9_para.hy = 2;
  hflx_ppm_outer_2_9_para.hz = 0;
  hflx_ppm_outer_2_9_para.bx = 256;
  hflx_ppm_outer_2_9_para.by = 8;
  hflx_ppm_outer_2_9_para.bz = 1;
  hflx_ppm_outer_2_9_para.mx = 1;
  hflx_ppm_outer_2_9_para.my = 2;
  hflx_ppm_outer_2_9_para.mz = 32;
  hflx_ppm_outer_2_9_para.advqy = &adv->qy[Proc.lev_hw - 0+hflx_ppm_outer_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_9_para.ox];
  hflx_ppm_outer_2_9_para.advqx = &adv->qx[Proc.lev_hw - 0+hflx_ppm_outer_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_9_para.ox];
  hflx_ppm_outer_2_9_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_outer_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_9_para.ox];
  hflx_ppm_outer_2_9_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_outer_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_9_para.ox];
  hflx_ppm_outer_2_9_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_outer_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_9_para.ox];
  hflx_ppm_outer_2_9_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_outer_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_9_para.ox];
  hflx_ppm_outer_2_9_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_outer_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_9_para.ox];
  hflx_ppm_outer_2_9_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_outer_2_9_para.oz][Proc.lat_hw -2+hflx_ppm_outer_2_9_para.oy][Proc.lon_hw -2+hflx_ppm_outer_2_9_para.ox];
  
  athread_spawn(hflx_ppm_outer_2_9, &hflx_ppm_outer_2_9_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->qly[0][0][0], &Proc.FieldReq[async_qly], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->dqy[0][0][0], &Proc.FieldReq[async_dqy], true, true, true, false, false, false, true, true);
  UpdateHalo_3d_D(Proc, &adv->q6y[0][0][0], &Proc.FieldReq[async_q6y], true, true, true, false, false, false, true, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qy]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_2_10_info hflx_ppm_outer_2_10_para;
  hflx_ppm_outer_2_10_para.lz = 32 - 0;
  hflx_ppm_outer_2_10_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  hflx_ppm_outer_2_10_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_2_10_para.oz = 0;
  hflx_ppm_outer_2_10_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  hflx_ppm_outer_2_10_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_2_10_para.hx = Proc.lon_hw;
  hflx_ppm_outer_2_10_para.hy = Proc.lat_hw;
  hflx_ppm_outer_2_10_para.hz = 0;
  hflx_ppm_outer_2_10_para.bx = 64;
  hflx_ppm_outer_2_10_para.by = 1;
  hflx_ppm_outer_2_10_para.bz = 1;
  hflx_ppm_outer_2_10_para.mx = 1;
  hflx_ppm_outer_2_10_para.my = 2;
  hflx_ppm_outer_2_10_para.mz = 32;
  hflx_ppm_outer_2_10_para.advcflx = &adv->cflx[Proc.lev_hw - 0+hflx_ppm_outer_2_10_para.oz][Proc.lat_hw -hflx_ppm_outer_2_10_para.hy +hflx_ppm_outer_2_10_para.oy][Proc.lon_hw -hflx_ppm_outer_2_10_para.hx +hflx_ppm_outer_2_10_para.ox];
  hflx_ppm_outer_2_10_para.advqy = &adv->qy[Proc.lev_hw - 0+hflx_ppm_outer_2_10_para.oz][Proc.lat_hw -hflx_ppm_outer_2_10_para.hy +hflx_ppm_outer_2_10_para.oy][Proc.lon_hw -hflx_ppm_outer_2_10_para.hx +hflx_ppm_outer_2_10_para.ox];
  hflx_ppm_outer_2_10_para.advmfx = &adv->mfx[Proc.lev_hw - 0+hflx_ppm_outer_2_10_para.oz][Proc.lat_hw -hflx_ppm_outer_2_10_para.hy +hflx_ppm_outer_2_10_para.oy][Proc.lon_hw -hflx_ppm_outer_2_10_para.hx +hflx_ppm_outer_2_10_para.ox];
  hflx_ppm_outer_2_10_para.advqlx = &adv->qlx[Proc.lev_hw - 0+hflx_ppm_outer_2_10_para.oz][Proc.lat_hw -hflx_ppm_outer_2_10_para.hy +hflx_ppm_outer_2_10_para.oy][Proc.lon_hw -hflx_ppm_outer_2_10_para.hx +hflx_ppm_outer_2_10_para.ox];
  hflx_ppm_outer_2_10_para.advdqx = &adv->dqx[Proc.lev_hw - 0+hflx_ppm_outer_2_10_para.oz][Proc.lat_hw -hflx_ppm_outer_2_10_para.hy +hflx_ppm_outer_2_10_para.oy][Proc.lon_hw -hflx_ppm_outer_2_10_para.hx +hflx_ppm_outer_2_10_para.ox];
  hflx_ppm_outer_2_10_para.advq6x = &adv->q6x[Proc.lev_hw - 0+hflx_ppm_outer_2_10_para.oz][Proc.lat_hw -hflx_ppm_outer_2_10_para.hy +hflx_ppm_outer_2_10_para.oy][Proc.lon_hw -hflx_ppm_outer_2_10_para.hx +hflx_ppm_outer_2_10_para.ox];
  hflx_ppm_outer_2_10_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+hflx_ppm_outer_2_10_para.oz][Proc.lat_hw -hflx_ppm_outer_2_10_para.hy +hflx_ppm_outer_2_10_para.oy][Proc.lon_hw -hflx_ppm_outer_2_10_para.hx +hflx_ppm_outer_2_10_para.ox];
  
  athread_spawn(hflx_ppm_outer_2_10, &hflx_ppm_outer_2_10_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqmf_lonTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lon[0][0][0], &Proc.FieldReq[async_qmf_lon], false, true, true, true, false, false, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qly]);
  HaloWait(Proc,&Proc.FieldReq[async_dqy]);
  HaloWait(Proc,&Proc.FieldReq[async_q6y]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  hflx_ppm_outer_2_11_info hflx_ppm_outer_2_11_para;
  hflx_ppm_outer_2_11_para.lz = 32 - 0;
  hflx_ppm_outer_2_11_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 0);
  hflx_ppm_outer_2_11_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  hflx_ppm_outer_2_11_para.oz = 0;
  hflx_ppm_outer_2_11_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  hflx_ppm_outer_2_11_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  hflx_ppm_outer_2_11_para.hx = 0;
  hflx_ppm_outer_2_11_para.hy = 1;
  hflx_ppm_outer_2_11_para.hz = 0;
  hflx_ppm_outer_2_11_para.bx = 256;
  hflx_ppm_outer_2_11_para.by = 8;
  hflx_ppm_outer_2_11_para.bz = 1;
  hflx_ppm_outer_2_11_para.mx = 1;
  hflx_ppm_outer_2_11_para.my = 2;
  hflx_ppm_outer_2_11_para.mz = 32;
  hflx_ppm_outer_2_11_para.advcfly = &adv->cfly[Proc.lev_hw - 0+hflx_ppm_outer_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_11_para.ox];
  hflx_ppm_outer_2_11_para.advmfy = &adv->mfy[Proc.lev_hw - 0+hflx_ppm_outer_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_11_para.ox];
  hflx_ppm_outer_2_11_para.advqly = &adv->qly[Proc.lev_hw - 0+hflx_ppm_outer_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_11_para.ox];
  hflx_ppm_outer_2_11_para.advdqy = &adv->dqy[Proc.lev_hw - 0+hflx_ppm_outer_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_11_para.ox];
  hflx_ppm_outer_2_11_para.advq6y = &adv->q6y[Proc.lev_hw - 0+hflx_ppm_outer_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_11_para.ox];
  hflx_ppm_outer_2_11_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+hflx_ppm_outer_2_11_para.oz][Proc.lat_hw -1+hflx_ppm_outer_2_11_para.oy][Proc.lon_hw -0+hflx_ppm_outer_2_11_para.ox];
  
  athread_spawn(hflx_ppm_outer_2_11, &hflx_ppm_outer_2_11_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  hflx_ppm_outerqmf_latTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qmf_lat[0][0][0], &Proc.FieldReq[async_qmf_lat], true, false, true, false, false, true, false, true);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lon]);
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_2_0_info adv_run_2_0_para;
  adv_run_2_0_para.lz = 32 - 0;
  adv_run_2_0_para.ly = MIN(Proc.lat_end+1, 1199) - MAX(Proc.lat_beg, 1);
  adv_run_2_0_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_2_0_para.oz = 0;
  adv_run_2_0_para.oy = MAX(Proc.lat_beg, 1) - Proc.lat_beg;
  adv_run_2_0_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_2_0_para.hx = 2;
  adv_run_2_0_para.hy = 2;
  adv_run_2_0_para.hz = 0;
  adv_run_2_0_para.bx = 256;
  adv_run_2_0_para.by = 8;
  adv_run_2_0_para.bz = 1;
  adv_run_2_0_para.mx = 1;
  adv_run_2_0_para.my = 2;
  adv_run_2_0_para.mz = 32;
  adv_run_2_0_para.advold_m = &adv->old_m[Proc.lev_hw - 0+adv_run_2_0_para.oz][Proc.lat_hw -2+adv_run_2_0_para.oy][Proc.lon_hw -2+adv_run_2_0_para.ox];
  adv_run_2_0_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+adv_run_2_0_para.oz][Proc.lat_hw -2+adv_run_2_0_para.oy][Proc.lon_hw -2+adv_run_2_0_para.ox];
  adv_run_2_0_para.advqmf_lon = &adv->qmf_lon[Proc.lev_hw - 0+adv_run_2_0_para.oz][Proc.lat_hw -2+adv_run_2_0_para.oy][Proc.lon_hw -2+adv_run_2_0_para.ox];
  adv_run_2_0_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+adv_run_2_0_para.oz][Proc.lat_hw -2+adv_run_2_0_para.oy][Proc.lon_hw -2+adv_run_2_0_para.ox];
  adv_run_2_0_para.state_newqv = &state_new->qv[Proc.lev_hw - 0+adv_run_2_0_para.oz][Proc.lat_hw -2+adv_run_2_0_para.oy][Proc.lon_hw -2+adv_run_2_0_para.ox];
  adv_run_2_0_para.le_lon = &mesh->le_lon[0][0][0];
  adv_run_2_0_para.le_lat = &mesh->le_lat[0][0][0];
  adv_run_2_0_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(adv_run_2_0, &adv_run_2_0_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qmf_lat]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_2_1_info adv_run_2_1_para;
  adv_run_2_1_para.lz = 32 - 0;
  adv_run_2_1_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  adv_run_2_1_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_2_1_para.oz = 0;
  adv_run_2_1_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  adv_run_2_1_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_2_1_para.hx = 0;
  adv_run_2_1_para.hy = 1;
  adv_run_2_1_para.hz = 0;
  adv_run_2_1_para.bx = 256;
  adv_run_2_1_para.by = 8;
  adv_run_2_1_para.bz = 1;
  adv_run_2_1_para.mx = 1;
  adv_run_2_1_para.my = 2;
  adv_run_2_1_para.mz = 32;
  adv_run_2_1_para.advqmf_lat = &adv->qmf_lat[Proc.lev_hw - 0+adv_run_2_1_para.oz][Proc.lat_hw -1+adv_run_2_1_para.oy][Proc.lon_hw -0+adv_run_2_1_para.ox];
  adv_run_2_1_para.state_newtmpsum = &state_new->tmpsum[Proc.lev_hw - 0+adv_run_2_1_para.oz][Proc.lat_hw -1+adv_run_2_1_para.oy][Proc.lon_hw -0+adv_run_2_1_para.ox];
  
  athread_spawn(adv_run_2_1, &adv_run_2_1_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runtmpsumTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  // SumCall:state_new->tmpsum.[0, 0, 32, 0, 1199, 1200, 1, 0, 2400]
  tmp_state_new_tmpsum = allocate_1d_array_D(32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        tmp_state_new_tmpsum[k-Proc.lev_hw]=tmp_state_new_tmpsum[k-Proc.lev_hw]+state_new->tmpsum[k][j][i];
      }
    }
  }
  Zonal_Sum_1d_D(Proc, &tmp_state_new_tmpsum,32);
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 1199)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        state_new->tmpsum[k][j][i]=tmp_state_new_tmpsum[k-Proc.lev_hw];
      }
    }
  }
  free_1d_array_D(tmp_state_new_tmpsum,32);
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_2_2_info adv_run_2_2_para;
  adv_run_2_2_para.lz = 32 - 0;
  adv_run_2_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 1199);
  adv_run_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_2_2_para.oz = 0;
  adv_run_2_2_para.oy = MAX(Proc.lat_beg, 1199) - Proc.lat_beg;
  adv_run_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_2_2_para.hx = 2;
  adv_run_2_2_para.hy = 2;
  adv_run_2_2_para.hz = 0;
  adv_run_2_2_para.bx = 256;
  adv_run_2_2_para.by = 8;
  adv_run_2_2_para.bz = 1;
  adv_run_2_2_para.mx = 1;
  adv_run_2_2_para.my = 2;
  adv_run_2_2_para.mz = 32;
  adv_run_2_2_para.advold_m = &adv->old_m[Proc.lev_hw - 0+adv_run_2_2_para.oz][Proc.lat_hw -2+adv_run_2_2_para.oy][Proc.lon_hw -2+adv_run_2_2_para.ox];
  adv_run_2_2_para.state_oldqv = &state_old->qv[Proc.lev_hw - 0+adv_run_2_2_para.oz][Proc.lat_hw -2+adv_run_2_2_para.oy][Proc.lon_hw -2+adv_run_2_2_para.ox];
  adv_run_2_2_para.state_newtmpsum = &state_new->tmpsum[Proc.lev_hw - 0+adv_run_2_2_para.oz][Proc.lat_hw -2+adv_run_2_2_para.oy][Proc.lon_hw -2+adv_run_2_2_para.ox];
  adv_run_2_2_para.state_newqv = &state_new->qv[Proc.lev_hw - 0+adv_run_2_2_para.oz][Proc.lat_hw -2+adv_run_2_2_para.oy][Proc.lon_hw -2+adv_run_2_2_para.ox];
  adv_run_2_2_para.le_lat = &mesh->le_lat[0][0][0];
  adv_run_2_2_para.area_cell = &mesh->area_cell[0][0][0];
  
  athread_spawn(adv_run_2_2, &adv_run_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_2_3_info adv_run_2_3_para;
  adv_run_2_3_para.lz = 32 - 0;
  adv_run_2_3_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  adv_run_2_3_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_2_3_para.oz = 0;
  adv_run_2_3_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  adv_run_2_3_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_2_3_para.hx = 2;
  adv_run_2_3_para.hy = 2;
  adv_run_2_3_para.hz = 0;
  adv_run_2_3_para.bx = 256;
  adv_run_2_3_para.by = 8;
  adv_run_2_3_para.bz = 1;
  adv_run_2_3_para.mx = 1;
  adv_run_2_3_para.my = 2;
  adv_run_2_3_para.mz = 32;
  adv_run_2_3_para.state_newqv = &state_new->qv[Proc.lev_hw - 0+adv_run_2_3_para.oz][Proc.lat_hw -2+adv_run_2_3_para.oy][Proc.lon_hw -2+adv_run_2_3_para.ox];
  adv_run_2_3_para.state_oldm = &state_old->m[Proc.lev_hw - 0+adv_run_2_3_para.oz][Proc.lat_hw -2+adv_run_2_3_para.oy][Proc.lon_hw -2+adv_run_2_3_para.ox];
  
  athread_spawn(adv_run_2_3, &adv_run_2_3_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  buf = (struct Vector3){0.0,0.0,0.0};
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=0+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        buf = ppm(state_new->qv[(k - 2)][j][i],state_new->qv[(k - 1)][j][i],state_new->qv[k][j][i],state_new->qv[(k + 1)][j][i],state_new->qv[(k + 2)][j][i]);
        adv->qlx[k][j][i] = buf.x;
        adv->dqx[k][j][i] = buf.y;
        adv->q6x[k][j][i] = buf.z;
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmqlxTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &adv->qlx[0][0][0], &Proc.FieldReq[async_qlx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->dqx[0][0][0], &Proc.FieldReq[async_dqx], true, true, true, true, true, false, false, false);
  UpdateHalo_3d_D(Proc, &adv->q6x[0][0][0], &Proc.FieldReq[async_q6x], true, true, true, true, true, false, false, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  cursum = 0.0;
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_qlx]);
  HaloWait(Proc,&Proc.FieldReq[async_dqx]);
  HaloWait(Proc,&Proc.FieldReq[async_q6x]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  for(k=1+Proc.lev_hw; k<32+Proc.lev_hw; k+=1){
    for(j=MAX(Proc.lat_beg, 0)-Proc.lat_beg+Proc.lat_hw; j<MIN(Proc.lat_end+1, 1200)-Proc.lat_beg+Proc.lat_hw; j+=1){
      for(i=MAX(Proc.lon_beg, 0)-Proc.lon_beg+Proc.lon_hw; i<MIN(Proc.lon_end+1, 2400)-Proc.lon_beg+Proc.lon_hw; i+=1){
        ci = (int)(adv->cflz[k][j][i]);
        cf = (adv->cflz[k][j][i] - ci);
        if ((adv->cflz[k][j][i] > 0))
        {
          s1 = (1.0 - cf);
          s2 = 1.0;
          ds1 = (s2 - s1);
          ds2 = (pow(s2,2) - pow(s1,2));
          ds3 = (pow(s2,3) - pow(s1,3));
          cursum = 0.0;
          for (l=(k - ci);l<((k - 1) + 1);l+=1){
            cursum = (cursum + state_new->qv[l][j][i]);
          }
          adv->qmf_lev[k][j][i] = ((adv->we[k][j][i] * (((cursum + (adv->qlx[((k - ci) - 1)][j][i] * ds1)) + ((0.5 * adv->dqx[((k - ci) - 1)][j][i]) * ds2)) + (adv->q6x[((k - ci) - 1)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / adv->cflz[k][j][i]);
        }
        else
        {
          if ((adv->cflz[k][j][i] < 0))
          {
            s1 = 0.0;
            s2 = -cf;
            ds1 = (s2 - s1);
            ds2 = (pow(s2,2) - pow(s1,2));
            ds3 = (pow(s2,3) - pow(s1,3));
            for (l=k;l<(((k - ci) - 1) + 1);l+=1){
              cursum = (cursum + state_new->qv[l][j][i]);
            }
            adv->qmf_lev[k][j][i] = ((-adv->we[k][j][i] * (((cursum + (adv->qlx[(k - ci)][j][i] * ds1)) + ((0.5 * adv->dqx[(k - ci)][j][i]) * ds2)) + (adv->q6x[(k - ci)][j][i] * ((ds2 / 2.0) - (ds3 / 3.0))))) / adv->cflz[k][j][i]);
          }
          else
          {
            adv->qmf_lev[k][j][i] = 0.0;
          }
        }
      }
    }
  }
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  vflx_ppmqmf_levTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_2_4_info adv_run_2_4_para;
  adv_run_2_4_para.lz = 32 - 0;
  adv_run_2_4_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  adv_run_2_4_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_2_4_para.oz = 0;
  adv_run_2_4_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  adv_run_2_4_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_2_4_para.hx = 2;
  adv_run_2_4_para.hy = 0;
  adv_run_2_4_para.hz = 2;
  adv_run_2_4_para.bx = 256;
  adv_run_2_4_para.by = 1;
  adv_run_2_4_para.bz = 4;
  adv_run_2_4_para.mx = 1;
  adv_run_2_4_para.my = 8;
  adv_run_2_4_para.mz = 8;
  adv_run_2_4_para.state_newqv = &state_new->qv[Proc.lev_hw - 2+adv_run_2_4_para.oz][Proc.lat_hw -0+adv_run_2_4_para.oy][Proc.lon_hw -2+adv_run_2_4_para.ox];
  adv_run_2_4_para.state_oldm = &state_old->m[Proc.lev_hw - 2+adv_run_2_4_para.oz][Proc.lat_hw -0+adv_run_2_4_para.oy][Proc.lon_hw -2+adv_run_2_4_para.ox];
  adv_run_2_4_para.advqmf_lev = &adv->qmf_lev[Proc.lev_hw - 2+adv_run_2_4_para.oz][Proc.lat_hw -0+adv_run_2_4_para.oy][Proc.lon_hw -2+adv_run_2_4_para.ox];
  
  athread_spawn(adv_run_2_4, &adv_run_2_4_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  Filter_On_Cell(1,1,&state_new->qv[0][0][0]);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  Filter_On_CellTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state_new->qv[0][0][0], &Proc.FieldReq[async_qv], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_qv]);
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  adv_run_2_5_info adv_run_2_5_para;
  adv_run_2_5_para.lz = 32 - 0;
  adv_run_2_5_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  adv_run_2_5_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  adv_run_2_5_para.oz = 0;
  adv_run_2_5_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  adv_run_2_5_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  adv_run_2_5_para.hx = 2;
  adv_run_2_5_para.hy = 2;
  adv_run_2_5_para.hz = 0;
  adv_run_2_5_para.bx = 256;
  adv_run_2_5_para.by = 8;
  adv_run_2_5_para.bz = 1;
  adv_run_2_5_para.mx = 1;
  adv_run_2_5_para.my = 2;
  adv_run_2_5_para.mz = 32;
  adv_run_2_5_para.state_newqv = &state_new->qv[Proc.lev_hw - 0+adv_run_2_5_para.oz][Proc.lat_hw -2+adv_run_2_5_para.oy][Proc.lon_hw -2+adv_run_2_5_para.ox];
  adv_run_2_5_para.state_oldm = &state_old->m[Proc.lev_hw - 0+adv_run_2_5_para.oz][Proc.lat_hw -2+adv_run_2_5_para.oy][Proc.lon_hw -2+adv_run_2_5_para.ox];
  
  athread_spawn(adv_run_2_5, &adv_run_2_5_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  adv_runqvTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  UpdateHalo_3d_D(Proc, &state_new->qv[0][0][0], &Proc.FieldReq[async_qv], true, true, true, true, true, true, true, false);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
  TimeBeg = MPI_Wtime();
  
  HaloWait(Proc,&Proc.FieldReq[async_m]);
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  copy_old_m_2_2_info copy_old_m_2_2_para;
  copy_old_m_2_2_para.lz = 32 - 0;
  copy_old_m_2_2_para.ly = MIN(Proc.lat_end+1, 1200) - MAX(Proc.lat_beg, 0);
  copy_old_m_2_2_para.lx = MIN(Proc.lon_end+1, 2400) - MAX(Proc.lon_beg, 0);
  copy_old_m_2_2_para.oz = 0;
  copy_old_m_2_2_para.oy = MAX(Proc.lat_beg, 0) - Proc.lat_beg;
  copy_old_m_2_2_para.ox = MAX(Proc.lon_beg, 0) - Proc.lon_beg;
  copy_old_m_2_2_para.hx = 1;
  copy_old_m_2_2_para.hy = 1;
  copy_old_m_2_2_para.hz = 0;
  copy_old_m_2_2_para.bx = 256;
  copy_old_m_2_2_para.by = 8;
  copy_old_m_2_2_para.bz = 1;
  copy_old_m_2_2_para.mx = 1;
  copy_old_m_2_2_para.my = 2;
  copy_old_m_2_2_para.mz = 32;
  copy_old_m_2_2_para.state_oldm = &state_old->m[Proc.lev_hw - 0+copy_old_m_2_2_para.oz][Proc.lat_hw -1+copy_old_m_2_2_para.oy][Proc.lon_hw -1+copy_old_m_2_2_para.ox];
  copy_old_m_2_2_para.advold_m = &adv->old_m[Proc.lev_hw - 0+copy_old_m_2_2_para.oz][Proc.lat_hw -1+copy_old_m_2_2_para.oy][Proc.lon_hw -1+copy_old_m_2_2_para.ox];
  
  athread_spawn(copy_old_m_2_2, &copy_old_m_2_2_para);
  athread_join();
  
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  copy_old_mold_mTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void Diagnose_State_2(struct HybridStateField* state)
{
  Diagnose(state,10);
  TimeEnd = MPI_Wtime();
  CompTime += (TimeEnd - TimeBeg);
  DiagnoseTime += (TimeEnd - TimeBeg);
  TimeBeg = MPI_Wtime();
  
  TimeEnd = MPI_Wtime();
  CommTime += (TimeEnd - TimeBeg);
  
  
}

void MeshInit_0(struct HybridMeshField* global_mesh, struct HybridMeshField* mesh)
{
  LatLonMeshInit(&global_mesh[0]);
  LatLonMeshInit_cp(&global_mesh[0], &mesh[0]);
}

void MeshInit_1(struct HybridMeshField* global_mesh, struct HybridMeshField* mesh)
{
  LatLonMeshInit(&global_mesh[0]);
  LatLonMeshInit_cp(&global_mesh[0], &mesh[0]);
}

void MeshInit_2(struct HybridMeshField* global_mesh, struct HybridMeshField* mesh)
{
  LatLonMeshInit(&global_mesh[0]);
  LatLonMeshInit_cp(&global_mesh[0], &mesh[0]);
}

void timeOperatorInit_0(struct HybridStateField* state, struct HybridStaticField* staticv, struct HybridAdvField* adv, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  ncIO_Read_0(&state[0], &staticv[0]);
  spaceOperatorInit_0(&staticv[0], &mesh[0]);
  gzlevInit_0(&state[Timeinfo.oldt], &staticv[0]);
  gzlevInit_0(&state[Timeinfo.newt], &staticv[0]);
  gzlevInit_0(&state[2], &staticv[0]);
  uvInit_0(&state[Timeinfo.oldt]);
  operatorPrepareNull_0(&state[Timeinfo.oldt], &staticv[0], &adv[0], advPara, &mesh[0], dt);
  advPrepare_0(&state[Timeinfo.oldt], &adv[1], &adv[0]);
  filterinit_0(&mesh[0], dt);
}

void timeOperatorInit_1(struct HybridStateField* state, struct HybridStaticField* staticv, struct HybridAdvField* adv, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  ncIO_Read_1(&state[0], &staticv[0]);
  spaceOperatorInit_1(&staticv[0], &mesh[0]);
  gzlevInit_1(&state[Timeinfo.oldt], &staticv[0]);
  gzlevInit_1(&state[Timeinfo.newt], &staticv[0]);
  gzlevInit_1(&state[2], &staticv[0]);
  uvInit_1(&state[Timeinfo.oldt]);
  operatorPrepareNull_1(&state[Timeinfo.oldt], &staticv[0], &adv[0], advPara, &mesh[0], dt);
  advPrepare_1(&state[Timeinfo.oldt], &adv[1], &adv[0]);
  filterinit_1(&mesh[0], dt);
}

void timeOperatorInit_2(struct HybridStateField* state, struct HybridStaticField* staticv, struct HybridAdvField* adv, struct HybridAdvPara* advPara, struct HybridMeshField* mesh, double dt)
{
  ncIO_Read_2(&state[0], &staticv[0]);
  spaceOperatorInit_2(&staticv[0], &mesh[0]);
  gzlevInit_2(&state[Timeinfo.oldt], &staticv[0]);
  gzlevInit_2(&state[Timeinfo.newt], &staticv[0]);
  gzlevInit_2(&state[2], &staticv[0]);
  uvInit_2(&state[Timeinfo.oldt]);
  operatorPrepareNull_2(&state[Timeinfo.oldt], &staticv[0], &adv[0], advPara, &mesh[0], dt);
  advPrepare_2(&state[Timeinfo.oldt], &adv[1], &adv[0]);
  filterinit_2(&mesh[0], dt);
}

void wrk3d_0(struct HybridStateField* state, struct HybridStaticField* staticv, struct HybridTendField* tend, struct HybridTendPara* tendPara, struct HybridAdvField* adv, struct HybridAdvPara* advptPara, struct HybridAdvPara* advmPara, struct HybridMeshField* mesh, double dt, double dtd2, double dtd3)
{
  stepForwardBackward_0(&state[Timeinfo.oldt], &state[Timeinfo.oldt], &state[Timeinfo.newt], &staticv[0], &tend[Timeinfo.oldt], &tend[Timeinfo.newt], tendPara, &adv[0], advptPara, &mesh[0], dtd3);
  stepForwardBackward_0(&state[Timeinfo.oldt], &state[Timeinfo.newt], &state[2], &staticv[0], &tend[Timeinfo.oldt], &tend[Timeinfo.newt], tendPara, &adv[0], advptPara, &mesh[0], dtd2);
  stepForwardBackward_0(&state[Timeinfo.oldt], &state[2], &state[Timeinfo.newt], &staticv[0], &tend[Timeinfo.oldt], &tend[Timeinfo.newt], tendPara, &adv[0], advptPara, &mesh[0], dt);
  damp_run_0(&state[Timeinfo.newt], &tend[Timeinfo.newt], &mesh[0], dt);
  c2a_0(&state[Timeinfo.newt]);
  timeadvance_0();
  adv_run_0(&state[Timeinfo.oldt], &state[Timeinfo.newt], &adv[1], advmPara, &mesh[0], dt);
  Diagnose_State_0(&state[Timeinfo.oldt]);
}

void wrk3d_1(struct HybridStateField* state, struct HybridStaticField* staticv, struct HybridTendField* tend, struct HybridTendPara* tendPara, struct HybridAdvField* adv, struct HybridAdvPara* advptPara, struct HybridAdvPara* advmPara, struct HybridMeshField* mesh, double dt, double dtd2, double dtd3)
{
  stepForwardBackward_1(&state[Timeinfo.oldt], &state[Timeinfo.oldt], &state[Timeinfo.newt], &staticv[0], &tend[Timeinfo.oldt], &tend[Timeinfo.newt], tendPara, &adv[0], advptPara, &mesh[0], dtd3);
  stepForwardBackward_1(&state[Timeinfo.oldt], &state[Timeinfo.newt], &state[2], &staticv[0], &tend[Timeinfo.oldt], &tend[Timeinfo.newt], tendPara, &adv[0], advptPara, &mesh[0], dtd2);
  stepForwardBackward_1(&state[Timeinfo.oldt], &state[2], &state[Timeinfo.newt], &staticv[0], &tend[Timeinfo.oldt], &tend[Timeinfo.newt], tendPara, &adv[0], advptPara, &mesh[0], dt);
  damp_run_1(&state[Timeinfo.newt], &tend[Timeinfo.newt], &mesh[0], dt);
  c2a_1(&state[Timeinfo.newt]);
  timeadvance_1();
  adv_run_1(&state[Timeinfo.oldt], &state[Timeinfo.newt], &adv[1], advmPara, &mesh[0], dt);
  Diagnose_State_1(&state[Timeinfo.oldt]);
}

void wrk3d_2(struct HybridStateField* state, struct HybridStaticField* staticv, struct HybridTendField* tend, struct HybridTendPara* tendPara, struct HybridAdvField* adv, struct HybridAdvPara* advptPara, struct HybridAdvPara* advmPara, struct HybridMeshField* mesh, double dt, double dtd2, double dtd3)
{
  stepForwardBackward_2(&state[Timeinfo.oldt], &state[Timeinfo.oldt], &state[Timeinfo.newt], &staticv[0], &tend[Timeinfo.oldt], &tend[Timeinfo.newt], tendPara, &adv[0], advptPara, &mesh[0], dtd3);
  stepForwardBackward_2(&state[Timeinfo.oldt], &state[Timeinfo.newt], &state[2], &staticv[0], &tend[Timeinfo.oldt], &tend[Timeinfo.newt], tendPara, &adv[0], advptPara, &mesh[0], dtd2);
  stepForwardBackward_2(&state[Timeinfo.oldt], &state[2], &state[Timeinfo.newt], &staticv[0], &tend[Timeinfo.oldt], &tend[Timeinfo.newt], tendPara, &adv[0], advptPara, &mesh[0], dt);
  damp_run_2(&state[Timeinfo.newt], &tend[Timeinfo.newt], &mesh[0], dt);
  c2a_2(&state[Timeinfo.newt]);
  timeadvance_2();
  adv_run_2(&state[Timeinfo.oldt], &state[Timeinfo.newt], &adv[1], advmPara, &mesh[0], dt);
  Diagnose_State_2(&state[Timeinfo.oldt]);
}

int main(int argc, char **argv)
{
  int size,rank;
  double tottime_beg, tottime_end;
  MPI_Init(&argc, &argv);
  MPI_Comm_size(MPI_COMM_WORLD, &size);
  MPI_Comm_rank(MPI_COMM_WORLD, &rank);
  ProcInit_LonLat_Domain(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev);
  
  //Proc Ngb Init
  if (Proc.lat_beg >= 0 && Proc.lat_end <= 11){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,337, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 12 && Proc.lat_end <= 23){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,18, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 24 && Proc.lat_end <= 35){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,10, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 36 && Proc.lat_end <= 47){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,7, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 48 && Proc.lat_end <= 59){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,5, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 60 && Proc.lat_end <= 83){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,4, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 84 && Proc.lat_end <= 143){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,3, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 144 && Proc.lat_end <= 1055){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,2, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 1056 && Proc.lat_end <= 1115){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,3, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 1116 && Proc.lat_end <= 1139){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,4, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 1140 && Proc.lat_end <= 1151){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,5, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 1152 && Proc.lat_end <= 1163){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,7, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 1164 && Proc.lat_end <= 1175){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,10, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 1176 && Proc.lat_end <= 1187){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,19, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  if (Proc.lat_beg >= 1188 && Proc.lat_end <= 1199){
    ProcInit_LonLat_Ngb(&Proc,MPI_COMM_WORLD,ProcLatNum,ProcLon,ProcLat,nlon,nlat,nlev,337, 2, 2, 2, 2, DTYPE_DOUBLE, 108);
  }
  
  PhysicalVariableInit();
  
  TimeInit();
  
  athread_init();
  
  global_info gi;
  gi.fnx = Proc.full_nlon;
  gi.fny = Proc.full_nlat;
  gi.fnz = Proc.full_nlev;
  gi.hnx = Proc.half_nlon;
  gi.hny = Proc.half_nlat;
  gi.hnz = Proc.half_nlev;
  gi.ghx = Proc.lon_hw;
  gi.ghy = Proc.lat_hw;
  gi.ghz = Proc.lat_hw;
  athread_spawn(global_prepare, &gi);
  athread_join();
  
  if (Proc.lat_beg >= 0 && Proc.lat_end <= 11)
  {
    MeshInit_0(global_mesh, mesh);
    timeOperatorInit_0(state, staticv, adv, &advptPara, mesh, 30);
    tottime_beg = MPI_Wtime();
    for (int t = 0; t < 30; t += 1){
      wrk3d_0(state, staticv, tend, &tendPara, adv, &advptPara, &advmPara, mesh, 30, 15.0, 10.0);
    }
    tottime_end = MPI_Wtime();
  }
  
  if (Proc.lat_beg >= 12 && Proc.lat_end <= 1187)
  {
    MeshInit_1(global_mesh, mesh);
    timeOperatorInit_1(state, staticv, adv, &advptPara, mesh, 30);
    tottime_beg = MPI_Wtime();
    for (int t = 0; t < 30; t += 1){
      wrk3d_1(state, staticv, tend, &tendPara, adv, &advptPara, &advmPara, mesh, 30, 15.0, 10.0);
    }
    tottime_end = MPI_Wtime();
  }
  
  if (Proc.lat_beg >= 1188 && Proc.lat_end <= 1199)
  {
    MeshInit_2(global_mesh, mesh);
    timeOperatorInit_2(state, staticv, adv, &advptPara, mesh, 30);
    tottime_beg = MPI_Wtime();
    for (int t = 0; t < 30; t += 1){
      wrk3d_2(state, staticv, tend, &tendPara, adv, &advptPara, &advmPara, mesh, 30, 15.0, 10.0);
    }
    tottime_end = MPI_Wtime();
  }
  
  ProfilingOutPut(Proc.id);
  if (Proc.id == 0) printf("Time is %.2f\n",tottime_end-tottime_beg);
}